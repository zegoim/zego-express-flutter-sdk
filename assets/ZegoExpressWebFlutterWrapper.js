window["ZegoFlutterEngine"] =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./sdk/src/webrtc/zego.client.web.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "../zego-express-WebRTC/dist/ZegoExpressWebRTC.js":
/*!********************************************************!*\
  !*** ../zego-express-WebRTC/dist/ZegoExpressWebRTC.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/*! For license information please see ZegoExpressWebRTC.js.LICENSE.txt */
!function(e,t){if(true)module.exports=t(__webpack_require__(/*! zego-express-engine-webrtm */ "../zego-express-WebRTM/dist/ZegoExpressWebRTM.js"));else { var i, r; }}("undefined"!=typeof self?self:this,(function(__WEBPACK_EXTERNAL_MODULE__4119__){return function(){var __webpack_modules__={4537:function(e){"use strict";e.exports=function(e,t){for(var r=new Array(arguments.length-1),i=0,o=2,n=!0;o<arguments.length;)r[i++]=arguments[o++];return new Promise((function(o,s){r[i]=function(e){if(n)if(n=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];o.apply(null,t)}};try{e.apply(t||null,r)}catch(e){n&&(n=!1,s(e))}}))}},7419:function(e,t){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var i=new Array(64),o=new Array(123),n=0;n<64;)o[i[n]=n<26?n+65:n<52?n+71:n<62?n-4:n-59|43]=n++;r.encode=function(e,t,r){for(var o,n=null,s=[],a=0,d=0;t<r;){var c=e[t++];switch(d){case 0:s[a++]=i[c>>2],o=(3&c)<<4,d=1;break;case 1:s[a++]=i[o|c>>4],o=(15&c)<<2,d=2;break;case 2:s[a++]=i[o|c>>6],s[a++]=i[63&c],d=0}a>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),a=0)}return d&&(s[a++]=i[o],s[a++]=61,1===d&&(s[a++]=61)),n?(a&&n.push(String.fromCharCode.apply(String,s.slice(0,a))),n.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";r.decode=function(e,t,r){for(var i,n=r,a=0,d=0;d<e.length;){var c=e.charCodeAt(d++);if(61===c&&a>1)break;if(void 0===(c=o[c]))throw Error(s);switch(a){case 0:i=c,a=1;break;case 1:t[r++]=i<<2|(48&c)>>4,i=c,a=2;break;case 2:t[r++]=(15&i)<<4|(60&c)>>2,i=c,a=3;break;case 3:t[r++]=(3&i)<<6|c,a=0}}if(1===a)throw Error(s);return r-n},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},9211:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}},945:function(e){"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),i=128===r[3];function o(e,i,o){t[0]=e,i[o]=r[0],i[o+1]=r[1],i[o+2]=r[2],i[o+3]=r[3]}function n(e,i,o){t[0]=e,i[o]=r[3],i[o+1]=r[2],i[o+2]=r[1],i[o+3]=r[0]}function s(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],t[0]}function a(e,i){return r[3]=e[i],r[2]=e[i+1],r[1]=e[i+2],r[0]=e[i+3],t[0]}e.writeFloatLE=i?o:n,e.writeFloatBE=i?n:o,e.readFloatLE=i?s:a,e.readFloatBE=i?a:s}():function(){function t(e,t,r,i){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,r,i);else if(isNaN(t))e(2143289344,r,i);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,r,i);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,r,i);else{var n=Math.floor(Math.log(t)/Math.LN2);e((o<<31|n+127<<23|8388607&Math.round(t*Math.pow(2,-n)*8388608))>>>0,r,i)}}function s(e,t,r){var i=e(t,r),o=2*(i>>31)+1,n=i>>>23&255,s=8388607&i;return 255===n?s?NaN:o*(1/0):0===n?1401298464324817e-60*o*s:o*Math.pow(2,n-150)*(s+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,i),e.readFloatLE=s.bind(null,o),e.readFloatBE=s.bind(null,n)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),i=128===r[7];function o(e,i,o){t[0]=e,i[o]=r[0],i[o+1]=r[1],i[o+2]=r[2],i[o+3]=r[3],i[o+4]=r[4],i[o+5]=r[5],i[o+6]=r[6],i[o+7]=r[7]}function n(e,i,o){t[0]=e,i[o]=r[7],i[o+1]=r[6],i[o+2]=r[5],i[o+3]=r[4],i[o+4]=r[3],i[o+5]=r[2],i[o+6]=r[1],i[o+7]=r[0]}function s(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],r[4]=e[i+4],r[5]=e[i+5],r[6]=e[i+6],r[7]=e[i+7],t[0]}function a(e,i){return r[7]=e[i],r[6]=e[i+1],r[5]=e[i+2],r[4]=e[i+3],r[3]=e[i+4],r[2]=e[i+5],r[1]=e[i+6],r[0]=e[i+7],t[0]}e.writeDoubleLE=i?o:n,e.writeDoubleBE=i?n:o,e.readDoubleLE=i?s:a,e.readDoubleBE=i?a:s}():function(){function t(e,t,r,i,o,n){var s=i<0?1:0;if(s&&(i=-i),0===i)e(0,o,n+t),e(1/i>0?0:2147483648,o,n+r);else if(isNaN(i))e(0,o,n+t),e(2146959360,o,n+r);else if(i>17976931348623157e292)e(0,o,n+t),e((s<<31|2146435072)>>>0,o,n+r);else{var a;if(i<22250738585072014e-324)e((a=i/5e-324)>>>0,o,n+t),e((s<<31|a/4294967296)>>>0,o,n+r);else{var d=Math.floor(Math.log(i)/Math.LN2);1024===d&&(d=1023),e(4503599627370496*(a=i*Math.pow(2,-d))>>>0,o,n+t),e((s<<31|d+1023<<20|1048576*a&1048575)>>>0,o,n+r)}}}function s(e,t,r,i,o){var n=e(i,o+t),s=e(i,o+r),a=2*(s>>31)+1,d=s>>>20&2047,c=4294967296*(1048575&s)+n;return 2047===d?c?NaN:a*(1/0):0===d?5e-324*a*c:a*Math.pow(2,d-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=s.bind(null,o,0,4),e.readDoubleBE=s.bind(null,n,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function i(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function n(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7199:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},6662:function(e){"use strict";e.exports=function(e,t,r){var i=r||8192,o=i>>>1,n=null,s=i;return function(r){if(r<1||r>o)return e(r);s+r>i&&(n=e(i),s=0);var a=t.call(n,s,s+=r);return 7&s&&(s=1+(7|s)),a}}},4997:function(e,t){"use strict";var r=t;r.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)(r=e.charCodeAt(i))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var i,o=null,n=[],s=0;t<r;)(i=e[t++])<128?n[s++]=i:i>191&&i<224?n[s++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,n[s++]=55296+(i>>10),n[s++]=56320+(1023&i)):n[s++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,n)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,n.slice(0,s))),o.join("")):String.fromCharCode.apply(String,n.slice(0,s))},r.write=function(e,t,r){for(var i,o,n=r,s=0;s<e.length;++s)(i=e.charCodeAt(s))<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&56320==(64512&(o=e.charCodeAt(s+1)))?(i=65536+((1023&i)<<10)+(1023&o),++s,t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128);return r-n}},2100:function(e,t,r){"use strict";e.exports=r(9482)},9482:function(e,t,r){"use strict";var i=t;function o(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}i.build="minimal",i.Writer=r(1173),i.BufferWriter=r(3155),i.Reader=r(1408),i.BufferReader=r(593),i.util=r(9693),i.rpc=r(5994),i.roots=r(5054),i.configure=o,o()},1408:function(e,t,r){"use strict";e.exports=d;var i,o=r(9693),n=o.LongBits,s=o.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function d(e){this.buf=e,this.pos=0,this.len=e.length}var c,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new d(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new d(e);throw Error("illegal buffer")},l=function(){return o.Buffer?function(e){return(d.create=function(e){return o.Buffer.isBuffer(e)?new i(e):u(e)})(e)}:u};function h(){var e=new n(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function g(){if(this.pos+8>this.len)throw a(this,8);return new n(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}d.create=l(),d.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,d.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return c}),d.prototype.int32=function(){return 0|this.uint32()},d.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},d.prototype.bool=function(){return 0!==this.uint32()},d.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)},d.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|p(this.buf,this.pos+=4)},d.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},d.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},d.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},d.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},d.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},d.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},d._configure=function(e){i=e,d.create=l(),i._configure();var t=o.Long?"toLong":"toNumber";o.merge(d.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return g.call(this)[t](!0)},sfixed64:function(){return g.call(this)[t](!1)}})}},593:function(e,t,r){"use strict";e.exports=n;var i=r(1408);(n.prototype=Object.create(i.prototype)).constructor=n;var o=r(9693);function n(e){i.call(this,e)}n._configure=function(){o.Buffer&&(n.prototype._slice=o.Buffer.prototype.slice)},n.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},n._configure()},5054:function(e){"use strict";e.exports={}},5994:function(e,t,r){"use strict";t.Service=r(7948)},7948:function(e,t,r){"use strict";e.exports=o;var i=r(9693);function o(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(o.prototype=Object.create(i.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(t,r,o,n,s){if(!n)throw TypeError("request must be specified");var a=this;if(!s)return i.asPromise(e,a,t,r,o,n);if(a.rpcImpl)try{return a.rpcImpl(t,r[a.requestDelimited?"encodeDelimited":"encode"](n).finish(),(function(e,r){if(e)return a.emit("error",e,t),s(e);if(null!==r){if(!(r instanceof o))try{r=o[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",r,t),s(null,r)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:function(e,t,r){"use strict";e.exports=o;var i=r(9693);function o(e,t){this.lo=e>>>0,this.hi=t>>>0}var n=o.zero=new o(0,0);n.toNumber=function(){return 0},n.zzEncode=n.zzDecode=function(){return this},n.length=function(){return 1};var s=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return n;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new o(r,i)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if(i.isString(e)){if(!i.Long)return o.fromNumber(parseInt(e,10));e=i.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):n},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;o.fromHash=function(e){return e===s?n:new o((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},o.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},o.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},9693:function(e,t,r){"use strict";var i=t;function o(e,t,r){for(var i=Object.keys(t),o=0;o<i.length;++o)void 0!==e[i[o]]&&r||(e[i[o]]=t[i[o]]);return e}function n(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&o(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}i.asPromise=r(4537),i.base64=r(7419),i.EventEmitter=r(9211),i.float=r(945),i.inquire=r(7199),i.utf8=r(4997),i.pool=r(6662),i.LongBits=r(1945),i.isNode=Boolean(void 0!==r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),i.global=i.isNode&&r.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},i.isString=function(e){return"string"==typeof e||e instanceof String},i.isObject=function(e){return e&&"object"==typeof e},i.isset=i.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(e){return"number"==typeof e?i.Buffer?i._Buffer_allocUnsafe(e):new i.Array(e):i.Buffer?i._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(e){return e?i.LongBits.from(e).toHash():i.LongBits.zeroHash},i.longFromHash=function(e,t){var r=i.LongBits.fromHash(e);return i.Long?i.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},i.merge=o,i.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},i.newError=n,i.ProtocolError=n("ProtocolError"),i.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},i.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var e=i.Buffer;e?(i._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},i._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):i._Buffer_from=i._Buffer_allocUnsafe=null}},1173:function(e,t,r){"use strict";e.exports=l;var i,o=r(9693),n=o.LongBits,s=o.base64,a=o.utf8;function d(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function c(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function l(){this.len=0,this.head=new d(c,0,0),this.tail=this.head,this.states=null}var h=function(){return o.Buffer?function(){return(l.create=function(){return new i})()}:function(){return new l}};function p(e,t,r){t[r]=255&e}function g(e,t){this.len=e,this.next=void 0,this.val=t}function f(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function _(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}l.create=h(),l.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(l.alloc=o.pool(l.alloc,o.Array.prototype.subarray)),l.prototype._push=function(e,t,r){return this.tail=this.tail.next=new d(e,t,r),this.len+=t,this},g.prototype=Object.create(d.prototype),g.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},l.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new g((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},l.prototype.int32=function(e){return e<0?this._push(f,10,n.fromNumber(e)):this.uint32(e)},l.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},l.prototype.uint64=function(e){var t=n.from(e);return this._push(f,t.length(),t)},l.prototype.int64=l.prototype.uint64,l.prototype.sint64=function(e){var t=n.from(e).zzEncode();return this._push(f,t.length(),t)},l.prototype.bool=function(e){return this._push(p,1,e?1:0)},l.prototype.fixed32=function(e){return this._push(_,4,e>>>0)},l.prototype.sfixed32=l.prototype.fixed32,l.prototype.fixed64=function(e){var t=n.from(e);return this._push(_,4,t.lo)._push(_,4,t.hi)},l.prototype.sfixed64=l.prototype.fixed64,l.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},l.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var m=o.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};l.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(o.isString(e)){var r=l.alloc(t=s.length(e));s.decode(e,r,0),e=r}return this.uint32(t)._push(m,t,e)},l.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(p,1,0)},l.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new d(c,0,0),this.len=0,this},l.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new d(c,0,0),this.len=0),this},l.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},l.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},l._configure=function(e){i=e,l.create=h(),i._configure()}},3155:function(e,t,r){"use strict";e.exports=n;var i=r(1173);(n.prototype=Object.create(i.prototype)).constructor=n;var o=r(9693);function n(){i.call(this)}function s(e,t,r){e.length<40?o.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}n._configure=function(){n.alloc=o._Buffer_allocUnsafe,n.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]}},n.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(n.writeBytesBuffer,t,e),this},n.prototype.string=function(e){var t=o.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},n._configure()},4095:function(e,t){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoAudioEffectPlayer=void 0;var i=function(){function e(e,t){this.zegoWebRTC=e,this.stream=t}return e.prototype.start=function(e,t,i,o){this.zegoWebRTC.playEffect(r({stream:this.stream,effectID:e},t||{}),i,o)},e.prototype.stop=function(e){return this.zegoWebRTC.stopEffect(this.stream,e)},e.prototype.pause=function(e){return this.zegoWebRTC.pauseEffect(this.stream,e)},e.prototype.resume=function(e){return this.zegoWebRTC.resumeEffect(this.stream,e)},e.prototype.setVolume=function(e,t){return this.zegoWebRTC.setEffectVolume(e,t)},e.prototype.getTotalDuration=function(e){return this.zegoWebRTC.getEffectDuration(e)},e.prototype.getCurrentProgress=function(e){return this.zegoWebRTC.getEffectCurrentProgress(this.stream,e)},e.prototype.seekTo=function(e,t){return this.zegoWebRTC.seekAudioEffect(this.stream,e,t)},e}();t.ZegoAudioEffectPlayer=i},8835:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRealTimeSequentialDataManager=void 0;var i=r(3504),o=function(){function e(e,t){this.dataChannelManager=new i.DataChannelListener(e,t)}return e.prototype.startBroadcasting=function(e){return this.dataChannelManager.startBroadcasting(e)},e.prototype.stopBroadcasting=function(e){return this.dataChannelManager.stopBroadcasting(e)},e.prototype.sendRealTimeSequentialData=function(e,t){return this.dataChannelManager.sendRealTimeSequentialData(e,t)},e.prototype.startSubscribing=function(e){return this.dataChannelManager.startSubscribing(e)},e.prototype.stopSubscribing=function(e){return this.dataChannelManager.stopSubscribing(e)},e.prototype.on=function(e,t){this.dataChannelManager.on(e,t)},e.prototype.off=function(e,t){this.dataChannelManager.off(e,t)},e}();t.ZegoRealTimeSequentialDataManager=o},1297:function(e,t){"use strict";var r,i,o,n;Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSEIType=t.ZegoRangeAudioMode=t.ZegoRangeAudioMicrophoneState=t.ZegoMixStreamRenderMode=void 0,(n=t.ZegoMixStreamRenderMode||(t.ZegoMixStreamRenderMode={}))[n.AspectFill=0]="AspectFill",n[n.AspectFit=1]="AspectFit",(o=t.ZegoRangeAudioMicrophoneState||(t.ZegoRangeAudioMicrophoneState={}))[o.Off=0]="Off",o[o.TurningOn=1]="TurningOn",o[o.On=2]="On",(i=t.ZegoRangeAudioMode||(t.ZegoRangeAudioMode={}))[i.World=0]="World",i[i.Team=1]="Team",(r=t.ZegoSEIType||(t.ZegoSEIType={}))[r.ZegoDefined=0]="ZegoDefined",r[r.UserUnregister=1]="UserUnregister"},3116:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressRangeAudio=void 0;var o=i(r(2760)),n=function(){function e(e){this.zegoAudioListener=o.default.getInstance(e)}return e.getInstance=function(t){if(!e.instance){if(!t)throw Error("create instance failed.");e.instance=new e(t)}return e.instance},e.prototype.on=function(e,t){return this.zegoAudioListener.on(e,t)},e.prototype.off=function(e,t){return this.zegoAudioListener.off(e,t)},e.prototype.setAudioReceiveRange=function(e){this.zegoAudioListener.setAudioReceiveRange(e)},e.prototype.updateSelfPosition=function(e,t,r,i){this.zegoAudioListener.updateSelfPosition(e,t,r,i)},e.prototype.updateAudioSource=function(e,t){this.zegoAudioListener.updateAudioSource(e,t)},e.prototype.enableSpatializer=function(e){return this.zegoAudioListener.enableSpatializer(e)},e.prototype.enableMicrophone=function(e){return this.zegoAudioListener.enableMicrophone(e)},e.prototype.enableSpeaker=function(e){return this.zegoAudioListener.enableSpeaker(e)},e.prototype.setRangeAudioMode=function(e){this.zegoAudioListener.setRangeAudioMode(e)},e.prototype.setTeamID=function(e){this.zegoAudioListener.setRangeAudioTeamID(e)},e.prototype.isAudioContextRunning=function(){return"running"===this.zegoAudioListener.getAudioContextState()},e.prototype.resumeAudioContext=function(){return this.zegoAudioListener.resumeAudioContext()},e}();t.ZegoExpressRangeAudio=n},4780:function(e,t,r){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressEngine=t.ClientUtil=void 0;var s=r(9880),a=n(r(1700)),d=n(r(3827)),c=n(r(3824)),u=n(r(7526)),l=n(r(577)),h=r(2777),p=r(4897),g=r(957);s.ZegoExpressEngine.use(a.default),s.ZegoExpressEngine.use(d.default),s.ZegoExpressEngine.use(c.default),s.ZegoExpressEngine.use(u.default),s.ZegoExpressEngine.use(l.default),s.ZegoExpressEngine.use(h.RangeAudio),s.ZegoExpressEngine.use(p.DataChannel),s.ZegoExpressEngine.use(g.BeautyEffect);var f=r(9880);Object.defineProperty(t,"ClientUtil",{enumerable:!0,get:function(){return f.ClientUtil}});var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(s.ZegoExpressEngine);t.ZegoExpressEngine=_},9880:function(e,t,r){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.ClientUtil=t.ZegoExpressEngine=void 0;var n=r(4119),s=r(5321),a=r(4095),d=function(e){function t(t,r){var i=this;return n.ZegoExpressWebRTMEngine.version="2.16.1",(i=e.call(this,t,r,0,arguments[2])||this).zegoWebRTC=new s.ZegoWebRTC(i.logger,i.dataReport,i.zegoWebRTM),i}return o(t,e),t.prototype.setSEIConfig=function(e){this.zegoWebRTC.setSEIConfig(e)},t.use=function(e){n.ZegoExpressWebRTMEngine.use(e),s.ZegoWebRTC.use(e)},t.prototype.checkSystemRequirements=function(e,t){return void 0===t&&(t=0),this.zegoWebRTC.checkSystemRequirements(t,e)},t.prototype.off=function(e,t){return this.zegoWebRTM.stateCenter.listenerList[e]?this.zegoWebRTM.off(e,t):!!this.zegoWebRTC.stateCenter.listenerList[e]&&this.zegoWebRTC.off(e,t)},t.prototype.on=function(e,t){return this.zegoWebRTM.stateCenter.listenerList[e]?this.zegoWebRTM.on(e,t):!!this.zegoWebRTC.stateCenter.listenerList[e]&&this.zegoWebRTC.on(e,t)},t.prototype.createStream=function(e){return this.zegoWebRTC.createStream(e)},t.prototype.getPublishingStreamQuality=function(e){return this.zegoWebRTC.getPublishingStreamQuality(e)},t.prototype.sendSEI=function(e,t){return this.zegoWebRTC.sendSEI(e,t)},t.prototype.getElectronScreenSources=function(){return this.zegoWebRTC.getElectronScreenSources()},t.prototype.destroyStream=function(e){return this.zegoWebRTC.destroyStream(e)},t.prototype.startPublishingStream=function(e,t,r){return this.zegoWebRTC.startPublishingStream(e,t,r)},t.prototype.stopPublishingStream=function(e){return this.zegoWebRTC.stopPublishingStream(e)},t.prototype.setVideoConfig=function(e,t){return this.zegoWebRTC.setVideoConfig(e,t)},t.prototype.setAudioConfig=function(e,t){return this.zegoWebRTC.setAudioConfig(e,t)},t.prototype.replaceTrack=function(e,t){return this.zegoWebRTC.replaceTrack(e,t)},t.prototype.setCaptureVolume=function(e,t){return this.zegoWebRTC.setCaptureVolume(e,t)},t.prototype.setDummyCaptureImagePath=function(e,t){return this.zegoWebRTC.setDummyCaptureImagePath(e,t)},t.prototype.setStreamExtraInfo=function(e,t){return this.zegoWebRTC.setStreamExtraInfo(e,t)},t.prototype.addPublishCdnUrl=function(e,t){return 3===arguments.length?this.zegoWebRTC.addPublishCdnUrl(arguments[0],arguments[2]):this.zegoWebRTC.addPublishCdnUrl(e,t)},t.prototype.removePublishCdnUrl=function(e,t){return 3===arguments.length?this.zegoWebRTC.removePublishCdnUrl(arguments[0],arguments[2]):this.zegoWebRTC.removePublishCdnUrl(e,t)},t.prototype.mutePublishStreamVideo=function(e,t,r){return this.zegoWebRTC.mutePublishStreamVideo(e,t,r)},t.prototype.mutePublishStreamAudio=function(e,t){return this.zegoWebRTC.mutePublishStreamAudio(e,t)},t.prototype.setEffectsBeauty=function(e,t,r){return this.zegoWebRTC.setBeautyEffect(e,t,r)},t.prototype.startPlayingStream=function(e,t){return this.zegoWebRTC.startPlayingStream(e,t)},t.prototype.stopPlayingStream=function(e){return this.zegoWebRTC.stopPlayingStream(e)},t.prototype.mutePlayStreamVideo=function(e,t){return this.zegoWebRTC.mutePlayStreamVideo(e,t)},t.prototype.mutePlayStreamAudio=function(e,t){return this.zegoWebRTC.mutePlayStreamAudio(e,t)},t.prototype.getPlayingStreamQuality=function(e){return this.zegoWebRTC.getPlayingStreamQuality(e)},t.prototype.startMixerTask=function(e){return this.zegoWebRTC.startMixerTask(e)},t.prototype.stopMixerTask=function(e){return this.zegoWebRTC.stopMixerTask(e)},t.prototype.setMixerTaskConfig=function(e){return this.zegoWebRTC.setMixerTaskConfig(e)},t.prototype.startMixingAudio=function(e,t){return this.zegoWebRTC.startMixingAudio(e,t)},t.prototype.stopMixingAudio=function(e,t){return this.zegoWebRTC.stopMixingAudio(e,t)},t.prototype.setMixingAudioVolume=function(e,t,r){return this.zegoWebRTC.setMixingAudioVolume(e,t,r)},t.prototype.createAudioEffectPlayer=function(e){if(e instanceof MediaStream)return new a.ZegoAudioEffectPlayer(this.zegoWebRTC,e);throw Error("Param localStream is not instance of MediaStream.")},t.prototype.loadAudioEffect=function(e,t){var r=this;return new Promise((function(i,o){r.zegoWebRTC.preloadEffect(e,t,(function(t){t&&o(t),i(e)}))}))},t.prototype.unloadAudioEffect=function(e){return this.zegoWebRTC.unloadEffect(e)},t.prototype.enumDevices=function(){return this.zegoWebRTC.enumDevices()},t.prototype.getCameras=function(){return this.zegoWebRTC.getCameras()},t.prototype.getMicrophones=function(){return this.zegoWebRTC.getMicrophones()},t.prototype.getSpeakers=function(){return this.zegoWebRTC.getSpeakers()},t.prototype.useVideoDevice=function(e,t){return this.zegoWebRTC.useVideoDevice(e,t)},t.prototype.useAudioDevice=function(e,t){return this.zegoWebRTC.useAudioDevice(e,t)},t.prototype.useAudioOutputDevice=function(e,t){return this.zegoWebRTC.setAudioOutputDevice(e,t)},t.prototype.setSoundLevelDelegate=function(e,t,r){return this.zegoWebRTC.setSoundLevelDelegate(e,t,null==r?void 0:r.enableInBackground)},t.prototype.isMicrophoneMuted=function(){return this.zegoWebRTC.isMicrophoneMuted()},t.prototype.muteMicrophone=function(e){return this.zegoWebRTC.muteMicrophone(e)},t.prototype.enableVideoCaptureDevice=function(e,t){return this.zegoWebRTC.enableCameraCapturing(e,t)},t.prototype.createRangeAudioInstance=function(){return this.zegoWebRTC.createRangeAudioInstance()},t.prototype.createRealTimeSequentialDataManager=function(e){return this.zegoWebRTC.createRealTimeSequentialDataManager(e)},t.prototype.destroyRealTimeSequentialDataManager=function(e){this.zegoWebRTC.destroyRealTimeSequentialDataManager(e)},t}(n.ZegoExpressWebRTMEngine);t.ZegoExpressEngine=d;var c=r(608);Object.defineProperty(t,"ClientUtil",{enumerable:!0,get:function(){return c.ClientUtil}})},1089:function(e,t){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_WECHATMINI_ACTION=t.ZEGO_WEBRTC_ACTION=void 0,(i=t.ZEGO_WEBRTC_ACTION||(t.ZEGO_WEBRTC_ACTION={})).CONSTRUCTOR="zc.0",i.CHECK_SUPPORT="zc.csr",i.CREATE_STREAM="zc.cs",i.DESTROY_STREAM="zc.ds",i.START_PUBLISHING_STREAM="zc.sps.0",i.START_PLAYING_STREAM="zc.sps.1",i.STOP_PUBLISHING_STREAM="zc.sps.0.0",i.STOP_PLAYING_STREAM="zc.sps.1.0",i.SET_MEDIA_SIDE_FLAGS="zc.smsg.0",i.SEND_MEDIA_SIDE_INFO="zc.smsi.0",i.ON_STREAM="zc.os",i.ON_PUSH_STREAM_UPDATE="zc.opsu",i.BIND_WINDOW_LISTENER="zc.wl",i.SET_AUDIO_OUTPUT="zc.sao",i.SET_CUSTOM_SIGNAL_URL="zc.scsu",i.SET_TURN_OVER_TCP_ONLY="zc.stoto",i.RDH_ACTIVE="zc.rdh.a",i.RDH_MAX_TIME="zc.rdh.m",i.RDH_WEBRTC_URL_RSP="zc.rdh.hfwur",i.PUBLISH_STATE_HANDLE="zc.psh.0",i.PLAY_STATE_HANDLE="zc.psh.1",i.STATECENTER_ACTION_LISTENER="zc.sc.al",i.STATECENTER_SET_SETTING="zc.sc.ss",i.SIGNAL_SET_SESSION_INFO="zc.s.ssi",i.SIGNAL_RESET_CONNECT_TIMER="zc.s.rct",i.SIGNAL_BIND_WEBSOCKET_HANDLE="zc.s.bwh",i.SIGNAL_RESET_CHECK_MESSAGE="zc.s.rcm",i.SIGNAL_UPDATE_TOKEN="zc.s.ut",i.SIGNAL_SEND_MESSAGE_WITH_CALLBACK="zc.s.smwc",i.SIGNAL_CONNECT_SERVER="zc.s.cs.0",i.SIGNAL_START_CONNECT_TIMER="zc.s.sct",i.SIGNAL_DISCONNECT_SERVER="zc.s.dc",i.SIGNAL_CREATE_SESSION="zc.s.cs.1",i.SIGNAL_REMOVE_SESSION="zc.s.rs",i.SIGNAL_SEND_REMOVE_SESSION="zc.s.srs",i.SIGNAL_SEND_MESSAGE="zc.s.sm",i.SIGNAL_HANDLE_RESPOND_DATA="zc.s.hrd",i.SIGNAL_ADD_SESSION="zc.s.as",i.SIGNAL_HANDLE_PUSH_DATA="zc.s.hpd",i.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA="zc.s.hprsd",i.SIGNAL_SEND_MEDIA_DESC="zc.s.smd",i.SIGNAL_SEND_CANDIDATE_INFO="zc.s.sci",i.SIGNAL_SEND_MEDIA_DESC_ACK="zc.s.smda",i.SIGNAL_SEND_CANDIDATE_INFO_ACK="zc.s.scia",i.SIGNAL_SEND_CLOSE_SESSION_ACK="zc.s.scsa",i.SIGNAL_SEND_RESET_SESSION_ACK="zc.s.srsa",i.SIGNAL_REGISTER_PUSH_CALLBACK="zc.s.rpc",i.SIGNAL_CHECK_MESSAGE_TIMEOUT="zc.s.cmt",i.SIGNAL_SEND_HEARTBEAT="zc.s.sh",i.SIGNAL_QUALITY_REPORT="zc.s.qr",i.SIGNAL_SEND_STREAM_STATUS="zc.s.sss",i.SIGNAL_ACTIVE_PLAY_VIDEO_STREAM="zc.s.apvs",i.SIGNAL_ACTIVE_PLAY_AUDIO_STREAM="zc.s.apas",i.SIGNAL_SEND_BROADCAST_STATUS="zc.s.sbs",i.SIGNAL_SEND_NET_PROBE="zc.s.snp",i.SIGNAL_SEND_NET_QUALITY_INFO_PUSH_ACK="zc.s.npa",i.PUBLISHER_START_PUBLISH="zc.p.0.sp.0",i.PUBLISHER_PUBLISH_SUCCESS="zc.p.ps",i.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS="zc.p.0.ocpss",i.PUBLISHER_HANDLE_CREATE_SESSION_WITH_SDP="zc.p.0.hcsws",i.PUBLISHER_ON_CREATE_OFFER_SUCCESS="zc.p.0.ocos",i.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS="zc.p.0.oslds",i.PUBLISHER_ON_GET_REMOTE_DESCRIPTION="zc.p.0.ogrd",i.PUBLISHER_ON_RECV_MEDIA_DESC="zc.p.0.ormd",i.PUBLISHER_ON_RECV_CANDIDATE_INFO="zc.p.0.orci.0",i.PUBLISHER_ON_RECV_PUBLISH_EVENT="zc.p.0.orpe",i.PUBLISHER_ON_RECV_CLIENT_INFO="zc.p.0.orci.1",i.PUBLISHER_ON_ICE_CANDIDATE="zc.p.0.oic",i.PUBLISHER_ON_CONNECTION_STATE_CHANGE="zc.p.0.ocsc",i.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE="zc.p.0.oicsc",i.PUBLISHER_RESET_PUBLISH="zc.p.0.rp",i.PUBLISHER_SET_PLAYER_QUALITY_TIMER="zc.p.0.spqt",i.PUBLISHER_UPLOAD_PUBLISH_QUALITY="zc.p.0.upq",i.PUBLISHER_ON_RECV_RESET_SESSION="zc.p.0.orrs",i.PUBLISHER_ON_RECV_CLOSE_SESSION="zc.p.0.orcs",i.PUBLISHER_SEND_CANDIDATE_INFO="zc.p.0.sci",i.PUBLISHER_STATE_ERROR="zc.p.0.psr",i.PUBLISHER_STOP_PUBLISH="zc.p.0.sp.1",i.PUBLISHER_ON_DISCONNECT="zc.p.0.od",i.PUBLISHER_START_SOUND_LEVEL="zc.p.0.ssl.0",i.PUBLISHER_STOP_SOUND_LEVEL="zc.p.0.ssl.1",i.PUBLISHER_HANDLE_ENC_BITRATE="zc.p.0.heb",i.PUBLISHER_ON_RECV_NET_QUALITY_INFO="zc.p.0.nqi",i.PUBLISHER_ON_RECV_UPDATE_MEDIA_DESC="zc.p.0.orumd",i.PUBLISHER_SEND_SEI="zc.p.0.ss",i.PLAYER_START_PLAY="zc.p.1.sp.0",i.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS="zc.p.ocpss.1",i.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP="zc.p.hcsws.1",i.PLAYER_ON_CREATE_OFFER_SUCCESS="zc.p.ocos.1",i.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS="zc.p.oslds.1",i.PLAYER_ON_RECV_MEDIA_DESC="zc.p.ormd.1",i.PLAYER_ON_RECV_CANDIDATE_INFO="zc.p.orci.1",i.PLAYER_ON_RECV_PLAY_EVENT="zc.p.orpe.1",i.PLAYER_ON_RECV_CLIENT_INFO="zc.p.orci.1.1",i.PLAYER_ON_ICE_CANDIDATE="zc.p.oic.1",i.PLAYER_ON_CONNECTION_STATE_CHANGE="zc.p.ocsc.1",i.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE="zc.p.oicsc.1",i.PLAYER_RESET_PLAY="zc.p.rp.1",i.PLAYER_SET_PLAYER_QUALITY_TIMER="zc.p.spqt.1",i.PLAYER_UPLOAD_PLAYER_QUALITY="zc.p.upq.1",i.PLAYER_ON_RECV_RESET_SESSION="zc.p.orrs.1",i.PLAYER_ON_RECV_CLOSE_SESSION="zc.p.orcs.1",i.PLAYER_ON_RECV_STREAM_STATUS="zc.p.orss.1",i.PLAYER_ON_GOT_REMOTE_STREAM="zc.p.ogrs.1",i.PAYER_GET_VIDEO_CODEC="zc.p.gvc",i.PLAYER_SEND_CANDIDATE_INFO="zc.p.sci.1",i.PLAYER_STATE_ERROR="zc.p.psr.1",i.PLAYER_STOP_PLAY="zc.p.1.sp.1",i.PLAYER_ON_DISCONNECT="zc.p.od.1",i.PLAYER_START_SOUND_LEVEL="zc.p.ssl.1",i.PLAYER_STOP_SOUND_LEVEL="zc.p.ssl.1.1",i.PLAYER_ON_RECV_NET_QUALITY_INFO="zc.p.1.nqi",i.UPLOAD_SPEED_LOG_QUALITY="zc.uslq",i.PUBLISH_SET_CAPTURE_VOLUME="zc.p.scv",i.PUBLISH_SET_BEAUTY_EFFECT="zc.p.0.sbe",i.STREAMHANDLER_MERGE_STREAM_BY_STREAM_SEQ="zc.sh.msbss",i.STREAMHANDLER_MERGE_STREAM="zc.sh.ms",i.STREAMHANDLER_PATCH_STREAM_LIST="zc.sh.psl",i.STREAMHANDLER_SEND_BIZCHANNEL_REQUESTV2="zc.sh.sbr",i.ANALOGSOCKET_UPDATE_MEDIA_READY_STATE="zc.as.umrs",i.ANALOGSOCKET_UPDATE_ACCESS_READY_STATE="zc.as.uars",i.ANALOGSOCKET_SET_MEDIA_SERVER_STATE="zc.as.smss",i.ANALOGSOCKET_SET_ACCESS_SERVER_STATE="zc.as.sass",i.ANALOGSOCKET_SEND="zc.as.s.0",i.ANALOGSOCKET_OPEN="zc.as.op",(r=t.ZEGO_WECHATMINI_ACTION||(t.ZEGO_WECHATMINI_ACTION={})).ADD_PUBLISH_CDN_URL="zw.apcu",r.REMOVE_PUBLISH_CDN_URL="zw.rpcu",r.STOP_MIXER_TASK="zw.smt",r.ON_STREAM="zw.os",r.ON_PUSH_STREAM_UPDATE="zw.opsu",r.ON_PUBLISH_STATE_UPDATE="zw.w.opsu",r.ON_PUBLISH_STATE_UPDATE_HANDLE="zw.w.opsuh",r.WECHATMINI_SETPREFERPLAYSOURCETYPE="zw.w.sppst.1",r.WECHATMINI_BIND_LISTENER="zw.w.bl",r.WECHATMINI_DELETE_LISTENER="zw.w.dl",r.WECHATMINI_UPDATE_PLAYER_STATE="zw.w.ups",r.WECHATMINI_UPDATE_PLAYER_NET_STATUS="zw.w.upns",r.WECHATMINI_SET_CUSTOM_SIGNAL_URL="zw.w.scsu",r.WECHATMINI_GET_NEXT_URL="zw.w.gnu",r.WECHATMINI_BIND_STREAM_CENTER_HANDLER="zw.w.bsch",r.WECHATMINI_BIND_RTM_LISTENER="zw.w.brl",r.PUBLISHMODULE_SET_PREFER_PUBLISH_SOURCE_TYPE="zw.pu.sppst.0",r.PUBLISHMODULE_START_PUBLISHING_STREAM="zw.pu.sps.0",r.PUBLISHMODULE_STOP_PUBLISHING_STREAM="zw.pu.sps.0.0",r.PUBLISHMODULE_FETCH_PUBLISH_STREAM_URL="zw.pu.fpsu.0",r.PUBLISHMODULE_HANDLE_FETCH_STREAM_PUBLISH_URL_RSP="zw.pu.hfspur.0",r.PUBLISHMODULE_DO_PUBLISH_STREAM="zw.pu.dps.0",r.PUBLISHMODULE_UPDATE_STREAM_INFO="zw.pu.upi",r.PUBLISHMODULE_HANDLE_STREAM_UPDATE_RSP="zw.pu.hsur",r.PLAYMODULE_START_PLAYING_STREAM="zw.pl.sps.1",r.PLAYMODULE_STOP_PLAYING_STREAM="zw.pl.sps.1.0",r.PLAYMODULE_START_PLAYING_STREAM_FROM_CDN="zw.pl.spsfc",r.PLAYMODULE_START_PLAYING_STREAM_FROM_BGP="zw.pl.spsfb",r.PLAYMODULE_DO_PLAY_STREAM="zw.pl.dps",r.PLAYMODULE_FETCH_PLAY_STREAM_URL="zw.pl.fpsu",r.PLAYMODULE_HANDLE_FETCH_STREAM_URL_RSP="zw.pl.hfsur",r.STREAMCENTERWECHAT_RESET="zw.scw.r.0",r.STREAMCENTERWECHAT_START_PUBLISHING_STREAM="zw.scw.sps.0",r.STREAMCENTERWECHAT_START_PLAYING_STREAM="zw.scw.sps.1",r.STREAMCENTERWECHAT_START_PLAYER="zw.scw.sp.0",r.STREAMCENTERWECHAT_ON_STREAM_URL_UPDATE="zw.scw.opuu.0",r.STREAMCENTERWECHAT_UPDATE_PLAYER_STATE="zw.scw.ups.0",r.STREAMCENTERWECHAT_UPDATE_PLAYER_NET_STATUS="zw.scw.upns",r.STREAMCENTERWECHAT_UPDATE_PUBLISHING_STATE="zw.scw.ups.0.0",r.STREAMCENTERWECHAT_UPDATE_PLAYING_STATE="zw.scw.ups.1.0",r.STREAMCENTERWECHAT_GET_NEXT_URL="zw.scw.gnu",r.STREAMCENTERWECHAT_STOP_PUBLISHING_STREAM="zw.scw.sps.0.0",r.STREAMCENTERWECHAT_STOP_PLAYING_STREAM="zw.scw.sps.1.0",r.STREAMCENTERWECHAT_STOP_PLAYER="zw.scw.sp.1",r.STREAMCENTERWECHAT_ON_PLAY_START="zw.scw.ops.0",r.STREAMCENTERWECHAT_ON_PLAY_STOP="zw.scw.ops.1",r.STREAMCENTERWECHAT_ON_PLAY_RETRY="zw.scw.opr",r.PLAYWECHAT_TRY_START_PLAYER="zw.pw.tsp.0",r.PLAYWECHAT_UPDATE_EVENT="zw.pw.ue",r.PLAYWECHAT_GET_PLAY_URL="zw.pw.gpu"},9595:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTC=t.ZegoSettingConfig=void 0;var r=function(){function e(){this.defaultSetting={publish_video_codec:"H264",camera_video_bitrate:800,screen_video_bitrate:1500,custom_video_bitrate:0,l3_play_buffer_ms:500,AEC:!0,AGC:!0,ANS:!0,resource_mode:0,bitrate_mode:"default"},this.setting=JSON.parse(JSON.stringify(this.defaultSetting))}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setSetting=function(e,t){var r=Array.isArray(t)&&t.length>0;for(var i in e)for(var o in e[i])if(!o.endsWith("_ctrlmode")){if(r&&-1==t.indexOf(o))continue;var n=e[i][o+"_ctrlmode"];1===n||2===n?this.setting[o]=e[i][o]:this.defaultSetting[o]&&(this.setting[o]=this.defaultSetting[o]),"number"==typeof n&&(this.setting[o+"_ctrlmode"]=e[i][o+"_ctrlmode"])}},e.prototype.getSetting=function(e,t){return void 0===t&&(t=!1),t?2==this.setting[e+"_ctrlmode"]?this.setting[e]:void 0:this.setting[e]},e}();t.ZegoSettingConfig=r,t.RTC="rtc"},7325:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateCenter=void 0;var i=r(6706),o=r(608),n=r(1089),s=r(9595),a=r(6706),d=r(3529),c=function(){function e(e,t){this.logger=e,this.dataReport=t,this.debug=!1,this.testEnvironment=!1,this.pullLimited=!0,this.useNetAgent=!0,this.configOK=!1,this.relateService=[],this.role=2,this.maxMemberCount=0,this.roomCreateFlag=1,this.callbackList={},this.publishStreamList={},this.streamUrlMap={},this.cmdCallback={},this.customUrl=[],this.customPlayUrl=[],this.turnOverTcpOnly=!1,this.customSetTcpOrUdp=!1,this.supportUdp=!1,this.audioEffectBuffer={},this.audioBitRate=48e3,this.cdnSeq=0,this.listenerList={roomStreamUpdate:[],streamExtraInfoUpdate:[],playerStateUpdate:[],publisherStateUpdate:[],screenSharingEnded:[],publishQualityUpdate:[],playQualityUpdate:[],remoteCameraStatusUpdate:[],remoteMicStatusUpdate:[],soundLevelUpdate:[],capturedSoundLevelUpdate:[],videoDeviceStateChanged:[],audioDeviceStateChanged:[],deviceError:[],_deviceError:[],_remoteCameraStatusUpdate:[],_remoteMicStatusUpdate:[],_streamUpdated:[],receiveRealTimeSequentialData:[],beautyEffectOverload:[],playerRecvSEI:[]},this.reportList={},this.reportSeqList={startPublish:{},rePublish:{},startPlay:{},rePlay:{},stopPublish:{},stopPlay:{}},this.streamTrigger={},this.audioStreamList={},this.deviceInfos=null,this.deviceChangeTimer=null,this.deviceStateOut=!1,this.networkState=a.ENUM_NETWORK_STATE.offline,this.streamRetryTime=300,this.checkList=[],this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""},this.streamConnectTime=0,this.clientIP="",this.type="PUBLIC",this.roomList=[],this.isMultiRoom=!1,this.browser="",this.unregisterSeiFilter="",this.playAccelerate=!0,this.softCoding=!0,this.logReportCallback=o.ClientUtil.logReportCallback,this.unregisterCallback=o.ClientUtil.unregisterCallback,this.checkIllegalCharacters=o.ClientUtil.checkIllegalCharacters,this.decodeServerError=o.ClientUtil.decodeServerError,this.getLiveRoomError=o.ClientUtil.getLiveRoomError,this.getServerError=o.ClientUtil.getServerError,this.mergeStreamList=o.ClientUtil.mergeStreamList,this.checkInteger=o.ClientUtil.checkInteger,this.isUrl=o.ClientUtil.isUrl,this.actionSuccessCallback=o.ClientUtil.actionSuccessCallback,this.checkValidNumber=o.ClientUtil.checkValidNumber,this.getDevices=o.ClientUtil.getDevices,this.uint8arrayToBase64=o.ClientUtil.uint8arrayToBase64,this.settingConfig=new s.ZegoSettingConfig}return e.prototype.getRequestId=function(){return this.idName+"-"+a.getSeq()},e.prototype.getSignalCmdContent=function(e,t,r,i){var o={request_id:t,room_id:e,from_userid:this.idName,from_username:this.nickName,to_userid:r};return null!=i&&(o.result=i),JSON.stringify(o)},e.prototype.actionListener=function(e){for(var t=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];if(!["playQualityUpdate","publishQualityUpdate","soundLevelUpdate","capturedSoundLevelUpdate"].includes(e)&&this.listenerList[e]){var s=i.getReportSeq();this.dataReport.newReport(s,d.ZegoRTCLogEvent.kZegoListener.event),this.dataReport.addMsgInfo(s,{listener:e,params:r}),this.dataReport.uploadReport(s)}this.listenerList[e]&&this.listenerList[e].forEach((function(i){try{setTimeout((function(){i.apply(void 0,r)}),0)}catch(r){t.logger.error(n.ZEGO_WEBRTC_ACTION.STATECENTER_ACTION_LISTENER+" "+e+" "+r)}}))},e.prototype.getRoomByRoomID=function(e){return this.roomList.find((function(t){return t.roomID==e}))},e.prototype.getPlayRoom=function(e){return this.roomList.find((function(t){return!!t.streamList.find((function(t){return t.stream_id==e}))}))},e}();t.StateCenter=c},5740:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoStreamCenter=void 0;t.ZegoStreamCenter=function(){this.publisherList={},this.playerList={}}},7560:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamHandler=void 0;var i=r(6706),o=r(2752),n=r(1089),s=function(){function e(e,t,r,i,o){this.logger=e,this.stateCenter=t,this.rtm=r,this.streamCenter=i,this.roomID=o,this.minStreamSeq=0,this.streamSeq=0,this.streamQuerying=!1,this.streamSeqMergeMap=null,this.streamListHBMergeInterval=2e3,this.streamListMergeInterval=5e3}return e.prototype.setCDNInfo=function(e,t){e.urlFlv=t.urls_flv instanceof Array?t.urls_flv[0]||"":"string"==typeof t.urls_flv?t.urls_flv:"",e.urlHls=t.urls_m3u8 instanceof Array?t.urls_m3u8[0]||"":"string"==typeof t.urls_m3u8?t.urls_m3u8:"",e.urlHttpsFlv=t.urls_https_flv instanceof Array?t.urls_https_flv[0]||"":"string"==typeof t.urls_https_flv?t.urls_https_flv:"",e.urlHttpsHls=t.urls_https_m3u8 instanceof Array?t.urls_https_m3u8[0]||"":"string"==typeof t.urls_https_m3u8?t.urls_https_m3u8:"",e.urlRtmp=t.urls_rtmp instanceof Array?t.urls_rtmp[0]||"":"string"==typeof t.urls_rtmp?t.urls_rtmp:""},e.prototype.onStreamUpdated=function(e,t,r){},e.prototype.onStreamExtraInfoUpdated=function(e,t){},e.prototype.handleStreamStart=function(e,t){this.logger.info("zb.sh.hss call stream update"),this.room=t,e.body?(this.streamListHBMergeInterval=e.body.stream_list_hb_wait_merge_time||2e3,this.streamListMergeInterval=e.body.stream_list_push_merge_timeout||5e3,this.streamQuerying=!1,this.handleFullUpdateStream(e.body.stream_seq,e.body.stream_info||[]),this.handleReconnectStream(e.body.stream_info),this.logger.info("zb.sh.hss call end")):this.logger.error("zb.sh.hss server response wrong")},e.prototype.onPublishStateUpdate=function(e,t,r){},e.prototype.updateStreamInfo=function(e,t,r,n){var s,a,d=this;void 0===r&&(r=""),this.logger.info("zb.sh.usi call");var c=r,u=null===(s=this.room)||void 0===s?void 0:s.streamList.find((function(t){return t.stream_id===e}));u||this.logger.warn("zb.sh.usi stream not in room cmd "+t);var l={stream_id:e,extra_info:c};2002!==t&&2003!==t||(l.stream_sid=(null==u?void 0:u.stream_sid)||"");var h=JSON.stringify(l),p={sub_cmd:t,stream_msg:h,third_token:null===(a=this.room)||void 0===a?void 0:a.token},g=this.room;this.room.streamInfoList[e]={};var f=function(r,i){d.handleStreamUpdateRsp(r,e,t)},_=function(s,a){var c=d.room;if(c&&!c.isResetRoom&&!d.rtm.isDisConnect()&&s.code&&s.code==o.errorCodeList.TIMEOUT.code&&c.streamInfoList[e].seq==a)2001==t&&d.stateCenter.publishStreamList[e]&&d.stateCenter.publishStreamList[e].state==i.ENUM_PUBLISH_STREAM_STATE.update_info||2002==t?setTimeout((function(){d.updateStreamInfo(e,t,r,n)}),0):n&&n(o.errorCodeList.TIMEOUT);else if(s.body&&s.body.err_code){var u=d.stateCenter.getServerError(s.body.err_code,d.stateCenter.useNetAgent,s.body.err_message);[1011,1000002002].includes(u.code)&&(u=o.errorCodeList.TOKEN_EXPIRED),n&&n(u,a),t===i.ENUM_STREAM_SUB_CMD.liveBegin&&d.onPublishStateUpdate(i.ENUM_PUBLISH_STATE_UPDATE.error,e,u)}};this.stateCenter.useNetAgent?this.rtm.liveRoomHandler.sendStreamUpdate(p,f,_,{sessionID:null==g?void 0:g.sessionID,roomID:null==g?void 0:g.roomID,roomSessionID:null==g?void 0:g.roomSessionID}):this.room.streamInfoList[e].seq=this.rtm.service.sendMessage("stream",p,f,_,void 0,{sessionID:null==g?void 0:g.sessionID,roomID:null==g?void 0:g.roomID,roomSessionID:null==g?void 0:g.roomSessionID}),this.logger.info("zb.sh.usi call success cmd "+t)},e.prototype.handleStreamUpdateRsp=function(e,t,r){var i,o,n;if(this.rtm.isDisConnect())this.logger.warn("zb.sh.hsur not login");else if(0==e.body.err_code){this.logger.info("zb.sh.hsur stream seq "+this.streamSeq+" server seq "+e.body.stream_seq),this.streamSeq=e.body.stream_seq;var s=this.room;if(s)if((null===(i=null==e?void 0:e.body)||void 0===i?void 0:i.token_remain_time)&&(this.stateCenter.getRoomByRoomID(null===(o=null==e?void 0:e.header)||void 0===o?void 0:o.room_id)?this.rtm.resetRoomTokenTimer(e.header.room_id,e.body.token_remain_time):this.logger.error("zb.sh.hsur room no found ignore "+JSON.stringify(null===(n=e.header)||void 0===n?void 0:n.room_id))),this.stateCenter.useNetAgent)this.handleStreamSync(e,t,r);else for(var a=0;a<e.body.stream_info.length;a++){var d=e.body.stream_info[a].stream_id;this.handleStreamRsp(s,d,e.body.stream_info[a],r),delete s.streamInfoList[d]}else this.logger.info("hsur.0 room no found")}else this.logger.error("zb.sh.hsur stream update error "+e.body.err_code)},e.prototype.handleStreamSync=function(e,t,r){if(e.body.stream_seq>this.streamSeq)this.fetchStreamList();else{var i=this.room.streamList.find((function(e){return e.stream_id==t}));i&&e.body.stream_ver>i.stream_ver?this.fetchStreamList(t):this.handleStreamRsp(this.room,t,{stream_id:t,stream_sid:e.body.stream_sid,stream_ver:e.body.stream_ver,stream_nid:e.body.stream_nid},r)}},e.prototype.handleStreamRsp=function(e,t,r,o){var n=this.stateCenter.publishStreamList[t];n?n.state==i.ENUM_PUBLISH_STREAM_STATE.update_info&&(n.state=i.ENUM_PUBLISH_STREAM_STATE.publishing,this.logger.info("hsur.0 cmd "+o),2001===o||e.streamList.find((function(e){return e.stream_id==t}))||e.streamList.push(r),this.onPublishStateUpdate(i.ENUM_PUBLISH_STATE_UPDATE.start,t,{code:0,message:""})):this.logger.info("hsur.0 stream is not exist")},e.prototype.handleFetchStreamListRsp=function(e,t){if(this.logger.info("zb.sh.hfslr call"),this.streamQuerying=!1,0===e.body.err_code)if(this.streamSeq!==e.body.stream_seq){var r=e.body.stream_info;t&&(r=e.body.stream_info.filter((function(e){return e.stream_id===t}))),this.handleFullUpdateStream(e.body.stream_seq,r),this.logger.info("zb.sh.hfslr call success")}else this.logger.info("zb.sh.hfslr same seq");else this.logger.info("zb.sh.hfslr server error=",e.body.err_code)},e.prototype.handleFullUpdateStream=function(e,t){var r=this;this.logger.info("zb.sh.hfus call"),this.streamSeq=e,this.logger.debug("zb.sh.hfus server seq "+this.streamSeq),this.stateCenter.mergeStreamList(this.stateCenter.idName,this.room.streamList,t,(function(e,t,o){0!==e.length&&(r.logger.debug("zb.sh.hfus callback addstream"),r.onStreamUpdated(r.roomID,i.ENUM_STREAM_UPDATE_TYPE.added,r.makeCallbackStreamList(e))),0!==t.length&&(r.logger.debug("zb.sh.hfus callback delstream"),r.onStreamUpdated(r.roomID,i.ENUM_STREAM_UPDATE_TYPE.deleted,r.makeCallbackStreamList(t))),0!==o.length&&(r.logger.debug("zb.sh.hfus callback updatestream"),r.onStreamExtraInfoUpdated(r.roomID,r.makeCallbackStreamList(o)))})),this.logger.info("zb.sh.hfus call success")},e.prototype.handlePushStreamUpdateMsg=function(e){if(this.logger.warn("zb.sh.hpsum call "+JSON.stringify(e)),e.body.stream_info&&0!==e.body.stream_info.length){if(e.body.stream_info.length+this.streamSeq!==e.body.stream_seq)return this.logger.info("zb.sh.hpsum call updatestream"),void this.fetchStreamList();switch(this.streamSeq=e.body.stream_seq,e.body.stream_cmd){case i.ENUM_STREAM_UPDATE_CMD.added:this.handleAddedStreamList(e.body.stream_info);break;case i.ENUM_STREAM_UPDATE_CMD.deleted:this.handleDeletedStreamList(e.body.stream_info);break;case i.ENUM_STREAM_UPDATE_CMD.updated:this.handleUpdatedStreamList(e.body.stream_info)}this.logger.info("zb.sh.hpsum call success")}else this.logger.info("zb.sh.hpsum, emtpy list")},e.prototype.handlePriPushStreamUpdateMsg=function(e){if(this.logger.info("zb.sh.hpsum call"),e.body.streams_info&&0!==e.body.streams_info.length){if(e.body.streams_info.length+this.streamSeq!==e.body.stream_seq)return this.logger.info("zb.sh.hpsum call updatestream"),void this.mergeStreamByStreamSeq(e.body.stream_cmd,e.body.stream_seq,e.body.streams_info);switch(this.streamSeq=e.body.stream_seq,e.body.stream_cmd){case i.ENUM_STREAM_UPDATE_CMD_PRI.added:this.handleAddedStreamList(e.body.streams_info);break;case i.ENUM_STREAM_UPDATE_CMD_PRI.deleted:this.handleDeletedStreamList(e.body.streams_info);break;case i.ENUM_STREAM_UPDATE_CMD_PRI.updated:this.handleUpdatedStreamList(e.body.streams_info)}this.logger.info("zb.sh.hpsum call success")}else this.logger.info("zb.sh.hpsum, emtpy list")},e.prototype.handleAddedStreamList=function(e){this.logger.debug("zb.sh.hasl call");for(var t,r=[],o=0;o<e.length;o++)if(e[o].anchor_id_name!=this.stateCenter.idName&&e[o].id_name!=this.stateCenter.idName&&e[o].user_id!==this.stateCenter.idName){t=!1;for(var n=0;n<this.room.streamList.length;n++)if(e[o].stream_id===this.room.streamList[n].stream_id){t=!0;break}t||r.push(e[o])}else this.logger.debug("hdsl.0 have self stream added");if(0!==r.length){this.logger.debug("zb.sh.hasl callback addstream");for(var s=0;s<r.length;s++)this.room.streamList.push(r[s]);this.onStreamUpdated(this.roomID,i.ENUM_STREAM_UPDATE_TYPE.added,this.makeCallbackStreamList(r))}this.logger.info("zb.sh.hasl call success")},e.prototype.handleDeletedStreamList=function(e){this.logger.debug("zb.sh.hdsl call");for(var t=[],r=0;r<e.length;r++)if(e[r].anchor_id_name!=this.stateCenter.idName&&e[r].id_name!=this.stateCenter.idName&&e[r].user_id!==this.stateCenter.idName){for(var o=this.room.streamList.length-1;o>=0;o--)if(e[r].stream_id===this.room.streamList[o].stream_id){this.room.streamList.splice(o--,1),t.push(e[r]);break}}else this.logger.debug("zb.sh.hdsl have self stream deleted");0!==t.length&&(this.logger.debug("zb.sh.hdsl callback delstream"),this.onStreamUpdated(this.roomID,i.ENUM_STREAM_UPDATE_TYPE.deleted,this.makeCallbackStreamList(t))),this.logger.info("zb.sh.hdsl call")},e.prototype.handleUpdatedStreamList=function(e){this.logger.debug("zb.sh.husl call");for(var t=[],r=0;r<e.length;r++)if(e[r].anchor_id_name!=this.stateCenter.idName&&e[r].id_name!=this.stateCenter.idName&&e[r].user_id!==this.stateCenter.idName){for(var i=0;i<this.room.streamList.length;i++)if(e[r].stream_id===this.room.streamList[i].stream_id){e[r].extra_info!==this.room.streamList[i].extra_info&&(this.room.streamList[i]=e[r],t.push(e[r]));break}}else this.logger.debug("hsul.0 have self stream updated");0!==t.length&&(this.logger.debug("zb.sh.husl callback updatestream"),this.onStreamExtraInfoUpdated(this.roomID,this.makeCallbackStreamList(t))),this.logger.info("zb.sh.husl call success")},e.prototype.fetchStreamList=function(e){var t,r,i,o=this;if(this.logger.info("zb.sh.fsl call"),this.rtm.isDisConnect())this.logger.info("zb.sh.fsl state error");else if(this.streamQuerying)this.logger.info("zb.sh.fsl already doing");else{if(this.streamQuerying=!0,this.logger.debug("zb.sh.fsl send fetch request"),this.stateCenter.useNetAgent)this.rtm.liveRoomHandler.getStreamList({},(function(t){o.handleFetchStreamListRsp(t,e)}),(function(e){}),{roomID:null===(t=this.room)||void 0===t?void 0:t.roomID,sessionID:null===(r=this.room)||void 0===r?void 0:r.sessionID,roomSessionID:null===(i=this.room)||void 0===i?void 0:i.roomSessionID});else{var n=this.room;this.rtm.service.sendMessage("stream_info",{reserve:0},this.handleFetchStreamListRsp.bind(this),(function(e,t){}),void 0,{roomID:null==n?void 0:n.roomID,sessionID:null==n?void 0:n.sessionID,roomSessionID:null==n?void 0:n.roomSessionID})}this.logger.info("zb.sh.fsl call success")}},e.prototype.handleReconnectStream=function(e){var t,r;this.logger.info("zb.sh.hrs call");var o=this.streamCenter.publisherList,n=this.streamCenter.playerList,s=function(n){if((null===(r=null===(t=o[n])||void 0===t?void 0:t.room)||void 0===r?void 0:r.roomID)!==a.roomID)return"continue";if(o[n].publisher.state!=i.ENUM_PUBLISH_STATE.publishing||e.find((function(e){return e.stream_id==n}))){if(o[n].publisher.state==i.ENUM_PUBLISH_STATE.stop&&e.find((function(e){return e.stream_id==n}))){d=void 0,d="PUBLIC"===a.stateCenter.type?i.ENUM_STREAM_SUB_CMD.liveEnd:i.ENUM_STREAM_CMD_PRI.liveEnd,a.updateStreamInfo(n,d);for(var s=0;s<a.room.streamList.length;s++)if(a.room.streamList[s].stream_id==n){a.room.streamList.splice(s--,1);break}}}else{var d=void 0;d="PUBLIC"===a.stateCenter.type?i.ENUM_STREAM_SUB_CMD.liveBegin:i.ENUM_STREAM_CMD_PRI.liveBegin,a.updateStreamInfo(n,d,a.stateCenter.publishStreamList[n].extra_info)}},a=this;for(var d in o)s(d);for(var d in o)o[d].room.roomID===this.roomID&&o[d].isReDispatch&&(this.logger.info("zb.sh.hrs "+d+"retry dispatch"),(c=o[d].retryDispatchHandler).stopMaxTime(),c.invalid(),c.initStream(d,o[d].publishOption,!0),c.active(0),o[d].isReDispatch=!1);for(var d in n){var c;n[d].room.roomID===this.roomID&&n[d].isReDispatch&&(this.logger.info("zb.sh.hrs "+d+"retry dispatch"),(c=n[d].retryDispatchHandler).stopMaxTime(),c.invalid(),c.initStream(d,n[d].playOption,!1),c.active(0),n[d].isReDispatch=!1)}this.logger.info("zb.sh.hrs end")},e.prototype.makeCallbackStreamList=function(e){var t,r=[];if(this.stateCenter.useNetAgent&&this.stateCenter.appConfig&&(t=this.stateCenter.appConfig.media_config.play_config.resource_info.find((function(e){return e.resource_type===i.SignalResourceType.CDN}))),e&&e.length>0)for(var o=0;o<e.length;o++){var n=[],s=[],a=[],d=e[o].stream_id;if(t){for(var c=0;c<t.service_info.length;c++){var u=t.service_info[c],l=u.protocol,h=u.url_template;switch(l){case i.ProtocolType.FLV:var p=h.replace("{STREAM_NAME}",d);n.push(p);break;case i.ProtocolType.HLS:var g=h.replace("{STREAM_NAME}",d);s.push(g);break;case i.ProtocolType.RTMP:var f=h.replace("{STREAM_NAME}",d);a.push(f)}}e[o].urls_flv=n,e[o].urls_m3u8=s,e[o].urls_rtmp=a}var _={user:{userID:e[o].anchor_id_name||e[o].id_name,userName:e[o].anchor_nick_name||e[o].nick_name},extraInfo:e[o].extra_info,streamID:e[o].stream_id,roomID:"",urlFlv:"",urlRtmp:"",urlHls:"",urlHttpsFlv:"",urlHttpsHls:"",streamGID:e[o].stream_gid,closeType:e[o].close_type};this.setCDNInfo(_,e[o]),r.push(_)}return r},e.prototype.sendBizChannelRequest=function(e,t,r,i){var o=this;void 0===i&&(i=!1),e=Object.assign(e,{is_retry_req:i?1:0});var n=this.room;this.rtm.service.sendMessage("biz_channel",e,(function(e,r){t(e.header.seq,e.body.cmd,e.body.rsp_body)}),(function(i,n){var s=i.body.err_code,a=i.body.rsp_body;"number"!=typeof s||2002!==s?r(s,n,a):o.sendBizChannelRequest(e,t,r,!0)}),void 0,{roomID:null==n?void 0:n.roomID,sessionID:null==n?void 0:n.sessionID,roomSessionID:null==n?void 0:n.roomSessionID})},e.prototype.sendBizChannelRequestV2=function(e,t,r,i){var o=this,s=e.server,a=e.location,d=e.cmd,c=e.channel,u=this.rtm.netAgent,l=this.room,h=void 0,p=t.timestamp;t&&(h=JSON.stringify(t));var g={cmd:d,req_body:h,appid:this.stateCenter.appid,timestamp:p||Math.ceil((new Date).getTime()/1e3),token:null==l?void 0:l.token,user_id:this.stateCenter.idName,channel:c||"media"};this.logger.info(n.ZEGO_WEBRTC_ACTION.STREAMHANDLER_SEND_BIZCHANNEL_REQUESTV2+" "+JSON.stringify(g)+" request "+JSON.stringify(e)),u.startHttpRequest({service:s,headers:[],body:g,idName:this.stateCenter.idName,method_no:2,ack:!1,location:a},(function(e){o.logger.info(n.ZEGO_WEBRTC_ACTION.STREAMHANDLER_SEND_BIZCHANNEL_REQUESTV2+" rsp "+JSON.stringify(e.body));var s=e.status_code,a=e.body;if(200===s){var d=a;if("string"==typeof a)try{d=JSON.parse(a)}catch(e){throw i(s),e}var c=d.err_code,u=d.rsp_body,l=void 0;try{l=JSON.parse(u)}catch(e){l=u}if(0!==c)return"number"==typeof c&&2002===c?void o.sendBizChannelRequest(t,r,i,!0):void i(s,c,l);r(l)}else i(s)}),(function(e){i(-1,null==e?void 0:e.code,void 0,e)}))},e.prototype.updateStreamExtraInfo=function(e,t,r,i){},e.prototype.setStreamExtraInfo=function(e,t,r,i){},e.prototype._publishTarget=function(e,t,r){},e.prototype.patchStreamList=function(e){var t=this;if("number"==typeof e.body.StreamRefresh&&0!==e.body.StreamRefresh)return this.logger.info(n.ZEGO_WEBRTC_ACTION.STREAMHANDLER_PATCH_STREAM_LIST+" stream refresh "),void this.fetchStreamList();e.body.stream_seq===this.streamSeq||this.streamSeqMergeMap||(this.logger.info(n.ZEGO_WEBRTC_ACTION.STREAMHANDLER_PATCH_STREAM_LIST+" call update stream "+this.streamSeq+" server "+e.body.stream_seq),this.streamSeqMergeTimer&&clearTimeout(this.streamSeqMergeTimer),this.streamSeqMergeTimer=setTimeout((function(){t.handleMergeTimeout()}),this.streamListHBMergeInterval)),this.minStreamSeq=e.body.stream_seq},e.prototype.mergeStreamByStreamSeq=function(e,t,r){var i=this;this.streamSeqMergeMap||(this.logger.warn(n.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM_BY_STREAM_SEQ+" new merge stream list "+this.streamSeq+" server "+t),this.streamSeqMergeMap={},this.streamSeqMergeTimer&&clearTimeout(this.streamSeqMergeTimer),this.streamSeqMergeTimer=setTimeout((function(){i.handleMergeTimeout()}),this.streamListMergeInterval)),this.logger.info(n.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM_BY_STREAM_SEQ+" "+this.streamSeqMergeMap+" "+e+" "+t+" "+r),this.streamSeqMergeMap[t]={cmd:e,streamList:r}},e.prototype.handleMergeTimeout=function(){if(this.streamSeqMergeMap){var e=Object.keys(this.streamSeqMergeMap).map((function(e){return+e})).sort((function(e,t){return e-t}));e[e.length-1]-e[0]+1===e.length||e[e.length-1]>=this.minStreamSeq?this.mergeStream(e):(this.streamSeqMergeMap=null,this.fetchStreamList())}},e.prototype.mergeStream=function(e){var t=this;this.logger.info(n.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM+" merge streamList "+this.streamSeq+" streamSeqList "+e.join(","));var r=e[e.length-1],o=[];e.forEach((function(e){if(t.streamSeqMergeMap&&t.streamSeqMergeMap[e])switch(t.streamSeqMergeMap[e].cmd){case i.ENUM_STREAM_UPDATE_CMD.added:t.streamSeqMergeMap[e].streamList.forEach((function(e){var t=o.findIndex((function(t){return t.stream_id==e.stream_id}));-1!==t&&o.splice(t),o.push(e)}));break;case i.ENUM_STREAM_UPDATE_CMD.deleted:t.streamSeqMergeMap[e].streamList.forEach((function(e){var t=o.findIndex((function(t){return t.stream_id==e.stream_id}));-1!==t&&o.splice(t)}));break;case i.ENUM_STREAM_UPDATE_CMD.updated:t.streamSeqMergeMap[e].streamList.forEach((function(e){var t=o.findIndex((function(t){return t.stream_id==e.stream_id}));-1!==t&&o.splice(t),o.push(e)}))}})),this.streamSeqMergeMap=null,this.logger.info(n.ZEGO_WEBRTC_ACTION.STREAMHANDLER_MERGE_STREAM+" "+o),this.handleFullUpdateStream(r,o)},e.prototype.reset=function(){this.minStreamSeq=0,this.streamSeqMergeMap=null,this.streamSeqMergeTimer&&(clearTimeout(this.streamSeqMergeTimer),this.streamSeqMergeTimer=void 0),this.streamListHBMergeInterval=2e3,this.streamListMergeInterval=5e3},e}();t.StreamHandler=s},6706:function(e,t,r){"use strict";var i,o,n,s,a,d,c,u,l,h,p,g,f,_,m;Object.defineProperty(t,"__esModule",{value:!0}),t.NetAgentPCRequest=t.BusinessService=t.ZegoConnectionAgent=t.ZegoExpressWebRTM=t.ZegoDataReport=t.ZegoLogger=t.ZegoExpressWebRTMEngine=t.getReportSeq=t.getSeq=t.ZegoSEIType=t.QUALITY_CONSTANT=t.QualityGrade=t.REPORT_ACTION=t.ENUM_RETRY_STATE=t.ENUM_PLAY_STATE_UPDATE=t.ENUM_PUBLISH_STATE_UPDATE=t.LinkedList=t.ListNode=t.E_CLIENT_TYPE=t.ENUM_SOURCE_TYPE=t.ENUM_DISPATCH_TYPE=t.ENUM_BROADCASTER_STATUS=t.ENUM_PLAY_SOURCE_TYPE=t.ENUM_PUBLISH_STATE_NEGO=t.ENUM_PUSH_SIGNAL_SUB_CMD=t.ENUM_SIGNAL_SUB_CMD=t.QUALITYLEVEL=t.SERVER_ERROR_CODE=t.ENUM_STREAM_UPDATE_CMD_PRI=t.ENUM_STREAM_UPDATE_CMD=t.MINIUM_HEARTBEAT_INTERVAL=t.STREAM_DELETE_REASON=t.ENUM_NETWORK_STATE=t.ENUM_RUN_STATE=t.ENUM_STREAM_UPDATE_TYPE=t.ENUM_STREAM_CMD_PRI=t.ENUM_STREAM_SUB_CMD=t.ENUM_PUBLISH_STREAM_STATE=t.MAX_RETRY_CONNECT_INTERVAL=t.MAX_TRANS_DATA_LENGTH=t.MAX_TRANS_TYPE_LENGTH=t.MAX_MESSAGE_LENGTH=t.MAX_ROOM_ID_LENGTH=t.MAX_USER_NAME_LENGTH=t.MAX_USER_ID_LENGTH=t.MAX_STREAM_ID_LENGTH=t.MAX_TRY_HEARTBEAT_COUNT=t.SEND_MSG_TIMEOUT=t.SEND_MSG_RESET=t.MAX_TRY_CONNECT_COUNT=t.streamMap=t.ENUM_CONNECT_STATE=t.ProtocolType=t.SignalResourceType=t.ENUM_PROBE_STATE=t.ENUM_PLAY_STATE_NEGO=t.ENUM_PLAYER_STATE=t.ENUM_PLAY_STATE=t.ENUM_PUBLISH_STATE=t.ENUM_SCREEM_RESOLUTION_TYPE=t.ENUM_RESOLUTION_TYPE=t.ENUM_SIGNAL_STATE=t.ERROR_CODES=t.ENUM_REMOTE_TYPE=t.LOG_LEVEL=t.ENUM_LOG_LEVEL=t.ROOMVERSION=t.PROTO_VERSION=void 0,t.PROTO_VERSION="2.16.1",t.ROOMVERSION="V1",(m=t.ENUM_LOG_LEVEL||(t.ENUM_LOG_LEVEL={}))[m.debug=0]="debug",m[m.info=1]="info",m[m.warn=2]="warn",m[m.error=3]="error",m[m.report=99]="report",m[m.disable=100]="disable",t.LOG_LEVEL={debug:0,info:1,warn:2,error:3,report:99,disable:100},(_=t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={}))[_.disable=0]="disable",_[_.websocket=1]="websocket",_[_.https=2]="https",t.ERROR_CODES={ROOM_SESSION_ID_ERR:1000000152,FETCH_TRANS_UNKNOWN_CHANNEL:1000001108,FETCH_TRANS_UNKNOWN_TYPE:1000001109,FETCH_TRANS_WRONG_SEQ:1000001110},(f=t.ENUM_SIGNAL_STATE||(t.ENUM_SIGNAL_STATE={}))[f.disconnected=0]="disconnected",f[f.connecting=1]="connecting",f[f.connected=2]="connected",t.ENUM_RESOLUTION_TYPE={LOW:{width:320,height:240,frameRate:15,bitRate:300},MEDIUM:{width:640,height:480,frameRate:15,bitRate:800},HIGH:{width:1280,height:720,frameRate:20,bitRate:1500}},t.ENUM_SCREEM_RESOLUTION_TYPE={LOW:{frameRate:20,bitRate:800},MEDIUM:{frameRate:15,bitRate:1500},HIGH:{frameRate:5,bitRate:2e3}},t.ENUM_PUBLISH_STATE={start:0,waitingSessionRsp:1,waitingOfferRsp:2,waitingServerAnswer:3,waitingServerICE:4,connecting:5,publishing:6,stop:7,didNotStart:8},t.ENUM_PLAY_STATE={start:0,waitingSessionRsp:1,waitingOfferRsp:2,waitingServerAnswer:3,waitingServerICE:4,connecting:5,playing:6,stop:7,didNotStart:8},t.ENUM_PLAYER_STATE={start:0,playing:1,stop:2},t.ENUM_PLAY_STATE_NEGO={stop:0,start:1,waiterAnswer:2,waitingCandidate:3,sendCandidate:4,iceConnected:5,iceDisconnected:6,iceClosed:7,iceFailed:8},(g=t.ENUM_PROBE_STATE||(t.ENUM_PROBE_STATE={}))[g.tryProbe=0]="tryProbe",g[g.probed=2]="probed",(p=t.SignalResourceType||(t.SignalResourceType={}))[p.CDN=0]="CDN",p[p.RTC=1]="RTC",p[p.L3=2]="L3",(h=t.ProtocolType||(t.ProtocolType={}))[h.UDP=0]="UDP",h[h.RTMP=1]="RTMP",h[h.FLV=2]="FLV",h[h.HLS=3]="HLS",h[h.WEBRTC=4]="WEBRTC",t.ENUM_CONNECT_STATE={disconnect:0,connecting:1,connected:2},t.streamMap={"/lr/push/stream_add":12001,"/lr/push/stream_delete":12002,"/lr/push/stream_update":12003},t.MAX_TRY_CONNECT_COUNT=3,t.SEND_MSG_RESET=2,t.SEND_MSG_TIMEOUT=1,t.MAX_TRY_HEARTBEAT_COUNT=5,t.MAX_STREAM_ID_LENGTH=256,t.MAX_USER_ID_LENGTH=64,t.MAX_USER_NAME_LENGTH=256,t.MAX_ROOM_ID_LENGTH=128,t.MAX_MESSAGE_LENGTH=1024,t.MAX_TRANS_TYPE_LENGTH=128,t.MAX_TRANS_DATA_LENGTH=4096,t.MAX_RETRY_CONNECT_INTERVAL=12,t.ENUM_PUBLISH_STREAM_STATE={waiting_url:1,tryPublish:2,update_info:3,publishing:4,stop:5,retryPublish:6},t.ENUM_STREAM_SUB_CMD={liveNone:0,liveBegin:2001,liveEnd:2002,liveUpdate:2003},t.ENUM_STREAM_CMD_PRI={liveBegin:"zegochat_js.room_stream_create_req",liveEnd:"zegochat_js.room_stream_delete_req",liveUpdate:"zegochat_js.room_stream_update_req"},t.ENUM_STREAM_UPDATE_TYPE={added:1,deleted:0},(l=t.ENUM_RUN_STATE||(t.ENUM_RUN_STATE={}))[l.logout=0]="logout",l[l.trylogin=1]="trylogin",l[l.login=2]="login",(u=t.ENUM_NETWORK_STATE||(t.ENUM_NETWORK_STATE={}))[u.offline=0]="offline",u[u.online=1]="online",t.STREAM_DELETE_REASON={0:{code:1,description:"user_stop_publishing_stream_normal"},1:{code:2,description:"user_heart_beat_timeout"},2:{code:3,description:"user_repeat_login"},3:{code:4,description:"user_kicked_out"},4:{code:5,description:"user_offline"},100:{code:6,description:"remove_by_server"}},function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CDN=1]="CDN",e[e.RTC=2]="RTC",e[e.L3=3]="L3"}(i||(i={})),t.MINIUM_HEARTBEAT_INTERVAL=3e3,t.ENUM_STREAM_UPDATE_CMD={added:12001,deleted:12002,updated:12003},t.ENUM_STREAM_UPDATE_CMD_PRI={added:1,updated:2,deleted:3},t.SERVER_ERROR_CODE=1e4,(c=t.QUALITYLEVEL||(t.QUALITYLEVEL={}))[c.low=1]="low",c[c.stantard=2]="stantard",c[c.hight=3]="hight",c[c.custome=4]="custome",t.ENUM_SIGNAL_SUB_CMD={none:0,joinLiveRequest:1001,joinLiveResult:1002,joinLiveInvite:1003,joinLiveStop:1004},t.ENUM_PUSH_SIGNAL_SUB_CMD={none:0,pushJoinLiveRequest:11001,pushJoinLiveResult:11002,pushJoinLiveInvite:11003,pushJoinLiveStop:11004},t.ENUM_PUBLISH_STATE_NEGO={stop:0,start:1,waiterAnswer:2,waitingCandidate:3,sendCandidate:4,iceConnected:5,iceDisconnected:6,iceClosed:7,iceFailed:8},(d=t.ENUM_PLAY_SOURCE_TYPE||(t.ENUM_PLAY_SOURCE_TYPE={}))[d.cdn=0]="cdn",d[d.ultra=1]="ultra",(a=t.ENUM_BROADCASTER_STATUS||(t.ENUM_BROADCASTER_STATUS={}))[a.stop=0]="stop",a[a.start=1]="start",(s=t.ENUM_DISPATCH_TYPE||(t.ENUM_DISPATCH_TYPE={}))[s.cdn=0]="cdn",s[s.ultra=1]="ultra",s[s.customUrl=2]="customUrl",(n=t.ENUM_SOURCE_TYPE||(t.ENUM_SOURCE_TYPE={}))[n.CDN=0]="CDN",n[n.BGP=1]="BGP",(o=t.E_CLIENT_TYPE||(t.E_CLIENT_TYPE={}))[o.ClientType_None=0]="ClientType_None",o[o.ClientType_H5=1]="ClientType_H5",o[o.ClientType_SmallPragram=2]="ClientType_SmallPragram",o[o.ClientType_Webrtc=3]="ClientType_Webrtc";var v=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._id=null,this.next=null,this.prev=null,this._id=e,this._data=t}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id?this._id:null},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!1,configurable:!0}),e.prototype.hasNext=function(){return this.next&&this.next.id},e.prototype.hasPrev=function(){return this.prev&&this.prev.id},e}();t.ListNode=v;var E,S,T,C=function(){function e(){this.start=new v,this.end=new v,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}return e.prototype.insertBefore=function(e,t){var r=new v(this._idCounter,t);return r.next=e,r.prev=e.prev,e.prev&&(e.prev.next=r),e.prev=r,++this._idCounter,++this._numNodes,r},e.prototype.addLast=function(e){return this.insertBefore(this.end,e)},e.prototype.add=function(e){return this.addLast(e)},e.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},e.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},e.prototype.size=function(){return this._numNodes},e.prototype.getFromFirst=function(e){var t=0,r=this.start.next;if(e>=0)for(;t<e&&null!==r;)r=r.next,++t;else r=null;if(null===r)throw"Index out of bounds.";return r},e.prototype.get=function(e){return 0===e?this.getFirst():e===this._numNodes-1?this.getLast():this.getFromFirst(e)},e.prototype.remove=function(e){return e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),--this._numNodes,e},e.prototype.removeFirst=function(){var e=null;return this._numNodes>0&&this.start.next&&(e=this.remove(this.start.next)),e},e.prototype.removeLast=function(){var e=null;return this._numNodes>0&&this.end.prev&&(e=this.remove(this.end.prev)),e},e.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},e.prototype.each=function(e){for(var t=this.start;t.hasNext();)e(t=t.next)},e.prototype.find=function(e){for(var t=this.start,r=!1,i=null;t.hasNext()&&!r;)e(t=t.next)&&(i=t,r=!0);return i},e.prototype.map=function(e){for(var t=this.start,r=[];t.hasNext();)e(t=t.next)&&r.push(t);return r},e.prototype.push=function(e){return this.addLast(e)},e.prototype.unshift=function(e){this._numNodes>0?this.insertBefore(this.start.next,e):this.insertBefore(this.end,e)},e.prototype.pop=function(){return this.removeLast()},e.prototype.shift=function(){return this.removeFirst()},e}();t.LinkedList=C,t.ENUM_PUBLISH_STATE_UPDATE={start:0,error:1,retry:2},t.ENUM_PLAY_STATE_UPDATE={start:0,error:1,retry:2,stop:3},t.ENUM_RETRY_STATE={didNotStart:0,retrying:1,finished:2},t.REPORT_ACTION={eventStart:"eventStart",eventEndWithMsgInfo:"eventEndWithMsgInfo",addEventMsg:"addEventMsg",addEvent:"addEvent",eventEnd:"eventEnd",addMsgInfo:"addMsgInfo"},(T=t.QualityGrade||(t.QualityGrade={}))[T.Unknown=-1]="Unknown",T[T.Excellent=0]="Excellent",T[T.Good=1]="Good",T[T.Middle=2]="Middle",T[T.Poor=3]="Poor",T[T.Die=4]="Die",(S=t.QUALITY_CONSTANT||(t.QUALITY_CONSTANT={}))[S.MinQuality=0]="MinQuality",S[S.DieQuality=0]="DieQuality",S[S.PoorMinQuality=1]="PoorMinQuality",S[S.MiddleMinQuality=30]="MiddleMinQuality",S[S.GoodMinQuality=60]="GoodMinQuality",S[S.ExcellentMinQuality=85]="ExcellentMinQuality",S[S.MaxQuality=100]="MaxQuality",(E=t.ZegoSEIType||(t.ZegoSEIType={}))[E.ZegoDefined=0]="ZegoDefined",E[E.UserUnregister=1]="UserUnregister";var y=r(4119);Object.defineProperty(t,"getSeq",{enumerable:!0,get:function(){return y.getSeq}}),Object.defineProperty(t,"getReportSeq",{enumerable:!0,get:function(){return y.getReportSeq}}),Object.defineProperty(t,"ZegoExpressWebRTMEngine",{enumerable:!0,get:function(){return y.ZegoExpressWebRTMEngine}}),Object.defineProperty(t,"ZegoLogger",{enumerable:!0,get:function(){return y.ZegoLogger}}),Object.defineProperty(t,"ZegoDataReport",{enumerable:!0,get:function(){return y.ZegoDataReport}}),Object.defineProperty(t,"ZegoExpressWebRTM",{enumerable:!0,get:function(){return y.ZegoExpressWebRTM}}),Object.defineProperty(t,"ZegoConnectionAgent",{enumerable:!0,get:function(){return y.ZegoConnectionAgent}}),Object.defineProperty(t,"BusinessService",{enumerable:!0,get:function(){return y.BusinessService}}),Object.defineProperty(t,"NetAgentPCRequest",{enumerable:!0,get:function(){return y.NetAgentPCRequest}})},2752:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={NOT_LOGIN:{code:1000002,message:"not login room"},STREAMID_TOO_LONG:{code:1000014,message:"stream ID is too long"},STREAM_ID_NULL:{code:1000015,message:"streamID is empty"},STREAM_ID_INVALID_CHARACTER:{code:1000016,message:"stream ID contains illegal characters"},NETWORK_BROKEN:{code:1000017,message:"network is broken"},LOCALSTREAM_WRONG:{code:1000018,message:"local stream wrong"},INPUT_PARAM:{code:1100001,message:"input param error."},TIMEOUT:{code:1100002,message:"network timeout."},SOCKET_CLOSE:{code:1100003,msg:"socket close"},INIT_SDK_WRONG:{code:1101e3,message:"init sdk wrong"},WX_GET_SETTING_FAIL:{code:1101001,message:"wx get setting fail"},GET_CONFIG_FAIL:{code:1101002,message:"get app config fail"},USER_ID_NULL:{code:1002005,message:"user ID is empty"},USER_ID_INVALID_CHARACTER:{code:1002006,message:"user ID contains illegal characters"},USER_ID_TOO_LONG:{code:1002007,message:"user ID is too long"},USER_NAME_NULL:{code:1002008,message:"username is empty"},USER_NAME_TOO_LONG:{code:1002010,message:"username is too long"},ROOM_ID_NULL:{code:1002011,message:"room ID is empty"},ROOM_ID_INVALID_CHARACTER:{code:1002012,message:"room ID contains illegal characters"},ROOM_ID_TOO_LONG:{code:1002013,message:"room ID is too long"},LOGIN_TIMEOUT:{code:1002031,message:"login timeout"},ROOM_MAX_USER_COUNT:{code:1002034,message:"users logging into the room exceeds the maximum number"},MULTIPLE_LOGIN_KICKOUT:{code:1002050,message:"kickout may be the same user ID login other"},ROOM_RETRY_TIMEOUT:{code:1002053,message:"network is broken and login fail."},MANUAL_KICKOUT:{code:1002055,message:"server has sent a signal to kick out"},ROOM_INNER_ERROR:{code:1002099,message:"room inner error"},HEARTBEAT_TIMEOUT:{code:1102001,message:"heartbeat timeout."},PARSE_JSON_ERROR:{code:1102011,message:"parse json error."},LOGIN_PROCESSING:{code:1102012,message:"login is processing."},LIVEROOM_REQUEST_ERROR:{code:1102013,message:"liveroom request error."},ZPUSH_REQUEST_FAIL:{code:1102014,message:"zpush request fail."},LOGIN_STATE_WRONG:{code:1102015,message:"user login state is wrong."},TOKEN_ERROR:{code:1102016,message:"token error"},DISPATCH_ERROR:{code:1102017,message:"dispatch error"},TOKEN_EXPIRED:{code:1102018,message:"token expired"},SUBCMD_ERROR:{code:1102019,message:"subcmd error."},ZEGO_AUTH_ERROR:{code:1102020,message:"zego auth error."},BIZ_CHANNEL_ERROR:{code:1102021,message:"biz channel error."},DISPATCH_TIMEOUT:{code:1102022,message:"dispatch request timeout"},CONNECT_FAILED:{code:1102023,message:"connect signal fail"},PUBLISHER_MEDIA_SERVER_FORBID:{code:1003025,message:"stream is forbided by media server"},PUBLISHER_EXTRA_INFO_TOO_LONG:{code:1003051,message:"stream extra info is too long"},PUBLISHER_PARAM:{code:1103001,message:"input param error"},PUBLISHER_BROWSER_NOT_SUPPORT:{code:1103002,message:"browser do not support"},PUBLISHER_DISPATCH_FAIL:{code:1103003,message:"dispatch request error"},PUBLISHER_SCREEN_FAILED:{code:1103010,message:"screen fail"},ENUMERATE_DEVICES_FAIL:{code:1103011,message:"enumerate devices fail"},PUBLISHER_DISPATCH_REQUEST_FAIL:{code:1103020,message:"dispatch request fail"},PUBLISHER_SESSION_REQUEST_FAIL:{code:1103021,message:"session request fail"},PUBLISHER_CREATE_OFFER_ERROR:{code:1103022,message:"create offer error"},PUBLISHER_SET_LOCAL_DESC_ERROR:{code:1103023,message:"setLocalDescription error"},PUBLISHER_MEDIA_DESC_ERROR:{code:1103024,message:"mediaDesc error"},PUBLISHER_SET_REMOTE_DESC_ERROR:{code:1103025,message:"other side offer error"},PUBLISHER_CANDIDATE_ERROR:{code:1103026,message:"candidate error"},PUBLISHER_SESSION_CLOSED:{code:1103027,message:"server session closed"},PUBLISHER_MEDIA_CONNECTION_ERROR:{code:1103028,message:"ice connection error"},PUBLISHER_SERVER_NEGO_TIMEOUT:{code:1103030,message:"negotiation timeout"},PUBLISH_DEVICE_OUT_ERR:{code:1103041,message:"device change "},PUBLISH_SCREEN_CANCELED:{code:1103042,message:"screen canceled"},PUBLISH_SCREEN_NOT_SUPPORT:{code:1103043,message:"screen not support"},PUBLISH_NO_PREVIEW:{code:1103044,message:"stream is not from zego"},REPEATED_PULL:{code:1103049,message:"repeated pull same stream"},PUBLISHER_WEBSOCKET_DISCONNECTED:{code:1103050,message:"websocket disconnected"},PUBLISHER_RETRY_TIMEOUT:{code:1103051,message:"publisher retry timeout"},PUBLISHER_HTTPS_REQUIRED:{code:1103053,message:"https is required"},PUBLISHER_NO_PREVIEW:{code:1103054,message:"no preview"},PUBLISHER_STREAM_NO_FOUND:{code:1103055,message:"publish stream no found"},PUBLISHER_IS_PUBLISHING:{code:1103056,message:"publish is publishing"},PUBLISHER_CLIENT_IP_CHANGED:{code:1103058,message:"client ip changed"},PUBLISHER_TTL_OVERTIME:{code:1103059,message:"ttl over time"},PUBLISHER_SESSION_TIMEOUT:{code:1103060,message:"session request timeout"},PUBLISHER_GET_USER_MEDIA_FAIL:{code:1103061,message:"get media fail"},PUBLISHER_DEVICE_NO_ALLOWED:{code:1103064,message:"get device not allowed"},PUBLISHER_DEVICE_NO_READABLE:{code:1103065,message:"device is not readable"},PUBLISHER_OVER_CONSTRAINED:{code:1103066,message:"device does not meet constraints"},PUBLISHER_UPDATE_SDP_TIMEOUT:{code:1103067,message:"update sdp time out"},PUBLISHER_UPDATE_SDP_FAIL:{code:1103068,message:"update sdp fail"},VIDEO_EFFECT_IS_STARTING:{code:1103073,message:"video effect is starting, please operate after video effect is started"},PLAYER_PARAM:{code:1104001,message:"input parm error"},PLAYER_DISPATCH_REQUEST_FAIL:{code:1104020,message:"dispatch request fail"},PLAYER_SESSION_REQUEST_FAIL:{code:1104021,message:"session request fail"},PLAYER_CREATE_OFFER_ERROR:{code:1104022,message:"create offer error"},PLAYER_SET_LOCAL_DESC_ERROR:{code:1104023,message:"setLocalDescription error"},PLAYER_MEDIA_DESC_ERROR:{code:1104024,message:"mediaDesc error"},PLAYER_SET_REMOTE_DESC_ERROR:{code:1104025,message:"other side offer error"},PLAYER_CANDIDATE_ERROR:{code:1104026,message:"candidate error"},PLAYER_SESSION_CLOSED:{code:1104027,message:"server session closed"},PLAYER_MEDIA_CONNECTION_ERROR:{code:1104028,message:"ice connection error"},PLAYER_WEBSOCKET_DISCONNECTED:{code:1104029,message:"websocket disconnected"},PLAYER_SERVER_NEGO_TIMEOUT:{code:1104030,message:"negotiation timeout"},PLAYER_RETRY_TIMEOUT:{code:1104031,message:"player retry timeout"},PLAYER_IS_PLAYING:{code:1104032,message:"player is playing"},PLAYER_CLIENT_IP_CHANGED:{code:1104033,message:"client ip changed"},PLAYER_TTL_OVERTIME:{code:1104034,message:"ttl is over time"},PLAYER_SESSION_RESET:{code:1104035,message:"reset session push"},PLAYER_SESSION_TIMEOUT:{code:1104036,message:"session request timeout"},PLAYER_PROBE_TIMEOUT:{code:1104037,message:"probe time out"},PLAYER_UNSUPPORTED_PROTOCOL:{code:1104038,message:"resource mode is not supported"},PLAYER_STREAM_NOT_EXIST:{code:1104039,message:"play stream not found"},DEVICE_ERROR_TYPE_UNPLUGGED:{code:1006006,message:"the device is unplugged"},IM_CONTENT_NULL:{code:1009001,message:"message content is empty"},IM_CONTENT_TOO_LONG:{code:1009002,message:"message content is too long"},IM_SEND_FAILED:{code:1009010,message:"failed to send message"},FREQ_LIMITED:{code:1109001,message:"frequency limited."}}},3529:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoWechatLogEvent=t.ZegoRTCLogEvent=void 0;var i=r(2752),o=function(e){return e};t.ZegoRTCLogEvent={kZegoTaskCreateStream:{event:"/sdk/create_stream",error:{kBrowserNotSupportError:i.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kParamError:i.errorCodeList.PUBLISHER_PARAM,kScreenCancelError:i.errorCodeList.PUBLISH_SCREEN_CANCELED,kScreenFailedError:i.errorCodeList.PUBLISHER_SCREEN_FAILED,kScreenNotSupportError:i.errorCodeList.PUBLISH_SCREEN_NOT_SUPPORT,kHttpsRequiredError:i.errorCodeList.PUBLISHER_HTTPS_REQUIRED,kGetUserMediaError:i.errorCodeList.PUBLISHER_GET_USER_MEDIA_FAIL,kDeviceNoAllowedError:i.errorCodeList.PUBLISHER_DEVICE_NO_ALLOWED,kDeviceNoReadableError:i.errorCodeList.PUBLISHER_DEVICE_NO_READABLE,kDeviceOverConstrainedError:i.errorCodeList.PUBLISHER_OVER_CONSTRAINED},stream_type:o,screen:o,camera:o,custom:o},kZegoTaskPublishStart:{event:"/sdk/api/publish_request",error:{kPublishParamError:i.errorCodeList.PUBLISHER_PARAM,kPublishNetworkTimeoutError:i.errorCodeList.TIMEOUT,kPublishDispatchTimeoutError:i.errorCodeList.DISPATCH_TIMEOUT,kPublishDispatchError:i.errorCodeList.DISPATCH_ERROR,kPublishNetworkBrokenError:i.errorCodeList.NETWORK_BROKEN,kPublishNoPreviewError:i.errorCodeList.PUBLISH_NO_PREVIEW,kPublishEffectIsStarting:i.errorCodeList.VIDEO_EFFECT_IS_STARTING,kPublishNoLoginError:i.errorCodeList.NOT_LOGIN,kPublishRetryTimeoutError:i.errorCodeList.PUBLISHER_RETRY_TIMEOUT,kMediaServerForbidError:i.errorCodeList.PUBLISHER_MEDIA_SERVER_FORBID,kPublishTokenExpiredError:i.errorCodeList.TOKEN_EXPIRED,kPublishSessionClosedError:i.errorCodeList.PUBLISHER_SESSION_CLOSED,kPublishNegoTimeoutError:i.errorCodeList.PUBLISHER_SERVER_NEGO_TIMEOUT,kCreateOfferError:i.errorCodeList.PUBLISHER_CREATE_OFFER_ERROR,kSetLocalDescError:i.errorCodeList.PUBLISHER_SET_LOCAL_DESC_ERROR,kSessionTimeoutError:i.errorCodeList.PUBLISHER_SESSION_TIMEOUT,kSessionRequestError:i.errorCodeList.PUBLISHER_SESSION_REQUEST_FAIL,kSetRemoteDescError:i.errorCodeList.PUBLISHER_SET_REMOTE_DESC_ERROR,kMediaConnectionError:i.errorCodeList.PUBLISHER_MEDIA_CONNECTION_ERROR,kWebsocketDisconnectedError:i.errorCodeList.PUBLISHER_WEBSOCKET_DISCONNECTED,kMediaDescError:i.errorCodeList.PUBLISHER_MEDIA_DESC_ERROR,kCandidateError:i.errorCodeList.PUBLISHER_CANDIDATE_ERROR,kIsPublishing:i.errorCodeList.PUBLISHER_IS_PUBLISHING,kClientIPChangedError:i.errorCodeList.PUBLISHER_CLIENT_IP_CHANGED,kTTLOverTimeError:i.errorCodeList.PUBLISHER_TTL_OVERTIME,kUpdateMediaDescriptionTimeOut:i.errorCodeList.PUBLISHER_UPDATE_SDP_TIMEOUT,kUpdateMediaDescriptionError:i.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL},publishOption:o,message:o,session_id:o,stream:o,video_en_codec_id:o,cap_w:o,cap_h:o,w:o,h:o,video_en_fps:o,video_en_bps:o,audio_c_channel_count:o,audio_en_bps:o,aec_level:o,ans_level:o,agc:o,traffic_control_min_video_bitrate:o,use_na:o},kZegoTaskVideoCaptureSize:{event:"/sdk/api/publish_video_c_size",session_id:o,w:o,h:o},kZegoTaskVideoPlaySize:{event:"/sdk/play_video_size_changed",session_id:o,w:o,h:o},kZegoTaskRePublish:{event:"/sdk/republish",stream:o},kZegoTaskPublishStop:{event:"/sdk/stop_publish",error:{kParamError:i.errorCodeList.PUBLISHER_PARAM},stream:o},kZegoTaskPlayStart:{event:"/sdk/api/play_request",error:{kStreamIDNullError:i.errorCodeList.STREAM_ID_NULL,kPlayParamError:i.errorCodeList.PLAYER_PARAM,kPlayStreamIDToLongError:i.errorCodeList.STREAMID_TOO_LONG,kPlayStreamIDInvalidCharacterError:i.errorCodeList.STREAM_ID_INVALID_CHARACTER,kPlayNoLoginError:i.errorCodeList.NOT_LOGIN,kPlayRepeatedPullError:i.errorCodeList.REPEATED_PULL,kPlayNetworkTimeoutError:i.errorCodeList.TIMEOUT,kPlayDispatchTimeoutError:i.errorCodeList.DISPATCH_TIMEOUT,kPlayDispatchError:i.errorCodeList.DISPATCH_ERROR,kPlayNetworkBrokenError:i.errorCodeList.NETWORK_BROKEN,kPlayUnsupportedResourceMode:i.errorCodeList.PLAYER_UNSUPPORTED_PROTOCOL,kPlayStreamNotFound:i.errorCodeList.PLAYER_STREAM_NOT_EXIST,kPlayRetryTimeoutError:i.errorCodeList.PLAYER_RETRY_TIMEOUT,kPlaySessionClosedError:i.errorCodeList.PLAYER_SESSION_CLOSED,kPlaySessionResetError:i.errorCodeList.PLAYER_SESSION_RESET,kPlayNegoTimeoutError:i.errorCodeList.PLAYER_SERVER_NEGO_TIMEOUT,kCreateOfferError:i.errorCodeList.PLAYER_CREATE_OFFER_ERROR,kSetLocalDescError:i.errorCodeList.PLAYER_SET_LOCAL_DESC_ERROR,kSessionRequestError:i.errorCodeList.PLAYER_SESSION_REQUEST_FAIL,kSessionTimeoutError:i.errorCodeList.PLAYER_SESSION_TIMEOUT,kSetRemoteDescError:i.errorCodeList.PLAYER_SET_REMOTE_DESC_ERROR,kMediaConnectionError:i.errorCodeList.PLAYER_MEDIA_CONNECTION_ERROR,kWebsocketDisconnectedError:i.errorCodeList.PLAYER_WEBSOCKET_DISCONNECTED,kCandidateError:i.errorCodeList.PLAYER_CANDIDATE_ERROR,kMediaDescError:i.errorCodeList.PLAYER_MEDIA_DESC_ERROR,kIsPlaying:i.errorCodeList.PLAYER_IS_PLAYING,kClientIPChangedError:i.errorCodeList.PLAYER_CLIENT_IP_CHANGED,kTTLOverTimeError:i.errorCodeList.PLAYER_TTL_OVERTIME,kProbeTimeOutError:i.errorCodeList.PLAYER_PROBE_TIMEOUT},playOption:o,message:o,session_id:o,stream:o,audio_activate:o,video_activate:o,use_na:o},kZegoTaskRePlay:{event:"/sdk/replay",stream:o},kZegoTaskPlayStop:{event:"/sdk/stop_play",error:{kParamError:i.errorCodeList.PUBLISHER_PARAM},stream:o},kZegoTaskEnumDevices:{event:"/device/list",error:{kBrowserNotSupportError:i.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:i.errorCodeList.ENUMERATE_DEVICES_FAIL},dev_list:o},kZegoTaskAudioOutput:{event:"/device/audio_capture",error:{kBrowserNotSupportError:i.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:i.errorCodeList.ENUMERATE_DEVICES_FAIL},session_id:o,device:o},kZegoTaskVideoCapture:{event:"/device/video_capture",error:{kBrowserNotSupportError:i.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:i.errorCodeList.ENUMERATE_DEVICES_FAIL},session_id:o,device:o},kZegoTaskDeviceInterrupt:{event:"/device/interrupt",error:{kBrowserNotSupportError:i.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,kEnumDevicesError:i.errorCodeList.ENUMERATE_DEVICES_FAIL},session_id:o,interrupt:o},kZegoTaskSetDebug:"/sdk/set_debug",kZegoTaskSetLog:"/sdk/set_log_config",kZegoTaskCheckSystemRequirements:{event:"/sdk/check_system",capability:o},kZegoTaskRemoteCameraUpdate:{event:"/sdk/remote_camera_update",stream:o,status:o},kZegoTaskRemoteMicUpdate:{event:"/sdk/remote_mic_update",stream:o,status:o},kZegoTaskDestroyStream:{event:"/sdk/destroy_stream",error:{kLocalStreamError:i.errorCodeList.LOCALSTREAM_WRONG}},kZegoTaskScreenSharingEnded:"/sdk/screen_share_end",kZegoTaskAudioOutputChanged:{event:"/device/api/audio_output",session_id:o,stream:o,device:o,reason:o},kZegoEventPublishStat:"/sdk/publish_stat_report",kZegoEventPlayStat:"/sdk/play_stat_report",kZegoTaskLiveRoomGetStreamUpdateInfo:{event:"/liveroom/get_stream_update_info",stream_update_type:o,update_stream:o},kZegoTaskLiveRoomGetStreamExtraInfo:{event:"/liveroom/get_stream_extra_info",update_stream:o},kZegoTaskPlayDecodeFirstVideoFrame:{event:"/sdk/play_decode_first_video_frame",session_id:o,fft_consumed:o},kZegoVisibilityChange:{event:"/app/background"},kZegoSetCaptureVolume:{event:"/sdk/set_capture_volume",error:{kParamError:i.errorCodeList.INPUT_PARAM}},kZegoListener:{event:"/sdk/listener"},kZegoNetProbe:{event:"/sdk/net_probe"},kZegoNetProbeResult:{event:"/sdk/net_probe_result"},kZegoTaskCloudSettingCache:{event:"/cloud_setting/cache"},kZegoTaskCloudSettingRefresh:{event:"/cloud_setting/refresh"}},t.ZegoWechatLogEvent={kZegoTaskCheckSystemRequirements:{event:"/sdk/check_system",error:{kCheckSystemGetSettingFailError:i.errorCodeList.WX_GET_SETTING_FAIL},capability:o},kZegoTaskPublishStart:{event:"/sdk/api/publish_request",error:{kPublishStreamIDNullError:i.errorCodeList.STREAM_ID_NULL,kPublishParamError:i.errorCodeList.PUBLISHER_PARAM,kPublishStreamIDTooLongError:i.errorCodeList.STREAMID_TOO_LONG,kPublishStreamIDInvalidCharacterError:i.errorCodeList.STREAM_ID_INVALID_CHARACTER,kPublishNetworkTimeoutError:i.errorCodeList.TIMEOUT,kPublishDispatchTimeoutError:i.errorCodeList.DISPATCH_TIMEOUT,kPublishDispatchError:i.errorCodeList.DISPATCH_ERROR,kPublishNetworkBrokenError:i.errorCodeList.NETWORK_BROKEN,kPublishNoLoginError:i.errorCodeList.NOT_LOGIN,kPublishRetryTimeoutError:i.errorCodeList.PUBLISHER_RETRY_TIMEOUT,kIsPublishing:i.errorCodeList.PUBLISHER_IS_PUBLISHING},publishOption:o,stream:o,message:o},kZegoTaskPlayStart:{event:"/sdk/api/play_request",error:{kPlayStreamIDNullError:i.errorCodeList.STREAM_ID_NULL,kPlayParamError:i.errorCodeList.PLAYER_PARAM,kPlayStreamIDTooLongError:i.errorCodeList.STREAMID_TOO_LONG,kPlayStreamIDInvalidCharacterError:i.errorCodeList.STREAM_ID_INVALID_CHARACTER,kPlayNoLoginError:i.errorCodeList.NOT_LOGIN,kPlayRepeatedPullError:i.errorCodeList.REPEATED_PULL,kPlayNetworkTimeoutError:i.errorCodeList.TIMEOUT,kPlayDispatchTimeoutError:i.errorCodeList.DISPATCH_TIMEOUT,kPlayDispatchError:i.errorCodeList.DISPATCH_ERROR,kPlayNetworkBrokenError:i.errorCodeList.NETWORK_BROKEN,kPlayRetryTimeoutError:i.errorCodeList.PLAYER_RETRY_TIMEOUT,kIsPlaying:i.errorCodeList.PLAYER_IS_PLAYING},playOption:o,message:o,session_id:o,stream:o,audio_activate:o,video_activate:o},kZegoEventPublishStat:"/sdk/publish_stat_report",kZegoEventPlayStat:"/sdk/play_stat_report",kZegoTaskRePublish:"/sdk/republish",kZegoTaskRePlay:"/sdk/replay",kZegoTaskPublishStop:{event:"/sdk/stop_publish",error:{kParamError:i.errorCodeList.PUBLISHER_PARAM},stream:o},kZegoTaskPlayStop:{event:"/sdk/stop_play",error:{kParamError:i.errorCodeList.PUBLISHER_PARAM},stream:o},kZegoTaskLiveRoomGetStreamUpdateInfo:{event:"/liveroom/get_stream_update_info",stream_update_type:o,update_stream:o},kZegoTaskLiveRoomGetStreamExtraInfo:{event:"/liveroom/get_stream_extra_info",update_stream:o}}},2367:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_WEBRTC_ACTION=void 0,(r=t.ZEGO_WEBRTC_ACTION||(t.ZEGO_WEBRTC_ACTION={})).SET_VIDEO_CONFIG="zc.svc",r.SET_AUDIO_CONFIG="zc.sac",r.REPLACE_TRACK="zc.rp",r.SET_BEAUTY_EFFECT="zc.sbe",r.ENABLE_STREAM="zc.es",r.ENABLE_MIC_ONLY="zc.emo",r.ACTIVATE_SEI_INSERT="zc.asi",r.MUTE_PUBLISH_STREAM_VIDEO="zc.mpsv.0",r.MUTE_PUBLISH_STREAM_AUDIO="zc.mpsa.0",r.MUTE_MIC="zc.mm",r.MUTE_PLAY_STREAM_VIDEO="zc.mpsv.1",r.MUTE_PLAY_STREAM_AUDIO="zc.mpsa.1",r.ADD_TRACK="zc.at",r.REMOVE_TRACK="zc.rt",r.HANDLE_TRACK="zc.ht"},4495:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AdvancedModule=void 0;var s=r(2367),a=r(5098),d=r(8706),c=function(){function e(e,t,r,i){this.logger=e,this.dataReport=t,this.streamCenter=r,this.stateCenter=i,this.screenShotReady=!1}return e.prototype.setVideoConfig=function(e,t){var r=this;return this.logger.info(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" call"),new Promise((function(i,o){var n=d.ZegoRTCLogEvent.kZegoSetVideoConfig.error,a=n.kLocalStreamError,c=n.kParamError,u=r.stateCenter.getReportSeq();if(r.dataReport.newReport(u,d.ZegoRTCLogEvent.kZegoSetVideoConfig.event),!(e instanceof MediaStream))return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" localStream not found"),r.dataReport.addMsgInfo(u,a),r.dataReport.uploadReport(u),void o({errorCode:c.code,extendedData:c.message+" localStream no found"});if(!t||"object"!=typeof t||0==Object.keys(t).length)return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints wrong"),r.dataReport.addMsgInfo(u,c),r.dataReport.uploadReport(u),void o({errorCode:c.code,extendedData:c.message+" constraints wrong"});if(t.width&&!r.stateCenter.checkValidNumber(t.width))return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints width integer number, range[1, 10000]"),r.dataReport.addMsgInfo(u,{error:c.code,message:c.message+" constraints width integer number, range[1, 10000]"}),r.dataReport.uploadReport(u),void o({errorCode:c.code,extendedData:c.message+" constraints wrong"});if(t.height&&!r.stateCenter.checkValidNumber(t.height))return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+" constraints height integer number, range[1, 10000]"),r.dataReport.addMsgInfo(u,{error:c.code,message:c.message+" constraints height integer number, range[1, 10000]"}),r.dataReport.uploadReport(u),void o({errorCode:c.code,extendedData:c.message+" constraints wrong"});if(t.maxBitrate&&"number"!=typeof t.maxBitrate){var l=" constraints maxBitrate is not a number";return r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+l),r.dataReport.addMsgInfo(u,{error:c.code,message:c.message+l}),r.dataReport.uploadReport(u),void o({errorCode:c.code,extendedData:c.message+l})}if(t.frameRate&&"number"!=typeof t.frameRate)return l=" constraints frameRate is not a number",r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_VIDEO_CONFIG+l),r.dataReport.addMsgInfo(u,{error:c.code,message:c.message+l}),r.dataReport.uploadReport(u),void o({errorCode:c.code,extendedData:c.message+l});r.setPublishStreamConstraints(e,t,(function(e){r.dataReport.uploadReport(u),i(e)}))}))},e.prototype.setAudioConfig=function(e,t){var r=this;return this.logger.info(s.ZEGO_WEBRTC_ACTION.SET_AUDIO_CONFIG+" call"),new Promise((function(i){var o=r.stateCenter.getReportSeq();return r.dataReport.newReport(o,d.ZegoRTCLogEvent.kZegoSetAudioConfig.event),e instanceof MediaStream?!t||"object"!=typeof t||0==Object.keys(t).length||void 0!==t.AEC&&"boolean"!=typeof t.AEC||void 0!==t.AGC&&"boolean"!=typeof t.AGC||void 0!==t.ANS&&"boolean"!=typeof t.ANS?(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_AUDIO_CONFIG+" constraints wrong"),r.dataReport.addMsgInfo(o,d.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError),r.dataReport.uploadReport(o),void i({errorCode:d.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.code,extendedData:d.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.message+" constraints wrong"})):void r.setPublishStreamConstraints(e,t,(function(e){r.dataReport.uploadReport(o),i(e)})):(r.logger.error(s.ZEGO_WEBRTC_ACTION.SET_AUDIO_CONFIG+" localStream not found"),r.dataReport.addMsgInfo(o,d.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError),r.dataReport.uploadReport(o),void i({errorCode:d.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.code,extendedData:d.ZegoRTCLogEvent.kZegoSetAudioConfig.error.kParamError.message+" localStream no found"}))}))},e.prototype.enableStream=function(e,t){if(this.logger.info(s.ZEGO_WEBRTC_ACTION.ENABLE_STREAM+" call"),"boolean"!=typeof t.video&&"boolean"!=typeof t.audio)return this.logger.error(s.ZEGO_WEBRTC_ACTION.ENABLE_STREAM+" option error"),!1;var r=!0,i=!0;return"boolean"==typeof t.video&&(r=this.enableCamera(e,t.video,t.retain)),"boolean"==typeof t.audio&&(i=this.enableMicrophone(e,t.audio)),r&&i},e.prototype.enableMicrophoneOnly=function(e){if(this.logger.info(s.ZEGO_WEBRTC_ACTION.ENABLE_MIC_ONLY+" call"),"boolean"!=typeof e)return!1;for(var t=0;t<this.streamCenter.previewStreamList.length;t++)if(!this.streamCenter.previewStreamList[t].enableMicrophoneOnly(e,this.streamCenter))return this.logger.error("zsc.emo.0 previewer "+t+" change mic mute state failed"),!1;return this.streamCenter.isMicEnabled=e,!0},e.prototype.replaceTrack=function(e,t){return o(this,void 0,void 0,(function(){var r,i,o;return n(this,(function(n){return r=this.stateCenter.getReportSeq(),this.dataReport.newReport(r,d.ZegoRTCLogEvent.kZegoReplaceTrack.event),i=d.ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError,e instanceof MediaStream?t&&t instanceof MediaStreamTrack?(o=this._replaceTrack(e,t),this.dataReport.uploadReport(r),[2,o]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.REPLACE_TRACK+" mediastream track no found"),this.dataReport.uploadReport(r,void 0,i),[2,{errorCode:i.code,extendedData:i.message+" mediastream track no found"}]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.REPLACE_TRACK+" localStream not found"),this.dataReport.uploadReport(r,void 0,i),[2,{errorCode:i.code,extendedData:i.message+" localStream no found"}])}))}))},e.prototype.setPublishStreamConstraints=function(e,t,r){var i,s=this;this.logger.info("zsc.spsc.0 constraints",JSON.stringify(t));var d=this.streamCenter.checkPreview(e);if(!d)return this.logger.error("zsc.spsc.0 preview no found"),void(r&&r({errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message}));var c=this.streamCenter.checkPublish(e),u=null==c?void 0:c.publisher,l=(null===(i=null==u?void 0:u.peerConnection)||void 0===i?void 0:i.getSenders())||[],h=d.videoTrack,p=d.audioTrack,g=!1,f=!1;h&&(t.width||t.height||t.frameRate||t.videoQuality)&&(t.videoQuality||(d.mediaStreamConfig.videoQuality=4),g=!0),void 0===t.ANS&&void 0===t.AGC&&void 0===t.AEC||(f=!0),g&&!h?(this.logger.error("zsc.spsc.0 video track not found"),r&&r({errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message})):t.video=!0,f&&!p?(this.logger.error("zsc.spsc.0 audio track not found"),r&&r({errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message})):t.audio=!0;var _,m=JSON.parse(JSON.stringify(d.mediaStreamConfig)),v=Object.assign(d.mediaStreamConfig,t);"screen"==d.previewType?(_=this.streamCenter.getScreenConstrains(v)).bitRate!==m.bitRate&&(t.maxBitrate=_.bitRate):_=d.getMediaStreamConstraints(v,!0),this.logger.info("zsc.spsc.0 applyConstraints ",JSON.stringify(_));var E=[];g&&h&&E.push(h.applyConstraints(_.video));var S=!0;if(f&&(S=(null==p?void 0:p.enabled)||!1,null==p||p.stop(),E.push(navigator.mediaDevices.getUserMedia({video:!1,audio:_.audio}))),l.length>0&&t.maxBitrate){var T=l.filter((function(e){return e.track&&"video"===e.track.kind}));T||this.logger.error("zsc.spsc.0 video sender no found");var C=T.length>1?T[1]:T[0]?T[0]:null;if(C){var y=C.getParameters();y.encodings||(y.encodings=[{}]),y.encodings[0].maxBitrate=1e3*t.maxBitrate,E.push(C.setParameters(y))}else this.logger.error("zsc.spsc.0 video sender no found")}else t.maxBitrate&&(d.videoInfo.bitRate=t.maxBitrate);E.length>0?Promise.all(E).then((function(e){var i,o,n=e[1];if(f){var a=(o=g?e[1]:e[0]).getVideoTracks()[0];null==a||a.stop();var c=o.getAudioTracks()[0];c.enabled=S,n=JSON.stringify(c.getConstraints()),d.replacePreviewTrack(c),d.gainNode||d.onAudioTrackChange(c)}if(t.maxBitrate&&(d.videoInfo.bitRate=t.maxBitrate,u&&(u.videoInfo.bitRate=t.maxBitrate)),(null===(i=null==_?void 0:_.video)||void 0===i?void 0:i.frameRate)&&u){var l=_.video.frameRate;d.videoInfo.frameRate=l,u.videoInfo.frameRate=l}s.logger.info("zsc.spsc.0 set constraints success",n),r&&r({errorCode:0,extendedData:""})})).catch((function(t){return o(s,void 0,void 0,(function(){var i,o,s,c,u=this;return n(this,(function(n){switch(n.label){case 0:return this.logger.error("zsc.spsc.0 fail reason ",t.name,t.toString()),f?(i=d.getMediaStreamConstraints(m),this.logger.info("zsc.spsc.0 oldMediaStreamConstraints ",JSON.stringify(i)),[4,navigator.mediaDevices.getUserMedia({video:!1,audio:i.audio}).catch((function(e){u.logger.error("zsc.spsc.0.1 setbackup fail "+e.name)}))]):[3,2];case 1:(o=n.sent())&&(null==(s=e.getVideoTracks()[0])||s.stop(),c=o.getAudioTracks()[0],d.replacePreviewTrack(c),d.gainNode||d.onAudioTrackChange(c)),this.logger.info("zsc.spsc.0.1 setbackup suc "),n.label=2;case 2:return r&&r({errorCode:a.errorCodeList.PUBLISHER_CONSTRAINTS_ERROR.code,extendedData:t.name+" "+(t.constraint?"constraint:"+t.constraint:"")}),[2]}}))}))})):(this.logger.warn("zsc.spsc.0 constaints is no changes"),r&&r({errorCode:a.errorCodeList.PUBLISHER_CONSTRAINTS_ERROR.code,extendedData:"constraints is no changes"}))},e.prototype.useVideoDevice=function(e,t){var r=this;return this.logger.info("zc.uvd.0 call"),new Promise((function(i){var o=r.stateCenter.getReportSeq();if(r.dataReport.newReport(o,d.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.event),r.dataReport.addMsgInfo(o,{device:d.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.device(t)}),!(e instanceof MediaStream))return r.logger.error("zc.uvd.0 localStream not found"),r.dataReport.addMsgInfo(o,d.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kLocalStreamError),r.dataReport.uploadReport(o),void i({errorCode:d.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.code,extendedData:d.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.message});if("string"!=typeof t)return r.logger.error("zc.uvd.0 deviceID must be string"),r.dataReport.addMsgInfo(o,{error:d.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.code,message:d.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.message+" deviceID must be string"}),r.dataReport.uploadReport(o),void i({errorCode:d.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.code,extendedData:d.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kParamError.message});var n=function(t){var n,s;r.dataReport.uploadReport(o);var a=r.streamCenter.checkPublish(e);a&&(a.cameraLabel=(null===(s=null===(n=a.publisher.previewer)||void 0===n?void 0:n.videoTrack)||void 0===s?void 0:s.label)||a.cameraLabel),i(t)};r.stateCenter.getDevices((function(o){if(!o.cameras.find((function(e){return e.deviceID==t})))return r.logger.error("zc.uvd.0 device is not found"),void i({errorCode:d.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kDevicesNoFoundError.code,extendedData:d.ZegoRTCLogEvent.kZegoTaskUseVideoDevice.error.kDevicesNoFoundError.message});r.switchDevice("video",e,t,n)}),(function(i){r.logger.warn("zc.uvd.0 getDevices err:",i),r.switchDevice("video",e,t,n)}))}))},e.prototype.useAudioDevice=function(e,t){var r=this;return this.logger.info("zc.uad.1 call"),new Promise((function(i){var o=r.stateCenter.getReportSeq();r.dataReport.newReport(o,d.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.event),r.dataReport.addMsgInfo(o,{device:d.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.device(t)});var n=function(e,t){r.logger.error("zc.uad.1 "+t);var n=e;n.message=n.message+(t?" "+t:""),r.dataReport.addMsgInfo(o,n),r.dataReport.uploadReport(o),i({errorCode:n.code,extendedData:n.message})},s=function(t){var n;r.dataReport.uploadReport(o);var s=r.streamCenter.checkPublish(e);s&&(s.microLabel=(null===(n=e.getAudioTracks()[0])||void 0===n?void 0:n.label)||s.microLabel),i(t)};e instanceof MediaStream?"string"==typeof t?r.stateCenter.getDevices((function(o){if(!o.microphones.find((function(e){return e.deviceID==t})))return r.logger.error("zc.uad.1 device is not found"),void i({errorCode:d.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kDevicesNoFoundError.code,extendedData:d.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kDevicesNoFoundError.message});r.switchDevice("audio",e,t,s)}),(function(i){r.logger.warn("zc.uad.1 getDevices err:",i),r.switchDevice("audio",e,t,s)})):n(d.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kParamError,"deviceID must be string"):n(d.ZegoRTCLogEvent.kZegoTaskUseAudioDevice.error.kLocalStreamError,"localStream not found")}))},e.prototype.publishTarget=function(e){var t=this,r=this.stateCenter.getReportSeq();switch(e.type){case"addpush":this.dataReport.newReport(r,d.ZegoRTCLogEvent.kZegoTaskAddPublishCdnUrl.event);break;case"delpush":case"clearpush":this.dataReport.newReport(r,d.ZegoRTCLogEvent.kZegoTaskRemovePublishCdnUrl.event)}return this.dataReport.addMsgInfo(r,{stream:d.ZegoRTCLogEvent.kZegoTaskRemovePublishCdnUrl.stream(e.streamID),target_url:d.ZegoRTCLogEvent.kZegoTaskRemovePublishCdnUrl.target_url(e.pushUrl)}),new Promise((function(i,o){var n=function(e,i){t.logger.error("zb.pt"+(i||e.message)),t.dataReport.addMsgInfo(r,{error:e.code,message:e.message+(i||"")}),t.dataReport.uploadReport(r),o({errorCode:e.code,extendedData:e.message+(i?" "+i:"")})};if(-1==["addpush","delpush","clearpush"].indexOf(e.type))return t.logger.error("zb.sh.pt cdn push type error"),void n(a.errorCodeList.PUBLISHER_CDN_PUSH_ERROR,"type error");if(e.streamID&&"string"==typeof e.streamID)if(e.pushUrl&&"string"==typeof e.pushUrl)if(t.stateCenter.publishStreamList[e.streamID]){var s=t.streamCenter.getRoomByStreamID(e.streamID);s?s.streamHandler._publishTarget(e,(function(e){t.dataReport.uploadReport(r),i(e)}),n):n(d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kNoLoginError)}else n(d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kPublishStreamNoFoundError);else n(d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kParamError,"push url error");else n(d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kParamError,"stream id type error")}))},e.prototype.enableDualStream=function(e){this.logger.info("zsc.eds call");var t=this.streamCenter.checkPreview(e);t&&!t.lowStream?navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"custom"==t.previewType?this.logger.error("zsc.eds can not support firefox"):this.streamCenter.checkPublish(e)?this.logger.error("zsc.eds is publishing"):(t.enableDualStream=!0,t.createLowStream()):this.logger.error("zsc.eds preview no found")},e.prototype.setLowStreamParameter=function(e,t){var r=this.streamCenter.checkPreview(e);if(r){var i=r.videoInfo;t.width&&i.width&&t.width>i.width||t.height&&i.height&&t.height>i.height||t.frameRate&&i.frameRate&&t.frameRate>i.frameRate||t.height&&i.bitRate&&t.bitRate>i.bitRate||(r.lowStreamConfig=Object.assign(r.lowStreamConfig,t))}else this.logger.error("zsc.slsp.0 preview no found")},e.prototype.handleTrack=function(e,t,r,i,d){var c;return o(this,void 0,void 0,(function(){var u,l,h,p,g,f,_,m,v,E,S=this;return n(this,(function(T){switch(T.label){case 0:return t instanceof MediaStream?r instanceof MediaStreamTrack&&"audio"!=r.kind?(u=this.streamCenter.checkPreview(t))?"video"===r.kind&&(null===(c=u.videoEffect)||void 0===c?void 0:c.enabled)?(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" need to disable video beauty effect first"),d&&d({errorCode:a.errorCodeList.VIDEO_EFFECT_IS_RUNNING.code,extendedData:"need to disable video beauty effect before add or remove track"}),[2]):"ADD"==e&&(t.getTracks().length>=2||t.getTracks().find((function(e){return e.kind==r.kind})))?(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" only stream which have one track and kind no exist can add track"),d&&d({errorCode:a.errorCodeList.TRACK_CAN_NOT_ADD.code,extendedData:a.errorCodeList.TRACK_CAN_NOT_ADD.message}),[2]):"REMOVE"!=e||1!=t.getTracks().length&&t.getTracks().includes(r)?!(l=this.streamCenter.checkPublish(t))||5===l.publisher.stateNego&&1!=l.publisher.isUpdateSDP?l?(h=l.publisher,p=u,(g=l.publisher.peerConnection)?(h.isUpdateSDP=!0,"ADD"!=e?[3,1]:(g.addTrack(r,t),[3,4])):[2]):[3,6]:(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" publish state wrong"),d&&d({errorCode:a.errorCodeList.PUBLISHER_STATE_WRONG.code,extendedData:a.errorCodeList.PUBLISHER_STATE_WRONG.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" not supported"),d({errorCode:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.code,extendedData:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" stream no found"),d&&d({errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" only can handle video track"),d({errorCode:a.errorCodeList.INPUT_PARAM.code,extendedData:a.errorCodeList.INPUT_PARAM.message}),[2]):(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" stream wrong"),d({errorCode:a.errorCodeList.INPUT_PARAM.code,extendedData:a.errorCodeList.INPUT_PARAM.message}),[2]);case 1:return window.RTCPeerConnection&&window.RTCPeerConnection.prototype.getTransceivers&&window.RTCRtpTransceiver.prototype.stop?[4,g.getSenders().find((function(e){return e.track&&e.track==r}))]:(this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" not supported getTransceivers"),d({errorCode:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.code,extendedData:a.errorCodeList.HANDLE_TRACK_NOT_SUPPORTED.message}),[2]);case 2:return f=T.sent(),[4,g.getTransceivers().find((function(e){return e.sender==f}))];case 3:if(_=T.sent(),!(f&&_&&_.stop))return this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" sender no found"),d&&d({errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message}),[2];try{g.removeTrack(f),_.stop()}catch(e){this.logger.error(s.ZEGO_WEBRTC_ACTION.HANDLE_TRACK+" "+e),d&&d({errorCode:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.code,extendedData:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.message+" "+e})}T.label=4;case 4:return m={},v=this.streamCenter.previewStreamList.find((function(e){return e.localStream.getTracks().find((function(e){return e==r}))})),m=v&&"ADD"==e?v.videoInfo:{},[4,g.createOffer()];case 5:return E=T.sent(),h.onCreateOfferSuccess(E,!0,m,(function(s){return o(S,void 0,void 0,(function(){var o;return n(this,(function(n){return 0!==s?d&&d({errorCode:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.code,extendedData:a.errorCodeList.PUBLISHER_UPDATE_SDP_FAIL.message}):(o="video"==r.kind?"videoTrack":"audioTrack","ADD"==e?(t.addTrack(r),p[o]=r,"video"==r.kind&&1==r.enabled?h.sendStreamStatus(0,h.mic_status,!0):1==r.enabled&&h.sendStreamStatus(h.camera_status,0,!0)):("video"==r.kind?h.sendStreamStatus(2,h.mic_status,!0):h.sendStreamStatus(h.camera_status,2,!0),t.removeTrack(r),p[o]=null),u.mediaStreamConfig.video="ADD"==e,i({errorCode:0,extendedData:""})),[2]}))}))})),[3,7];case 6:"ADD"==e?t.addTrack(r):t.removeTrack(r),i({errorCode:0,extendedData:""}),u.mediaStreamConfig.video="ADD"==e,T.label=7;case 7:return[2]}}))}))},e.prototype.switchDevice=function(e,t,r,o){var n=this,s=this.streamCenter.checkPublish(t);if(s&&s.publisher&&5!==s.publisher.stateNego)return this.logger.error("zsc.sd.0 stream is publishing"),void(o&&o({errorCode:a.errorCodeList.PUBLISHER_STREAM_NO_FOUND.code,extendedData:a.errorCodeList.PUBLISHER_STREAM_NO_FOUND.message}));var d=this.streamCenter.checkPreview(t);if(!d)return this.logger.error("zsc.sd.0 preview no found"),void(o&&o({errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message}));if("video"===e&&0==d.mediaStreamConfig.video)return this.logger.error("zsc.sd.0 camera can not be changed when video is false"),void(o&&o({errorCode:a.errorCodeList.VIDEO_DEVICE_FALSE.code,extendedData:a.errorCodeList.VIDEO_DEVICE_FALSE.message}));if("audio"===e&&0==d.mediaStreamConfig.audio)return this.logger.error("zsc.sd.0 microphone can not be changed when audio is false"),void(o&&o({errorCode:a.errorCodeList.AUDIO_DEVICE_FALSE.code,extendedData:a.errorCodeList.AUDIO_DEVICE_FALSE.message}));d.mediaStreamConfig.videoInput!==r&&delete d.mediaStreamConfig.facingMode;var c,u={};"video"===e?(u.videoInput=r,c=d.videoTrack):(u.audioInput=r,c=d.audioTrack);var l=this.stateCenter.browser;this.logger.info("zsc.sd.0 browser "+l),"firefox"===l&&(null==c||c.stop());var h=i(i({},d.mediaStreamConfig),u),p=d.getMediaStreamConstraints(h),g=function(t,r){r.getTracks().forEach((function(t){if(t.kind===e){var r="video"===e?"videoTrack":"audioTrack",i=d[r];t.enabled=i.enabled,"video"===e&&d.lowStream&&d.lowStream.getTracks().forEach((function(e){return e.stop()})),!s||d.muteImage&&!t.enabled&&"audio"!=e?d&&d.muteImage&&!t.enabled&&"video"==e?d[r]=t:d&&d.replacePreviewTrack(t):s.publisher.replacePublishedTrack(t),i&&i.stop()}})),d.restartSoundLevel()};"audio"==e?p.video=!1:p.audio=!1,navigator.mediaDevices.getUserMedia(p).then((function(t){Object.assign(d.mediaStreamConfig,u),g(0,t),n.logger.info("zsc.sd.0 switch "+e+" device success"),o&&o({errorCode:0,extendedData:""})}),(function(t){var r,i;"video"==e?null===(r=d.videoTrack)||void 0===r||r.stop():null===(i=d.audioTrack)||void 0===i||i.stop(),n.logger.warn("zsc.sd.0 switch "+e+" device failed, stop last device and retry. ",t+""),navigator.mediaDevices.getUserMedia(p).then((function(t){Object.assign(d.mediaStreamConfig,u),g(0,t),n.logger.info("zsc.sd.0 swtich "+e+" device success"),o&&o({errorCode:0,extendedData:""})}),(function(t){n.logger.warn("zsc.sd.0 swtich "+e+" device failed and recover last device. ",t+"");var r=d.getMediaStreamConstraints(d.mediaStreamConfig),i=a.errorCodeList.VIDEO_DEVICE_FALSE;"audio"===e&&(i=a.errorCodeList.AUDIO_DEVICE_FALSE),navigator.mediaDevices.getUserMedia(r).then((function(r){g(0,r),n.logger.info("zsc.sd.0 recover last "+e+" device success"),o&&o({errorCode:i.code,extendedData:i.message+" "+JSON.stringify(t)})}),(function(t){n.logger.error("zsc.sd.0 swtich "+e+" device and recover failed, please recreate stream. ",t+""),o&&o({errorCode:i.code,extendedData:i.message+" "+JSON.stringify(t)})}))}))}))},e.prototype._replaceTrack=function(e,t){var r=this.streamCenter.checkPreview(e),i=this.streamCenter.checkPublish(e);return i?i.publisher.replacePublishedTrack(t):r?r.localStream.getTracks().find((function(e){return e.kind===t.kind}))?(r.replacePreviewTrack(t),{errorCode:0,extendedData:""}):(this.logger.error("zc.rt.0 track no found"),{errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message}):(this.logger.error("zc.rt.0 preview no found"),{errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message})},e.prototype.enableMicrophone=function(e,t){var r=this.streamCenter.checkPreview(e);return r?r.enableMicrophone(t,this.streamCenter):(this.logger.error("zsc.em.0 no preview"),!1)},e.prototype.enableCamera=function(e,t,r){var i=this.streamCenter.checkPreview(e);return i?i.enableCamera(t,this.streamCenter,r):(this.logger.error("zsc.ec.0 no preview"),!1)},e.prototype.setDummyCaptureImagePath=function(e,t){var r=this;return new Promise((function(i,o){var n=r.streamCenter.checkPreview(t);if(!n)return r.logger.error("zc.sdcp.0 preview no found"),void i(!1);if("string"!=typeof e)return r.logger.error("zc.sdcp.0 filePath type error"),void i(!1);var s=new Image;s.src=e,s.onload=function(){n.loadImgTimer&&clearTimeout(n.loadImgTimer),n.loadImgTimer=void 0,r.logger.info("zc.sdcp.0 load file path success"),n.muteImage=s,i(!0)},n.loadImgTimer=setTimeout((function(){r.logger.error("zc.sdcp.0 load img timeout"),i(!1)}),5e3)}))},e}();t.AdvancedModule=c},4378:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.signal=t.publisher=t.publishModule=t.playModule=t.preview=t.streamHandler=t.zegoWebRTC=t.ENUM_PUBLISH_STREAM_STATE=t.ENUM_STREAM_CMD_PRI=t.ENUM_STREAM_SUB_CMD=t.PROTO_VERSION=void 0;var s=r(2367),a=r(5098),d=r(8706),c=r(7248);function u(e,t){if(!e||"live"!==e.readyState)return 2;var r=e.kind;return!0===e.enabled?0:"video"===r&&"firefox"===t?2:20}t.PROTO_VERSION="2.16.1",t.ENUM_STREAM_SUB_CMD={liveNone:0,liveBegin:2001,liveEnd:2002,liveUpdate:2003},t.ENUM_STREAM_CMD_PRI={liveBegin:"zegochat_js.room_stream_create_req",liveEnd:"zegochat_js.room_stream_delete_req",liveUpdate:"zegochat_js.room_stream_update_req"},t.ENUM_PUBLISH_STREAM_STATE={waiting_url:1,tryPublish:2,update_info:3,publishing:4,stop:5,retryPublish:6},t.zegoWebRTC={mutePublishStreamVideo:function(e,t,r){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_VIDEO+" call");var i=this.stateCenter.getReportSeq();if(this.dataReport.newReport(i,d.ZegoRTCLogEvent.kZegoTaskMutePublishVideo),"boolean"!=typeof t||void 0!==r&&"boolean"!=typeof r)return this.logger.error(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_VIDEO+" option error"),!1;var o=this.rtcModules.advancedModule.enableStream(e,{video:!t,retain:r});return this.dataReport.uploadReport(i),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_VIDEO+" end"),o},mutePublishStreamAudio:function(e,t){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_AUDIO+" call");var r=this.stateCenter.getReportSeq();if(this.dataReport.newReport(r,d.ZegoRTCLogEvent.kZegoTaskMutePublishAudio),"boolean"!=typeof t)return this.logger.error(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_AUDIO+" option error"),!1;var i=this.rtcModules.advancedModule.enableStream(e,{audio:!t});return this.dataReport.uploadReport(r),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PUBLISH_STREAM_AUDIO+" end"),i},mutePlayStreamVideo:function(e,t){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_VIDEO+" call "+e+" "+t);var r=this.stateCenter.getReportSeq();this.dataReport.newReport(r,d.ZegoRTCLogEvent.kZegoTaskMutePlayVideo);var i=this.rtcModules.playModule.mutePlayStream(e,"video",t);return this.dataReport.uploadReport(r),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_VIDEO+" end"),i},mutePlayStreamAudio:function(e,t){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_AUDIO+" call "+e+" "+t);var r=this.stateCenter.getReportSeq();this.dataReport.newReport(r,d.ZegoRTCLogEvent.kZegoTaskMutePlayAudio);var i=this.rtcModules.playModule.mutePlayStream(e,"audio",t);return this.dataReport.uploadReport(r),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_PLAY_STREAM_AUDIO+"end"),i},muteMicrophone:function(e){this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_MIC+" call");var t=this.stateCenter.getReportSeq();if(this.dataReport.newReport(t,d.ZegoRTCLogEvent.kZegoTaskMuteMicrophone),"boolean"!=typeof e)return this.logger.error(s.ZEGO_WEBRTC_ACTION.MUTE_MIC+" option error"),!1;var r=this.rtcModules.advancedModule.enableMicrophoneOnly(!e);return this.dataReport.uploadReport(t),this.logger.info(s.ZEGO_WEBRTC_ACTION.MUTE_MIC+" end"),r},activateSEIInsert:function(e){var t=e.stream,r=e.action,i=e.infoType;return this.rtcModules.publishModule.activateSEIInsert(t,r,i)},getAudioInfo:function(e,t,r){if(!e)return this.logger.error("localStream is empty!"),!1;var o=i({},r);return new c.MediaUtil(this.ac,o).connectToSource(e,(function(e){t(e)}))},startRecord:function(e){var t=this,r=this.streamCenter.checkPreview(e);if(r){var i=e.clone(),o=i.getAudioTracks();o.length>0&&r.hasEmptyAudioTrack&&o.forEach((function(e){i.removeTrack(e)})),this.recordedBlobs=[];var n={mimeType:"video/webm;codecs=vp9"};MediaRecorder.isTypeSupported(n.mimeType)||(n={mimeType:"video/webm;codecs=vp8,opus"},MediaRecorder.isTypeSupported(n.mimeType)||(n={mimeType:"video/webm;codecs=vp8"},MediaRecorder.isTypeSupported(n.mimeType)||(n={mimeType:"video/webm"},MediaRecorder.isTypeSupported(n.mimeType)||(n={mimeType:""}))));try{this.mediaRecorder=new MediaRecorder(i,n)}catch(e){return void this.logger.error("Exception while creating ZegoMediaRecorder:",e)}this.mediaRecorder.onstop=function(e){t.logger.warn("Recorder stopped: "+e)},this.mediaRecorder.ondataavailable=this.handleDataAvailable.bind(this),this.mediaRecorder.start(10)}else this.logger.error("stream is not from zego!")},stopRecord:function(){this.mediaRecorder?this.mediaRecorder.stop():this.logger.warn("please invoke startRecord first")},resumeRecord:function(){this.mediaRecorder?this.mediaRecorder.resume():this.logger.warn("please invoke startRecord first")},pauseRecord:function(){this.mediaRecorder?this.mediaRecorder.pause():this.logger.warn("please invoke startRecord first")},saveRecord:function(e){if(this.mediaRecorder&&this.recordedBlobs){var t=new Blob(this.recordedBlobs,{type:"video/webm"}),r=window.URL.createObjectURL(t),i=document.createElement("a");i.style.display="none",i.href=r,i.download=e+".webm",document.body.appendChild(i),i.click(),setTimeout((function(){document.body.removeChild(i),window.URL.revokeObjectURL(r)}),100)}else this.logger.warn("please invoke startRecord first")},handleDataAvailable:function(e){e.data&&e.data.size>0&&this.recordedBlobs.push(e.data)},takeSnapShot:function(e,t){if(e&&0!==e.videoHeight){var r=document.createElement("canvas");r.width=e.videoWidth,r.height=e.videoHeight;var i=r.getContext("2d");i&&i.drawImage(e,0,0,r.width,r.height),t.src=r.toDataURL("image/jpeg")}else this.logger.error("video can not empty")},saveSnapShot:function(e,t){if(e&&0!==e.videoHeight){var r=document.createElement("canvas");r.width=e.videoWidth,r.height=e.videoHeight;var i=r.getContext("2d");i&&i.drawImage(e,0,0,r.width,r.height),r.toBlob((function(e){var r=window.URL.createObjectURL(e),i=document.createElement("a");i.style.display="none",i.href=r,i.download=t+".jpeg",document.body.appendChild(i),i.click(),setTimeout((function(){document.body.removeChild(i),window.URL.revokeObjectURL(r)}),100)}))}else this.logger.error("video can not empty")},setStreamExtraInfo:function(e,t){var r=this;return new Promise((function(i,o){var n=r.stateCenter.getReportSeq();r.dataReport.newReport(n,d.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.event),r.dataReport.addMsgInfo(n,{stream:d.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.stream(e),stream_extra_info:d.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.stream_extra_info(t)});var s=function(e,t){r.logger.error("zb.ssei "+t),r.dataReport.addMsgInfo(n,{error:e.code,message:e.message+" "+t}),r.dataReport.uploadReport(n),o({errorCode:e.code,extendedData:e.message+" "+t})};if("string"==typeof e&&""!=e)if("string"==typeof t&&""!=t)if(r.RTM.isDisConnect())s(d.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kNoLoginError,"not login");else if(r.stateCenter.publishStreamList[e]){var a=r.streamCenter.getRoomByStreamID(e);a?(r.dataReport.addMsgInfo(n,{room_sid:d.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.room_sid(a.sessionID)}),a.streamHandler.setStreamExtraInfo(e,t,i,s),r.dataReport.uploadReport(n)):s(d.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kNoLoginError,"not login")}else s(d.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kPublishStreamNoFoundError,"publish stream no found");else s(d.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kParamError,"extraInfo must be string and no empty");else s(d.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kParamError,"streamID must be string and not empty")}))},addTrack:function(e,t){var r=this;return new Promise((function(i,o){r.logger.info(s.ZEGO_WEBRTC_ACTION.ADD_TRACK+" call"),r.rtcModules.advancedModule.handleTrack("ADD",e,t,i,o)}))},removeTrack:function(e,t){var r=this;return new Promise((function(i,o){r.logger.info(s.ZEGO_WEBRTC_ACTION.REMOVE_TRACK+" call"),r.rtcModules.advancedModule.handleTrack("REMOVE",e,t,i,o)}))},enableCameraCapturing:function(e,t){return void 0===t&&(t=!0),o(this,void 0,void 0,(function(){var r;return n(this,(function(i){return(r=this.streamCenter.checkPreview(e))?[2,r.enableCameraCapturing(t)]:(this.logger.error("zsc.ecc no preview"),[2,!1])}))}))}},t.streamHandler={_publishTarget:function(e,r,i){var o=this;this.logger.info("zb.sh.ptcall");var n=Math.ceil((new Date).getTime()/1e3),s=e.streamID;this.stateCenter.testEnvironment&&(s="zegotest-"+this.stateCenter.appid+"-"+e.streamID);var c={appid:this.stateCenter.appid,biz_type:0,timestamp:n,seq:this.stateCenter.cdnSeq++,version:1*t.PROTO_VERSION,stream_id:s,pushurl:e.pushUrl};if(this.logger.debug("zb.sh.pt send command"),this.stateCenter.useNetAgent)this.sendBizChannelRequestV2({server:1,location:"/liveroomcmd/push",cmd:e.type},c,(function(t){o.logger.info("zb.sh.pt receive message");var n=t||{},s=n.code,d=n.message;s&&0!=s?(o.logger.error("zb.sh.pt "+e.type+" error code: "+s+" "+d),i(a.errorCodeList.UNKNOWN_SERVER_ERROR," cmd: "+e.type+" "+s+" "+d)):(o.logger.info("zb.sh.pt "+e.type+" success"),r&&r({errorCode:0,extendedData:""}))}),(function(t,r,n,s){var a="";s||(s=d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kUnknownServerError,200===t?(o.logger.info("zb.sh.pt error: "+r),s=d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kUnknownServerError,2001==r?s=d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kInvalidChannelError:2002==r&&(s=d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kBizChannelError),a="cmd: "+e.type+", biz_code: "+r):a="request media server fail, error: "+t,o.logger.error("zb.sh.pt "+a)),i&&i(s,a)}));else{var u={channel:"media",cmd:e.type,req_body:JSON.stringify(c)};this.sendBizChannelRequest(u,(function(t,n,s){if(o.logger.info("zb.sh.pt receive message"),0!=s.length){var c=JSON.parse(s),u=c.code,l=c.message;u&&0!=u?(o.logger.error("zb.sh.pt "+e.type+" error code: "+u+" "+l),i(a.errorCodeList.UNKNOWN_SERVER_ERROR," cmd: "+e.type+" "+u+" "+l)):(o.logger.info("zb.sh.pt "+e.type+" success"),r&&r({errorCode:0,extendedData:""}))}else i(d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kNoResponseError)}),(function(t,r,n){o.logger.info("zb.sh.pt error: "+t);var s=d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kUnknownServerError;2001==t?s=d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kInvalidChannelError:2002==t&&(s=d.ZegoRTCLogEvent.kZegoTaskPublishTarget.error.kBizChannelError),o.logger.error("zb.sh.pt "),i(s," cmd: "+e.type+" "+t+"   ")}))}},updateStreamExtraInfo:function(e,r,i,o){var n;this.logger.info("zb.sh.usei call"),n="PUBLIC"===this.stateCenter.type?t.ENUM_STREAM_SUB_CMD.liveUpdate:t.ENUM_STREAM_CMD_PRI.liveUpdate,this.stateCenter.publishStreamList[e]&&this.stateCenter.publishStreamList[e].state>=t.ENUM_PUBLISH_STREAM_STATE.update_info?(this.stateCenter.publishStreamList[e].extra_info=r,this.updateStreamInfo(e,n,r),i({errorCode:0})):this.stateCenter.publishStreamList[e]&&this.stateCenter.publishStreamList[e].state===t.ENUM_PUBLISH_STREAM_STATE.tryPublish?(this.stateCenter.publishStreamList[e].extra_info=r,i({errorCode:0})):o(d.ZegoRTCLogEvent.kZegoTaskLiveRoomSendStreamExtraInfo.error.kUpdateStreamInfoFailError)},setStreamExtraInfo:function(e,t,r,i){this.updateStreamExtraInfo(e,t,r,i)}},t.preview={enableCamera:function(e,t,r){var i,o,n,s,a,d=this;if(!this.localStream||0==this.localStream.getVideoTracks().length)return this.logger.error("zp.ec.2 video track no found"),!1;var c,l=this.videoTrack;if(!e&&this.muteImage){var h=document.createElement("canvas");h.width=this.muteImage.width,h.height=this.muteImage.height;var p=h.getContext("2d"),g=function(){p.drawImage(d.muteImage,0,0),d.muteImageAnID=requestAnimationFrame(g)};g(),c=h.captureStream().getVideoTracks()[0],this.localStream.removeTrack(this.localStream.getVideoTracks()[0]),this.localStream.addTrack(c)}else e&&this.muteImage&&((null===(i=null==this?void 0:this.videoEffect)||void 0===i?void 0:i.enabled)?this.replacePreviewTrack(this.videoEffect.output,!0):this.replacePreviewTrack(this.videoTrack));var f=this.stateCenter.browser;if(r&&!e||!l){if(r&&!e)if(null===(o=this.videoEffect)||void 0===o?void 0:o.enabled)this.logger.warn("zp.ec.2 Unable to keep the preview screen when beauty is turned on");else{var _=this.cloneVideoTrack;this.cloneVideoTrack=this.videoTrack.clone(),this.cloneVideoTrack.enabled=!0,this.replacePreviewTrack(this.cloneVideoTrack,!1,{retainTrack:!0}),_&&_.stop()}}else if(l.enabled=e,"chrome"===f&&e&&void 0!==typeof l.getSettings().width&&l.getSettings().width>0&&navigator.userAgent){var m=0,v=navigator.userAgent.toLowerCase().match(/chrome\/([\d.]+)/)[1];if(v&&(m=parseInt(v.split(",")[0])),m&&m>=87&&m<92){var E=l.getSettings().width-1,S=l.getSettings().height-1,T=l.getSettings().frameRate;l.applyConstraints({width:E,height:S,frameRate:T}).then((function(){l.applyConstraints({width:d.videoInfo.width,height:d.videoInfo.height,frameRate:T})}))}}l&&(l.enabled=e),null===(n=this.lowStream)||void 0===n||n.getVideoTracks().forEach((function(t){t.enabled=e}));var C=null===(s=t.checkPublish(this.localStream))||void 0===s?void 0:s.publisher;if(C){var y=null===(a=C.peerConnection)||void 0===a?void 0:a.getSenders().filter((function(e){var t;return"video"===(null===(t=e.track)||void 0===t?void 0:t.kind)}));y&&y.forEach((function(t){var r;!e&&d.muteImage&&c?null==t||t.replaceTrack(c):e&&((null===(r=null==d?void 0:d.videoEffect)||void 0===r?void 0:r.enabled)&&d.videoEffect.output?t.track!==d.videoEffect.output&&(null==t||t.replaceTrack(d.videoEffect.output)):t.track!==d.videoTrack&&(null==t||t.replaceTrack(d.videoTrack)),d.muteImageAnID&&cancelAnimationFrame(d.muteImageAnID))}));var R=this.muteImage&&!e?0:u(this.videoTrack,f);C.sendStreamStatus(R,C.mic_status)}return this.isVideoEnabled=e,this.logger.info("zp.ec.2 call success"),!0},enableMicrophone:function(e,t){var r;if(!this.localStream)return this.logger.error("zp.em.2 no localStream"),!1;this.localStream.getAudioTracks().forEach((function(t){t.enabled=e})),this.audioTrack&&(this.audioTrack.enabled=e&&t.isMicEnabled);var i=null===(r=t.checkPublish(this.localStream))||void 0===r?void 0:r.publisher;if(i&&i.signal){var o=i.camera_status,n=e&&t.isMicEnabled?0:2;i.sendStreamStatus(o,n)}return this.isAudioEnabled=e,this.logger.debug("zp.em.2 call success"),!0},replacePreviewTrack:function(e,t,r){var i;return void 0===t&&(t=!1),o(this,void 0,void 0,(function(){var o,s,a,d;return n(this,(function(n){switch(n.label){case 0:return e&&e.kind&&this.localStream?(o=!0===(null==r?void 0:r.retainTrack),s="audio"===e.kind?"audioTrack":"videoTrack",t||!(null===(i=this.videoEffect)||void 0===i?void 0:i.enabled)||"video"!==e.kind?[3,3]:o?[3,2]:[4,this.videoEffect.setInput(e)]):[2];case 1:n.sent(),n.label=2;case 2:return[3,4];case 3:"audio"===e.kind&&this.gainNode?(this.audioTrackSrc&&this.audioTrackSrc.numberOfOutputs&&(this.audioTrackSrc.disconnect(this.gainNode),this.audioTrackSrc=null),(a=this.ac.createMediaStreamDestination()).stream.getTracks().forEach((function(e){e.stop(),a.stream.removeTrack(e)})),a.stream.addTrack(e),this.audioTrackSrc=this.ac.createMediaStreamSource(a.stream),this.audioTrackSrc.connect(this.gainNode)):((d=this.localStream.getTracks().find((function(t){return t.kind===e.kind})))&&this.localStream.removeTrack(d),this.localStream.addTrack(e),!o&&"video"===e.kind&&this.enableDualStream&&this.createLowStream()),n.label=4;case 4:return t||o||(this[s]=e),[2]}}))}))},enableCameraCapturing:function(e){var t;return o(this,void 0,void 0,(function(){var r,o,s,a,d,c,l,h,p;return n(this,(function(n){switch(n.label){case 0:return this.localStream&&this.videoTrack&&"camera"===this.previewType?(r=null===(t=this.streamCenter.checkPublish(this.localStream))||void 0===t?void 0:t.publisher,e?"live"!==this.videoTrack.readyState?[3,1]:(this.logger.warn("zp.ecc camera is already capturing"),[3,9]):[3,10]):(this.logger.error("zp.ecc not camera stream"),[2,!1]);case 1:o=this.getMediaStreamConstraints(i(i({},this.mediaStreamConfig),{audio:!1})),n.label=2;case 2:return n.trys.push([2,8,,9]),[4,navigator.mediaDevices.getUserMedia(o)];case 3:return s=n.sent(),(a=s.getVideoTracks()[0]).enabled=this.isVideoEnabled,!1===a.enabled&&this.logger.warn("zp.ecc video is not enabled"),!this.muteImage||this.isVideoEnabled?[3,4]:(this.videoTrack=a,a.enabled=!this.isVideoEnabled,[3,7]);case 4:return r?[4,r.replacePublishedTrack(a)]:[3,6];case 5:if(0!==(d=n.sent()).errorCode)throw d;return[3,7];case 6:this.replacePreviewTrack(a),n.label=7;case 7:return[3,9];case 8:return c=n.sent(),this.logger.error("zsc.ecc resume camera capturing failed. "+JSON.stringify(c)),[2,!1];case 9:return[3,13];case 10:return l=this.videoTrack.enabled,"safari"===(h=this.stateCenter.browser)?[3,12]:(this.videoTrack.enabled=!1,[4,new Promise((function(e){setTimeout((function(){e(void 0)}),100)}))]);case 11:n.sent(),n.label=12;case 12:this.videoTrack.stop(),this.videoTrack.enabled=l,r&&(p=this.muteImage&&!this.isVideoEnabled?0:u(this.videoTrack,h),r.sendStreamStatus(p,r.mic_status)),n.label=13;case 13:return[2,!0]}}))}))}},t.playModule={mutePlayStream:function(e,t,r){var i=this;return this.logger.info("zsc.mps.0 call "+t+" "+r),new Promise((function(o,n){if("string"!=typeof e||""==e)return i.logger.error("zsc.mps.0 streamID must be string and not empty"),void n(!1);if("boolean"!=typeof r)return i.logger.error("zsc.mps.0 mute must be boolean"),void n(!1);var s=i.streamCenter.playerList[e];if(!s)return i.logger.error("zsc.mps.0 player not found"),void n(!1);if("video"===t){if(s.playOption&&!1===s.playOption.video||s.player&&0!==s.player.cameraStatus)return i.logger.error("zsc.mps.0 stream no contain video"),void n(!1);s.player.signal.ActivatePlayVideoStream(i.stateCenter.getSeq(),s.player.sessionId,r,(function(){i.logger.info("zsc.mps.0 suc");var e=i.stateCenter.getReportSeq();s.player.playMediaStatus.video=!r,i.dataReport.newReport(e,d.ZegoRTCLogEvent.kZegoPlayContentChanged.event),i.dataReport.addMsgInfo(e,{session_id:d.ZegoRTCLogEvent.kZegoPlayContentChanged.session_id(s.player.sessionId),video_activate:d.ZegoRTCLogEvent.kZegoPlayContentChanged.video_activate(s.player.playMediaStatus.video?1:0),audio_activate:d.ZegoRTCLogEvent.kZegoPlayContentChanged.audio_activate(s.player.playMediaStatus.audio?1:0)}),i.playVideoStatus=i.dataReport.uploadReport(e),o(!0)}),(function(){i.logger.error("zsc.mps.0 fail"),n(!1)}))}else if("audio"===t){if(s.playOption&&!1===s.playOption.audio||s.player&&0!==s.player.micStatus)return i.logger.error("zsc.mps.0 stream no contain audio"),void n(!1);s.player.signal.ActivatePlayAudioStream(i.stateCenter.getSeq(),s.player.sessionId,r,(function(){i.logger.info("zsc.mps.0 suc");var e=i.stateCenter.getReportSeq();s.player.playMediaStatus.audio=!r,i.dataReport.newReport(e,d.ZegoRTCLogEvent.kZegoPlayContentChanged.event),i.dataReport.addMsgInfo(e,{session_id:d.ZegoRTCLogEvent.kZegoPlayContentChanged.session_id(s.player.sessionId),video_activate:d.ZegoRTCLogEvent.kZegoPlayContentChanged.video_activate(s.player.playMediaStatus.video?1:0),audio_activate:d.ZegoRTCLogEvent.kZegoPlayContentChanged.audio_activate(s.player.playMediaStatus.audio?1:0)}),i.dataReport.uploadReport(e),o(!0)}),(function(){i.logger.error("zsc.mps.0 fail"),n(!1)}))}else n(!1)}))},setStreamAudioOutput:function(e,t){var r=this;return!(null==t||0==t.length||!e||(this.logger.debug("zsc.ssao.0 device "+t),e?"undefined"!==e.sinkId?(e.setSinkId(t).then((function(){r.logger.info("zsc.ssao.0 success device: "+t)})).catch((function(e){r.logger.info("zsc.ssao.0 "+e.name)})),0):(this.logger.error("zsc.ssao.0 browser does not suppport"),1):(this.logger.error("zsc.ssao.0 no localVideo"),1)))}},t.publishModule={activateSEIInsert:function(e,t,r){void 0===r&&(r=0);var i=this.streamCenter.checkPreview(e);if(!i)return this.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" stream is not created"),!1;if(0!==t&&1!==t)return this.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" value of action should be 0 or 1"),!1;i.activatesSEIConfig={action:t,infoType:r};var o=this.streamCenter.checkPublish(e);return o&&(null==o||o.publisher.activateSEIInsert(t,r)),!0}},t.publisher={activateSEIInsert:function(e,t){var r=this;return new Promise((function(i,o){return r.signal?(r.signal&&r.signal.activateSEIInsert(r.stateCenter.getSeq(),r.sessionId,r.peerID,e,t,(function(e,t,o){var n=!1;0===o.result?(r.logger.info(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" called success"),n=!0):1===o.result?(r.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" "+o.peer_id+" invalid param."),n=!1):2===o.result&&(r.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" peer not exist"),n=!1),i(n)}),(function(e){1===e&&r.logger.error(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" request timeout")})),!1):i(!1)}))},replacePublishedTrack:function(e,t){var r;return void 0===t&&(t=!1),o(this,void 0,void 0,(function(){var i,o,s,d,c,l,h,p;return n(this,(function(n){switch(n.label){case 0:return this.localStream,i=this.previewer,o=null==i?void 0:i.videoEffect,s=e.kind,d=i[s+"Track"],c=null===(r=this.peerConnection)||void 0===r?void 0:r.getSenders().filter((function(e){return e.track.kind===s})),l=this.stateCenter.browser,d?(h=0,p=0,"video"===s?(h=u(t?d:e,l),p=this.mic_status):"audio"===s&&(p=u(e,l),h=this.camera_status),[4,i.replacePreviewTrack(e,t)]):[3,2];case 1:return n.sent(),c?(c.forEach((function(r,n){"audio"!==s&&!t&&(null==o?void 0:o.enabled)||("video"==s&&i.lowStream&&c.length>1&&0==n?r.replaceTrack(i.lowStream.getVideoTracks()[0]):r.replaceTrack(e))})),this.sendStreamStatus(h,p)):this.logger.info("zc.rt.1 replace remote track will work after stream published"),this.logger.info("zc.rt.1 replace remote track success"),[2,{errorCode:0,extendedData:""}];case 2:return this.logger.error("zc.rt.1 publisher track no found"),[2,{errorCode:a.errorCodeList.TRACK_NOT_FOUND.code,extendedData:a.errorCodeList.TRACK_NOT_FOUND.message}]}}))}))}},t.signal={activateSEIInsert:function(e,t,r,i,o,n,a){this.logger.info(s.ZEGO_WEBRTC_ACTION.ACTIVATE_SEI_INSERT+" call "+t);var d={peer_id:r,action:i,info_type:o};this.sendMessageWithCallback("ActivateSEIInsertReq",e,t,d,n,a)}}},5098:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={NOT_LOGIN:{code:1000002,message:"not login room"},INPUT_PARAM:{code:1100001,message:"input param error."},PUBLISH_NOT_PUBLISH:{code:1103040,message:"publisher not found"},PUBLISH_NO_PREVIEW:{code:1103044,message:"stream is not from zego"},TRACK_NOT_FOUND:{code:1103047,message:"track is not found"},DEVICE_NOT_FOUND:{code:1103048,message:"device is not found"},PUBLISHER_CONSTRAINTS_ERROR:{code:1103029,message:"constraint error"},PUBLISHER_CDN_PUSH_ERROR:{code:1103052,message:"publisher cdn push error"},VIDEO_DEVICE_FALSE:{code:1103045,message:"video is false"},AUDIO_DEVICE_FALSE:{code:1103046,message:"audio is false"},UNKNOWN_SERVER_ERROR:{code:1100999,message:"unknown server error"},LOCALSTREAM_WRONG:{code:1000018,message:"local stream wrong"},PUBLISHER_STREAM_NO_FOUND:{code:1103055,message:"publish stream no found"},PUBLISH_TARGET_NO_RESPONSE:{code:1103063,message:"publish target no response"},BIZ_CHANNEL_ERROR:{code:1102021,message:"biz channel error."},INVALID_CHANNEL:{code:1102024,message:"invalid channel"},PUBLISHER_EXTRA_INFO_NULL:{code:1003050,message:"extra info of publishing stream is null"},PUBLISHER_UPDATE_STREAM_INFO_FAIL:{code:1103062,message:"update stream info fail"},TRACK_CAN_NOT_ADD:{code:1103063,message:"only stream which have one track and kind no exist can add track"},TRACK_CAN_NOT_REMOVE:{code:1103064,message:"stream which only has one track can not remove "},PUBLISHER_UPDATE_SDP_FAIL:{code:1103068,message:"update sdp fail"},PUBLISHER_STATE_WRONG:{code:1103069,message:"publisher state wrong"},HANDLE_TRACK_NOT_SUPPORTED:{code:1103070,message:"not support remove track"},VIDEO_EFFECT_IS_RUNNING:{code:1103071,message:"video effect processor is running"}}},3824:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(4495),o=r(4378);t.default={type:"Advance",install:function(e,t,r,n,s,a,d,c){for(var u in Object.defineProperty(t.prototype,"initAdvance",{value:function(){this.advancedModule=new i.AdvancedModule(this.logger,this.dataReport,this.streamCenter,this.stateCenter)},writable:!1}),o.zegoWebRTC)Object.defineProperty(e.prototype,u,{value:o.zegoWebRTC[u],writable:!1});for(var u in o.streamHandler)Object.defineProperty(r.prototype,u,{value:o.streamHandler[u],writable:!1});for(var u in o.preview)Object.defineProperty(n.prototype,u,{value:o.preview[u],writable:!1});for(var u in o.playModule)Object.defineProperty(s.prototype,u,{value:o.playModule[u],writable:!1});for(var u in o.publishModule)Object.defineProperty(a.prototype,u,{value:o.publishModule[u],writable:!1});for(var u in o.publisher)Object.defineProperty(d.prototype,u,{value:o.publisher[u],writable:!1});for(var u in o.signal)Object.defineProperty(c.prototype,u,{value:o.signal[u],writable:!1})}}},8706:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTCLogEvent=void 0;var i=r(5098),o=function(e){return e};t.ZegoRTCLogEvent={kZegoSetVideoConfig:{event:"/sdk/set_video_config",error:{kParamError:i.errorCodeList.INPUT_PARAM,kLocalStreamError:i.errorCodeList.LOCALSTREAM_WRONG}},kZegoSetAudioConfig:{event:"/sdk/set_audio_config",error:{kParamError:i.errorCodeList.INPUT_PARAM}},kZegoReplaceTrack:{event:"/sdk/replace_track",error:{kParamError:i.errorCodeList.INPUT_PARAM}},kZegoTaskUseVideoDevice:{event:"/device/api/video_c",error:{kParamError:i.errorCodeList.INPUT_PARAM,kDevicesNoFoundError:i.errorCodeList.DEVICE_NOT_FOUND,kLocalStreamError:i.errorCodeList.LOCALSTREAM_WRONG},device:o},kZegoTaskUseAudioDevice:{event:"/device/api/audio_c",error:{kParamError:i.errorCodeList.INPUT_PARAM,kDevicesNoFoundError:i.errorCodeList.DEVICE_NOT_FOUND,kLocalStreamError:i.errorCodeList.LOCALSTREAM_WRONG},device:o},kZegoTaskPublishTarget:{event:"/sdk/publish_target",error:{kParamError:i.errorCodeList.INPUT_PARAM,kPublishStreamNoFoundError:i.errorCodeList.PUBLISHER_STREAM_NO_FOUND,kNoLoginError:i.errorCodeList.NOT_LOGIN,kNoResponseError:i.errorCodeList.PUBLISH_TARGET_NO_RESPONSE,kBizChannelError:i.errorCodeList.BIZ_CHANNEL_ERROR,kInvalidChannelError:i.errorCodeList.INVALID_CHANNEL,kUnknownServerError:i.errorCodeList.UNKNOWN_SERVER_ERROR}},kZegoTaskAddPublishCdnUrl:{event:"/sdk/add_publish_cdn_url",error:{kParamError:i.errorCodeList.INPUT_PARAM}},kZegoTaskRemovePublishCdnUrl:{event:"/sdk/remove_publish_cdn_url",error:{kParamError:i.errorCodeList.INPUT_PARAM},stream:o,target_url:o},kZegoTaskClearPublishCdnUrl:{event:"/sdk/clear_publish_cdn_url",error:{kParamError:i.errorCodeList.INPUT_PARAM}},kZegoPlayContentChanged:{event:"/sdk/play_content_changed",session_id:o,video_activate:o,audio_activate:o},kZegoTaskMutePublishVideo:"/sdk/mute_publish_video",kZegoTaskMutePublishAudio:"/sdk/mute_publish_audio",kZegoTaskMuteMicrophone:"/sdk/mute_microphone",kZegoTaskMutePlayVideo:"/sdk/mute_play_video",kZegoTaskMutePlayAudio:"/sdk/mute_play_audio",kZegoTaskLiveRoomSendStreamExtraInfo:{event:"/liveroom/send_stream_extra_info",error:{kParamError:i.errorCodeList.INPUT_PARAM,kExtraInfoNullError:i.errorCodeList.PUBLISHER_EXTRA_INFO_NULL,kNoLoginError:i.errorCodeList.NOT_LOGIN,kPublishStreamNoFoundError:i.errorCodeList.PUBLISHER_STREAM_NO_FOUND,kUpdateStreamInfoFailError:i.errorCodeList.PUBLISHER_UPDATE_STREAM_INFO_FAIL},stream:o,stream_extra_info:o,room_sid:o}}},7248:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaUtil=void 0;var r=function(){function e(e,t){var r=this,i=t.type,o=t.channels,n=void 0===o?1:o,s=t.bufferSize,a=void 0===s?0:s,d=t.sampleBit,c=void 0===d?16:d,u=t.sampleRate,l=void 0===u?44100:u;this.instant=0,this.slow=0,this.clip=0,this.context=e,this.type=i,this.channels=n,this.bufferSize=a,this.sampleBit=c,this.sampleRate=l,this.script=e.createScriptProcessor(a,n,n),(new Date).getTime(),this.script.addEventListener("audioprocess",(function(e){var t,o=e.inputBuffer.getChannelData(0),n=0,s=0;for(t=0;t<o.length;++t)n+=o[t]*o[t],Math.abs(o[t])>.99&&(s+=1);if(r.instant=Math.sqrt(n/o.length),r.slow=.95*r.slow+.05*r.instant,r.clip=s/o.length,"pcm"===i||"wav"===i){for(var a=[],d=0;d<r.channels;d++)a.push(e.inputBuffer.getChannelData(d));r.recorderBuffer(a)}})),"pcm"!==i&&"wav"!==i||this.initRecorderBuffer(i)}return e.prototype.connectToSource=function(e,t){try{this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination),void 0!==t&&t(null)}catch(e){console.error(e),void 0!==t&&t(e)}return this},e.prototype.recorderBuffer=function(e){this.worker.postMessage({command:"record",val:e})},e.prototype.initRecorderBuffer=function(e){var t=this;this.worker=this.inlineWorker((function(){var e,t,r,i,o,n,s=[];function a(e,t,r){for(var i=0;i<r.length;i++,t+=2){var o=Math.max(-1,Math.min(1,r[i]));e.setInt16(t,o<0?32768*o:32767*o,!0)}}function d(e,t,r){for(var i=0;i<r.length;i++,t++){var o=Math.max(-1,Math.min(1,r[i])),n=o<0?128*o:127*o;n+=128,e.setInt8(t,n)}}function c(e,t,r){for(var i=0;i<r.length;i++)e.setUint8(t+i,r.charCodeAt(i))}function u(e,t){for(var r=new Float32Array(t.length/e),i=0,o=0;i<r.length;)r[i]=t[o],o+=e,i++;return r}function l(e,t,r){for(var i=new Float32Array(t*e.length),o=0,n=0;n<r[0].length;n++)i.set(r[0][n],o),o+=r[0][n].length;return i}function h(e,t){for(var r=new Float32Array(e.length+t.length),i=0;i<e.length+t.length;i+=2)r[i]=e[i/2>>0],r[i+1]=t[i/2>>0];return r}function p(t){var r,i;if(1==e)r=l(s[0],o,s),1!=t&&(i=u(t,r));else if(2==e){var n=l(s[0],o,s),a=l(s[1],o,s);1!=t?i=h(u(t,n),u(t,a)):r=h(n,a)}return 1!=t?i:r}this.onmessage=function(u){switch(u.data.command){case"init":l=u.data.val,e=l.sampleChannel,t=l.sampleBit,r=l.sampleRate,i=l.oldSampleRate,o=l.bufferSize,n=l.type;break;case"record":!function(o){for(var u=0;u<e;u++)s[u]||(s[u]=[]),s[u].push(o[u]);var l=Math.round(i/r);"pcm"===n?function(e){var r=function(e,r){var i;8==r?i=e.length:16==r&&(i=e.length,i*=2);var o=new ArrayBuffer(i),n=new DataView(o);return 8==r?d(n,0,e):16==t&&a(n,0,e),n}(p(e),t);self.postMessage({command:"exportPcmLive",val:r})}(l):"wav"===n&&function(i){var o=function(i,o){var n;8==o?n=i.length:16==t&&(n=i.length,n*=2);var s=new ArrayBuffer(n+44),u=new DataView(s),l=r,h=t,p=e;return c(u,0,"RIFF"),u.setUint32(4,36+n,!0),c(u,8,"WAVE"),c(u,12,"fmt "),u.setUint32(16,16,!0),u.setUint16(20,1,!0),u.setUint16(22,p,!0),u.setUint32(24,l,!0),u.setUint32(28,l*p*(h/8),!0),u.setUint16(32,p*(h/8),!0),u.setUint16(34,h,!0),c(u,36,"data"),u.setUint32(40,n,!0),8==t?d(u,44,i):16==t&&a(u,44,i),u}(p(i),t);self.postMessage({command:"exportWav",val:o})}(l),s=[]}(u.data.val)}var l}})),this.worker.postMessage({command:"init",val:{sampleChannel:this.channels,sampleBit:this.sampleBit,sampleRate:this.sampleRate,oldSampleRate:this.context.sampleRate,bufferSize:this.bufferSize,type:e}}),this.worker.onmessage=function(e){switch(e.data.command){case"exportPcmLive":t.onReceiveBuffer(e.data.val);break;case"exportWav":t.onReceiveWav(e.data.val)}}},e.prototype.onReceiveBuffer=function(e){},e.prototype.onReceiveWav=function(e){},e.prototype.writeString=function(e,t,r){for(var i=0;i<r.length;i++)e.setUint8(t+i,r.charCodeAt(i))},e.prototype.writeBuffer=function(e,t,r){for(var i=0;i<r.byteLength;i++)e.setUint8(t+i,r[i])},e.prototype.concatenation=function(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].buffer.byteLength;var i=new Uint8Array(t),o=0;for(r=0;r<e.length;++r)i.set(new Uint8Array(e[r].buffer),o),o+=e[r].buffer.byteLength;return i},e.prototype.encodeWave=function(e){var t=this.concatenation(e),r=t.byteLength,i=new ArrayBuffer(r+44),o=new DataView(i),n=this.sampleRate,s=this.sampleBit,a=this.channels;return this.writeString(o,0,"RIFF"),o.setUint32(4,36+r,!0),this.writeString(o,8,"WAVE"),this.writeString(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,a,!0),o.setUint32(24,n,!0),o.setUint32(28,n*a*(s/8),!0),o.setUint16(32,a*(s/8),!0),o.setUint16(34,s,!0),this.writeString(o,36,"data"),o.setUint32(40,r,!0),this.writeBuffer(o,44,t),o},e.prototype.stop=function(){this.mic.disconnect(),this.script.disconnect()},e.prototype.inlineWorker=function(e){if(Worker&&e){var t=e.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1],r=URL.createObjectURL(new window.Blob([t],{type:"text/javascript"}));return new Worker(r)}return null},e}();t.MediaUtil=r},2523:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_WEBRTC_ACTION=void 0,(r=t.ZEGO_WEBRTC_ACTION||(t.ZEGO_WEBRTC_ACTION={})).PRELOAD_EFFECT="zc.pe.0",r.PLAY_EFFECT="zc.pe.1",r.PAUSE_EFFECT="zc.pe.2",r.RESUME_EFFECT="zc.re",r.STOP_EFFECT="zc.se",r.UNLOAD_EFFECT="zc.ue",r.AUDIO_EFFECT_PROCESS="zc.aep",r.SET_EFFECT_VOLUME="zc.sev",r.START_MIXING_AUDIO="zc.sma.0",r.STOP_MIXING_AUDIO="zc.sma.1",r.MIXING_BUFFER="zc.mb",r.STOP_MIXING_BUFFER="zc.smb",r.PUBLISHER_PLAY_EFFECT="zc.p.0.pe.0",r.PUBLISHER_PAUSE_EFFECT="zc.p.0.pe.1",r.PUBLISHER_RESUME_EFFECT="zc.p.0.re",r.PUBLISHER_STOP_EFFECT="zc.p.0.se",r.PUBLISHER_START_MIXING_AUDIO="zc.p.0.sma.0",r.PUBLISHER_STOP_MIXING_AUDIO="zc.p.0.sma.1",r.SET_MIXING_AUDIO_VOLUME="zc.smav",r.PUBLISHER_MIXING_BUFFER="zc.p.0.mb",r.PUBLISHER_SET_MIXING_AUDIO_VOLUME="zc.p.0.smav"},3013:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioBufferProcessor=void 0;var i=r(4853),o=function(){function e(e,t,r){this.logger=e,this.ac=t,this.localStream=r,this.audioBufferList=[],this.replace=!1,this.effectEndedCallBack=null,this.effectEndedListener=null,this.startTimes=0,this.startOffset=0,this.pauseTimes=0,this.resumeOffset=0,this.paused=!1,this.isMixAudio=!1,this.isMixingBuffer=!1,this.loop=!1}return e.prototype.playEffect=function(e,t,r,i,o){var n=this;!0!==this.isMixAudio?this.audioBuffer?(this.startOffset=e||0,this.loop=t||!1,this.replace=r||!1,this.effectEndedCallBack=o,this.mixEffect(this.audioBuffer,(function(){n.buffSource.loop=!!t,e?n.buffSource.start(0,e/1e3):n.buffSource.start(0),n.startTimes=Date.now(),n.effectEndedListener=n.effectEndedHandler.bind(n),n.buffSource.addEventListener("ended",n.effectEndedListener),i&&i()}))):this.logger.error("amu.pe.1 no audio buffer found"):this.logger.warn("amu.pe.1 audio is mixing")},e.prototype.stopMixingBuffer=function(){return this.isMixingBuffer=!1,this.stopMixingAudio()},e.prototype.playRealTimeEffect=function(e){var t=this;this.mixEffect(e,(function(){t.buffSource&&t.buffSource.start(0),t.buffSource&&t.buffSource.addEventListener("ended",(function(){t.audioBufferList.shift(),t.audioBufferList.length>0&&t.isMixAudio&&t.playRealTimeEffect(t.audioBufferList[0])}))}))},e.prototype.pauseEffect=function(){this.audioBufferList.length>0?this.logger.error("amu.pe.0 real time buffer can not be paused"):(this.stopMixingAudio(!0),this.resumeOffset=(this.pauseTimes-this.startTimes+this.startOffset)%(1e3*this.audioBuffer.duration),this.paused=!0)},e.prototype.resumeEffect=function(){this.audioBufferList.length>0?this.logger.error("amu.pe.0 real time buffer can not be resume"):(this.playEffect(this.resumeOffset,this.loop,this.replace,void 0,this.effectEndedCallBack),this.startOffset=this.resumeOffset,this.paused=!1)},e.prototype.mixEffect=function(e,t){this.localStream?(this.ac.resume(),this.gainNode=this.ac.createGain(),this.buffSource=this.ac.createBufferSource(),this.buffSource.buffer=e,this.buffSource.connect(this.gainNode),this.gainNode.connect(this.ac.destination),this.replaceTrack()&&t()):this.logger.error("amu.me.0 localStream can not be found")},e.prototype.replaceTrack=function(){if(!this.destination||!this.streamSource)return!1;!this.replace&&this.streamSource.connect(this.destination),this.gainNode.connect(this.destination);var e=this.destination.stream.getAudioTracks()[0];return this.micTrack=this.localStream.getAudioTracks()[0],this.localStream.removeTrack(this.micTrack),this.localStream.addTrack(e),this.isMixAudio=!0,!0},e.prototype.effectEndedHandler=function(){this.stopMixingAudio(),this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null},e.prototype.stopMixingAudio=function(e){return void 0===e&&(e=!1),this.paused?(this.logger.info("amu.sma.1 audioEffect is paused"),!e&&this.effectEndedListener&&(this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null),!0):this.isMixAudio?this.localStream?(this.buffSource&&(this.buffSource.removeEventListener("ended",this.effectEndedListener),this.buffSource.stop(),this.pauseTimes=Date.now(),this.buffSource.disconnect(this.gainNode),this.buffSource=null),this.gainNode.disconnect(this.destination),this.gainNode.disconnect(this.ac.destination),this.isMixAudio=!1,this.audioBufferList=[],!e&&this.effectEndedListener&&(this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null),!0):(this.logger.error("amu.sma.1 localStream can not be found"),!1):(this.logger.warn("amu.sma.1 no mixing audio found"),!0)},e.prototype.getProcess=function(){var e=Date.now();return this.paused&&(e=this.pauseTimes),(e-this.startTimes+this.startOffset)%(1e3*this.audioBuffer.duration)},e.prototype.seekTo=function(e){void 0===e&&(e=0),this.startOffset=e,this.paused?this.resumeOffset=e:(this.stopMixingAudio(!0),this.playEffect(e,this.loop,this.replace,void 0,this.effectEndedCallBack))},e.prototype.mixingBuffer=function(e,t){var r=this;!0!==this.isMixAudio||0!=this.audioBufferList.length||0!=this.isMixingBuffer?(this.ac.resume(),this.ac.decodeAudioData(e,(function(e){r.audioBufferList.push(e),1==r.audioBufferList.length&&r.playRealTimeEffect(r.audioBufferList[0]),r.isMixingBuffer=!0,t&&t()}),(function(e){r.logger.error("amu.mb.0 "+e),t&&t({code:i.errorCodeList.PUBLISHER_DECODE_AUDIO_FAIL.code,message:i.errorCodeList.PUBLISHER_DECODE_AUDIO_FAIL.message+" "+e})}))):this.logger.error("amu.mb.0 audio is mixing")},e}();t.AudioBufferProcessor=o},4194:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AudioMix=void 0;var r=function(){function e(e,t,r,i,o){this.logger=e,this.ac=t,this.localStream=r,this.mediaEleSources=i,this.browser=o,this.replace=!1,this.isMixAudio=!1,this.audioCurrentTimer=null,this.audioResumedTimer=null}return e.prototype.startMixingAudio=function(e,t){if(this.replace=t||!1,this.isMixAudio)return this.logger.error("amu.sma.0 audio is mixing"),!1;if(!this.localStream)return this.logger.error("amu.sma.0 localStream can not be found"),!1;if(e.captureStream=e.captureStream||e.mozCaptureStream||e.webkitCaptureStream,this.ac.resume(),this.gainNode=this.ac.createGain(),"safari"===this.browser){var r=this.mediaEleSources.find((function(t){return t.audio===e}));if(r)this.audioNode=r.node;else{var i=this.ac.createMediaElementSource(e);this.audioNode=i,this.mediaEleSources.push({audio:e,node:i})}var o=this.getBrowserInfo(),n=!1;"10.15.6"===(null==o?void 0:o.sysVer)&&"13.1.2"===(null==o?void 0:o.ver)&&(n=!0),n&&(this.audioResumedTimer=setInterval((function(){e.currentTime=e.currentTime+.45}),6e4))}else this.audioNode=this.ac.createMediaStreamSource(e.captureStream());return this.audioNode.connect(this.gainNode),this.replaceTrack()},e.prototype.getBrowserInfo=function(){var e,t={},r=navigator.userAgent.toLowerCase();e=(r.match(/x [\d._]+/gi)+"").replace(/[^0-9|_.]/gi,"").replace(/_/gi,"."),t.sysVer=e;var i=r.match(/(msie|firefox|chrome|opera|version).*?([\d.]+)/);return i&&(t.browser=i[1].replace(/version/,"'safari"),t.ver=i[2]),t},e.prototype.replaceTrack=function(){if(!this.destination||!this.streamSource)return!1;!this.replace&&this.streamSource.connect(this.destination),this.gainNode.connect(this.destination);var e=this.destination.stream.getAudioTracks()[0];return this.micTrack=this.localStream.getAudioTracks()[0],this.localStream.removeTrack(this.micTrack),this.localStream.addTrack(e),this.isMixAudio=!0,!0},e.prototype.stopMixingAudio=function(){return this.isMixAudio?this.localStream?(this.audioNode&&(this.audioNode.disconnect(this.gainNode),this.audioNode=null,this.audioCurrentTimer&&(clearInterval(this.audioCurrentTimer),this.audioCurrentTimer=null),this.audioResumedTimer&&(clearInterval(this.audioResumedTimer),this.audioResumedTimer=null)),this.gainNode.disconnect(this.destination),this.isMixAudio=!1,!0):(this.logger.error("amu.sma.1 localStream can not be found"),!1):(this.logger.warn("amu.sma.1 no mixing audio found"),!0)},e.prototype.setMixingAudioVolume=function(e){return this.gainNode?(this.gainNode.gain.value=e,!0):(this.logger.error("amu.sma.2 no mixing audio found"),!1)},e}();t.AudioMix=r},6459:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AudioMixModule=void 0;var n=r(2523),s=r(4234),a=r(6447),d=function(){function e(e,t,r,i,o){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=i,this.ac=o,this.buffer=null,this.blank=null,"safari"==this.stateCenter.browser&&null==this.blank&&null==this.buffer&&(this.ac.resume(),this.buffer=this.ac.createBuffer(1,1,this.ac.sampleRate),this.blank=this.ac.createBufferSource(),this.blank.buffer=this.buffer,this.blank.connect(this.ac.destination),this.blank.start())}return e.prototype.preloadEffect=function(e,t,r){if(this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.PRELOAD_EFFECT,{effectID:e},{effectID:!0}))if(t&&"string"==typeof t){if(this.stateCenter.audioEffectBuffer[e])return this.logger.warn(n.ZEGO_WEBRTC_ACTION.PRELOAD_EFFECT+" audio buffer already exists"),void(r&&r());this.logger.info(n.ZEGO_WEBRTC_ACTION.PRELOAD_EFFECT+" start preload effect"),this._preloadEffect(this.ac,e,t,r)}else this.logger.error(n.ZEGO_WEBRTC_ACTION.PRELOAD_EFFECT+" params error")},e.prototype.checkPreviewer=function(e,t,r){void 0===t&&(t={});var i=!!(null==r?void 0:r.effectID),o=!!(null==r?void 0:r.streamID),n=!!(null==r?void 0:r.previewer),s=t.effectID,a=t.streamID;return!o&&!a||"string"==typeof a||a instanceof MediaStream?i&&!s?(this.logger.error(e+" effectID required"),!1):s&&"string"!=typeof s?(this.logger.error(e+" effectID type error"),!1):!n||(this.streamCenter.getPreviewer(a)||("string"==typeof a?this.logger.error(e+" "+a+" stream is not publishing"):this.logger.error(e+" stream doesn't exist"),!1)):(this.logger.error(e+" stream type error"),!1)},e.prototype.getEffectDuration=function(e){if(!this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS,{effectID:e},{effectID:!0}))return 0;var t=this.stateCenter.audioEffectBuffer[e];return t?t.duration?Math.floor(1e3*t.duration):0:(this.logger.error(n.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS+" effect not found"),0)},e.prototype.getEffectProgress=function(e,t){var r=this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS,{streamID:e,effectID:t},{effectID:!0,streamID:!0,previewer:!0});return"boolean"==typeof r?0:this.getAudioManager(r).getEffectProgress(t)},e.prototype.seekAudioEffect=function(e,t,r){if(r<0)return this.logger.error(n.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS+"param time error "),!1;var i=this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS,{streamID:e,effectID:t},{effectID:!0,streamID:!0,previewer:!0});return"boolean"!=typeof i&&this.getAudioManager(i).seekAudioEffect(t,r)},e.prototype.playEffect=function(e,t,r){return i(this,void 0,void 0,(function(){var i,s,a,d,c=this;return o(this,(function(o){switch(o.label){case 0:return i=e.stream||e.streamID,s=e.path,a=e.effectID,this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.PLAY_EFFECT,{streamID:i,effectID:a},{streamID:!0,effectID:!0})?(d=this.stateCenter.audioEffectBuffer[a],s?d?(this.logger.warn(n.ZEGO_WEBRTC_ACTION.PLAY_EFFECT+" audio effect already exists"),[3,3]):[3,1]:[3,4]):[2];case 1:return[4,new Promise((function(e,t){c.preloadEffect(a,s,(function(r){r?(c.logger.error(n.ZEGO_WEBRTC_ACTION.PLAY_EFFECT+" preload audio effect failed"),t(r)):e(void 0)}))}))];case 2:o.sent(),o.label=3;case 3:return[3,5];case 4:if(!d)return this.logger.error(n.ZEGO_WEBRTC_ACTION.PLAY_EFFECT+" audio effect doesn't exists"),[2];o.label=5;case 5:return this._playEffect(e,t,r),[2]}}))}))},e.prototype.pauseEffect=function(e,t){return this._pauseEffect(e,t)},e.prototype.resumeEffect=function(e,t){return this._resumeEffect(e,t)},e.prototype.stopEffect=function(e,t){return this._stopEffect(e,t)},e.prototype.unloadEffect=function(e){return!!this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.UNLOAD_EFFECT,{effectID:e},{effectID:!0})&&(delete this.stateCenter.audioEffectBuffer[e],!0)},e.prototype.setEffectVolume=function(e,t,r){if("number"!=typeof t||t<0||t>200)return this.logger.error(n.ZEGO_WEBRTC_ACTION.SET_EFFECT_VOLUME+" volume must be a number between 0 and 200"),!1;var i=this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.SET_EFFECT_VOLUME,{streamID:e,effectID:r},{streamID:!0,previewer:!0});return"boolean"!=typeof i&&this.getAudioManager(i).setEffectVolume(t/100,r)},e.prototype.startMixingAudio=function(e,t){return this.logger.info(n.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" call "+e),e?t?(this.logger.info(n.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" end "+e),Array.isArray(t)&&0!==t.length&&t.every((function(e){return e instanceof HTMLMediaElement}))?this._startMixingAudio(e,t):(this.logger.error(n.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" audio list param type error"),!1)):(this.logger.error(n.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" no audio"),!1):(this.logger.error(n.ZEGO_WEBRTC_ACTION.START_MIXING_AUDIO+" stream not found"),!1)},e.prototype.stopMixingAudio=function(e,t){return e?Array.isArray(t)&&0!==t.length||void 0===t?this._stopMixingAudio(e,t):(this.logger.error(n.ZEGO_WEBRTC_ACTION.STOP_MIXING_AUDIO+" audio param type error"),!1):(this.logger.error(n.ZEGO_WEBRTC_ACTION.STOP_MIXING_AUDIO+" stream not found"),!1)},e.prototype.mixingBuffer=function(e,t,r,i){this.logger.info(n.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" call streamID: "+JSON.stringify(e)+" sourceID:"+t),e?t&&"string"==typeof t?(this._mixingBuffer(e,t,r,i),this.logger.info(n.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" end")):this.logger.error(n.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" param source id format error"):this.logger.error(n.ZEGO_WEBRTC_ACTION.MIXING_BUFFER+" param streamid format error")},e.prototype.stopMixingBuffer=function(e,t){return this._stopMixingBuffer(e,t)},e.prototype.setMixingAudioVolume=function(e,t,r){return this.logger.info(n.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" call"),e?"number"!=typeof t||t<0||t>200?(this.logger.error(n.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" volume must be a number between 0 and 200"),!1):r&&r instanceof HTMLMediaElement?this._setMixingAudioVolume(e,t,r):(this.logger.error(n.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" no audio"),!1):(this.logger.error(n.ZEGO_WEBRTC_ACTION.SET_MIXING_AUDIO_VOLUME+" stream not found"),!1)},e.prototype.getSoundLevel=function(e,t,r){this.logger.info("zc.gsl call");var i=this.stateCenter.getReportSeq();this.dataReport.newReport(i,s.ZegoRTCLogEvent.kZegoTaskGetSoundLevel.event);try{this.ac.resume();var o=this.ac.createMediaStreamSource(e),n=this.ac.createScriptProcessor(4096,1,1);this.stateCenter.audioStreamList[e.id]={mic:o,script:n},o.connect(n),n.connect(this.ac.destination),n.onaudioprocess=function(e){for(var r=e.inputBuffer.getChannelData(0),i=0,o=0;o<r.length;o++)i<r[o]&&(i=r[o]);t(i)},this.dataReport.uploadReport(i)}catch(e){r(e),this.dataReport.addMsgInfo(i,s.ZegoRTCLogEvent.kZegoTaskGetSoundLevel.error.kGetSoundLevelError),this.dataReport.uploadReport(i)}this.logger.info("zc.gsl call success")},e.prototype.stopSoundLevel=function(e){this.logger.info("zc.ssl call");var t=this.stateCenter.getReportSeq();this.dataReport.newReport(t,s.ZegoRTCLogEvent.kZegoTaskStopSoundLevel);var r=this.stateCenter.audioStreamList[e.id];r.mic.disconnect(),r.script.disconnect(),delete this.stateCenter.audioStreamList[e.id],this.dataReport.uploadReport(t)},e.prototype._preloadEffect=function(e,t,r,i){var o=this,n=new XMLHttpRequest;n.open("GET",r,!0),n.setRequestHeader("Range","none"),n.responseType="arraybuffer",n.onload=function(){if(200==n.status||304==n.status){var r=n.response;e.decodeAudioData(r,(function(e){o.logger.info("zc.pe.0 effect preload success"),o.stateCenter.audioEffectBuffer[t]=e,i&&i()}),(function(e){o.logger.error("zc.pe.0 effect preload fail "+e),i&&i(e)}))}else{var s=n.statusText;o.logger.error("zc.pe.0 effect preload fail "+s),i&&i(s)}},n.send()},e.prototype._playEffect=function(e,t,r){var i=e.stream||e.streamID,o=e.effectID,s=this.stateCenter.audioEffectBuffer[e.effectID];if(s){var a=this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.PLAY_EFFECT,{streamID:i,effectID:o},{streamID:!0,effectID:!0,previewer:!0});"boolean"!=typeof a&&this.getAudioManager(a).playEffect(e,s,t,r)}else this.logger.error(n.ZEGO_WEBRTC_ACTION.PLAY_EFFECT+" no audio buffer found")},e.prototype._pauseEffect=function(e,t){var r=this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.PAUSE_EFFECT,{streamID:e,effectID:t},{streamID:!0,previewer:!0});return"boolean"!=typeof r&&this.getAudioManager(r).pauseEffect(t)},e.prototype._resumeEffect=function(e,t){var r=this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.RESUME_EFFECT,{streamID:e,effectID:t},{streamID:!0,previewer:!0});return"boolean"!=typeof r&&this.getAudioManager(r).resumeEffect(t)},e.prototype._stopEffect=function(e,t){var r=this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.STOP_EFFECT,{streamID:e,effectID:t},{streamID:!0,previewer:!0});return"boolean"!=typeof r&&this.getAudioManager(r).stopEffect(t)},e.prototype._setMixingAudioVolume=function(e,t,r){var i=this.streamCenter.getPreviewer(e);return i?this.getAudioManager(i).setMixingAudioVolume(t/100,r):(this.logger.error("zc.sma.2 publisher doesn't exist"),!1)},e.prototype._startMixingAudio=function(e,t){var r=this.streamCenter.getPreviewer(e);return r?this.getAudioManager(r).startMixingAudio(t):("string"==typeof e?this.logger.error("zc.sma.0 "+e+" stream is not publishing"):this.logger.error("zc.sma.0 stream doesn't exist"),!1)},e.prototype._stopMixingAudio=function(e,t){var r=this.streamCenter.getPreviewer(e);return r?this.getAudioManager(r).stopMixingAudio(t):(this.logger.error("zc.sma.0 stream doesn't exist"),!1)},e.prototype._mixingBuffer=function(e,t,r,i){var o=this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.STOP_MIXING_BUFFER,{streamID:e,effectID:t},{effectID:!0,streamID:!0,previewer:!0});"boolean"!=typeof o&&(r instanceof ArrayBuffer?this.getAudioManager(o).mixingBuffer(t,r,i):this.logger.error("zc.mb.0 array buffer not found"))},e.prototype._stopMixingBuffer=function(e,t){var r=this.checkPreviewer(n.ZEGO_WEBRTC_ACTION.STOP_MIXING_BUFFER,{streamID:e,effectID:t},{effectID:!0,streamID:!0,previewer:!0});return"boolean"!=typeof r&&this.getAudioManager(r).stopMixingBuffer(t)},e.prototype.getAudioManager=function(e){var t=e.audioMixManager;return t||(t=new a.PreviewAudioManager(e),e.audioMixManager=t),t},e}();t.AudioMixModule=d},4853:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={GET_SOUND_LEVEL_FAIL:{code:1000019,message:"get sound level error"},PUBLISHER_DECODE_AUDIO_FAIL:{code:1103057,message:"decode audio data fail"}}},7526:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(6459);t.default={type:"AudioMix",install:function(e){Object.defineProperty(e.prototype,"initAudioMix",{value:function(){this.audioMixModule=new i.AudioMixModule(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.ac)}})}}},4234:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTCLogEvent=void 0;var i=r(4853);t.ZegoRTCLogEvent={kZegoTaskGetSoundLevel:{event:"/sdk/get_sound_level",error:{kGetSoundLevelError:i.errorCodeList.GET_SOUND_LEVEL_FAIL}},kZegoTaskStopSoundLevel:"/sdk/stop_sound_level"}},6447:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewAudioManager=void 0;var i=r(2523),o=r(3013),n=r(4194),s=function(){function e(e){this.previewer=e,this.audioSrcNode=void 0,this.audioDestNode=void 0,this.audioMixList=[],this.arrayBufferMap={},this.effectList=[],this.mediaEleSources=e.streamCenter.mediaEleSources}return Object.defineProperty(e.prototype,"logger",{get:function(){return this.previewer.logger},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localStream",{get:function(){return this.previewer.localStream},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"streamCenter",{get:function(){return this.previewer.streamCenter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ac",{get:function(){return this.previewer.ac},enumerable:!1,configurable:!0}),e.prototype.startMixingAudio=function(e){var t=this;return this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_START_MIXING_AUDIO+" call"),this.localStream?(e.forEach((function(e){var r;if(t.audioMixList.find((function(t){return t.media==e})))t.logger.warn(i.ZEGO_WEBRTC_ACTION.PUBLISHER_START_MIXING_AUDIO+" mix audio already exist");else if(t.localStream){t.streamCenter.soundLevelDelegate&&t.previewer.stopSoundLevel();var o=new n.AudioMix(t.logger,t.ac,t.localStream,t.mediaEleSources,t.previewer.stateCenter.browser);t.audioSrcNode||(t.audioSrcNode=t.ac.createMediaStreamSource(t.localStream));var s=!1;t.audioDestNode||(t.audioDestNode=t.ac.createMediaStreamDestination(),s=!0),o.destination=t.audioDestNode,o.streamSource=t.audioSrcNode,t.audioMixList.push({audioMix:o,media:e}),o.startMixingAudio(e),s&&(null===(r=t.audioDestNode)||void 0===r?void 0:r.stream)&&t.previewer.onAudioTrackChange(t.audioDestNode.stream.getAudioTracks()[0]),t.streamCenter.soundLevelDelegate&&t.previewer.startSoundLevel()}})),!0):(this.logger.error(i.ZEGO_WEBRTC_ACTION.PUBLISHER_START_MIXING_AUDIO+" localStream not found"),!1)},e.prototype.stopMixingAudio=function(e){var t=this;return this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_MIXING_AUDIO+" call"),e?e.forEach((function(e){for(var r=0;r<t.audioMixList.length;r++)if(t.audioMixList[r].media==e){t.audioMixList[r].audioMix.stopMixingAudio()&&t.audioMixList.splice(r--,1);break}})):(this.audioMixList.forEach((function(e){return e.audioMix.stopMixingAudio()})),this.audioMixList=[]),!0},e.prototype.setMixingAudioVolume=function(e,t){this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_MIXING_AUDIO_VOLUME+" call");var r=this.audioMixList.find((function(e){return e.media===t}));return r?(r.audioMix.setMixingAudioVolume(e),this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_MIXING_AUDIO_VOLUME+" call success"),!0):(this.logger.error(i.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_MIXING_AUDIO_VOLUME+" audio is not mixing"),!1)},e.prototype.playEffect=function(e,t,r,n){var s=this;if(this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_PLAY_EFFECT+" call"),this.localStream)if(this.effectList.find((function(r){return r.effectID==e.effectID&&r.audioBuffer==t})))this.logger.warn(i.ZEGO_WEBRTC_ACTION.PUBLISHER_PLAY_EFFECT+" effect already exist ");else{this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel();var a=new o.AudioBufferProcessor(this.logger,this.ac,this.localStream);this.audioSrcNode||(this.audioSrcNode=this.ac.createMediaStreamSource(this.localStream));var d=!1;this.audioDestNode||(this.audioDestNode=this.ac.createMediaStreamDestination(),d=!0),a.destination=this.audioDestNode,a.streamSource=this.audioSrcNode,a.audioBuffer=t;var c={processor:a,effectID:e.effectID,audioBuffer:t};this.effectList.push(c),a.playEffect(e.playTime,e.loop,!1,(function(){var e;d&&(null===(e=s.audioDestNode)||void 0===e?void 0:e.stream)&&s.previewer.onAudioTrackChange(s.audioDestNode.stream.getAudioTracks()[0]),r&&r()}),(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];s.effectList.splice(s.effectList.indexOf(c),1),n&&n.apply(void 0,e)})),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_PLAY_EFFECT+" play effect "+e.effectID+" success")}else this.logger.warn(i.ZEGO_WEBRTC_ACTION.PUBLISHER_PLAY_EFFECT+" stream not found")},e.prototype.pauseEffect=function(e){var t=this.effectList.find((function(t){return t.effectID==e}));if(t)this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),t.processor.pauseEffect(),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_PAUSE_EFFECT+" pause "+e+" success");else{if(void 0!==e)return this.logger.error(i.ZEGO_WEBRTC_ACTION.PUBLISHER_PAUSE_EFFECT+" effect not found"),!1;this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.effectList.forEach((function(e){return e.processor.pauseEffect()})),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel()}return!0},e.prototype.resumeEffect=function(e){var t=this.effectList.find((function(t){return t.effectID==e}));if(t)this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),t.processor.resumeEffect(),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_RESUME_EFFECT+" resume"+e+" success");else{if(void 0!==e)return this.logger.error(i.ZEGO_WEBRTC_ACTION.PUBLISHER_RESUME_EFFECT+" no effect found"),!1;this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.effectList.forEach((function(e){return e.processor.resumeEffect()})),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel()}return!1},e.prototype.stopEffect=function(e){var t=this.effectList.find((function(t){return t.effectID==e}));if(t)this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),t.processor.stopMixingAudio(),this.effectList.splice(this.effectList.indexOf(t),1),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_EFFECT+" pause "+e+" success");else{if(void 0!==e)return this.logger.error(i.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_EFFECT+" effect not found"),!1;this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.effectList.forEach((function(e){return e.processor.stopMixingAudio()})),this.effectList=[],this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel()}return!0},e.prototype.setEffectVolume=function(e,t){var r=this.effectList.find((function(e){return e.effectID==t}));if(r)r.processor.setMixingAudioVolume(e),this.logger.info("zp.sev.0 set volume "+t+" success");else{if(void 0!==t)return this.logger.error("zp.sev.0 effect not found"),!1;this.effectList.forEach((function(t){return t.processor.setMixingAudioVolume(e)}))}return!0},e.prototype.mixingBuffer=function(e,t,r){var n=this;if(this.logger.info(i.ZEGO_WEBRTC_ACTION.PUBLISHER_MIXING_BUFFER+" call"),this.localStream)if(this.arrayBufferMap[e])this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.arrayBufferMap[e].mixingBuffer(t,(function(){n.streamCenter.soundLevelDelegate&&n.previewer.startSoundLevel(),r&&r()}));else{this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel();var s=new o.AudioBufferProcessor(this.logger,this.ac,this.localStream);this.audioSrcNode||(this.audioSrcNode=this.ac.createMediaStreamSource(this.localStream));var a=!1;this.audioDestNode||(this.audioDestNode=this.ac.createMediaStreamDestination(),a=!0),s.destination=this.audioDestNode,s.streamSource=this.audioSrcNode,this.arrayBufferMap[e]=s,s.mixingBuffer(t,(function(){var e;n.streamCenter.soundLevelDelegate&&n.previewer.startSoundLevel(),a&&(null===(e=n.audioDestNode)||void 0===e?void 0:e.stream)&&n.previewer.onAudioTrackChange(n.audioDestNode.stream.getAudioTracks()[0]),r&&r()}))}},e.prototype.stopMixingBuffer=function(e){if(e&&this.arrayBufferMap[e])return this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.arrayBufferMap[e].stopMixingBuffer(),delete this.arrayBufferMap[e],this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),!0;if(void 0===e){for(var t in this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),this.arrayBufferMap)this.arrayBufferMap[t].stopMixingBuffer();return this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),!0}return this.logger.warn(i.ZEGO_WEBRTC_ACTION.PUBLISHER_MIXING_BUFFER+" arrayBuffer no found"),!1},e.prototype.getEffectProgress=function(e){var t=this.effectList.find((function(t){return t.effectID==e}));return t?t.processor.getProcess():(this.logger.error(i.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS+"  effect not found"),0)},e.prototype.seekAudioEffect=function(e,t){var r=this.effectList.find((function(t){return t.effectID==e}));return r?(this.streamCenter.soundLevelDelegate&&this.previewer.stopSoundLevel(),r.processor.seekTo(t),this.streamCenter.soundLevelDelegate&&this.previewer.startSoundLevel(),!0):(this.logger.error(i.ZEGO_WEBRTC_ACTION.AUDIO_EFFECT_PROCESS+" effect not found"),!1)},e.prototype.stopAudioManager=function(){this.stopMixingAudio(),this.stopMixingBuffer(),this.stopEffect()},e}();t.PreviewAudioManager=s},4897:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataChannel=void 0;var i=r(8835);t.DataChannel={type:"DataChannel",install:function(e){Object.defineProperty(e.prototype,"createRealTimeSequentialDataManager",{value:function(e){this.enableDataChannel(!0);var t=this.stateCenter.getRoomByRoomID(e);return t?t.dataChannelManager?null:(t.dataChannelManager=new i.ZegoRealTimeSequentialDataManager(this,e),t.dataChannelManager):(this.logger.error("zc.crsdm room no exist"),null)},writable:!1}),Object.defineProperty(e.prototype,"destroyRealTimeSequentialDataManager",{value:function(e){var t=this.stateCenter.roomList.find((function(t){return t.dataChannelManager==e}));t&&(e.dataChannelManager.reset(),t.dataChannelManager=null)},writable:!1})}}},3504:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.DataChannelListener=void 0;var o=function(){function e(e,t){this.zegoWebRTC=e,this.roomID=t,this.pubDataChannelList=[],this.subDataChannelList=[],this.listenerList={receiveRealTimeSequentialData:[]},this.logger=e.logger}return e.prototype.startBroadcasting=function(e,t){return r(this,void 0,void 0,(function(){var t,r,o,n;return i(this,(function(i){switch(i.label){case 0:return this.logger.info("dc.sb.0 call"),this.pubDataChannelList.includes(e)?(this.logger.error("dc.sb.0 datachannel already exist"),[2,!1]):(t=this.zegoWebRTC.streamCenter.publisherList[e])&&t.publisher.dataChannel?(this.pubDataChannelList.push(e),[2,!0]):t&&!t.publisher.dataChannel?(this.logger.error("dc.sb.0 publish datachannel no exist, try other stream ID"),[2,!1]):this.broadcastStream?[3,2]:(r=document.createElement("canvas"),o=this,[4,this.zegoWebRTC.createStream({custom:{source:r}})]);case 1:o.broadcastStream=i.sent(),i.label=2;case 2:return(n=this.zegoWebRTC.startPublishingStream(e,this.broadcastStream,{roomID:this.roomID},!0))&&this.pubDataChannelList.push(e),this.logger.info("dc.sb.0 end"),[2,n]}}))}))},e.prototype.stopBroadcasting=function(e){this.logger.info("dc.sb.1 call"),this.pubDataChannelList=this.pubDataChannelList.filter((function(t){return t!==e}));var t=this.zegoWebRTC.streamCenter.publisherList[e];return t?(t.room.roomID==this.roomID&&t.isDataChannel&&this.zegoWebRTC.stopPublishingStream(e),this.logger.info("dc.sb.1 end"),!0):(this.logger.error("dc.sb.1 datachannel no found"),!1)},e.prototype.sendRealTimeSequentialData=function(e,t){if(!t instanceof ArrayBuffer)return this.logger.error("dc.srsd data type wrong"),!1;var r=this.zegoWebRTC.streamCenter.publisherList[e];return r&&this.pubDataChannelList.includes(e)?this.sendBCMessage(r.publisher,t):(this.logger.error("dc.srsd datachannel no found"),!1)},e.prototype.sendBCMessage=function(e,t){var r;if(!e.dataChannelState)return!1;for(var i=new Uint8Array(t),o=0,n=t.byteLength,s=e.send_seq,a=0,d=(new Date).getTime(),c=0;n>0;){n>1151?c=1141:(c=n,a=1);var u=new Uint8Array(c+10);u[0]=1,u[1]=a,u[2]=e.send_seq>>8&255,u[3]=255&e.send_seq,u[4]=s>>8&255,u[5]=255&s,u[6]=d>>24&255,u[7]=d>>16&255,u[8]=d>>8&255,u[9]=255&d;for(var l=0;l<c;l++)u[l+10]=i[l+o];n-=c,o+=c,e.send_seq++,e.send_seq>=65536&&(e.send_seq=0),null===(r=e.dataChannel)||void 0===r||r.send(u)}return!0},e.prototype.startSubscribing=function(e,t){var o,n;return r(this,void 0,void 0,(function(){var t,r;return i(this,(function(i){switch(i.label){case 0:return this.logger.info("dc.ss.0 call"),this.subDataChannelList.includes(e)?(this.logger.error("dc.ss.0 datachannel already exist"),[2,!1]):(t=this.zegoWebRTC.streamCenter.playerList[e])?[3,2]:[4,this.zegoWebRTC.startPlayingStream(e,void 0,!0)];case 1:i.sent(),t=this.zegoWebRTC.streamCenter.playerList[e],i.label=2;case 2:return(r=t.player).dataChannel?(!(null===(o=r.onDataChannelList)||void 0===o?void 0:o.includes(this.onReceivedDataChannel.bind(this)))&&(null===(n=r.onDataChannelList)||void 0===n||n.push(this.onReceivedDataChannel.bind(this))),this.subDataChannelList.push(e),this.logger.info("dc.ss.0 end"),[2,!0]):(this.logger.error("dc.ss.0 datachannel no exist, try other stream ID"),[2,!1])}}))}))},e.prototype.stopSubscribing=function(e){this.logger.info("dc.ss.1 call"),this.subDataChannelList=this.subDataChannelList.filter((function(t){return t!==e}));var t=this.zegoWebRTC.streamCenter.playerList[e];return t?(t.room.roomID==this.roomID&&t.isDataChannel&&this.zegoWebRTC.stopPlayingStream(e),this.logger.info("dc.ss.1 end"),!0):(this.logger.error("dc.ss.1 datachannel no subscribe"),!1)},e.prototype.on=function(e,t){this.bindListener(e,t)},e.prototype.off=function(e,t){this.deleteListener(e,t)},e.prototype.bindListener=function(e,t){return this.listenerList[e]?"function"!=typeof t?(this.logger.error("zc.o.0 listener callBack must be funciton"),!1):(-1==this.listenerList[e].indexOf(t)&&this.listenerList[e].push(t),!0):(this.logger.error("dc.o.0 event "+e+" no found"),!1)},e.prototype.deleteListener=function(e,t){if(!this.listenerList[e])return this.logger.error("dc.o.1 listener no found"),!1;var r=this.listenerList[e];return t?r.splice(r.indexOf(t),1):this.listenerList[e]=[],!0},e.prototype.actionListener=function(e){for(var t=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];this.listenerList[e]&&this.listenerList[e].forEach((function(i){try{setTimeout((function(){i.apply(void 0,r)}),0)}catch(r){t.logger.error("dc.al "+e+" "+r)}}))},e.prototype.onReceivedDataChannel=function(e,t,r){this.actionListener("receiveRealTimeSequentialData",e,t,r)},e.prototype.reset=function(){var e=this;for(var t in this.logger.info("dc.rs call"),this.pubDataChannelList.forEach((function(t){var r=e.zegoWebRTC.streamCenter.publisherList[t];r&&r.room.roomID==e.roomID&&r.isDataChannel&&e.zegoWebRTC.stopPublishingStream(t)})),this.subDataChannelList.forEach((function(t){var r=e.zegoWebRTC.streamCenter.playerList[t];r&&r.room.roomID==e.roomID&&r.isDataChannel&&e.zegoWebRTC.stopPlayingStream(t)})),this.listenerList)this.listenerList[t]=[];this.broadcastStream&&this.zegoWebRTC.destroyStream(this.broadcastStream),this.broadcastStream=void 0,this.logger.info("dc.rs end")},e}();t.DataChannelListener=o},5906:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.streamHandler=t.zegoWebRTC=void 0;var o=r(817),n=r(6145),s="2.16.1",a=1e4,d={},c="addMsgInfo";function u(e,t){var r,i,n,s,d="",c=o.errorCodeList;return t.errorCode<2e9&&t.errorCode>1e9?(n={1:"MIXER_START_REQUEST_ERROR",2:"MIXER_START_REQUEST_ERROR",3:"MIXER_AUTHENTICATION_FAILED",150:"MIXER_INPUT_STREAM_NOT_EXISTS",151:"MIXER_START_REQUEST_ERROR",152:"MIXER_STOP_REQUEST_ERROR",153:"MIXER_INPUT_PARAMETERS_ERROR",154:"MIXER_EXCEED_MAX_OUTPUT_COUNT",155:"MIXER_INPUT_PARAMETERS_ERROR",156:"MIXER_VIDEO_CONFIG_INVALID",157:"MIXER_NO_SERVICES",158:"MIXER_EXCEED_MAX_INPUT_COUNT",159:"MIXER_START_REQUEST_ERROR",160:"MIXER_NOT_OWNER_STOPMIXER",170:"MIXER_WATERMARK_PARAMETERS_ERROR",171:"MIXER_WATERMARK_NULL",175:"MIXER_REPEAT_INPUT",190:"MIXER_START_REQUEST_ERROR"},s="MIXER_INNER_ERROR",(i=t.errorCode-a)>1e9&&n[i-1e9]&&(s=n[i-1e9]),r=c[d=s]):t.errorCode<1e6&&(r=e.decodeServerError(t.errorCode,t.extendedData),d=e.getLiveRoomError(t.errorCode,this.stateCenter.useNetAgent)),{reportErr:r,actualError:c[d]}}t.zegoWebRTC={startMixerTask:function(e){var t=this;return new Promise((function(r,i){var o=t.stateCenter.getReportSeq();t.dataReport.newReport(o,n.ZegoRTCLogEvent.kZegoTaskMixStart.event),t.stateCenter.logReportCallback("kZegoTaskMixStart"+e.taskID,t.dataReport,o,t.stateCenter.reportList);var s={errorCode:1005027,extendedData:"mix stream input parameters are wrong"};if(null==e?void 0:e.inputList.find((function(e){return(void 0===e.streamID||null===e.streamID)&&(s.extendedData=s.extendedData+". streamID should be of string type",!0)})))return t.dataReport.addMsgInfo(o,s),t.dataReport.uploadReport(o),t.stateCenter.unregisterCallback("kZegoTaskMixStart"+e.taskID,t.stateCenter.reportList),void i(s);e.outputConfig&&e.outputConfig.outputFps&&(e.outputConfig.outputFPS=e.outputConfig.outputFps);var a=function(r){var n=u(t.stateCenter,r),s=n.reportErr,a=n.actualError;s?t.dataReport.addMsgInfo(o,s):t.dataReport.addMsgInfo(o,r),t.dataReport.uploadReport(o),t.stateCenter.unregisterCallback("kZegoTaskMixStart"+e.taskID,t.stateCenter.reportList),a&&(r.errorCode=null==a?void 0:a.code,r.extendedData=(null==a?void 0:a.message)||""),i(r)},d=t.stateCenter.roomList[0];d?d.streamHandler.updateMixStream(e,(function(i){t.dataReport.uploadReport(o),t.stateCenter.unregisterCallback("kZegoTaskMixStart"+e.taskID,t.stateCenter.reportList),r(i)}),a):a({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kNoLoginError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kNoLoginError.message})}))},setMixerTaskConfig:function(e){var t=this;return new Promise((function(r,i){var o=t.stateCenter.getReportSeq();t.dataReport.newReport(o,n.ZegoRTCLogEvent.kZegoTaskMixConfig.event),t.stateCenter.logReportCallback("kZegoTaskMixConfig",t.dataReport,o,t.stateCenter.reportList);var s=t.stateCenter.roomList[0];s?s.streamHandler.setMixerTaskConfig(e).then((function(e){t.dataReport.uploadReport(o),t.stateCenter.unregisterCallback("kZegoTaskMixConfig",t.stateCenter.reportList),r(e)})).catch((function(e){t.dataReport.addMsgInfo(o,e),t.dataReport.uploadReport(o),t.stateCenter.unregisterCallback("kZegoTaskMixConfig",t.stateCenter.reportList),i(e)})):i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kNoLoginError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kNoLoginError.message})}))},stopMixerTask:function(e){var t=this;return new Promise((function(r,i){var o=t.stateCenter.getReportSeq();if(t.dataReport.newReport(o,n.ZegoRTCLogEvent.kZegoTaskMixStop.event),!e||"string"!=typeof e||e.length>256||!t.stateCenter.checkIllegalCharacters(e))return t.logger.error("zb.rh.lg taskID must be string less 256"),t.dataReport.addMsgInfo(o,{error:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.code,message:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.message+" param taskID error"}),t.dataReport.uploadReport(o),void i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kParamError.message+" param taskID error"});var s=function(e){var r=u(t.stateCenter,e),n=r.reportErr,s=r.actualError;n?t.dataReport.addMsgInfo(o,n):t.dataReport.addMsgInfo(o,e),t.dataReport.uploadReport(o),s&&(e.errorCode=null==s?void 0:s.code,e.extendedData=(null==s?void 0:s.message)||""),i(e)},a=t.stateCenter.roomList[0];a?a.streamHandler.stopMixStream(e,(function(e){t.dataReport.uploadReport(o),r(e)}),s):s({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kNoLoginError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kNoLoginError.message})}))}},t.streamHandler={setMixerTaskConfig:function(e){var t=this;return new Promise((function(r,i){var o,s={},a={};if(e&&e.videoCodec){var u=e.videoCodec.toLowerCase();if(-1==["vp8","h264"].indexOf(u))return t.logger.error("zb.sh.ums param videoCode error"),i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kVideoConfigInvalidError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kVideoConfigInvalidError.message}),!1;s.videoCodec=u,a.video_codec=u}if(e.backgroundColor){if(!t.stateCenter.checkInteger(e.backgroundColor))return t.logger.error("zb.sh.ums param backgroundColor must be integer number"),i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.message}),!1;s.backgroundColor=e.backgroundColor,a.background_color=e.backgroundColor}if(e.backgroundImage){if("string"!=typeof e.backgroundImage)return t.logger.error("zb.sh.ums param outputBgImage error"),i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.message}),!1;if(!e.backgroundImage.startsWith("preset-id://")||!e.backgroundImage.endsWith(".jpg")&&!e.backgroundImage.endsWith(".png"))return t.logger.error("zb.sh.ums illegal input background image URL"),i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kBackgroundImageUrlInvalidError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kBackgroundImageUrlInvalidError.message}),!1;s.backgroundImage=e.backgroundImage,a.background_image=e.backgroundImage}if(e.waterMark&&(s.waterMark=e.waterMark,a.water_mark=e.waterMark),e&&e.userData){if(!(e.userData instanceof Uint8Array))return t.logger.error("zb.sh.ums param userData required Uint8Array"),i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.message}),!1;if(e.userData.byteLength>1e3)return t.logger.error("zb.sh.ums param userData should shorter than 1000"),i({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixConfig.error.kParamError.message}),!1;s.userData=e.userData}e.extraParams&&(s.extraParams||(s.extraParams=[]),(o=s.extraParams).push.apply(o,e.extraParams)),d=s,t.stateCenter.actionSuccessCallback("kZegoTaskMixConfig",t.stateCenter.reportList)&&t.stateCenter.actionSuccessCallback("kZegoTaskMixConfig",t.stateCenter.reportList)(c,void 0,{config:n.ZegoRTCLogEvent.kZegoTaskMixConfig.config(a)}),r({errorCode:0,extendedData:""})}))},stopMixStream:function(e,t,r,i,d){var c=this;this.logger.info("zb.sh.sms call");var u={id_name:this.stateCenter.idName,live_channel:this.roomID,appid:this.stateCenter.appid,version:s};if("string"==typeof e&&(u.task_id=e),null!=i?this.stateCenter.testEnvironment?u.stream_id="zegotest-"+this.stateCenter.appid+"-"+i:u.stream_id=i:null!=d&&(u.mixurl=d),this.stateCenter.useNetAgent)this.sendBizChannelRequestV2({server:12,location:"/interface/command",cmd:"stop_mix"},u,(function(e){t&&t({errorCode:0,extendedData:""})}),(function(e,t,i,s){var d="";if(s)return s==o.errorCodeList.TIMEOUT&&(s=n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kRequestError),s.code&&20010===s.code&&(s=JSON.parse(JSON.stringify(o.errorCodeList.MIXER_NO_SERVICES))),void(r&&r(s,d));if(s=n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInternalError,200===e){if("number"==typeof t)return c.logger.debug("zb.sh.sms error: "+t),t+=1e9,void(r&&r({errorCode:c.stateCenter.getServerError(a+t).code,extendedData:d}));c.logger.error("zb.sh.sms stop mix fail "+JSON.stringify(error));var u=n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInternalError;r&&r({errorCode:u.code,extendedData:u.message})}else d="request mix server fail, error: "+e,c.logger.error("zb.sh.sms "+d),r&&r(s,d)}));else{var l={channel:"zeus",cmd:"stop_mix",req_body:JSON.stringify(u)};this.sendBizChannelRequest(l,(function(){t&&t({errorCode:0,extendedData:""})}),(function(e){if("number"==typeof e)r&&r({errorCode:c.stateCenter.getServerError(a+e).code,extendedData:""});else{c.logger.error("zb.sh.sms stop mix fail "+JSON.stringify(e));var t;t=e==o.errorCodeList.TIMEOUT?n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kRequestError:n.ZegoRTCLogEvent.kZegoTaskMixStop.error.kInternalError,r&&r({errorCode:t.code,extendedData:t.message})}}))}return!0},updateMixStream:function(e,t,r){var u,l,h=this;if(this.logger.info("zb.sh.ums call"),!e.noTaskID&&!e.taskID)return this.logger.error("zb.sh.ums no taskId found"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDNullError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDNullError.message}),!1;if(!e.noTaskID&&"string"!=typeof e.taskID)return this.logger.error("zb.rh.lg taskId must be string"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.noTaskID&&e.taskID.length>256)return this.logger.error("zb.sh.ums taskId is too long"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDToLongError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDToLongError.message}),!1;if(!e.noTaskID&&!this.stateCenter.checkIllegalCharacters(e.taskID))return this.logger.error("zb.sh.ums task ID contains illegal characters"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDInvalidCharacterError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kTaskIDInvalidCharacterError.message}),!1;if(!e.inputList||0==e.inputList.length)return this.logger.error("zb.sh.ums input list wrong"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInputListNullError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInputListNullError.message}),!1;e.inputList.forEach((function(e){"AUDIO"===e.contentType&&(!e.layout&&(e.layout={top:0,left:0,bottom:0,right:0}),e.layout.top=0,e.layout.left=0,e.layout.bottom=1,e.layout.right=1)}));for(var p=0;p<e.inputList.length;p++){var g=e.inputList[p],f={errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message};if("object"!=typeof g.layout)return this.logger.error("zb.sh.ums input layout must be object"),r(f),!1;if(!(this.stateCenter.checkInteger(g.layout.top,!1)&&this.stateCenter.checkInteger(g.layout.bottom,!1)&&this.stateCenter.checkInteger(g.layout.left,!1)&&this.stateCenter.checkInteger(g.layout.right,!1)))return this.logger.error("zb.sh.ums topleftbottomright must be integer number"),r(f),!1;if(void 0!==g.renderMode&&![0,1].includes(g.renderMode))return this.logger.error("zb.sh.ums render_mode is wrong"),r(f),!1}if(!e.outputList||0==e.outputList.length)return this.logger.error("zb.sh.ums no output list found"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputListNullError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputListNullError.message}),!1;if(e.outputList.some((function(e){return"string"==typeof e&&!h.stateCenter.isUrl(e)&&!h.stateCenter.checkIllegalCharacters(e)||"object"==typeof e&&e.target&&!h.stateCenter.isUrl(e.target)&&!h.stateCenter.checkIllegalCharacters(e.target)})))return this.logger.error("zb.sh.ums stream output target is incorrect"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.message}),!1;if(!((l=e.inputList.every((function(e){return"AUDIO"===e.contentType})))||e.outputConfig&&"object"==typeof e.outputConfig))return this.logger.error("zb.sh.ums no output config found"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputNoTargetError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputNoTargetError.message}),!1;if(l&&(e.outputConfig=i(i({},e.outputConfig||{}),{outputBitrate:.001,outputFPS:1,outputWidth:1,outputHeight:1})),!(l||e.outputConfig.outputBitrate&&this.stateCenter.checkInteger(e.outputConfig.outputBitrate)))return this.logger.error("zb.sh.ums bitrate param is required and must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.outputConfig.outputFPS||!this.stateCenter.checkInteger(e.outputConfig.outputFPS))return this.logger.error("zb.sh.ums fps param is required and must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.outputConfig.outputWidth||!this.stateCenter.checkInteger(e.outputConfig.outputWidth))return this.logger.error("zb.sh.ums width param is required and must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(!e.outputConfig.outputHeight||!this.stateCenter.checkInteger(e.outputConfig.outputHeight))return this.logger.error("zb.sh.ums height param is required and must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(void 0!==e.outputConfig.outputAudioCodecID&&!this.stateCenter.checkInteger(e.outputConfig.outputAudioCodecID,!1))return this.logger.error("zb.sh.ums AudioCodecID param must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(void 0!==e.outputConfig.outputAudioBitrate&&!this.stateCenter.checkInteger(e.outputConfig.outputAudioBitrate))return this.logger.error("zb.sh.ums AudioBitrate param must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;if(void 0!==e.outputConfig.outputAudioChannels&&!this.stateCenter.checkInteger(e.outputConfig.outputAudioChannels,!1))return this.logger.error("zb.sh.ums AudioChannels param must be integer number"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kParamError.message}),!1;var _={},m=0;e.outputConfig.singleStreamPassThrough&&"boolean"==typeof e.outputConfig.singleStreamPassThrough&&(m=e.outputConfig.singleStreamPassThrough?1:0),_={task_id:e.taskID,id_name:this.stateCenter.idName,live_channel:this.roomID,appid:this.stateCenter.appid,version:s,bypass:m,timestamp:Math.ceil((new Date).getTime()/1e3)};var v=d;v&&(v.videoCodec&&(_.extra_params=[{key:"video_encode",value:v.videoCodec}]),v.backgroundColor&&(_.output_bg_color=v.backgroundColor),v.backgroundImage&&(_.output_bg_image=v.backgroundImage),v.waterMark&&(_.watermark=v.waterMark),v.userData&&(_.userdata=this.stateCenter.uint8arrayToBase64(v.userData)),v.extraParams&&(!_.extra_params&&(_.extra_params=[]),(u=_.extra_params).push.apply(u,v.extraParams))),_.MixInput=e.inputList.map((function(e,t){var r=e.streamID;return h.stateCenter.testEnvironment&&(r="zegotest-"+h.stateCenter.appid+"-"+e.streamID),{stream_id:r,content_control:"AUDIO"===e.contentType?1:0,rect:{layer:t,top:e.layout.top,left:e.layout.left,bottom:e.layout.bottom,right:e.layout.right},render_mode:e.renderMode}})),this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)&&this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)(c,void 0,{mix_stream_id:n.ZegoRTCLogEvent.kZegoTaskMixStart.mix_stream_id(e.taskID),stream_cnt:n.ZegoRTCLogEvent.kZegoTaskMixStart.stream_cnt(_.MixInput.length),input_stream_list:n.ZegoRTCLogEvent.kZegoTaskMixStart.input_stream_list(_.MixInput)}),_.MixOutput=e.outputList.map((function(t){var i={},o="";if("string"==typeof t)o=t;else{if("object"!=typeof t||!t.target)return h.logger.error("zb.sh.ums output target required"),r({errorCode:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.code,extendedData:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kOutputTargetInvalidError.message}),!1;o=t.target}return o.startsWith("rtmp://")||o.startsWith("https://")&&o.endsWith(".flv")||o.startsWith("https://")&&o.endsWith(".m3u8")?i.mixurl=o:h.stateCenter.testEnvironment?i.stream_id="zegotest-"+h.stateCenter.appid+"-"+o:i.stream_id=o,i.bitrate=1e3*e.outputConfig.outputBitrate,i.fps=e.outputConfig.outputFPS,i.width=e.outputConfig.outputWidth,i.height=e.outputConfig.outputHeight,e.outputConfig.outputAudioCodecID&&(i.audio_enc_id=e.outputConfig.outputAudioCodecID),"vp8"===v.videoCodec?i.audio_enc_id=3:"h264"===v.videoCodec&&(i.audio_enc_id=0),e.outputConfig.outputAudioBitrate&&(i.audio_bitrate=1e3*e.outputConfig.outputAudioBitrate),e.outputConfig.outputAudioChannels&&(i.audio_channel_cnt=e.outputConfig.outputAudioChannels),h.stateCenter.testEnvironment?i.testenv=1:i.testenv=0,i})),this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)&&this.stateCenter.actionSuccessCallback("kZegoTaskMixStart"+e.taskID,this.stateCenter.reportList)(c,void 0,{output_target_list:n.ZegoRTCLogEvent.kZegoTaskMixStart.output_target_list(_.MixOutput)}),this.logger.debug("zb.sh.ums send command");var E=this.stateCenter.useNetAgent,S="zegotest-"+this.stateCenter.appid+"-";if(E)this.sendBizChannelRequestV2({server:12,location:"/interface/command",cmd:"start_mix"},_,(function(e){var r=e.play.map((function(e){var t={rtmpURL:"",hlsURL:"",flvURL:""},r=e.stream_alias||"";return h.stateCenter.testEnvironment&&r&&r.startsWith(S)&&(r=r.slice(S.length)),t.streamID=r,e.rtmp_url&&e.rtmp_url.length>0&&(t.rtmpURL=e.rtmp_url),e.hls_url&&e.hls_url.length>0&&(t.hlsURL=e.hls_url),e.hdl_url&&e.hdl_url.length>0&&(t.flvURL=e.hdl_url),t}));if(t){var i={mixerOutputList:r};t({errorCode:0,extendedData:JSON.stringify(i)})}}),(function(e,t,i,s){var d="";if(s)return s==o.errorCodeList.TIMEOUT&&(s=n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kRequestError),s.code&&20010===s.code&&(s=JSON.parse(JSON.stringify(o.errorCodeList.MIXER_NO_SERVICES))),void(r&&r(s,d));if(s=n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInternalError,200===e){if("number"==typeof t){if(h.logger.debug("zb.sh.ums error: "+t),1000000150==(t+=1e9)&&i){var c=(null==i?void 0:i.non_exist_streams.map((function(e){return h.stateCenter.testEnvironment&&e.startsWith(S)?e.slice(S.length):e})))||[];c.length>0&&(h.logger.debug("zb.sh.ums not exist streams: "+c),d=c.join(","))}return void(r&&r({errorCode:h.stateCenter.getServerError(a+t).code,extendedData:d}))}h.logger.debug("zb.sh.ums error code "+t);var u=n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInternalError;r&&r({errorCode:u.code,extendedData:u.message})}else d="request mix server fail, error: "+e,h.logger.error("zb.sh.ums "+d),r&&r(s,d)}));else{var T={channel:"zeus",cmd:"start_mix",req_body:JSON.stringify(_)};this.sendBizChannelRequest(T,(function(e,i,o){if(h.logger.debug("zb.sh.ums receive message"),0!=o.length){for(var n=JSON.parse(o),s=[],a=0;a<n.play.length;a++){var d={rtmpURL:"",hlsURL:"",flvURL:""},c=n.play[a].stream_alias||"";h.stateCenter.testEnvironment&&c&&c.startsWith(S)&&(c=c.slice(S.length)),d.streamID=c,n.play[a].rtmp_url&&n.play[a].rtmp_url.length>0&&(d.rtmpURL=n.play[a].rtmp_url),n.play[a].hls_url&&n.play[a].hls_url.length>0&&(d.hlsURL=n.play[a].hls_url),n.play[a].hdl_url&&n.play[a].hdl_url.length>0&&(d.flvURL=n.play[a].hdl_url),s.push(d)}if(t){var u={mixerOutputList:s};t({errorCode:0,extendedData:JSON.stringify(u)})}}else r&&r({errorCode:h.stateCenter.getServerError(10001).code,extendedData:""})}),(function(e,t,i){if("number"==typeof e){h.logger.debug("zb.sh.ums error: "+e);var s=[];if(1000000150==e&&0!=i.length)for(var d=JSON.parse(i),c=0;c<d.non_exist_streams.length;c++){var u=d.non_exist_streams[c];h.stateCenter.testEnvironment&&u.startsWith(S)?s.push(u.slice(S.length)):s.push(u)}r&&r({errorCode:h.stateCenter.getServerError(a+e).code,extendedData:""})}else{h.logger.debug("zb.sh.ums error code "+e.code);var l;l=e==o.errorCodeList.TIMEOUT?n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kRequestError:n.ZegoRTCLogEvent.kZegoTaskMixStart.error.kInternalError,r&&r({errorCode:l.code,extendedData:l.message})}}))}return!0}}},817:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={NOT_LOGIN:{code:1000002,message:"not login room"},INPUT_PARAM:{code:1100001,message:"input param error."},TIMEOUT:{code:1100002,message:"network timeout."},MIXER_NO_SERVICES:{code:1005e3,message:"no mix stream service"},MIXER_TASK_ID_NULL:{code:1005001,message:"mixer task is null"},MIXER_TASK_ID_TOO_LONG:{code:1005002,message:"task ID is too long"},MIXER_TASK_ID_INVALID_CHARACTER:{code:1005003,message:"task ID contains illegal characters"},MIXER_NO_OUTPUT_TARGET:{code:1005005,message:"task configuration does not specify output"},MIXER_OUTPUT_TARGET_INVALID:{code:1005006,message:"stream output target is incorrect"},MIXER_START_REQUEST_ERROR:{code:1005010,message:"start mixer task fail, possibly due to network reasons"},MIXER_STOP_REQUEST_ERROR:{code:1005011,message:"stop mixer task fail, possibly due to network reasons"},MIXER_NOT_OWNER_STOP_MIXER:{code:1005012,message:" maxed task must be stopped by the start user of the task"},MIXER_INPUTLIST_NULL:{code:1005020,message:"Mixed stream task input list is null"},MIXER_OUTPUTLIST_NULL:{code:1005021,message:"Mixed stream task output list is null"},MIXER_VIDEO_CONFIG_INVALID:{code:1005023,message:"invalid mixed stream task video configuration"},MIXER_EXCEED_MAX_INPUT_COUNT:{code:1005025,message:"more than the maximum number of input streams"},MIXER_INPUT_STREAM_NOT_EXISTS:{code:1005026,message:"Input stream does not exist"},MIXER_EXCEED_MAX_OUTPUT_COUNT:{code:1005030,message:"more than the maximum number of output streams"},MIXER_AUTHENTICATION_FAILED:{code:1005050,message:"mixed stream authentication failed"},MIXER_WATERMARK_NULL:{code:1005061,mag:"input watermark is null"},MIXER_WATERMARK_PARAMETERS_ERROR:{code:1005062,message:"input watermark parameter is wrong"},MIXER_WATERMARK_URL_INVALID:{code:1005063,message:"illegal input watermark URL"},MIXER_BACKGROUND_IMAGE_URL_INVALID:{code:1005067,message:"illegal input background image URL"},MIXER_REPEAT_INPUT:{code:1005099,message:"mix stream input repeat"},MIXER_INNER_ERROR:{code:1005099,message:"mixer internal error"}}},577:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(5906);t.default={type:"MixStream",install:function(e,t){for(var r in i.zegoWebRTC)Object.defineProperty(e.prototype,r,{value:i.zegoWebRTC[r],writable:!1});for(var r in i.streamHandler)Object.defineProperty(t.prototype,r,{value:i.streamHandler[r],writable:!1})}}},6145:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTCLogEvent=void 0;var i=r(817),o=function(e){return e};t.ZegoRTCLogEvent={kZegoTaskMixStart:{event:"/mix/start_mix",error:{kParamError:i.errorCodeList.INPUT_PARAM,kTaskIDNullError:i.errorCodeList.MIXER_TASK_ID_NULL,kTaskIDToLongError:i.errorCodeList.MIXER_TASK_ID_TOO_LONG,kTaskIDInvalidCharacterError:i.errorCodeList.MIXER_TASK_ID_INVALID_CHARACTER,kInputListNullError:i.errorCodeList.MIXER_INPUTLIST_NULL,kOutputListNullError:i.errorCodeList.MIXER_OUTPUTLIST_NULL,kOutputTargetInvalidError:i.errorCodeList.MIXER_OUTPUT_TARGET_INVALID,kOutputNoTargetError:i.errorCodeList.MIXER_NO_OUTPUT_TARGET,kRequestError:i.errorCodeList.MIXER_START_REQUEST_ERROR,kInternalError:i.errorCodeList.MIXER_INNER_ERROR,kNoLoginError:i.errorCodeList.NOT_LOGIN},mix_stream_id:o,stream_cnt:o,input_stream_list:o,output_target_list:o},kZegoTaskMixStop:{event:"/mix/stop_mix",error:{kParamError:i.errorCodeList.INPUT_PARAM,kTaskIDNullError:i.errorCodeList.MIXER_TASK_ID_NULL,kRequestError:i.errorCodeList.MIXER_STOP_REQUEST_ERROR,kInternalError:i.errorCodeList.MIXER_INNER_ERROR,kNoLoginError:i.errorCodeList.NOT_LOGIN}},kZegoTaskMixConfig:{event:"/mix/config_mix",error:{kParamError:i.errorCodeList.INPUT_PARAM,kVideoConfigInvalidError:i.errorCodeList.MIXER_VIDEO_CONFIG_INVALID,kBackgroundImageUrlInvalidError:i.errorCodeList.MIXER_BACKGROUND_IMAGE_URL_INVALID,kNoLoginError:i.errorCodeList.NOT_LOGIN},config:o}}},2760:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(r(2730)),a=n(r(5947)),d=n(r(1646)),c=n(r(1576)),u=r(7803),l=r(1297),h=function(){function e(e){var t=this;this.isSpatial=!1,this.audioSourceList=[],this.speakingUserIdList=[],this._audioCtx=null,this.zegoRTC=e,this.zegoRTC.on("roomStreamUpdate",(function(e,r,i){var o=i.map((function(e){return e.streamID}));"DELETE"===r?t.speakingUserIdList=t.speakingUserIdList.filter((function(e){var r=!o.includes(e);if(!r){var i=t.audioSourceMap[e];i&&i.isPlaying&&i.stopPlayingAudio()}return r})):"ADD"===r&&(t.speakingUserIdList=t.speakingUserIdList.concat(o),i.forEach((function(e){if(!t.audioSourceMap[e.streamID]){var r=t.getStreamInfo(e.extraInfo),i=r.teamID,o=r.sendMode,n=new s.default({userID:e.streamID,teamID:i,sendMode:o},{audioCtx:t.audioCtx,zegoRTC:t.zegoRTC,isSpatial:t.isSpatial,maxDistance:t.rangeListener.recvRange});t.audioSourceList.push(n),t.playStreamHandler.handlePlayAudioTask()}}))),t.playStreamHandler.setAudioSourceList(t.speakingAudioSourceList)})),this.zegoRTC.on("playerStateUpdate",(function(e){var r=t.audioSourceMap[e.streamID];r&&("NO_PLAY"===e.state?r.isPlaying=!1:r.isPlaying=!0)})),this.zegoRTC.on("streamExtraInfoUpdate",(function(e,r){r.forEach((function(e){var r=t.audioSourceMap[e.streamID];if(r){var i=t.getStreamInfo(e.extraInfo),o=i.teamID,n=i.sendMode;o!==r.teamID&&(r.teamID=o,t.enableSpatializer(t.isSpatial)),void 0!==n&&(r.sendMode=n),t.playStreamHandler.handlePlayAudioTask()}}))})),this.zegoRTC.RTM._on("_roomStateUpdate",(function(e,r){"CONNECTED"===r?(t.roomID=e,t.rangeListener.userID=t.zegoRTC.RTM.getUserID()):"DISCONNECTED"===r&&(t.roomID=void 0,t.rangeListener.reset(),t.audioSourceList=[])}));var r=window.AudioContext||window.webkitAudioContext;this._audioCtx=this.zegoRTC&&this.zegoRTC.ac||new r,this.rangeListener=a.default.getInstance(this.audioCtx,this.zegoRTC),this.playStreamHandler=d.default.getInstance(this.rangeListener),this.eventManager=c.default.getInstance()}return Object.defineProperty(e.prototype,"audioSourceMap",{get:function(){return this.audioSourceList.reduce((function(e,t){return t.userID&&(e[t.userID]=t),e}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"speakingAudioSourceList",{get:function(){var e=this;return this.audioSourceList.filter((function(t){return!!e.speakingUserIdList.includes(t.userID)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playingAudioSourceList",{get:function(){return this.audioSourceList.filter((function(e){return e.isPlaying}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"audioCtx",{get:function(){if(!this._audioCtx){var e=window.AudioContext||window.webkitAudioContext;this._audioCtx=new e}return this._audioCtx},enumerable:!1,configurable:!0}),e.getInstance=function(t){return e.instance||(e.instance=new e(t)),e.instance},e.prototype.resumeAudioContext=function(){return i(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){return[2,new Promise((function(t){e.audioCtx.onstatechange=function(){"running"===e.audioCtx.state&&t(!0)},e.audioCtx.suspend(),e.audioCtx.resume(),setTimeout((function(){t(!1)}),3e3)}))]}))}))},e.prototype.getAudioContextState=function(){return this.audioCtx.state},e.prototype.getStreamInfo=function(e){var t=void 0,r=void 0;try{var i=JSON.parse(e);t=i.range_audio_team_id,[l.ZegoRangeAudioMode.World,l.ZegoRangeAudioMode.Team].includes(i.range_audio_mode)&&(r=i.range_audio_mode)}catch(e){}return{teamID:t,sendMode:r}},e.prototype.setAudioReceiveRange=function(e){if(!u.checkNumber(e))throw Error("Failed to execute 'setAudioReceiveRange': Argument 'range' requires to be type number.");if((e=Number(e))<0)throw Error("Failed to execute 'setAudioReceiveRange': Argument 'range' can not be less than 0.");this.rangeListener.recvRange=e,this.audioSourceList.forEach((function(t){t.setMaxDistance(e)}))},e.prototype.updateSelfPosition=function(e,t,r,i){var o=function(e){return"Failed to execute 'updateSelfPosition': Argument '"+e+"' requires an array of type number.\""};if(!u.checkCoordinate(e))throw new Error(o("position"));if(!u.checkCoordinate(t))throw new Error(o("axisForward"));if(!u.checkCoordinate(r))throw new Error(o("axisRight"));if(!u.checkCoordinate(i))throw new Error(o("axisUp"));this.rangeListener&&this.rangeListener.updateSelfPosition(e,t,i),this.playStreamHandler.setListener(this.rangeListener)},e.prototype.updateAudioSource=function(e,t){if(e=String(e),!u.checkCoordinate(t))throw new Error("Failed to execute 'updateAudioSource': Arguments 'position' must be an array of type number.");var r=this.audioSourceMap[e];r?r.setPosition(t):(r=new s.default({userID:e,position:t},{audioCtx:this.audioCtx,zegoRTC:this.zegoRTC,isSpatial:this.isSpatial,maxDistance:this.rangeListener.recvRange}),this.enableSpatializer(this.isSpatial),this.audioSourceList.push(r)),this.playStreamHandler.setAudioSourceList(this.speakingAudioSourceList)},e.prototype.enableMicrophone=function(e){if(void 0===e&&(e=!0),!this.rangeListener.userID)throw new Error("Enable mic failed. Please log in room first.");return e?this.rangeListener.startPublishingStream():this.rangeListener.stopPublishingStream()},e.prototype.enableSpeaker=function(e){if(void 0===e&&(e=!0),!this.roomID)throw new Error("Enable speaker failed. Please log in room first.");this.playStreamHandler.isEnable=e,e?(this.playStreamHandler.startPlayingAudioStream(),this.playStreamHandler.handlePlayAudioTask()):this.playStreamHandler.stopPlayingAudioStream()},e.prototype.enableSpatializer=function(e){var t=this;void 0===e&&(e=!0),this.isSpatial=!!e,this.audioSourceList.forEach((function(r){var i=!(![r.teamID,t.rangeListener.teamID].includes(void 0)&&t.rangeListener.teamID===r.teamID)&&e;r.enableSpatializer(i)})),e&&this.rangeListener.updateListenerEffect()},e.prototype.setRangeAudioTeamID=function(e){this.rangeListener.setTeamID(e),this.enableSpatializer(this.isSpatial),this.playStreamHandler.handlePlayAudioTask()},e.prototype.setRangeAudioMode=function(e){this.rangeListener.setSendMode(e),this.rangeListener.setRecvMode(e),this.playStreamHandler.handlePlayAudioTask()},e.prototype.on=function(e,t){return this.eventManager.addEventHandler(e,t)},e.prototype.off=function(e,t){return this.eventManager.removeEventHandler(e,t)},e}();t.default=h},2777:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RangeAudio=void 0;var i=r(3116);t.RangeAudio={type:"RangeAudio",install:function(e){Object.defineProperty(e.prototype,"createRangeAudioInstance",{value:function(){return this.rangeAudio||(this.rangeAudio=i.ZegoExpressRangeAudio.getInstance(this)),this.rangeAudio},writable:!1})}}},2730:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var n=r(1297),s=function(){function e(e,t){this.panner=null,this.isSpatial=!1,this.autoPlay=!0,this.position=null,this.stream=null,this.sourceNode=null,this.isPlaying=!1,this.distance=null,this.audioCtx=t.audioCtx,this.zegoRTC=t.zegoRTC,this.isSpatial=t.isSpatial,this.maxDistance=t.maxDistance||1e5,this.userID=e.userID,this.teamID=e.teamID,this.sendMode=void 0!==e.sendMode?e.sendMode:n.ZegoRangeAudioMode.World,e.position&&(this.position=e.position)}return Object.defineProperty(e.prototype,"audioWrapper",{get:function(){var e=document.getElementById("#zg-audio-source-wrapper");return e||((e=document.createElement("div")).setAttribute("id","zg-audio-source-wrapper"),document.body.appendChild(e)),e},enumerable:!1,configurable:!0}),e.prototype.createPanner=function(){var e=this.position||[0,0,0],t=this.maxDistance;return new PannerNode(this.audioCtx,{panningModel:"HRTF",distanceModel:"linear",refDistance:1,maxDistance:t,rolloffFactor:1,coneOuterGain:.4,positionX:e[1],positionY:e[0],positionZ:-e[0]})},e.prototype.startPlayingAudio=function(){return i(this,void 0,void 0,(function(){var e,t;return o(this,(function(r){switch(r.label){case 0:return(e=document.getElementById("zg-audio-source-"+this.userID))?[3,2]:((e=document.createElement("audio")).setAttribute("autoplay","autoplay"),e.setAttribute("id","zg-audio-source-"+this.userID),e.setAttribute("crossorigin","anonymous"),t=this,[4,this.zegoRTC.startPlayingStream(this.userID)]);case 1:t.stream=r.sent(),this.audioWrapper.appendChild(e),this.stream&&(e.srcObject=this.stream,this.sourceNode=this.audioCtx.createMediaStreamSource(this.stream)),this.panner||(this.panner=this.createPanner()),this.sourceNode&&this.enableSpatializer(this.isSpatial,!0),"suspended"===this.audioCtx.state&&this.audioCtx.resume(),r.label=2;case 2:return e&&e.parentNode&&e.parentNode.removeChild(e),[2]}}))}))},e.prototype.stopPlayingAudio=function(){this.isPlaying&&this.zegoRTC.stopPlayingStream(this.userID),this.stream=null,this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=null)},e.prototype.setPosition=function(e){this.position=e,this.panner&&(this.panner.positionX.value=e[1],this.panner.positionY.value=e[2],this.panner.positionZ.value=-e[0])},e.prototype.setMaxDistance=function(e){this.maxDistance=e,this.panner&&(this.panner.maxDistance=this.maxDistance)},e.prototype.getDistanceFromListener=function(e){var t=this.position,r=e.position;if(!r||!t)return null;var i=[t[0]-r[0],t[1]-r[1],t[2]-r[2]];return this.distance=Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2)+Math.pow(i[2],2)),this.distance},e.prototype.enableSpatializer=function(e,t){void 0===t&&(t=!1),(t||this.isSpatial!==e)&&(this.isSpatial=e,this.sourceNode&&(e&&this.panner?(this.sourceNode.disconnect(),this.sourceNode.connect(this.panner).connect(this.audioCtx.destination)):e||(this.sourceNode.disconnect(),this.sourceNode.connect(this.audioCtx.destination))))},e}();t.default=s},1576:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.handlerListMap={microphoneStateUpdate:[]}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addEventHandler=function(e,t){if(!this.handlerListMap[e])return!1;if("function"!=typeof t)throw new Error("Params callBack is not a Function");return-1==this.handlerListMap[e].indexOf(t)&&this.handlerListMap[e].push(t),!0},e.prototype.removeEventHandler=function(e,t){return!!this.handlerListMap[e]&&(this.handlerListMap[e]=t?this.handlerListMap[e].filter((function(e){return e!==t})):[],!0)},e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.handlerListMap[e]&&this.handlerListMap[e].forEach((function(r){try{setTimeout((function(){r.apply(void 0,t)}),0)}catch(t){console.error("dispatch "+e+" "+t)}}))},e}();t.default=r},1646:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1297),o=function(){function e(e){this.isEnable=!1,this.interval=3e3,this.timer=null,this.audioSourceList=[],this.hasChanged=!1,this.maxPlayingQuantity=20,this.rangeListener=e}return e.getInstance=function(t){return e.instance||(e.instance=new e(t)),e.instance},e.prototype.setListener=function(e){this.rangeListener=e,this.hasChanged=!0},e.prototype.setAudioSourceList=function(e){this.audioSourceList=e,this.hasChanged=!0},e.prototype.startPlayingAudioStream=function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.playAudioTask()},e.prototype.playAudioTask=function(){var e=this;this.hasChanged&&(this.hasChanged=!1,this.handlePlayAudioTask()),this.timer=window.setTimeout((function(){e.playAudioTask()}),this.interval)},e.prototype.handlePlayAudioTask=function(){var e=this;if(this.isEnable){var t=this.getTeamAudioSourceGroup(),r=t.teamList,o=t.otherList,n=0;r.forEach((function(t){n<e.maxPlayingQuantity&&(t.isPlaying||t.startPlayingAudio(),n++)}));var s=this.rangeListener.recvMode===i.ZegoRangeAudioMode.World;s&&(o.forEach((function(t){t.distance=t.getDistanceFromListener(e.rangeListener)})),o.sort((function(e,t){return null===e.distance?1:null===t.distance||e.distance<t.distance?-1:e.distance>t.distance?1:0}))),o.forEach((function(t){s&&n<e.maxPlayingQuantity&&t.sendMode!==i.ZegoRangeAudioMode.Team&&null!==t.distance&&(null===e.rangeListener.recvRange||t.distance<=e.rangeListener.recvRange)?(t.isPlaying||t.startPlayingAudio(),n++):t.stopPlayingAudio()}))}else this.stopPlayingAudioStream()},e.prototype.getTeamAudioSourceGroup=function(){var e=this,t=[],r=[];return this.audioSourceList.forEach((function(i){[i.teamID,e.rangeListener.teamID].includes(void 0)||i.teamID!==e.rangeListener.teamID?r.push(i):t.push(i)})),{teamList:t,otherList:r}},e.prototype.stopPlayingAudioStream=function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.audioSourceList.forEach((function(e){e.stopPlayingAudio()}))},e}();t.default=o},5947:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1297),n=i(r(1576)),s=function(){function e(e,t){var r=this;this.recvMode=o.ZegoRangeAudioMode.World,this.sendMode=o.ZegoRangeAudioMode.World,this.recvRange=null,this.position=null,this.forwardAxis=[1,0,0],this.upAxis=[0,0,1],this.audioStream=null,this.isPublishing=!1,this.zegoRTC=t,this.audioCtx=e,this.audioListener=this.audioCtx.listener,this.eventHandler=n.default.getInstance(),this.zegoRTC.on("publisherStateUpdate",(function(e){var t=e.streamID,i=e.state,n=e.errorCode,s=e.extendedData;t===r.userID&&("NO_PUBLISH"===i?(r.isPublishing=!1,r.stopPublishingStream()):r.isPublishing=!0);var a={NO_PUBLISH:o.ZegoRangeAudioMicrophoneState.Off,PUBLISH_REQUESTING:o.ZegoRangeAudioMicrophoneState.TurningOn,PUBLISHING:o.ZegoRangeAudioMicrophoneState.On};r.eventHandler.emit("microphoneStateUpdate",a[i],n,s)}))}return e.getInstance=function(t,r){return e.instance||(e.instance=new e(t,r)),e.instance},e.prototype.updateSelfPosition=function(e,t,r){this.position=e,this.forwardAxis=t,Array.isArray(r)&&(this.upAxis=r),this.updateListenerEffect()},e.prototype.updateListenerEffect=function(){this.position&&(this.audioListener.positionX?(this.audioListener.positionX.value=this.position[1],this.audioListener.positionY.value=this.position[2],this.audioListener.positionZ.value=-this.position[0]):this.audioListener.setPosition(this.position[1],this.position[2],-this.position[0]),this.audioListener.forwardX?(this.audioListener.forwardX.value=this.forwardAxis[1],this.audioListener.forwardY.value=this.forwardAxis[2],this.audioListener.forwardZ.value=-this.forwardAxis[0],this.audioListener.upX.value=this.upAxis[1],this.audioListener.upY.value=this.upAxis[2],this.audioListener.upZ.value=-this.upAxis[0]):this.audioListener.setOrientation(this.forwardAxis[1],this.forwardAxis[2],-this.forwardAxis[0],this.upAxis[1],this.upAxis[2],-this.upAxis[0]))},e.prototype.startPublishingStream=function(){var e=this;this.zegoRTC.createStream({camera:{video:!1,audio:!0,audioBitrate:30}}).then((function(t){if(!e.userID)throw e.zegoRTC.destroyStream(t),Error("Enable mic failed. Please log in room first.");e.audioStream&&e.audioStream!==t&&e.zegoRTC.destroyStream(e.audioStream),e.audioStream=t;var r={range_audio_team_id:e.teamID,range_audio_mode:e.sendMode};e.zegoRTC.startPublishingStream(e.userID,t,{extraInfo:JSON.stringify(r)})})).catch((function(e){throw e}))},e.prototype.stopPublishingStream=function(){this.isPublishing&&this.userID&&this.zegoRTC.stopPublishingStream(this.userID),this.isPublishing=!1,this.audioStream&&(this.zegoRTC.destroyStream(this.audioStream),this.audioStream=null)},e.prototype.setRecvMode=function(e){this.recvMode=e},e.prototype.setSendMode=function(e){this.sendMode=e,this.updateSteamExtraInfo()},e.prototype.setTeamID=function(e){this.teamID=e,this.updateSteamExtraInfo()},e.prototype.updateSteamExtraInfo=function(){this.userID&&this.isPublishing&&this.zegoRTC.setStreamExtraInfo(this.userID,JSON.stringify({range_audio_team_id:this.teamID||void 0,range_audio_mode:this.sendMode}))},e.prototype.reset=function(){this.audioStream&&this.stopPublishingStream(),this.userID=void 0},e}();t.default=s},7803:function(e,t){"use strict";function r(e){return!isNaN(Number(e))&&Number.MAX_SAFE_INTEGER>=Number(e)&&Number(e)>=-Number.MAX_SAFE_INTEGER}Object.defineProperty(t,"__esModule",{value:!0}),t.checkCoordinate=t.checkBoolean=t.checkNumber=void 0,t.checkNumber=r,t.checkBoolean=function(e){return!1},t.checkCoordinate=function(e){if(Array.isArray(e)){for(var t=0;t<3;t++)if(!r(e[t]))return!1;return!0}return!1}},3524:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.preview=t.zegoWebRTC=void 0;var s=n(r(954)),a=r(3471);t.zegoWebRTC={setBeautyEffect:function(e,t,r){var i=this;return new Promise((function(o,n){if(!(e instanceof MediaStream))return i.logger.error("zc.sbe localStream not found"),void n({errorCode:ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError.code,extendedData:ZegoRTCLogEvent.kZegoReplaceTrack.error.kParamError.message+" localStream no found"});t=!!t;var s=function(e){o(e)},d=i.streamCenter.checkPreview(e);if(!d)return i.logger.error("zc.sbe.0 preview no found"),void s({errorCode:a.errorCodeList.PUBLISH_NO_PREVIEW.code,extendedData:a.errorCodeList.PUBLISH_NO_PREVIEW.message});d.setBeautyEffect(t,r).then((function(){s({errorCode:0,extendedData:""})})).catch((function(e){n({errorCode:e.errorCode||-1,extendedData:e.extendedData||e.toString()})}))}))}},t.preview={setBeautyEffect:function(e,t){return i(this,void 0,void 0,(function(){var r,n,d,c=this;return o(this,(function(u){switch(u.label){case 0:if(!this.videoTrack)return this.logger.error("zc.p.0.sbe.0 video track no found"),[2];if("undefined"==typeof WebGLRenderingContext)throw r=a.errorCodeList.VIDEO_EFFECT_NOT_SUPPORT,n=r.code,d=r.message,{errorCode:n,extendedData:d};return s.default?this.videoEffect?this.videoTrack===this.videoEffect.input?[3,2]:[4,this.videoEffect.setInput(this.videoTrack)]:[3,4]:[3,7];case 1:u.sent(),u.label=2;case 2:return[4,this.videoEffect.setBeautyEffectOptions(e,t)];case 3:return u.sent(),[3,6];case 4:return this.videoEffect=new s.default(this.logger,this.videoTrack),this.videoEffect.onOverload=function(e){c.stateCenter.actionListener("beautyEffectOverload",c.localStream,e)},this.videoEffect.onOutputChange=function(e){return i(c,void 0,void 0,(function(){var t,r,i;return o(this,(function(o){return this.videoTrack&&this.localStream&&(t=this.videoTrack,e&&(t=e),this.localStream.getVideoTracks()[0]!==t&&((r=null===(i=this.streamCenter.checkPublish(this.localStream))||void 0===i?void 0:i.publisher)&&r.previewer?r.replacePublishedTrack(t,!0):this.replacePreviewTrack(t,!!e))),[2]}))}))},[4,this.videoEffect.setBeautyEffectOptions(e,t)];case 5:u.sent(),u.label=6;case 6:return[3,8];case 7:this.logger.error("zc.p.0.sbe.0 beauty effect module no found"),u.label=8;case 8:return[2]}}))}))}}},3048:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PUBLISH_SET_BEAUTY_EFFECT=void 0;var s=n(r(8606)),a=n(r(5683)),d=n(r(8302));t.PUBLISH_SET_BEAUTY_EFFECT="zc.p.0.sbe.2";var c=function(){function e(e){this.logger=e,this.gl=null,this.effectConfig={sharpenIntensity:.5,whitenIntensity:.5,rosyIntensity:.5,smoothIntensity:.5},this.originResolution={width:0,height:0},this.shaderList=[],this.frameBufferList=[],this.outputTextureList=[],this.inputTexture=null,this.enableBeauty=!1}return e.prototype.setEnableBeauty=function(e){this.enableBeauty=!!e},e.prototype.init=function(e,r,n){return i(this,void 0,void 0,(function(){var i,c,u;return o(this,(function(o){return"undefined"!=typeof WebGLRenderingContext?(this.gl=n.getContext("webgl"),this.gl?(this.initGL(e,r),this.inputTexture?(this.canvasEl=n,(i=new s.default(this.gl,e,r)).setConstUniforms(),(c=new a.default(this.gl,e,r)).setConstUniforms(),(u=new d.default(this.gl,e,r)).setConstUniforms(),this.shaderList=[i,c,u],this.setEffectConfig(this.effectConfig),[2]):[2,this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" input texture not found")]):[2,this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" not get webgl context")]):[2,this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" not support webgl!")]}))}))},e.prototype.render=function(e){return i(this,void 0,void 0,(function(){var r,i,n,s,a=this;return o(this,(function(o){switch(o.label){case 0:return(r=this.gl)&&this.canvasEl?this.originResolution.height===e.videoHeight&&this.originResolution.width===e.videoWidth||!(Math.abs(this.originResolution.height-e.videoHeight)>2||Math.abs(this.originResolution.width-e.videoWidth)>2)?[3,3]:0===e.videoHeight||0===e.videoWidth?[2]:(this.canvasEl.width=e.videoWidth,this.canvasEl.height=e.videoHeight,e.setAttribute("width",e.videoWidth.toString()),e.setAttribute("height",e.videoHeight.toString()),!this.gl||this.gl.isContextLost()?[3,1]:(this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" resolution changed to "+e.videoWidth+"x"+e.videoHeight+", reset resolution."),this.resetResolution(e.videoWidth,e.videoHeight),this.shaderList.forEach((function(t){t.resetResolution(e.videoWidth,e.videoHeight)})),[3,3])):(this.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" video effect manager is not init!"),[2]);case 1:return this.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" resolution changed and gl context lost, restart effect"),this.release(),[4,this.init(e.videoWidth,e.videoHeight,this.canvasEl)];case 2:o.sent(),o.label=3;case 3:return i=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],n=[0,1,2,0,2,3],s=[0,0,1,0,1,1,0,1],r.viewport(0,0,e.width,e.height),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.inputTexture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),this.shaderList.forEach((function(e,t){var o=e.program;if(o){e.renderPreTextures&&e.renderPreTextures(i,n,s),r.useProgram(o),e.render();var d=r.getUniformLocation(o,"uTexture"),c=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,c),r.bufferData(r.ARRAY_BUFFER,new Float32Array(i),r.STATIC_DRAW);var u=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,u),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),r.STATIC_DRAW);var l=r.getAttribLocation(o,"aPosition");r.enableVertexAttribArray(l),r.vertexAttribPointer(l,3,r.FLOAT,!1,0,0);var h=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,h),r.bufferData(r.ARRAY_BUFFER,new Float32Array(s),r.STATIC_DRAW);var p=r.getAttribLocation(o,"aTexCoordinate");r.enableVertexAttribArray(p),r.vertexAttribPointer(p,2,r.FLOAT,!1,0,0);var g=t===a.shaderList.length-1?null:a.outputTextureList[t],f=t===a.shaderList.length-1?null:a.frameBufferList[t];r.bindFramebuffer(r.FRAMEBUFFER,f),r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),r.activeTexture(r.TEXTURE0),g&&r.bindTexture(r.TEXTURE_2D,g),r.uniform1i(d,0)}})),[2]}}))}))},e.prototype.setEffectConfig=function(e){var t=this;isNaN(e.sharpenIntensity)||(this.effectConfig.sharpenIntensity=e.sharpenIntensity),isNaN(e.whitenIntensity)||(this.effectConfig.whitenIntensity=e.whitenIntensity),isNaN(e.rosyIntensity)||(this.effectConfig.rosyIntensity=e.rosyIntensity),isNaN(e.smoothIntensity)||(this.effectConfig.smoothIntensity=e.smoothIntensity),this.shaderList.forEach((function(e){e.setEffectConfig(t.effectConfig)}))},e.prototype.release=function(){var e=this;this.shaderList.forEach((function(t){var r;t.program&&(null===(r=e.gl)||void 0===r||r.deleteProgram(t.program))})),this.outputTextureList.forEach((function(t){var r;t&&(null===(r=e.gl)||void 0===r||r.deleteTexture(t))})),this.frameBufferList.forEach((function(t){var r;t&&(null===(r=e.gl)||void 0===r||r.deleteFramebuffer(t))})),this.inputTexture=this.gl=null,this.shaderList=[],this.outputTextureList=[],this.frameBufferList=[]},e.prototype.initGL=function(e,r){var i=this.gl;if(!i)return this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" webgl context not found");this.inputTexture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.inputTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR);for(var o=0;3>o;o++){var n=i.createTexture();if(!n)return this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" create texture failed");i.bindTexture(i.TEXTURE_2D,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e,r,0,i.RGBA,i.UNSIGNED_BYTE,null);var s=i.createFramebuffer();if(!s)return this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" create frame buffer failed");i.bindFramebuffer(i.FRAMEBUFFER,s),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,n,0),this.outputTextureList.push(n),this.frameBufferList.push(s)}i.viewport(0,0,e,r),this.originResolution.width=e,this.originResolution.height=r},e.prototype.resetResolution=function(e,r){var i=this.gl;if(!i)return this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" can not find webgl context");this.outputTextureList.forEach((function(t){i.bindTexture(i.TEXTURE_2D,t),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e,r,0,i.RGBA,i.UNSIGNED_BYTE,null)})),i.viewport(0,0,e,r),this.originResolution.width=e,this.originResolution.height=r},e}();t.default=c},3471:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={VIDEO_EFFECT_NOT_SUPPORT:{code:1103072,message:"not support beauty effect"}}},957:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BeautyEffect=void 0;var i=r(3524);t.BeautyEffect={type:"BeautyEffect",install:function(e,t){for(var r in i.preview)Object.defineProperty(t.prototype,r,{value:i.preview[r],writable:!1});for(var r in i.zegoWebRTC)Object.defineProperty(e.prototype,r,{value:i.zegoWebRTC[r],writable:!1})}}},836:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.logger=e,this.recordedFrameCount=0,this.targetFrameRate=0,this.recordingDuration=0}return e.prototype.startRecordBeautyEffectOutput=function(e){return r(this,void 0,void 0,(function(){var t,r,o,n,s=this;return i(this,(function(i){switch(i.label){case 0:return t=6,this.recordID?(this.logger.warn("zc.p.0.sbe.3 detector is already recording"),[2,{result:!0}]):(r=(new Date).getTime(),this.recordID=r,this.targetFrameRate=e,this.recordedFrameCount=0,this.recordingDuration=t,[4,new Promise((function(e){window.setTimeout(e,1e3*s.recordingDuration)}))]);case 1:return i.sent(),this.recordID!==r?(this.recordID=void 0,[2,{result:!0}]):(this.recordID=void 0,o=this.targetFrameRate*this.recordingDuration,n=this.recordedFrameCount/t,this.recordedFrameCount<o/2?(this.logger.warn("zc.p.0.sbe.3 detect effect overload: current fps: "+n),[2,{result:!1,targetFPS:this.targetFrameRate,currentFPS:n}]):(this.logger.info("zc.p.0.sbe.3 detect effect current fps: "+n),[2,{result:!0}]))}}))}))},e.prototype.stopRecordBeautyEffectOutput=function(){this.recordedFrameCount=this.targetFrameRate=0,this.recordID=void 0},e.prototype.addFrame=function(){this.recordID&&(this.recordedFrameCount+=1)},e}();t.default=o},5683:function(e,t,r){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(r(6976)),a=r(1199),d=function(e){function t(t,r,i){var o=e.call(this,t,r,i)||this;return o.width=r,o.height=i,o.type="LightShader",o.uLightIntensity=null,o.uRedIntensity=null,o.whitenIntensity=.5,o.rosyIntensity=.5,o.program=o.makeProgram(a.lightVS,a.lightFS),o}return o(t,e),t.prototype.setEffectConfig=function(e){isNaN(e.whitenIntensity)||(this.whitenIntensity=e.whitenIntensity/100),isNaN(e.rosyIntensity)||(this.rosyIntensity=e.rosyIntensity/100)},t.prototype.render=function(){var e=this.gl;e.uniform1f(this.uLightIntensity,this.whitenIntensity),e.uniform1f(this.uRedIntensity,this.rosyIntensity)},t.prototype.setConstUniforms=function(){var e=this.program;if(e){var t=this.gl;t.useProgram(e),this.uLightIntensity=t.getUniformLocation(e,"intensity"),t.uniform1f(this.uLightIntensity,this.whitenIntensity),this.uRedIntensity=t.getUniformLocation(e,"rosyIntensity"),t.uniform1f(this.uRedIntensity,this.rosyIntensity);var r=t.getUniformLocation(e,"uPMVMatrix");t.uniformMatrix4fv(r,!1,[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])}},t}(s.default);t.default=d},6976:function(e,t){"use strict";function r(e){for(var t=e,r="",i=0;i<t.length;i++){var o=t.charCodeAt(i),n=o;o>=65&&o<=90&&(n=(o-65-13+26)%26+65),o>=97&&o<=122&&(n=(o-97-13+26)%26+97),r+=String.fromCharCode(n)}return r}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r){this.gl=e,this.width=t,this.height=r,this.type="baseShader",this.program=null,this.program=null}return e.prototype.setEffectConfig=function(e){},e.prototype.setConstUniforms=function(){},e.prototype.resetResolution=function(e,t){this.width=e||this.width,this.height=t||this.height},e.prototype.render=function(){},e.prototype.renderPreTextures=function(e,t,r){},e.prototype.makeProgram=function(e,t){var i=this.gl,o=r(e),n=r(t),s=this.makeShader(o,i.VERTEX_SHADER),a=this.makeShader(n,i.FRAGMENT_SHADER),d=i.createProgram();return i.attachShader(d,s),i.attachShader(d,a),i.linkProgram(d),i.getProgramParameter(d,i.LINK_STATUS),d},e.prototype.makeShader=function(e,t){var r=this.gl,i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS),i},e}();t.default=i},8606:function(e,t,r){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(r(6976)),a=r(1199),d=function(e){function t(t,r,i){var o=e.call(this,t,r,i)||this;return o.width=r,o.height=i,o.type="BlurShader",o.blurXProgram=null,o.blurYProgram=null,o.diffProgram=null,o.uIntensity=null,o.smoothIntensity=.5,o.blurTextureList=[],o.blurBufferList=[],o.blurXProgram=o.makeProgram(a.borderBlurVS,a.borderBlurFS),o.setBorderBlurProgram(o.blurXProgram,1/(r||1),0),o.blurYProgram=o.makeProgram(a.borderBlurVS,a.borderBlurFS),o.setBorderBlurProgram(o.blurYProgram,0,1/(i||1)),o.diffProgram=o.makeProgram(a.diffBlurVS,a.diffBlurFS),o.setDiffBlurProgram(o.diffProgram),o.program=o.makeProgram(a.mixBlurVS,a.mixBlurFS),o.initBlurBuffer(),o}return o(t,e),t.prototype.setEffectConfig=function(e){isNaN(e.smoothIntensity)||(this.smoothIntensity=e.smoothIntensity/100)},t.prototype.render=function(){this.gl.uniform1f(this.uIntensity,this.smoothIntensity)},t.prototype.initBlurBuffer=function(){var e=this.gl;this.blurTextureList=[],this.blurTextureList=[];for(var t=0;t<3;t++){var r=e.createTexture();if(!r)return;e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null);var i=e.createFramebuffer();if(!i)return;e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),this.blurTextureList.push(r),this.blurBufferList.push(i)}},t.prototype.renderPreTextures=function(e,t,r){var i=this,o=this.gl,n=[0,1,0],s=[1,1,2];[this.blurXProgram,this.blurYProgram,this.diffProgram].forEach((function(a,d){if(a){o.useProgram(a);var c=o.getUniformLocation(a,"uTexture");o.uniform1i(c,n[d]);var u=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,new Float32Array(e),o.STATIC_DRAW);var l=o.createBuffer();o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,l),o.bufferData(o.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),o.STATIC_DRAW);var h=o.getAttribLocation(a,"aPosition");o.enableVertexAttribArray(h),o.vertexAttribPointer(h,3,o.FLOAT,!1,0,0);var p=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,p),o.bufferData(o.ARRAY_BUFFER,new Float32Array(r),o.STATIC_DRAW);var g=o.getAttribLocation(a,"aTexCoordinate");o.enableVertexAttribArray(g),o.vertexAttribPointer(g,2,o.FLOAT,!1,0,0),o.bindFramebuffer(o.FRAMEBUFFER,i.blurBufferList[d]),o.clearColor(0,0,0,1),o.clear(o.COLOR_BUFFER_BIT),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0),o.activeTexture(o.TEXTURE0+s[d]),o.bindTexture(o.TEXTURE_2D,i.blurTextureList[d])}}))},t.prototype.setConstUniforms=function(){var e=this.width,t=this.height,r=this.program;if(r){var i=this.gl;i.useProgram(r);var o=i.getUniformLocation(r,"widthOffset");i.uniform1f(o,1/e);var n=i.getUniformLocation(r,"heightOffset");i.uniform1f(n,1/t),this.uIntensity=i.getUniformLocation(r,"blurAlpha"),i.uniform1f(this.uIntensity,this.smoothIntensity);var s=i.getUniformLocation(r,"blurTexture");i.uniform1i(s,1);var a=i.getUniformLocation(r,"blurDiffTexture");i.uniform1i(a,2)}},t.prototype.resetResolution=function(e,t){this.width=e||this.width,this.height=t||this.height},t.prototype.setBorderBlurProgram=function(e,t,r){var i=this.gl;i.useProgram(e);var o=i.getUniformLocation(e,"texBlurWidthOffset");i.uniform1f(o,t);var n=i.getUniformLocation(e,"texBlurHeightOffset");i.uniform1f(n,r)},t.prototype.setDiffBlurProgram=function(e){var t=this.gl;t.useProgram(e);var r=t.getUniformLocation(e,"blurTexture");t.uniform1i(r,1)},t}(s.default);t.default=d},1199:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixBlurFS=t.mixBlurVS=t.diffBlurFS=t.diffBlurVS=t.borderBlurFS=t.borderBlurVS=t.sharpnessFS=t.sharpnessVS=t.lightFS=t.lightVS=void 0,t.lightVS="cerpvfvba uvtuc sybng;\nnggevohgr irp2 nGrkPbbeqvangr;\nnggevohgr irp4 nCbfvgvba;\nhavsbez zng4 hCZIZngevk;\ninelvat irp2 iGrkPbbeq;\nibvq znva() {\n    ty_Cbfvgvba = hCZIZngevk * nCbfvgvba;\n    iGrkPbbeq = nGrkPbbeqvangr;\n}",t.lightFS="cerpvfvba uvtuc sybng;\ninelvat irp2 iGrkPbbeq;\nhavsbez fnzcyre2Q hGrkgher;\nhavsbez sybng vagrafvgl;\nhavsbez sybng ebflVagrafvgl;\nirp3 oevtugarffNaqPbagenfg(irp3 pbybe){\n  sybng v = vagrafvgl * 1.0;\n  sybng CV = 3.1415926;\n  sybng O = 0.12 * v;\n  sybng p = 0.1 * v;\n  sybng x = gna((45. + 44. * p) / 180.0 * CV);\n  pbybe = ((pbybe*255.0 - 127.5 * (1.0 - O)) * x + 127.5 * (1.0 + O)) / 255.0;\n  erghea pbybe;\n}\nibvq znva() {\n  irp4 grkgherPbybe = grkgher2Q(hGrkgher, iGrkPbbeq);\n  grkgherPbybe = irp4(oevtugarffNaqPbagenfg(grkgherPbybe.eto), grkgherPbybe.j);\n  grkgherPbybe.e = zva(grkgherPbybe.e + 0.06 * ebflVagrafvgl, 1.0);\n  ty_SentPbybe = grkgherPbybe;\n}",t.sharpnessVS="\nnggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\nhavsbez sybng vzntrJvqguSnpgbe;\nhavsbez sybng vzntrUrvtugSnpgbe;\nhavsbez sybng funecarff; \ninelvat irp2 iGrkPbbeq;\ninelvat irp2 yrsgGrkgherPbbeqvangr;\ninelvat irp2 evtugGrkgherPbbeqvangr;\ninelvat irp2 gbcGrkgherPbbeqvangr;\ninelvat irp2 obggbzGrkgherPbbeqvangr;\ninelvat sybng pragreZhygvcyvre;\ninelvat sybng rqtrZhygvcyvre;\nibvq znva() {\n  ty_Cbfvgvba = nCbfvgvba;\n  irp2 jvqguFgrc = irp2(vzntrJvqguSnpgbe, 0.0);\n  irp2 urvtugFgrc = irp2(0.0, vzntrUrvtugSnpgbe);\n  iGrkPbbeq = nGrkPbbeqvangr.kl;\n  yrsgGrkgherPbbeqvangr = nGrkPbbeqvangr.kl - jvqguFgrc;\n  evtugGrkgherPbbeqvangr = nGrkPbbeqvangr.kl + jvqguFgrc;\n  gbcGrkgherPbbeqvangr = nGrkPbbeqvangr.kl + urvtugFgrc;\n  obggbzGrkgherPbbeqvangr = nGrkPbbeqvangr.kl - urvtugFgrc;\n  pragreZhygvcyvre = 1.0 + 4.0 * funecarff;\n  rqtrZhygvcyvre = funecarff;\n}\n",t.sharpnessFS="\ncerpvfvba uvtuc sybng;\ninelvat uvtuc irp2 iGrkPbbeq;\ninelvat uvtuc irp2 yrsgGrkgherPbbeqvangr;\ninelvat uvtuc irp2 evtugGrkgherPbbeqvangr;\ninelvat uvtuc irp2 gbcGrkgherPbbeqvangr;\ninelvat uvtuc irp2 obggbzGrkgherPbbeqvangr;\ninelvat uvtuc sybng pragreZhygvcyvre;\ninelvat uvtuc sybng rqtrZhygvcyvre;\nhavsbez fnzcyre2Q hGrkgher;\nibvq znva() {\n  zrqvhzc irp4 nPbybe = grkgher2Q(hGrkgher, iGrkPbbeq);\n  zrqvhzc irp3 grkgherPbybe = nPbybe.eto;\n  zrqvhzc irp3 yrsgGrkgherPbybe = grkgher2Q(hGrkgher, yrsgGrkgherPbbeqvangr).eto;\n  zrqvhzc irp3 evtugGrkgherPbybe = grkgher2Q(hGrkgher, evtugGrkgherPbbeqvangr).eto;\n  zrqvhzc irp3 gbcGrkgherPbybe = grkgher2Q(hGrkgher, gbcGrkgherPbbeqvangr).eto;\n  zrqvhzc irp3 obggbzGrkgherPbybe = grkgher2Q(hGrkgher, obggbzGrkgherPbbeqvangr).eto;\n  ty_SentPbybe = irp4((grkgherPbybe * pragreZhygvcyvre - (yrsgGrkgherPbybe * rqtrZhygvcyvre + evtugGrkgherPbybe * rqtrZhygvcyvre + gbcGrkgherPbybe * rqtrZhygvcyvre + obggbzGrkgherPbybe * rqtrZhygvcyvre)), nPbybe.n);\n}",t.borderBlurVS="nggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\nhavsbez uvtuc sybng grkOyheJvqguBssfrg;\nhavsbez uvtuc sybng grkOyheUrvtugBssfrg;\ninelvat irp2 i_grkpbbeq0;\ninelvat irp4 grkgherFuvsg_1;\ninelvat irp4 grkgherFuvsg_2;\ninelvat irp4 grkgherFuvsg_3;\ninelvat irp4 grkgherFuvsg_4;\nibvq znva()\n{\n  ty_Cbfvgvba = nCbfvgvba;\n  i_grkpbbeq0 = nGrkPbbeqvangr.kl;\n\n  irp2 fvatyrFgrcBssfrg = irp2(grkOyheJvqguBssfrg, grkOyheUrvtugBssfrg)*2.5;\n\n  grkgherFuvsg_1 = irp4(nGrkPbbeqvangr.kl - fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + fvatyrFgrcBssfrg);\n  grkgherFuvsg_2 = irp4(nGrkPbbeqvangr.kl - 2.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 2.0 * fvatyrFgrcBssfrg);\n  grkgherFuvsg_3 = irp4(nGrkPbbeqvangr.kl - 3.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 3.0 * fvatyrFgrcBssfrg);\n  grkgherFuvsg_4 = irp4(nGrkPbbeqvangr.kl - 4.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 4.0 * fvatyrFgrcBssfrg);\n}",t.borderBlurFS="cerpvfvba zrqvhzc sybng;\nhavsbez fnzcyre2Q hGrkgher;\ninelvat irp2 i_grkpbbeq0;\ninelvat uvtuc irp4 grkgherFuvsg_1;\ninelvat uvtuc irp4 grkgherFuvsg_2;\ninelvat uvtuc irp4 grkgherFuvsg_3;\ninelvat uvtuc irp4 grkgherFuvsg_4;\nibvq znva(ibvq) { \n  zrqvhzc irp3 fhz = grkgher2Q(hGrkgher, i_grkpbbeq0).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_1.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_1.mj).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_2.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_2.mj).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_3.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_3.mj).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_4.kl).eto;\n  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_4.mj).eto;\n  ty_SentPbybe = irp4(fhz * 0.1111, 1.0); \n}",t.diffBlurVS="nggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\nhavsbez zng4 hCZIZngevk;\ninelvat irp2 i_grkpbbeq0;\nibvq znva()\n{\n  // ty_Cbfvgvba = hCZIZngevk * nCbfvgvba;\n  ty_Cbfvgvba = nCbfvgvba;\n  i_grkpbbeq0 = nGrkPbbeqvangr.kl;\n}",t.diffBlurFS="cerpvfvba zrqvhzc sybng;\nhavsbez fnzcyre2Q hGrkgher;\ninelvat irp2 i_grkpbbeq0;\nhavsbez fnzcyre2Q oyheGrkgher;\nibvq znva(ibvq) {\n  irp4 vPbybe = grkgher2Q(oyheGrkgher, i_grkpbbeq0);\n  irp4 zrnaPbybe = grkgher2Q(hGrkgher, i_grkpbbeq0);\n  irp4 qvssPbybe = vPbybe - zrnaPbybe;\n  qvssPbybe.e = zva(qvssPbybe.e * 50.0 * qvssPbybe.e, 1.0);\n  qvssPbybe.t = zva(qvssPbybe.t * 50.0 * qvssPbybe.t, 1.0);\n  qvssPbybe.o = zva(qvssPbybe.o * 50.0 * qvssPbybe.o, 1.0);\n  ty_SentPbybe = irp4(qvssPbybe.eto, 1.0);\n}",t.mixBlurVS="\nnggevohgr irp4 nCbfvgvba;\nnggevohgr irp4 nGrkPbbeqvangr;\ninelvat irp2 i_grkpbbeq0;\nhavsbez sybng jvqguBssfrg;\nhavsbez sybng urvtugBssfrg;\ninelvat irp2 grkgherFuvsg_1;\ninelvat irp2 grkgherFuvsg_2;\ninelvat irp2 grkgherFuvsg_3;\ninelvat irp2 grkgherFuvsg_4;\nibvq znva()\n{\n  ty_Cbfvgvba = nCbfvgvba;\n  i_grkpbbeq0 = nGrkPbbeqvangr.kl;\n  grkgherFuvsg_1 = irp2(i_grkpbbeq0 + 0.5 * irp2(jvqguBssfrg,urvtugBssfrg));\n  grkgherFuvsg_2 = irp2(i_grkpbbeq0 + 0.5 * irp2(-jvqguBssfrg,-urvtugBssfrg));\n  grkgherFuvsg_3 = irp2(i_grkpbbeq0 + 0.5 * irp2(-jvqguBssfrg,urvtugBssfrg));\n  grkgherFuvsg_4 = irp2(i_grkpbbeq0 + 0.5 * irp2(jvqguBssfrg,-urvtugBssfrg));\n}\n",t.mixBlurFS="\ncerpvfvba zrqvhzc sybng;\nhavsbez fnzcyre2Q hGrkgher;\ninelvat irp2 i_grkpbbeq0;\nhavsbez fnzcyre2Q oyheGrkgher;\nhavsbez fnzcyre2Q oyheQvssGrkgher;\nhavsbez ybjc sybng oyheNycun;\nibvq znva(ibvq) {\n  ybjc irp4 vPbybe = grkgher2Q(hGrkgher, i_grkpbbeq0);\n  ybjc irp4 zrnaPbybe = grkgher2Q(oyheGrkgher, i_grkpbbeq0);\n  ybjc irp4 inePbybe = grkgher2Q(oyheQvssGrkgher, i_grkpbbeq0);\n  ybjc sybng nycun = oyheNycun * 1.0;\n  ybjc sybng gurgn = 0.1;\n  zrqvhzc sybng c = pynzc((zva(vPbybe.e, zrnaPbybe.e - 0.1) - 0.2) * 4.0, 0.0, 1.0);\n  zrqvhzc sybng zrnaIne = znk(znk(inePbybe.e, inePbybe.t), inePbybe.o);\n  zrqvhzc sybng xZva = 0.1;\n  ybjc irp3 erfhygPbybe;\n  xZva = (1.0 - zrnaIne / (zrnaIne + gurgn)) * c * nycun;\n  erfhygPbybe = zvk(vPbybe.eto, zrnaPbybe.eto, xZva);\n  erfhygPbybe = zvk(vPbybe.eto, erfhygPbybe, zva(1.0,nycun));\n  ty_SentPbybe = irp4(erfhygPbybe,1.0);\n}"},8302:function(e,t,r){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(r(6976)),a=r(1199),d=function(e){function t(t,r,i){var o=e.call(this,t,r,i)||this;return o.width=r,o.height=i,o.type="SharpnessShader",o.uIntensity=null,o.sharpenIntensity=.5,o.program=o.makeProgram(a.sharpnessVS,a.sharpnessFS),o}return o(t,e),t.prototype.setEffectConfig=function(e){isNaN(e.sharpenIntensity)||(this.sharpenIntensity=e.sharpenIntensity/100)},t.prototype.render=function(){this.gl.uniform1f(this.uIntensity,.5*this.sharpenIntensity)},t.prototype.resetResolution=function(e,t){this.width=e||this.width,this.height=t||this.height,this.setConstUniforms()},t.prototype.setConstUniforms=function(){var e=this.width,t=this.height,r=this.program;if(r){var i=this.gl;i.useProgram(r);var o=i.getUniformLocation(r,"imageWidthFactor");i.uniform1f(o,1/e);var n=i.getUniformLocation(r,"imageHeightFactor");i.uniform1f(n,1/t),this.uIntensity=i.getUniformLocation(r,"sharpness"),i.uniform1f(this.uIntensity,.5*this.sharpenIntensity)}},t}(s.default);t.default=d},954:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PUBLISH_SET_BEAUTY_EFFECT=void 0;var s=n(r(836)),a=n(r(3048));t.PUBLISH_SET_BEAUTY_EFFECT="zc.p.0.sbe.1";var d=function(){function e(e,t){var r=this;this.logger=e,this.kind="video",this._enabled=!1,this.lastRenderTime=0,this.isStarting=!1,this.animationFrameId=0,this.backgroundLoop=null,this.eventHandler={visibilitychange:function(){if(document.hidden){var e=function(){r.enabled&&r.videoEl&&r.manager.render(r.videoEl),r.output&&r.output.requestFrame&&r.output.requestFrame(),r.detector.addFrame(),r.backgroundLoop=window.setTimeout(e,Math.floor(1e3/r.fps))};e()}else r.backgroundLoop&&(clearTimeout(r.backgroundLoop),r.backgroundLoop=null)}},this.setInput(t,!0),this.fps=15,this.detector=new s.default(e),this.backgroundLoop&&clearTimeout(this.backgroundLoop),this.backgroundLoop=null,this.lastRenderTime=0,this.manager=new a.default(e)}return Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"output",{get:function(){return this._output},enumerable:!1,configurable:!0}),e.prototype.setBeautyEffectOptions=function(e,r){return void 0===r&&(r={}),i(this,void 0,void 0,(function(){return o(this,(function(i){switch(i.label){case 0:return e&&this.manager.setEffectConfig(r),this.enabled===e?[3,6]:(this.manager.setEnableBeauty(e),this.enabled!==e&&this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" effect enabled "+e+"; options: "+JSON.stringify(r)),this.enabled=e,e?this.input?[4,this.startEffect()]:[3,2]:[3,3]);case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return[4,this.stopEffect()];case 4:i.sent(),i.label=5;case 5:i.label=6;case 6:return[2]}}))}))},e.prototype.startEffect=function(){return i(this,void 0,void 0,(function(){var e,r,n=this;return o(this,(function(s){switch(s.label){case 0:return this.isStarting=!0,this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" call start effect"),this.input?this.input&&this.output&&this.input!==this.output?(this.logger.warn(t.PUBLISH_SET_BEAUTY_EFFECT+" video effect is already enabled"),[2]):[4,this.startWebGLProcessor()]:(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" start effect failed, input track is null"),[2]);case 1:return e=s.sent(),[4,this.updateOutput(e)];case 2:return s.sent(),this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" start effect success"),this.detector.startRecordBeautyEffectOutput(this.fps).then((function(e){if(!e.result&&n.onOverload){var t=e.targetFPS,r=e.currentFPS;n.onOverload({targetFPS:t,currentFPS:r})}})),r=function(){return i(n,void 0,void 0,(function(){var e,t,i;return o(this,(function(o){switch(o.label){case 0:return this.enabled&&(this.animationFrameId=requestAnimationFrame(r)),e=Date.now(),t=1e3/this.fps,(i=this.lastRenderTime?e-this.lastRenderTime:t)>=t?(this.lastRenderTime=e-(i-t),this.videoEl&&this.videoEl.paused&&this.videoEl.play(),this.enabled&&this.videoEl?this.videoEl.videoWidth>6&&this.videoEl.videoHeight>6?[4,this.manager.render(this.videoEl)]:[3,2]:[3,3]):[3,3];case 1:o.sent(),o.label=2;case 2:this.output&&this.output.requestFrame&&this.output.requestFrame(),this.detector.addFrame(),o.label=3;case 3:return[2]}}))}))},this.animationFrameId=requestAnimationFrame(r),document.addEventListener("visibilitychange",this.eventHandler.visibilitychange,!1),this.isStarting=!1,[2]}}))}))},e.prototype.stopEffect=function(){return i(this,void 0,void 0,(function(){var e=this;return o(this,(function(r){switch(r.label){case 0:return this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" call stop effect"),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0),this.detector.stopRecordBeautyEffectOutput(),this.manager.release(),[4,this.updateOutput()];case 1:return r.sent(),void 0===this.removeDomTimer&&(this.removeDomTimer=window.setTimeout((function(){!1===e.enabled&&e.destroy()}),18e4)),document.removeEventListener("visibilitychange",this.eventHandler.visibilitychange),[2]}}))}))},e.prototype.destroy=function(){this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" destroy hidden elements"),this.canvasEl&&this.canvasEl.remove(),this.videoEl&&this.videoEl.remove(),this.videoEl=this.canvasEl=void 0,this.removeDomTimer&&(clearTimeout(this.removeDomTimer),this.removeDomTimer=void 0)},e.prototype.startWebGLProcessor=function(){return i(this,void 0,void 0,(function(){var e,r,i,n,s=this;return o(this,(function(o){switch(o.label){case 0:return this.input?(this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" start webgl processor"),this.removeDomTimer&&(clearTimeout(this.removeDomTimer),this.removeDomTimer=void 0),this.canvasEl&&this.videoEl?[3,2]:(this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" create elements"),this.canvasEl&&(this.canvasEl.remove(),this.canvasEl=void 0),this.videoEl&&(this.videoEl.remove(),this.videoEl=void 0),this.canvasEl=document.createElement("canvas"),this.videoEl=document.createElement("video"),this.videoEl.setAttribute("autoplay",""),this.videoEl.setAttribute("muted",""),this.videoEl.muted=!0,this.videoEl.setAttribute("playsinline",""),this.videoEl.setAttribute("style","display:none"),this.videoEl.srcObject=new MediaStream([this.input]),e=new Promise((function(e){var t=function(){s.videoEl&&s.videoEl.removeEventListener("playing",t),e(void 0)};s.videoEl&&s.videoEl.addEventListener("playing",t)})),this.videoEl.play(),[4,e])):(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" input track is null"),[2]);case 1:o.sent(),o.label=2;case 2:return r=this.input.getSettings(),i=r.width||this.videoEl.videoWidth,n=r.height||this.videoEl.videoHeight,r.frameRate&&this.fps!==r.frameRate&&(this.fps=r.frameRate,this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" set target fps: "+this.fps)),this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" beauty video processor: width "+r.width+" height "+r.height),i&&n?(this.canvasEl.width=i,this.canvasEl.height=n,this.videoEl.setAttribute("width",i.toString()),this.videoEl.setAttribute("height",n.toString()),this.manager.init(i,n,this.canvasEl),[2,this.canvasEl.captureStream().getVideoTracks()[0]]):(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" resolution of track is wrong"),[2])}}))}))},e.prototype.setInput=function(e,r){return void 0===r&&(r=!1),i(this,void 0,void 0,(function(){return o(this,(function(i){switch(i.label){case 0:return e===this.input?[3,6]:e.kind!==this.kind?(this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" kind of track is not video"),[2]):(this.output&&this.input===this.output&&this.logger.error(t.PUBLISH_SET_BEAUTY_EFFECT+" input track is same as effect track"),this.logger.info(t.PUBLISH_SET_BEAUTY_EFFECT+" change input track"),r?this.input?[4,this.removeInput()]:[3,2]:[3,5]);case 1:i.sent(),i.label=2;case 2:return this.input=e,this.enabled&&!this.videoEl?[4,this.startEffect()]:[3,4];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:this.input=e,this.videoEl&&(this.videoEl.srcObject=new MediaStream([this.input])),i.label=6;case 6:return[2]}}))}))},e.prototype.removeInput=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.input=void 0,[4,this.stopEffect()];case 1:return e.sent(),[2]}}))}))},e.prototype.updateOutput=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this.output===e?[3,3]:(this._output=e,this.onOutputChange?[4,this.onOutputChange(this._output)]:[3,2]);case 1:t.sent(),t.label=2;case 2:t.label=3;case 3:return[2]}}))}))},e.prototype.onOutputChange=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(e){return[2]}))}))},e.prototype.onOverload=function(e){},e}();t.default=d},608:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ClientUtil=void 0;var n=r(6706),s=r(3529),a=r(4395),d=function(){function e(){}return e.checkIllegalCharacters=function(e){return/^([0-9a-zA-Z#!$%&()`'+-;<=.>@^_~,\\*])+$/.test(e)&&/^[^:/]*$/g.test(e)},e.isUrl=function(e){return!!(e.startsWith("rtmp://")||e.startsWith("avertp://")||e.startsWith("https://")&&e.endsWith(".flv")||e.startsWith("https://")&&e.endsWith(".m3u8"))},e.registerCallback=function(e,t,r){var i,o;t.success&&(i=t.success,r[e+"SuccessCallback"]=i),t.error&&(o=t.error,r[e+"ErrorCallback"]=o)},e.actionErrorCallback=function(e,t){return t[e+"ErrorCallback"]},e.actionSuccessCallback=function(e,t){return t[e+"SuccessCallback"]},e.logReportCallback=function(t,r,i,o){e.registerCallback(t,{success:function(t,o){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];e.dataReportEvent(r,i,t,o,n)}},o)},e.actionLogReportCallback=function(t,r,i,o,n){e.actionSuccessCallback(t,r)&&e.actionSuccessCallback(t,r)(i,o)},e.getServerError=function(e,t,r){if(t)return{code:e,message:r||"liveroom error"};var i={1:"parse json error.",1001:"login is processing.",1002:"liveroom request error.",1003:"zpush connect fail.",1004:"zpush handshake fail.",1005:"zpush login fail.",1006:"user login state is wrong.",1007:"got no zpush addr",1008:"token error",1009:"dispatch error",1010:"token expired",1011:"token format error",1013:"token03 format error",2002:"biz channel error",1e9:"liveroom cmd error, code:",1000002001:"need relogin",1000002002:"third token auth error",1000002003:"token nonce type should be int64",1000002004:"token appid type  should be uint32",1000002005:"token timeout type should be int64",1000002006:"token user_id type should be string",1000002007:"token room_id type should be string",1000002008:"token format error",1000002009:"token privilege type should be map",1000002010:"token expire_time type should be int64",1000002011:"token user_id type should be string",1000002012:"token not exist",1000002013:"token update error",1000002014:"token not need to check"};if(0===e)return{code:0,message:""};var o={code:0,message:"liveroom cmd error"};if(o.code=e,e>1e9){var n=i[e];o.message=n?"liveroom cmd error, code: "+e+", message: "+n:i[1e9]+e}else o.message=i[e]?i[e]+" code:"+e:"unknown error code:"+e;return o},e.unregisterCallback=function(e,t){delete t[e+"SuccessCallback"],delete t[e+"ErrorCallback"]},e.decodeServerError=function(e,t){var r={code:-1,message:"server error"};return e>1e9&&(r.code=e-1e9+52e6),t&&(r.message=t),r},e.getLiveRoomError=function(e,t){var r={1016:"MULTI_ROOM_UNABLE",1105:"ROOM_MAX_USER_COUNT",1012:"PUBLISHER_ERROR_REPETITIVE_PUBLISH_STREAM",2002:"TOKEN_ERROR",2003:"ROOM_ERROR_LOGIN_TIMEOUT",2010:"TOKEN_ERROR",5022:"ROOM_COUNT_EXCEED"};return t?e>2e5&&e<3e5?r[e-2e5]:e<2e5?{50116:"TOKEN_ERROR",50117:"TOKEN_EXPIRED",50118:"TOKEN_ERROR",50119:"TOKEN_ERROR",50120:"TOKEN_ERROR",50121:"TOKEN_ERROR",50122:"TOKEN_ERROR",50123:"TOKEN_EXPIRED",50124:"TOKEN_ERROR",50125:"TOKEN_ERROR",50126:"TOKEN_ERROR",50127:"TOKEN_ERROR",50128:"TOKEN_ERROR"}[e]||r[e]||"ROOM_INNER_ERROR":r[e]||"ROOM_INNER_ERROR":e>1e9?r[e-1e9]||"":{1:"PARSE_JSON_ERROR",1001:"LOGIN_PROCESSING",1002:"LIVEROMM_REQUEST_ERROR",1003:"ZPUSH_REQUEST_FAIL",1004:"ZPUSH_REQUEST_FAIL",1005:"ZPUSH_REQUEST_FAIL",1006:"LOGIN_STATE_WRONG",1007:"ZPUSH_REQUEST_FAIL",1008:"TOKEN_ERROR",1009:"DIAPATCH_ERROR",1010:"TOKEN_EXPIRED",1011:"TOKEN_ERROR",1012:"SUBCMD_ERROR",1101:"ZEGO_AUTH_ERROR",2001:"BIZ_CHANNEL_ERROR",2002:"BIZ_CHANNEL_ERROR"}[e]||"ROOM_INNER_ERROR"},e.getKickoutError=function(e){var t={};switch(e){case 1:t.code=63000001,t.message="zpush multiple login kickout",t.name="MULTIPLE_LOGIN_KICKOUT";break;case 2:t.code=63000002,t.message="zpush manual kickout",t.name="MANUAL_KICKOUT";break;case 3:t.code=63000003,t.message="kickout reason = "+e;break;case 4:t.code=63000004,t.message="zpush multiple login kickout",t.name="MULTIPLE_LOGIN_KICKOUT";break;case 5:t.code=63000005,t.message="zpush token expired",t.name="TOKEN_EXPIRED";break;default:t.code=e,t.message="kickout reason = "+e}return t},e.dataReportEvent=function(e,t,r,i,o){switch(r){case"eventStart":e.eventStart(t,i);break;case"eventEndWithMsgInfo":e.eventEndWithMsgInfo(t,i,o[0]);break;case"addEventMsg":e.addEventMsg(t,i,o[0],o[1]);break;case"addEvent":e.addEvent(t,i);break;case"eventEnd":e.eventEnd(t,i);break;case"addMsgInfo":e.addMsgInfo(t,o[0])}},e.isKeepTryLogin=function(e){switch(e){case 1002:case 1003:return!0;default:return!1}},e.mergeStreamList=function(e,t,r,i){var o,n=[],s=[],a=[];r||(r=[]);for(var d=0;d<r.length;d++)if(r[d].anchor_id_name!=e&&r[d].id_name!=e&&r[d].user_id!=e){o=!1;for(var c=0;c<t.length;c++)if(r[d].stream_id===t[c].stream_id){r[d].extra_info!==t[c].extra_info&&a.push(r[d]),o=!0;break}o||n.push(r[d])}for(var u=0;u<t.length;u++){o=!1;for(var l=0;l<r.length;l++)if(t[u].stream_id===r[l].stream_id){o=!0;break}o||s.push(t[u])}for(t.splice(0),d=0;d<r.length;d++)t.push(r[d]);i(n,s,a)},e.checkInteger=function(e,t){return 0==t?"number"==typeof e&&e%1==0&&e>=0:"number"==typeof e&&e%1==0&&e>0},e.checkValidNumber=function(e,t,r){return t=t||1,r=r||1e4,"number"==typeof e&&e%1==0&&e>=t&&e<=r},e.uuid=function(e,t){var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(t=t||i.length,e)for(r=0;r<e;r++)o[r]=i[0|Math.random()*t];else{var n=void 0;for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",r=0;r<36;r++)o[r]||(n=0|16*Math.random(),o[r]=i[19==r?3&n|8:n])}return o.join("")},e.supportDetection=function(e,t,r,n){return i(this,void 0,void 0,(function(){var i,s,a,d,c,u,l,h;return o(this,(function(o){switch(o.label){case 0:return i={webRTC:!1,customCapture:!1,camera:!1,microphone:!1,videoCodec:{H264:!1,H265:!1,VP8:!1,VP9:!1},screenSharing:e,errInfo:{}},n&&"screenSharing"===n?(t({result:e,errInfo:i.errInfo}),[2]):n&&"customCapture"!==n||(((s=document.createElement("video")).captureStream||s.mozCaptureStream)&&(i.customCapture=!0),"customCapture"!==n)?(a=navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,d="https:"!==window.location.protocol&&"file:"!==window.location.protocol&&-1==window.location.hostname.indexOf("127.0.0.1")&&-1==window.location.hostname.indexOf("localhost"),n&&"camera"!==n&&"microphone"!==n?[3,9]:a?d?(i.camera=!1,console.error("webrtc requires https or localhost"),[3,9]):[3,1]:[3,9]):(t({result:i.customCapture,errInfo:i.errInfo}),[2]);case 1:if(n&&"camera"!==n)return[3,5];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,navigator.mediaDevices.getUserMedia({video:!0})];case 3:return(c=o.sent())&&(i.camera=!0)&&c.getTracks().forEach((function(e){return e.stop()})),[3,5];case 4:return u=o.sent(),i.errInfo.camera={name:u.name,message:u.message},console.error("camera devices detect error: ",u.name,u.message),[3,5];case 5:if(n&&"microphone"!==n)return[3,9];o.label=6;case 6:return o.trys.push([6,8,,9]),[4,navigator.mediaDevices.getUserMedia({audio:!0})];case 7:return(l=o.sent())&&(i.microphone=!0)&&l.getTracks().forEach((function(e){return e.stop()})),[3,9];case 8:return h=o.sent(),i.errInfo.microphone={name:h.name,message:h.message},console.error("microphone devices detect error: ",h.name,h.message),[3,9];case 9:return"camera"===n||"microphone"===n?(t({result:i[n],errInfo:i.errInfo}),[2]):(this.supportVideoCodeType((function(e,r){n||(i.videoCodec.H264=e.H264,i.videoCodec.H265=e.H265,i.videoCodec.VP8=e.VP8,i.videoCodec.VP9=e.VP9,i.webRTC=e.webRTC),r&&("string"==typeof r?i.errInfo.extendedDate=r:i.errInfo.webRTC={name:r.name,message:r.message},console.error("videoCodec detect error: "+r)),t&&t(n?{result:e[n],errInfo:i.errInfo}:i)}),r,n),[2])}}))}))},e.getDevices=function(e,t){void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then((function(t){for(var r=[],i=[],o=[],n=0;n<t.length;n++){var s=t[n];"audioinput"===s.kind&&r.push({deviceName:s.label,deviceID:s.deviceId}),"audiooutput"===s.kind&&i.push({deviceName:s.label,deviceID:s.deviceId}),"videoinput"===s.kind&&o.push({deviceName:s.label,deviceID:s.deviceId})}e&&e({microphones:r,speakers:i,cameras:o})})).catch((function(e){console.error("enumerate devices wrong "+e),t&&t(s.ZegoRTCLogEvent.kZegoTaskEnumDevices.error.kEnumDevicesError)})):t&&t(s.ZegoRTCLogEvent.kZegoTaskEnumDevices.error.kBrowserNotSupportError)},e.compareVersion=function(e,t){e=e.split("."),t=t.split(".");for(var r=Math.max(e.length,t.length);e.length<r;)e.push("0");for(;t.length<r;)t.push("0");for(var i=0;i<r;i++){var o=parseInt(e[i]),n=parseInt(t[i]);if(o>n)return 1;if(o<n)return-1}return 0},e.isSupportLive=function(e,t){var r=wx.getSystemInfoSync().SDKVersion,i={code:0,msg:""};this.compareVersion(r,"1.7.0")<0&&(i={code:10001,msg:""},e&&e(i)),wx.getSetting({success:function(t){var r=t.authSetting;r["scope.camera"]&&r["scope.record"]||(i={code:10002,msg:""}),e&&e(i)},fail:function(e){console.error("get setting error",e),t&&t(e)}})},e.supportVideoCodeType=function(e,t,r){return i(this,void 0,void 0,(function(){var i,n,s,d,c,u,l,h,p,g;return o(this,(function(o){switch(o.label){case 0:return i={webRTC:!1,H264:!1,VP8:!1,VP9:!1,H265:!1},r?1!==t||"VP8"!==r&&"H264"!==r?[3,2]:[4,(g=new a.CheckModule).checkSupportByType(r)]:[3,2];case 1:return"boolean"==typeof(n=o.sent())?(i[r]=n,[2,e(i)]):(i[r]=!1,[2,e(i,n)]);case 2:if("webRTC"!==r&&1!==t)return[3,7];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,(new RTCPeerConnection).createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})];case 4:return o.sent(),i.webRTC=!0,[3,6];case 5:return s=o.sent(),e&&e(i,s),[3,6];case 6:if("webRTC"===r)return[2,e(i)];o.label=7;case 7:if(1===t){for(d="",u=[],l=0,h=c=["VP8","H264"];l<h.length;l++)p=h[l],g=new a.CheckModule,u.push(g.checkSupportByType(p));return Promise.all(u).then((function(t){t.forEach((function(e,t){"boolean"==typeof e?i[c[t]]=!0:(i[c[t]]=!1,d=e)})),d?e(i,d):e(i)})),[2]}try{(new RTCPeerConnection).createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then((function(t){if(i.webRTC=!0,t&&t.sdp){var o=t.sdp.split("\r\n");if(i.H264=o.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("H264/")>-1})),"H264"===r)return e(i);if(i.VP8=o.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("VP8/")>-1})),"VP8"===r)return e(i);i.VP9=o.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("VP9/")>-1})),i.H265=o.some((function(e){return e.startsWith("a=rtpmap:")&&e.indexOf("H265/")>-1})),e&&e(i)}}))}catch(t){e&&e(i,t)}return[2]}}))}))},e.getPublisherStateType=function(e){return 0==e||1==e?0==e?"PUBLISHING":"NO_PUBLISH":"PUBLISH_REQUESTING"},e.getPlayerStateType=function(e){return 0==e||1==e?0==e?"PLAYING":"NO_PLAY":"PLAY_REQUESTING"},e.getSteamUpdateType=function(e){return 0==e?"DELETE":"ADD"},e.checkScreenParams=function(t,r){if("object"==typeof t&&void 0!==t.videoQuality&&!e.checkInteger(t.videoQuality))return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," videoQuality must be integer number"),!1;if("object"==typeof t&&void 0!==t.sourceID&&"string"!=typeof t.sourceID)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," sourceID must be string"),!1;if("object"==typeof t&&4===t.videoQuality){if(void 0===t.bitRate)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate is required when videoQuality is 4"),!1;if(!e.checkInteger(t.bitRate))return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be integer number"),!1;if(t.bitRate>10240)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate cannot greater than 10 Mbps"),!1;if(void 0===t.frameRate)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," frameRate is required when videoQuality is 4"),!1;if(!e.checkInteger(t.frameRate))return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," frameRate must be integer number"),!1;if(void 0===t.width)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," width is required when videoQuality is 4"),!1;if(!e.checkInteger(t.width))return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," width must be integer number"),!1;if(void 0===t.height)return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," height is required when videoQuality is 4"),!1;if(!e.checkInteger(t.height))return r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," height must be integer number"),!1}return!0},e.checkCameraParams=function(t,r){return t.width&&e.checkValidNumber(t.width)?t.height&&e.checkValidNumber(t.height)?t.frameRate&&e.checkValidNumber(t.frameRate)?!(!t.bitRate||!e.checkValidNumber(t.bitRate))||(r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be integer number"),!1):(r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," frameRate must be integer number"),!1):(r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," height must be integer number"),!1):(r(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," width must be integer number"),!1)},e.isParamEmpty=function(e){return null!=e&&""!==e},e.isTypeString=function(e){return"string"==typeof e},e.isTooLong=function(e,t){return!(e.length>=t)},e.isReDispatch=function(e){var t=e.message.match(/action:(\d+)/),r=t?Number(t[1]):NaN;return[s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kTTLOverTimeError,s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kClientIPChangedError,s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kTTLOverTimeError,s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kClientIPChangedError].includes(e)||[6].includes(r)},e.arrAvg=function(e,t,r){return e.push(t),e.length>r&&e.shift(),e.reduce((function(e,t){return e+t}))/e.length},e.getNetQuality=function(e,t,r){return void 0!==r?.15*this.calcQualityOfJitter(r)+.85*Math.min(this.calcQualityOfRtt(e),this.calcQualityOfLostRate(t,!1)):Math.min(this.calcQualityOfRtt(e),this.calcQualityOfLostRate(t,!0))},e.calcQualityOfRtt=function(e){return e<600?97-Math.pow(.09*e,1.1):18*Math.exp(.002*(600-e))},e.calcQualityOfJitter=function(e){return e<=50?98-Math.pow(e,1.15):n.QUALITY_CONSTANT.PoorMinQuality},e.calcQualityOfLostRate=function(e,t){if(t){var r=e;return r<=55?99-Math.pow(.8*r,1.18):n.QUALITY_CONSTANT.PoorMinQuality}var i=100*e;return i<=40?96-Math.pow(i,1.22):n.QUALITY_CONSTANT.PoorMinQuality},e.quality2QualityGrade=function(e){return n.QualityGrade.Unknown,e>=n.QUALITY_CONSTANT.ExcellentMinQuality?n.QualityGrade.Excellent:e>=n.QUALITY_CONSTANT.GoodMinQuality?n.QualityGrade.Good:e>=n.QUALITY_CONSTANT.MiddleMinQuality?n.QualityGrade.Middle:e>=n.QUALITY_CONSTANT.PoorMinQuality?n.QualityGrade.Poor:n.QualityGrade.Die},e.checkAudioTrackIsActive=function(e){return!!e.enabled},e.checkVideoTrackIsActive=function(e){return!!e.enabled},e.isSupportEncodedTransforms=function(){var e=!!window.RTCRtpScriptTransform;if(!e){var t=!!RTCRtpSender.prototype.createEncodedStreams,r=!1;try{new ReadableStream,r=!0}catch(e){console.error("Transferable streams are not supported.")}e=t&&r}return e},e.stringToUint8Array=function(e){for(var t=[],r=0,i=e.length;r<i;++r)t.push(e.charCodeAt(r));return new Uint8Array(t)},e.Uint8ArrayToString=function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e.decodeString=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(String,Array.from(e))))},e.encodeString=function(e){return Uint8Array.from(Array.from(unescape(encodeURIComponent(e))).map((function(e){return e.charCodeAt(0)})))},e.base64ToUint8Array=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(t),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i},e.uint8arrayToBase64=function(e){for(var t,r=0,i=e.length,o="";r<i;)t=e.subarray(r,Math.min(r+32768,i)),o+=String.fromCharCode.apply(null,Array.from(t)),r+=32768;return btoa(o)},e}();t.ClientUtil=d},7646:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.H264Parser=void 0;var r=function(){function e(e){this.view=e,this.offset=0,this.current_start_code_size=0,this.current_nalu_start=0,this.current_nalu_size=0,this.start_code_size=0,this.nalu_start=0,this.left_size=0,this.nalu_size=0,this.left_size=e.byteLength}return e.prototype.FindStartCode=function(){var e=this.view.byteLength-this.offset;for(this.current_start_code_size=0,this.current_nalu_start=-1;e>=3;){if(0==this.view.getUint8(this.offset)&&0==this.view.getUint8(this.offset+1)&&1==this.view.getUint8(this.offset+2))return this.current_start_code_size=3,this.current_nalu_start=this.offset,this.offset-1>=0&&0==this.view.getUint8(this.offset-1)&&(++this.current_start_code_size,--this.current_nalu_start),this.offset+=3,!0;--e,++this.offset}return!1},e.prototype.FindNalu=function(){return this.start_code_size=0,this.nalu_start=0,this.nalu_size=0,!(this.offset>=this.view.byteLength||!this.FindStartCode()||(this.start_code_size=this.current_start_code_size,this.nalu_start=this.current_nalu_start,0))},e.prototype.NextNalu=function(e){return this.start_code_size=0,this.nalu_start=0,this.nalu_size=0,!(this.offset>=this.view.byteLength)&&(!!this.FindStartCode()&&(this.start_code_size=this.current_start_code_size,this.nalu_start=this.current_nalu_start,!(!e||6==(31&this.view.getUint8(this.nalu_start+this.start_code_size)))||(this.FindStartCode()?(this.offset=this.current_nalu_start,this.nalu_size=this.current_nalu_start-this.nalu_start,!0):(this.nalu_size=this.view.byteLength-this.nalu_start,!0))))},e}();t.H264Parser=r},6502:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryHandler=void 0;var r=function(){function e(){this.RETRY_MAX_TIME=300,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryStartTime=0,this.retryActiveCount=1,this.isOverTime=!1}return e.prototype.init=function(e,t,r,i){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,"number"==typeof e&&e<3600&&(this.RETRY_MAX_TIME=e),"number"==typeof t&&(this.RETRY_START_TIME_INTERVAL=t),"number"==typeof r&&(this.RETRY_CONTINUE_COUNT=r),"number"==typeof i&&(this.RETRY_MAX_TIME_INTERVAL=i)},e.prototype.invalid=function(){this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.startRetryTimer&&clearTimeout(this.startRetryTimer),this.startRetryTimer=null,this.retryStartTime=0,this.retryActiveCount=1},e.prototype.isRetrying=function(){return null!==this.retryTimer||null!==this.startRetryTimer||null!==this.maxTimer},e}();t.RetryHandler=r},4767:function(e,t){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<r;t++)for(var n=arguments[t],s=0,a=n.length;s<a;s++,o++)i[o]=n[s];return i};Object.defineProperty(t,"__esModule",{value:!0}),t.SdpUtil=void 0;var i=function(){function e(){}return e.zegoSdp=function(e){var t=e.split("\r\n"),i=[],o=[];t.forEach((function(e){var t=e.match(/a=rtpmap:(\d+)\s+((H264\/90000)|(opus\/48000\/2))/);t&&t[1]&&t[2]&&("H264/90000"===t[2]&&i.push(t[1]),"opus/48000/2"===t[2]&&o.push(t[1]))}));var n=[];return t.map((function(e){var t=!0,s=e.match(/((a=rtcp-fb:)|(a=rtpmap:)|(a=fmtp:))(\d+)/);if(s&&s[5]&&(r(i,o).some((function(e){return e==s[5]}))||(t=!1)),e.indexOf("m=video")>-1){var a=e.split(" ");e=r([a[0],a[1],a[2]],i).join(" ")}else e.indexOf("m=audio")>-1&&(a=e.split(" "),e=r([a[0],a[1],a[2]],o).join(" "));t&&n.push(e)})),n.join("\r\n")},e.getSDPByVideDecodeType=function(e,t,i){var o={str:"",arr:[],obj:{H264:[],H265:[],VP8:[],VP9:[],OTHER:[]}};if(!e.includes("m=video"))return e;var n=/m=video.+/.exec(e)[0];n=n.match(/[\s|\d]+/g)[1].replace(" ",""),o.str=n,o.arr=o.str.split(" "),o.arr.forEach((function(t){var r=new RegExp("a=rtpmap:"+t+".+").exec(e)[0];r.includes("H264")?o.obj.H264.push(t):r.includes("H265")?o.obj.H265.push(t):r.includes("VP8")?o.obj.VP8.push(t):r.includes("VP9")?o.obj.VP9.push(t):o.obj.OTHER.push(t)})),o.obj.OTHER.forEach((function(t){var r=new RegExp("a=fmtp:"+t+".+apt=(\\d+)").exec(e),i=r&&r[1];i&&(o.obj.H264.includes(i)?o.obj.H264.push(t):o.obj.H265.includes(i)?o.obj.H265.push(t):o.obj.VP8.includes(i)?o.obj.VP8.push(t):o.obj.VP9.includes(i)&&o.obj.VP9.push(t))}));var s=[];if("VP9"===t?s=r(o.obj.H265,o.obj.H264,o.obj.VP8):"VP8"===t?s=r(o.obj.H265,o.obj.H264,o.obj.VP9):"H264"===t?s=r(o.obj.H265,o.obj.VP8,o.obj.VP9):"H265"===t&&(s=r(o.obj.VP8,o.obj.H264,o.obj.VP9)),i&&"H264"==t){var a=[];o.obj.H264.forEach((function(t){var r=new RegExp("a=fmtp:"+t+".+\\s\\n","g").exec(e);(null==r?void 0:r.find((function(e){return e.includes("profile-level-id=42e01f")})))||a.push(t)})),a.length==o.obj.H264.length&&(a=[]),s=s.concat(a)}return s.forEach((function(t){var r=o.arr.indexOf(t);o.arr.splice(r,1);var i=new RegExp("a=rtpmap:"+t+".+\\s\\n","g"),n=new RegExp("a=rtcp-fb:"+t+".+\\s\\n","g"),s=new RegExp("a=fmtp:"+t+".+\\s\\n","g");e=(e=(e=e.replace(i,"")).replace(n,"")).replace(s,"")})),e=e.replace(n,o.arr.join(" "))},e}();t.SdpUtil=i},5321:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return o(t,e),t},s=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoWebRTC=void 0;var d=r(6706),c=r(608),u=r(7325),l=r(1089),h=r(3529),p=r(908),g=r(3409),f=r(7560),_=r(1547),m=n(r(5515)),v=r(3770),E=r(4865),S=r(361),T=r(5019),C=r(9595),y=r(9595),R=function(){function e(e,t,r,i){var o=this;void 0===i&&(i=0),this.mediaEleSources=[],this.logger=e,this.dataReport=t,this.ac=new("undefined"!=typeof webkitAudioContext?webkitAudioContext:AudioContext),this.ac.addEventListener("statechange",(function(){"suspended"===o.ac.state&&o.ac.resume()})),this.checkAudioContext(),this.stateCenter=new u.StateCenter(this.logger,this.dataReport),this.stateCenter.clientType="webrtc",this.stateCenter.type=2===i?"PRIVATE":"PUBLIC",this.RTM=r,this.streamCenter=new g.ZegoStreamCenterWeb(this.logger,this.stateCenter,this.dataReport,this.RTM,this.ac,this.mediaEleSources),this.rtcModules=new p.RTCModules(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.RTM,this.ac),this.stateCenter.getSeq=d.getSeq,this.stateCenter.getReportSeq=d.getReportSeq,this.stateCenter.networkState=navigator?navigator.onLine?d.ENUM_NETWORK_STATE.online:d.ENUM_NETWORK_STATE.offline:d.ENUM_NETWORK_STATE.online,this.stateCenter.browser=m.browserDetails.browser,this.stateCenter.settingConfig=new y.ZegoSettingConfig,this.RTM.cloudSetting.setEnvVariable("sdk_version",d.PROTO_VERSION),this.RTM.cloudSetting.getSettingCache(C.RTC).then((function(e){o.logger.info(l.ZEGO_WEBRTC_ACTION.CONSTRUCTOR+" streamConfig "+JSON.stringify(e));var t=d.getReportSeq();o.dataReport.newReport(t,h.ZegoRTCLogEvent.kZegoTaskCloudSettingCache.event),o.dataReport.addMsgInfo(t,{files:[{name:C.RTC,content:null==e?void 0:e.setting,versions:null==e?void 0:e.versions}]}),o.dataReport.uploadReport(t),o.stateCenter.settingConfig.setSetting(null==e?void 0:e.setting)})).catch((function(e){o.logger.warn(l.ZEGO_WEBRTC_ACTION.CONSTRUCTOR+" streamConfig "+JSON.stringify(e))}))}return e.prototype.checkAudioContext=function(){var e=this;if(this.ac&&"suspended"===this.ac.state){var t=function(){e.ac.resume(),window.removeEventListener("click",t),window.removeEventListener("touchstart",t)};window.addEventListener("click",t),window.addEventListener("touchstart",t)}},e.prototype.mutePublishStreamVideo=function(e,t,r){return!1},e.prototype.mutePublishStreamAudio=function(e,t){return!1},e.prototype.mutePlayStreamVideo=function(e,t){return new Promise((function(e,t){console.error("should install advanced module"),e(!1)}))},e.prototype.mutePlayStreamAudio=function(e,t){return new Promise((function(e,t){console.error("should install advanced module"),e(!1)}))},e.prototype.muteMicrophone=function(e){return!1},e.prototype.isMicrophoneMuted=function(){return!this.streamCenter.isMicEnabled},e.prototype.setAudioOutput=function(e,t){return this.logger.info(l.ZEGO_WEBRTC_ACTION.SET_AUDIO_OUTPUT+" call"),"string"!=typeof t?(this.logger.error("audiooutput is not string"),!1):this.rtcModules.playModule.setStreamAudioOutput(e,t)},e.prototype.setCustomSignalUrl=function(e){if(this.logger.info(l.ZEGO_WEBRTC_ACTION.SET_CUSTOM_SIGNAL_URL+" call: "+e),e&&0!=e.length){var t=!0;e.forEach((function(e){return 0!=e.indexOf("wss://")&&(t=!1)})),t?this.stateCenter.customUrl=e:this.logger.error(l.ZEGO_WEBRTC_ACTION.SET_CUSTOM_SIGNAL_URL+" url is not correct")}else this.logger.error(l.ZEGO_WEBRTC_ACTION.SET_CUSTOM_SIGNAL_URL+" param error")},e.prototype.setGWNode=function(e){"string"==typeof e&&e.length>0&&(this.streamCenter.gwNode=e)},e.prototype.setQualityMonitorCycle=function(e){return"number"==typeof e&&e>=1e3?(this.streamCenter.setQualityMonitorCycle(e),!0):(this.logger.error("zc.sqmc.0 time must be number and bigger than 1000"),!1)},e.prototype.startPlayingStream=function(e,t,r){return this.logger.info(l.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM+" call by user"),this.rtcModules.playModule.startPlayingStream(e,t,r)},e.prototype.stopPlayingStream=function(e){this.logger.info(l.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" call by user"),this.rtcModules.playModule.stopPlayingStream(e)},e.prototype.setPlayAccelerate=function(e){this.stateCenter.playAccelerate=e},e.prototype.setTurnOverTcpOnly=function(e){this.logger.info(l.ZEGO_WEBRTC_ACTION.SET_TURN_OVER_TCP_ONLY+" call "+e),"boolean"==typeof e?this.stateCenter.turnOverTcpOnly=e:this.logger.error("zc.p.stoto.0 param must be param")},e.prototype.createStream=function(e){return this.rtcModules.publishModule.createStream(e)},e.prototype.destroyStream=function(e){this.rtcModules.publishModule.destroyStream(e)},e.prototype.startPublishingStream=function(e,t,r,i){return this.logger.info(l.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" call by user"),this.rtcModules.publishModule.startPublishingStream(e,t,r,i)},e.prototype.activateSEIInsert=function(e){return console.error("should install advanced module"),!1},e.prototype.setSEIConfig=function(e){this.stateCenter.seiConfig=e},e.prototype.sendSEI=function(e,t){return this.rtcModules.publishModule.sendSEI(e,t)},e.prototype.stopPublishingStream=function(e){return this.logger.info(l.ZEGO_WEBRTC_ACTION.STOP_PUBLISHING_STREAM+" call by user"),this.rtcModules.publishModule.stopPublishingStream(e)},e.prototype.setVideoConfig=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.setVideoConfig(e,t):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.setAudioConfig=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.setAudioConfig(e,t):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.replaceTrack=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.replaceTrack(e,t):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.preloadEffect=function(e,t,r){void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.preloadEffect(e,t,r):console.error("")},e.prototype.getEffectDuration=function(e){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.getEffectDuration(e):(console.error(""),0)},e.prototype.getEffectCurrentProgress=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.getEffectProgress(e,t):(console.error(""),0)},e.prototype.seekAudioEffect=function(e,t,r){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.seekAudioEffect(e,t,r):(console.error(""),!1)},e.prototype.playEffect=function(e,t,r){void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.playEffect(e,t,r):console.error("")},e.prototype.pauseEffect=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.pauseEffect(e,t):(console.error(""),!1)},e.prototype.resumeEffect=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.resumeEffect(e,t):(console.error(""),!1)},e.prototype.stopEffect=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopEffect(e,t):(console.error(""),!1)},e.prototype.unloadEffect=function(e){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.unloadEffect(e):(console.error(""),!1)},e.prototype.setEffectVolume=function(e,t,r){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.setEffectVolume(e,t,r):(console.error(""),!1)},e.prototype.startMixingAudio=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.startMixingAudio(e,t):(console.error(""),!1)},e.prototype.stopMixingAudio=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopMixingAudio(e,t):(console.error(""),!1)},e.prototype.mixingBuffer=function(e,t,r,i){void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.mixingBuffer(e,t,r,i):console.error("")},e.prototype.stopMixingBuffer=function(e,t){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopMixingBuffer(e,t):(console.error(""),!1)},e.prototype.setMixingAudioVolume=function(e,t,r){return void 0!==this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.setMixingAudioVolume(e,t,r):(console.error(""),!1)},e.prototype.checkSystemRequirements=function(t,r){var i=this,o=navigator&&navigator.mediaDevices&&(e.screenShotReady||"getDisplayMedia"in navigator.mediaDevices);return this.logger.info(l.ZEGO_WEBRTC_ACTION.CHECK_SUPPORT+" call"+navigator.userAgent),new Promise((function(e){var n=d.getReportSeq();i.dataReport.newReport(n,h.ZegoRTCLogEvent.kZegoTaskCheckSystemRequirements.event);var s=r||"all",a=function(t){i.dataReport.addMsgInfo(n,{capability:h.ZegoRTCLogEvent.kZegoTaskCheckSystemRequirements.capability(t)}),i.dataReport.uploadReport(n);var r=i.stateCenter.checkList.indexOf(s);i.stateCenter.checkList.splice(r,1),e(t)};return["webRTC","customCapture","camera","microphone","screenSharing","H264","VP8","all"].includes(s)&&[0,1].includes(t)?i.stateCenter.checkList.includes(s)||i.stateCenter.checkList.includes("all")?a({result:!1,errInfo:{extendedDate:"The last test of the same type has not returned a result "}}):(i.stateCenter.checkList.push(s),void c.ClientUtil.supportDetection(o,a,t,r)):a({result:!1,errInfo:{extendedDate:"param error"}})}))},e.prototype.enumDevices=function(e,t){return s(this,void 0,void 0,(function(){var r,i,o,n,s,c,u,l,p,g,f,_,m,v,E=this;return a(this,(function(a){switch(a.label){case 0:return this.logger.info("zc.ed.0 call"),r=function(){return new Promise((function(e,t){var r=d.getReportSeq();E.dataReport.newReport(r,h.ZegoRTCLogEvent.kZegoTaskEnumDevices.event),E.rtcModules.publishModule.recordDevices((function(t){var i=[],o=!0,n=!0;t.cameras.forEach((function(e){""===e.deviceID&&(o=!1),i.push({device:e.deviceName,type:0})})),t.microphones.forEach((function(e){""===e.deviceID&&(n=!1),i.push({device:e.deviceName,type:1})})),t.speakers.forEach((function(e){return i.push({device:e.deviceName,type:2})})),E.dataReport.addMsgInfo(r,{dev_list:h.ZegoRTCLogEvent.kZegoTaskEnumDevices.dev_list(i)}),E.dataReport.uploadReport(r),e({devices:t,enableCamera:o,enableMic:n})}),(function(e){E.dataReport.addMsgInfo(r,e),E.dataReport.uploadReport(r),t(e)}))}))},[4,r()];case 1:return i=a.sent(),o=i.devices,n=i.enableCamera,s=i.enableMic,c=o,e?(this.logger.info("zc.ed.0 check permission"),u={video:!0,audio:!0},"videoinput"===t?u.audio=!1:"audioinput"!==t&&"audiooutput"!==t||(u.video=!1),l=u.video&&!n,p=u.audio&&!s,l||p?(this.logger.info("zc.ed.0 need to get device permission. needCamera: "+l+", needMic: "+p),[4,navigator.mediaDevices.getUserMedia(u).catch((function(){}))]):[3,4]):[3,4];case 2:return(g=a.sent())&&g.getTracks().forEach((function(e){e.stop()})),[4,r()];case 3:f=a.sent(),_=f.devices,m=f.enableCamera,v=f.enableMic,u.video&&!m&&this.logger.warn("zc.ed.0 get video device permission failed."),u.audio&&!v&&this.logger.warn("zc.ed.0 get audio device permission failed."),c=_,a.label=4;case 4:return[2,c]}}))}))},e.prototype.getCameras=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.enumDevices(!0,"videoinput")];case 1:return[2,e.sent().cameras]}}))}))},e.prototype.getMicrophones=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.enumDevices(!0,"audioinput")];case 1:return[2,e.sent().microphones]}}))}))},e.prototype.getSpeakers=function(){return s(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.enumDevices(!0,"audiooutput")];case 1:return[2,e.sent().speakers]}}))}))},e.prototype.getAudioInfo=function(e,t,r){},e.prototype.getSoundLevel=function(e,t,r){this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.getSoundLevel(e,t,r):console.error("")},e.prototype.stopSoundLevel=function(e){this.rtcModules.audioMixModule?this.rtcModules.audioMixModule.stopSoundLevel(e):console.error("")},e.handleDataAvailable=function(t){t.data&&t.data.size>0&&e.recordedBlobs.push(t.data)},e.prototype.startRecord=function(e){},e.prototype.stopRecord=function(){},e.prototype.resumeRecord=function(){},e.prototype.pauseRecord=function(){},e.prototype.saveRecord=function(e){},e.prototype.takeSnapShot=function(e,t){},e.prototype.saveSnapShot=function(e,t){},e.prototype.useVideoDevice=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.useVideoDevice(e,t):new Promise((function(e,t){e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.useAudioDevice=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.useAudioDevice(e,t):(console.error("should use advanced module first"),new Promise((function(e,t){e({errorCode:-1,extendedData:"should install advanced module"})})))},e.prototype.getElectronScreenSources=function(){return this.rtcModules.publishModule.getElectronScreenSources()},e.prototype.setSoundLevelDelegate=function(e,t,r){this.logger.info("zc.ssd.0 call"),"boolean"==typeof e?t&&(!this.stateCenter.checkInteger(t)||t<100||t>3e3)?this.logger.error("zc.ssd.0 soundLevel interval must be integer number which is between 100 and 3000"):this.streamCenter.setSoundLevelDelegate(e,t,r):this.logger.error("zc.ssd.0 param 1 must be boolean")},e.prototype.on=function(e,t){return this.rtcModules.bindListener(e,t)},e.prototype.off=function(e,t){return this.rtcModules.deleteListener(e,t)},e.prototype.getVersion=function(){return d.PROTO_VERSION},e.prototype.setStreamExtraInfo=function(e,t){return new Promise((function(e,t){console.error("should use advanced module first"),t()}))},e.prototype.addPublishCdnUrl=function(e,t){return this.logger.info("zg.cm.apu call ",e,t),this.rtcModules.advancedModule?this.rtcModules.advancedModule.publishTarget({type:"addpush",streamID:e,pushUrl:t}):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.removePublishCdnUrl=function(e,t){return this.logger.info("zg.cm.apu call ",e,t),this.rtcModules.advancedModule?this.rtcModules.advancedModule.publishTarget({type:"delpush",streamID:e,pushUrl:t}):new Promise((function(e,t){console.error("should install advanced module"),e({errorCode:-1,extendedData:"should install advanced module"})}))},e.prototype.startMixerTask=function(e){return new Promise((function(e,t){console.error(""),t()}))},e.prototype.setMixerTaskConfig=function(e){return new Promise((function(e,t){console.error(""),t()}))},e.prototype.stopMixerTask=function(e){return new Promise((function(e,t){console.error(""),t()}))},e.prototype.setCaptureVolume=function(e,t){return this.rtcModules.publishModule.setCaptureVolume(e,t)},e.use=function(t){switch(t.type){case"AudioMix":t.install(p.RTCModules,_.ZegoPublish);break;case"MixStream":t.install(e,f.StreamHandler,p.RTCModules);break;case"Advance":t.install(e,p.RTCModules,f.StreamHandler,v.ZegoPreview,E.PlayModule,S.PublishModule,_.ZegoPublish,T.ZegoSignal);break;case"BeautyEffect":t.install(e,v.ZegoPreview);break;case"RangeAudio":case"DataChannel":t.install(e)}},e.prototype.createRangeAudioInstance=function(){throw new Error("should use range audio module")},e.prototype.createRealTimeSequentialDataManager=function(e){throw new Error("should use datachannel module")},e.prototype.destroyRealTimeSequentialDataManager=function(e){throw new Error("should use datachannel module")},e.prototype.enableDataChannel=function(e){"boolean"==typeof e&&(this.streamCenter.isDataChannelEnabled=e)},e.prototype.addTrack=function(e,t){return new Promise((function(e,t){throw new Error("use advanced module first")}))},e.prototype.removeTrack=function(e,t){return new Promise((function(e,t){throw new Error("use advanced module first")}))},e.prototype.setBeautyEffect=function(e,t,r){return new Promise((function(e,t){console.error("should install video effect module and advanced module"),e({errorCode:-1,extendedData:"should install video effect module and advanced module"})}))},e.prototype.getPublishingStreamQuality=function(e){return this.rtcModules.publishModule.getStreamStats(e)},e.prototype.getPlayingStreamQuality=function(e){return this.rtcModules.playModule.getStreamStats(e)},e.prototype.checkAudioTrackIsActive=function(e){return MediaStreamTrack instanceof e&&"video"===e.kind?c.ClientUtil.checkAudioTrackIsActive(e):(this.logger.error("zc.caia.0 track type error"),!1)},e.prototype.checkVideoTrackIsActive=function(e){return MediaStreamTrack instanceof e&&"audio"===e.kind?c.ClientUtil.checkVideoTrackIsActive(e):(this.logger.error("zc.cvia.0 track type error"),!1)},e.prototype.setDummyCaptureImagePath=function(e,t){return this.rtcModules.advancedModule?this.rtcModules.advancedModule.setDummyCaptureImagePath(e,t):new Promise((function(e,t){console.error("should install advanced module"),e(!1)}))},e.prototype.setAccess=function(e){this.RTM.setAccess(e),this.stateCenter.useNetAgent=e},e.prototype.setAudioOutputDevice=function(e,t){var r;return s(this,void 0,void 0,(function(){var i;return a(this,(function(o){switch(o.label){case 0:return(i=null===(r=e)||void 0===r?void 0:r.setSinkId)?(e.setsinkid&&(e.setsinkid.enabled=!0),[4,i.call(e,t)]):[3,2];case 1:return o.sent(),[2,!0];case 2:throw Error("Browser not support set audio output.")}}))}))},e.prototype.enableCameraCapturing=function(e,t){return void 0===t&&(t=!0),s(this,void 0,void 0,(function(){return a(this,(function(e){return console.error("should use advanced module first"),[2,!1]}))}))},e.prototype.enableDualStream=function(e){this.rtcModules.advancedModule?this.rtcModules.advancedModule.enableDualStream(e):console.error("use advance module first")},e.prototype.setLowStreamParameter=function(e,t){this.rtcModules.advancedModule?this.rtcModules.advancedModule.setLowStreamParameter(e,t):console.error("use advance module first")},e.prototype.setRemoteDefaultVideoStreamType=function(e){this.logger.info("zc.srdvs call"),[0,1,2].includes(e)?this.stateCenter.streamType=e:this.logger.error("zc.srdvs streamType must be number 0 or 1 or 2")},e.prototype.setSoftCoding=function(e){"boolean"==typeof e&&(this.stateCenter.softCoding=e)},e.screenShotReady=!1,e}();t.ZegoWebRTC=R,window.addEventListener("message",(function(e){var t=e.data.type,r=e.origin;r!==window.location.origin&&console.warn("ScreenStream: you should discard foreign event from origin:",r),"SS_PING"===t&&(R.screenShotReady=!0)}))},746:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalogSocket=void 0;var i,o,n=r(6706),s=r(1089);!function(e){e[e.Connected=0]="Connected",e[e.Disconnected=1]="Disconnected",e[e.Broken=2]="Broken"}(i||(i={})),function(e){e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL"}(o||(o={}));var a=function(){function e(e,t,r,o){var s=this;this.server=e,this.netAgent=t,this.signalConfig=r,this.logger=o,this.readyState=WebSocket.CLOSED,this.isActive=!1,this.accessServerState=i.Disconnected,this.originAccessServerState=i.Disconnected,this.mediaServerState=i.Disconnected,this.originMediaServerState=i.Disconnected,this.eventHandler={accessDisconnect:function(){s.setAccessServerState(i.Disconnected)},accessConnect:function(){s.setAccessServerState(i.Connected)},accessBroken:function(){s.setAccessServerState(i.Broken)},mediaDisconnect:function(){s.setMediaServerState(i.Disconnected)},mediaConnect:function(e){s.setMediaServerState(i.Connected,e)},mediaBroken:function(){s.setMediaServerState(i.Broken)}},this.wsHandler=t.getPCRequest("unified_rtc"===e?n.BusinessService.SERVICE_WEBRTC_SIGNAL:n.BusinessService.SERVICE_L3_WEBRTC_SIGNAL,{path:r.path,query:r.query}),this.setAccessServerState(t.isConnect()?i.Connected:i.Disconnected),this.setMediaServerState(0===this.wsHandler.connectState?i.Connected:i.Disconnected)}return e.prototype.updateAccessReadyState=function(){this.isActive&&this.accessServerState===i.Connected&&this.mediaServerState!==i.Connected?this.onreconnnecting&&this.onreconnnecting():this.accessServerState===i.Disconnected&&this.logger.warn(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_UPDATE_ACCESS_READY_STATE+" access timeout")},e.prototype.updateMediaReadyState=function(e){return this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_UPDATE_MEDIA_READY_STATE+" "+e),this.mediaServerState===i.Connected?(this.originMediaServerState===i.Broken&&e===o.AUTO&&this.onreconnnecting&&this.onreconnnecting(),void(this.readyState!==WebSocket.OPEN&&(this.readyState=WebSocket.OPEN,this.onopen&&this.onopen()))):this.mediaServerState===i.Disconnected?(this.wsHandler.off("connected",this.eventHandler.mediaConnect),this.wsHandler.off("disconnected",this.eventHandler.mediaDisconnect),this.wsHandler.off("broken",this.eventHandler.mediaBroken),this.wsHandler.off("downLoadMessage"),this.netAgent.off("connected",this.eventHandler.accessConnect),this.netAgent.off("disconnected",this.eventHandler.accessDisconnect),this.netAgent.off("broken",this.eventHandler.accessBroken),void(this.readyState!==WebSocket.CLOSED&&(this.readyState=WebSocket.CLOSED,this.onclose&&this.onclose()))):void(this.mediaServerState===i.Broken&&(this.readyState=WebSocket.CONNECTING,this.onerror&&this.onerror(new Event("signal connecting"))))},e.prototype.setMediaServerState=function(e,t){this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SET_MEDIA_SERVER_STATE+" "+e+" "+t),this.mediaServerState!==e?(this.originMediaServerState=this.mediaServerState,this.mediaServerState=e,this.updateMediaReadyState(t)):this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SET_MEDIA_SERVER_STATE+" same state")},e.prototype.setAccessServerState=function(e){this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SET_ACCESS_SERVER_STATE+" "+e),this.accessServerState!==e?(this.originAccessServerState=this.accessServerState,this.accessServerState=e,this.updateAccessReadyState()):this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SET_ACCESS_SERVER_STATE+" same state")},e.prototype.open=function(){var e=this;this.isActive=!0,this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_OPEN+" state "+this.mediaServerState),this.mediaServerState===i.Disconnected&&(this.wsHandler.on("connected",this.eventHandler.mediaConnect),this.wsHandler.on("disconnected",this.eventHandler.mediaDisconnect),this.wsHandler.on("broken",this.eventHandler.mediaBroken),this.netAgent.on("connected",this.eventHandler.accessConnect),this.netAgent.on("disconnected",this.eventHandler.accessDisconnect),this.netAgent.on("broken",this.eventHandler.accessBroken),this.wsHandler.on("downLoadMessage",(function(t){e.logger.info("zc.as.op download msg "+t),e.onmessage({data:t})})))},e.prototype.close=function(){this.isActive=!1,this.wsHandler.off("connected",this.eventHandler.mediaConnect),this.wsHandler.off("disconnected",this.eventHandler.mediaDisconnect),this.wsHandler.off("broken",this.eventHandler.mediaBroken),this.wsHandler.off("downLoadMessage"),this.netAgent.off("connected",this.eventHandler.accessConnect),this.netAgent.off("disconnected",this.eventHandler.accessDisconnect),this.netAgent.off("broken",this.eventHandler.accessBroken),this.wsHandler.closeRequest()},e.prototype.send=function(e,t){var r=this;-1==e.indexOf("QualityReportReq")&&this.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SEND+" "+e),this.wsHandler.sendRequest({payload:e,ack:t},(function(e){r.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SEND+" fail "+e),r.onerror&&r.onerror(e)}),(function(e){r.logger.info(s.ZEGO_WEBRTC_ACTION.ANALOGSOCKET_SEND+" suc "+e)}))},e.prototype.onopen=function(){},e.prototype.onclose=function(e){},e.prototype.onerror=function(e){},e.prototype.onmessage=function(e){},e.prototype.onreconnnecting=function(){},e}();t.AnalogSocket=a},4395:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CheckModule=void 0;var n=r(4767),s=function(){function e(){var e=this;this.iceconnectionstatechangeTimes=0,this.isCheckAll=!1;var t=document.createElement("canvas");t.getContext("2d").fillStyle="rgba(255, 255, 255, 0)";try{this.localStream=t.captureStream()}catch(e){console.error("canvas captureStream error",e)}this.timer=setTimeout((function(){e.resolve("Detection timeout"),e.hangup()}),5e3)}return e.prototype.checkSupportByType=function(e){return i(this,void 0,void 0,(function(){var t,r,i=this;return o(this,(function(o){switch(o.label){case 0:return this.checkType=e,t={},this.localPc=new RTCPeerConnection(t),this.remotePc=new RTCPeerConnection(t),r=new Promise((function(e){return i.resolve=e})),this.localPc.addEventListener("icecandidate",(function(e){return i.onIceCandidate(i.localPc,e)})),this.remotePc.addEventListener("icecandidate",(function(e){return i.onIceCandidate(i.remotePc,e)})),this.remotePc.addEventListener("iceconnectionstatechange",(function(t){"connected"===i.remotePc.iceConnectionState&&(i.iceconnectionstatechangeResult=!0),2==++i.iceconnectionstatechangeTimes&&i.iceCandidate&&(clearTimeout(i.timer),"connected"===i.remotePc.iceConnectionState?i.resolve(!0):i.resolve("The browser does not support "+e+" format"),i.hangup())})),this.localStream.getTracks().forEach((function(e){return i.localPc.addTrack(e,i.localStream)})),[4,this.check(e)];case 1:return o.sent(),[4,r];case 2:return[2,o.sent()]}}))}))},e.prototype.check=function(e){return i(this,void 0,void 0,(function(){var t,r;return o(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.localPc.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})];case 1:return(t=i.sent()).sdp=n.SdpUtil.getSDPByVideDecodeType(t.sdp,e),this.onCreateOfferSuccess(t),[3,3];case 2:return r=i.sent(),this.onCreateSessionDescriptionError(r),[3,3];case 3:return[2]}}))}))},e.prototype.onCreateOfferSuccess=function(e){return i(this,void 0,void 0,(function(){var t,r,i,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.localPc.setLocalDescription(e)];case 1:return o.sent(),[3,3];case 2:return t=o.sent(),this.onSetSessionDescriptionError(t),[2];case 3:return o.trys.push([3,5,,6]),[4,this.remotePc.setRemoteDescription(e)];case 4:return o.sent(),[3,6];case 5:return r=o.sent(),this.onSetSessionDescriptionError(r),[2];case 6:return o.trys.push([6,9,,10]),[4,this.remotePc.createAnswer()];case 7:return i=o.sent(),[4,this.onCreateAnswerSuccess(i)];case 8:return o.sent(),[3,10];case 9:return n=o.sent(),this.onCreateSessionDescriptionError(n),[2];case 10:return[2]}}))}))},e.prototype.onCreateAnswerSuccess=function(e){return i(this,void 0,void 0,(function(){var t,r;return o(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.remotePc.setLocalDescription(e)];case 1:return i.sent(),[3,3];case 2:return t=i.sent(),this.onSetSessionDescriptionError(t),[2];case 3:return i.trys.push([3,5,,6]),[4,this.localPc.setRemoteDescription(e)];case 4:return i.sent(),[3,6];case 5:return r=i.sent(),this.onSetSessionDescriptionError(r),[2];case 6:return[2]}}))}))},e.prototype.onIceCandidate=function(e,t){return i(this,void 0,void 0,(function(){var r;return o(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.getOtherPc(e).addIceCandidate(t.candidate)];case 1:return i.sent(),[3,3];case 2:return r=i.sent(),console.error(this.checkType,this.getPcName(e)+" addIceCandidate error",r),clearTimeout(this.timer),this.hangup(),this.resolve(r),[3,3];case 3:return"remotePc"===this.getPcName(e)&&t.candidate&&(this.iceCandidate=!0),this.iceconnectionstatechangeResult&&"localPc"===this.getPcName(e)&&(clearTimeout(this.timer),this.hangup(),this.resolve(!0)),[2]}}))}))},e.prototype.getOtherPc=function(e){return e===this.localPc?this.remotePc:this.localPc},e.prototype.getPcName=function(e){return e===this.localPc?"localPc":"remotePc"},e.prototype.onCreateSessionDescriptionError=function(e){console.error("Failed to create session description: "+e.toString()),clearTimeout(this.timer),this.hangup(),this.resolve(e)},e.prototype.onSetSessionDescriptionError=function(e){console.error("Failed to set session description: "+e.toString()),clearTimeout(this.timer),this.hangup(),this.resolve(e)},e.prototype.hangup=function(){this.localPc.close(),this.remotePc.close(),this.iceconnectionstatechangeTimes=0,this.localStream.getTracks().forEach((function(e){return e.stop()}))},e}();t.CheckModule=s},8493:function(e,t,r){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.RetryDispatchHandler=void 0;var n=r(6502),s=r(6706),a=r(1089),d=r(3529),c=r(2752),u=function(e){function t(t,r,i,o){var n=e.call(this)||this;return n.retryActiveCount=1,n.RETRY_MAX_TIME=90,n.logger=t,n.stateCenter=r,n.rtm=i,n.streamCenter=o,n}return o(t,e),t.prototype.initStream=function(e,t,r){this.streamID=e,this.playOption=t,this.isPublish=r},t.prototype.active=function(e){var t=this;if(this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" retry call "+this.streamID),this.stateCenter.networkState==s.ENUM_NETWORK_STATE.offline)return this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" network is broken, stop retry"),!1;if(this.retryTimer)return this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" has active, ignore"),!1;if(this.isOverTime)return this.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" retry over time, stop retry"),!1;if(!this.rtm.isLogin()){this.stopMaxTime(),this.invalid();var r=this.isPublish?this.streamCenter.publisherList[this.streamID]:this.streamCenter.playerList[this.streamID];r&&(r.isReDispatch=!0)}var i=this.retryActiveCount-1,o=this.playOption&&2==this.playOption.resourceMode?1:0,n={stream_id:this.streamID,ptype:this.isPublish?"push":"pull",signals:this.streamCenter.getAllInUseUrl(),header_kvs:[{key:"grpc-metadata-push",value:this.playOption&&this.playOption.cdnUrl||""}],retry:i,center_ability:!0,dispatch_type:o};return this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=setTimeout((function(){t.retryTimer=null,t.retryActiveCount++;var e=t.streamCenter.getRoomByStreamID(t.streamID),r=t.rtm.service.sendMessage("webrtc_url",n,(function(e,r){t.handleFetchWebRtcUrlRsp(e)}),(function(e,r){t.handleFetchWebRtcUrlRsp(e)}),void 0,{sessionID:null==e?void 0:e.sessionID,roomID:null==e?void 0:e.roomID,roomSessionID:null==e?void 0:e.roomSessionID});t.isPublish&&r?t.streamCenter.publisherList[t.streamID]&&(t.streamCenter.publisherList[t.streamID].seq=r):r&&t.streamCenter.playerList[t.streamID]&&(t.streamCenter.playerList[t.streamID].seq=r)}),"number"==typeof e?e:1e3*this.retryActiveInterval),this.logger.info(a.ZEGO_WEBRTC_ACTION.RDH_ACTIVE+" call success"),!0},t.prototype.startMaxTime=function(){var e=this;this.maxTimer||(this.maxTimer=setTimeout((function(){e.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_MAX_TIME+" "+e.streamID+" dispatch over max time "+e.RETRY_MAX_TIME+"s stop retry"),e.isOverTime=!0,e.invalid();var t=d.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError;t.message=t.message+" try max limit",e.isPublish?e.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.error,e.streamID,t):e.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.error,e.streamID,t)}),1e3*this.RETRY_MAX_TIME))},t.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},t.prototype.onactive=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.handleFetchWebRtcUrlRsp=function(e){if(e.code&&[c.errorCodeList.TIMEOUT.code].includes(e.code))this.active();else{if(e.code&&[c.errorCodeList.SOCKET_CLOSE.code].includes(e.code))return this.stopMaxTime(),this.invalid(),void(this.isPublish?this.streamCenter.publisherList[this.streamID].isReDispatch=!0:this.streamCenter.playerList[this.streamID].isReDispatch=!0);var t=e,r=t.body.stream_id,i=!1;if(this.isPublish&&(!this.streamCenter.publisherList[r]||t.header.seq!==this.streamCenter.publisherList[this.streamID].seq))return this.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" seq is not match, ignore "+this.streamID),this.stopMaxTime(),void this.invalid();if(!(this.isPublish||this.streamCenter.playerList[this.streamID]&&t.header.seq===this.streamCenter.playerList[this.streamID].seq))return this.logger.warn(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" seq is not match, ignore "+this.streamID),this.stopMaxTime(),void this.invalid();if("PUBLIC"===this.stateCenter.type){if(this.stateCenter.clientIP=t.body.clientip||"",0!==t.body.err_code&&2==t.body.need_action)return this.retryActiveInterval=t.body.action_delay/1e3||Math.floor(3*Math.random())+3,2==this.retryActiveCount&&((n=d.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError).message=n.message+(t.body.err_code?" server error:"+t.body.err_code:""),"push"===t.body.ptype?this.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.retry,r,n):this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.retry,r,n)),void this.active();if(0!==t.body.err_code&&1!==t.body.need_action&&![3102].includes(t.body.err_code))return this.retryActiveInterval=Math.floor(3*Math.random())+3,2==this.retryActiveCount&&((n=d.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError).message=n.message+(t.body.err_code?" server error:"+t.body.err_code:""),"push"===t.body.ptype?this.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.retry,r,n):this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.retry,r,n)),void this.active();if(this.stopMaxTime(),this.invalid(),t.body.urls&&Array.isArray(t.body.urls)&&t.body.urls.length>0?i=!0:this.logger.error(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" signal url is empty"),"push"===t.body.ptype&&this.streamCenter.publisherList[r]){if(!i)return void this.streamCenter.onPublishStateUpdate(s.ENUM_PUBLISH_STATE_UPDATE.error,r,d.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishDispatchError);var o=this.streamCenter.publisherList[r];this.stateCenter.publishStreamList[r]?(o.ttl=t.body.hosts_ttl?(new Date).getTime()+1e3*t.body.hosts_ttl:0,o.isCenterNode="boolean"==typeof t.body.is_center_node&&t.body.is_center_node,o.serverUrls=t.body.urls,this.streamCenter.startPublishingStream(r)):this.logger.error(a.ZEGO_WEBRTC_ACTION.RDH_WEBRTC_URL_RSP+" no streamid to publish")}else if("pull"==t.body.ptype&&this.streamCenter.playerList[r]){var n;if(!i)return(n=d.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayDispatchError).message=n.message+(t.body.err_code?" server error:"+t.body.err_code:""),3102===t.body.err_code&&(n=d.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayUnsupportedResourceMode),void this.streamCenter.onPlayStateUpdate(s.ENUM_PLAY_STATE_UPDATE.error,r,n);var u=this.streamCenter.playerList[r];u.ttl=t.body.hosts_ttl?(new Date).getTime()+1e3*t.body.hosts_ttl:0,u.isCenterNode="boolean"==typeof t.body.is_center_node&&t.body.is_center_node,u.serverUrls=t.body.urls,this.streamCenter.startPlayingStream(r,this.stateCenter.useNetAgent,this.streamCenter.playSuccessCallBackList[r])}}}},t}(n.RetryHandler);t.RetryDispatchHandler=u},6014:function(e,t,r){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.RetryStreamHandler=void 0;var n=r(6706),s=r(6502),a=r(3529),d=r(1089),c=r(608),u=function(e){function t(t,r,i,o){var n=e.call(this)||this;return n.logger=t,n.stateCenter=r,n.streamCenter=i,n.isPublish=o,n.serverUrls=[],n}return o(t,e),t.prototype.initStream=function(e,t){this.streamID=e,this.serverUrls=t},t.prototype.activePublish=function(e){var t=this;if(this.logger.info("zc.tsh.a retry call "+this.streamID),this.stateCenter.networkState==n.ENUM_NETWORK_STATE.offline)return this.logger.info("zc.tsh.a network is broken, stop retry"),!1;if(this.retryTimer)return this.logger.info("zc.tsh.a has active, ignore"),!1;if(this.isOverTime)return this.logger.warn("zc.tsh.a retry over time, stop retry"),!1;if(1==this.retryActiveCount)this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL);else{var r=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1));this.retryActiveInterval=r>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:r}var i=this.streamCenter.publisherList[this.streamID].publisher,o=this.serverUrls[0],s=["unified_rtc","unified_l3"].includes(o);if(!s){var a=this.serverUrls,d=i.signal?i.signal.server:"";a.forEach((function(e,r){return r<=a.indexOf(d)&&t.serverUrls.push(e)})),a.splice(0,a.indexOf(d)+1),o=this.serverUrls[this.retryActiveCount%this.serverUrls.length==0?this.serverUrls.length-1:this.retryActiveCount%this.serverUrls.length-1]}return this.retryTimer=setTimeout((function(){t.logger.info("zc.tsh.a stream "+t.streamID+" : connect to "+(s?"unified signal server":"signal server "+o)),t.retryTimer&&clearTimeout(t.retryTimer),t.retryTimer=null,t.retryActiveCount++,t.streamCenter.connectPublishServer(t.streamID,o)}),"number"==typeof e?e:1e3*this.retryActiveInterval),this.logger.info("zc.tsh.a call success"),!0},t.prototype.activePull=function(e,t){var r=this;if(this.logger.info("zc.tsh.a retry call "+this.streamID),t&&(this.playStreamSuccess=t),this.stateCenter.networkState==n.ENUM_NETWORK_STATE.offline)return this.logger.info("zc.tsh.a network is broken, stop retry"),!1;if(this.retryTimer)return this.logger.info("zc.tsh.a has active, ignore"),!1;if(this.isOverTime)return this.logger.warn("zc.tsh.a retry over time, stop retry"),!1;if(1==this.retryActiveCount)this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL);else{var i=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1));this.retryActiveInterval=i>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:i}var o=this.streamCenter.playerList[this.streamID].player,s=this.serverUrls,a=o.signal?o.signal.server:"",d=this.serverUrls[0],c=["unified_rtc","unified_l3"].includes(d);return c||(s.forEach((function(e,t){return t<=s.indexOf(a)&&r.serverUrls.push(e)})),s.splice(0,s.indexOf(a)+1),d=this.serverUrls[this.retryActiveCount%this.serverUrls.length==0?this.serverUrls.length-1:this.retryActiveCount%this.serverUrls.length-1]),this.retryTimer=setTimeout((function(){r.logger.warn("zc.tsh.a stream "+r.streamID+" : connect to "+(c?"unified signal server":"signal server "+d)),r.retryTimer&&clearTimeout(r.retryTimer),r.retryTimer=null,r.retryActiveCount++,r.streamCenter.connectPlayServer(r.streamID,r.playStreamSuccess,d)}),"number"==typeof e?e:1e3*this.retryActiveInterval),this.logger.info("zc.tsh.a call success"),!0},t.prototype.startMaxTime=function(){var e=this;this.logger.warn("zc.tsh.smt "+this.streamID+" call"),this.maxTimer?this.logger.warn("zc.tsh.smt max timer"):this.maxTimer=setTimeout((function(){if(e.logger.warn("zc.tsh.smt "+e.streamID+" over max time "+e.RETRY_MAX_TIME+"s, stop retry"),e.isOverTime=!0,e.invalid(),e.isPublish){if(!e.streamCenter.publisherList[e.streamID])return void e.logger.info("zc.tsh.smt streamID "+e.streamID+" publish no found");e.publishStateHandle(n.ENUM_PUBLISH_STATE_UPDATE.error,e.streamID,a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishRetryTimeoutError,!0)}else{if(!e.streamCenter.playerList[e.streamID])return void e.logger.info("zc.tsh.smt streamID "+e.streamID+" play no found");e.playStateHandle(n.ENUM_PLAY_STATE_UPDATE.error,e.streamID,a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRetryTimeoutError,!0)}}),1e3*this.RETRY_MAX_TIME)},t.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},t.prototype.onactive=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.retryNextSignal=function(e){var t,r;if(this.stateCenter.networkState==n.ENUM_NETWORK_STATE.offline)return!0;if(this.isPublish){var i=this.streamCenter.publisherList[this.streamID];if(i.publisher.state==n.ENUM_PUBLISH_STATE.stop&&[a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionTimeoutError.code,a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNegoTimeoutError.code].includes(e.code))return!0;if(i.isCenterNode&&(null===(t=i.publisher.signal)||void 0===t?void 0:t.wsReadyState)==WebSocket.OPEN)return!1;if(!i.isCenterNode&&[a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishSessionClosedError.code].includes(e.code)){var o=(s=e.message.match(/reason:(\d+)/))?s[1]:"";return!["26"].includes(o)}return!0}var s,d=this.streamCenter.playerList[this.streamID];return!(d.player.state!=n.ENUM_PLAY_STATE.stop||![a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionTimeoutError.code,a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNegoTimeoutError.code].includes(e.code))||(!d.isCenterNode||(null===(r=d.player.signal)||void 0===r?void 0:r.wsReadyState)!=WebSocket.OPEN)&&(!(!d.isCenterNode&&[a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlaySessionClosedError.code].includes(e.code))||(o=(s=e.message.match(/reason:(\d+)/))?s[1]:"",!["24","26","28"].includes(o)))},t.prototype.publishStateHandle=function(e,t,r,i){this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISH_STATE_HANDLE+" call "+t+" "+(r?r.code+"":""));var o=i||this.RETRY_MAX_TIME<3;if(!o&&r&&(c.ClientUtil.isReDispatch(r)||0==this.serverUrls.length))return this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISH_STATE_HANDLE+" stop "+o+" "+JSON.stringify(this.serverUrls)),this.stopMaxTime(),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,void this.streamCenter.onPublishStateUpdate(e,t,r);var s=this.streamCenter.publisherList[t],u=s.publisher;if(!o&&r&&0!==r.code){!this.maxTimer&&!o&&this.startMaxTime(),this.stateCenter.publishStreamList[t].state=n.ENUM_PUBLISH_STREAM_STATE.retryPublish;var l=u.localStream,h=u.videoInfo,p=u.mediaStreamConfig,g=u.publishOption;if(0!=u.sessionId&&u.signal&&u.shouldSendCloseSession()&&(u.signal.sendCloseSession(n.getSeq(),u.sessionId,1),u.signal.removeSession(u.sessionId),u.closeSessionSignal=!0),u.resetPublish(),!o&&!this.retryNextSignal(r)){if(s.isCenterNode&&u.gwNodeTTL<(new Date).getTime()&&0!==u.gwNodeList.length)u.gwNode="",u.gwNodeList=[],u.gwNodeTTL=0;else if(s.isCenterNode){var f=u.gwNodeList.findIndex((function(e){return e==u.gwNode}));u.gwNode=u.gwNodeList[++f%u.gwNodeList.length]}return this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISH_STATE_HANDLE+" retry current signal "),this.streamCenter.onPublishStateUpdate(2,t,r),void(this.stateCenter.useNetAgent?u.startPublish(t,l,h,p,g):this.startRetryTimer=setTimeout((function(){u.startPublish(t,l,h,p,g)}),3e3))}this.streamCenter.removeStreamFromSignal(!0,t)}if(o)return this.stopMaxTime(),this.invalid(),1===e&&u.resetPublish(),void this.streamCenter.onPublishStateUpdate(e,t,r);if(r&&0!==r.code&&this.activePublish(void 0)){var _=n.getReportSeq();this.streamCenter.dataReport.newReport(_),this.streamCenter.dataReport.addMsgInfo(_,{stream:a.ZegoRTCLogEvent.kZegoTaskRePublish.stream(this.streamID)}),this.streamCenter.dataReport.uploadReport(_,a.ZegoRTCLogEvent.kZegoTaskRePublish.event),this.streamCenter.onPublishStateUpdate(2,t,r)}this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISH_STATE_HANDLE+" end "+t)},t.prototype.playStateHandle=function(e,t,r,i){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAY_STATE_HANDLE+" call "+t+" "+(r?r.code+"":""));var o=i||this.RETRY_MAX_TIME<3;if(!o&&r&&(c.ClientUtil.isReDispatch(r)||0==this.serverUrls.length))return this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAY_STATE_HANDLE+" stop "+o+" "+JSON.stringify(this.serverUrls)),this.stopMaxTime(),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,void this.streamCenter.onPlayStateUpdate(e,t,r);if(!o&&r&&0!==r.code){!this.maxTimer&&!o&&this.startMaxTime();var s=this.streamCenter.playerList[t],u=s.player,l=u.playOption;if(0!=u.sessionId&&u.signal&&u.shouldSendCloseSession()&&(u.signal.sendCloseSession(n.getSeq(),u.sessionId,1),u.signal.removeSession(u.sessionId),u.closeSessionSignal=!0),u.resetPlay(),!o&&!this.retryNextSignal(r)){if(s.isCenterNode&&u.gwNodeTTL<(new Date).getTime()&&0!==u.gwNodeList.length)u.gwNode="",u.gwNodeList=[],u.gwNodeTTL=0;else if(s.isCenterNode){var h=u.gwNodeList.findIndex((function(e){return e==u.gwNode}));u.gwNode=u.gwNodeList[++h%u.gwNodeList.length]}return this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAY_STATE_HANDLE+" retry current signal "),this.streamCenter.onPlayStateUpdate(2,t,r),void(this.stateCenter.useNetAgent?u.startPlay(t,u.getRemoteStreamSuc,l):this.startRetryTimer=setTimeout((function(){u.startPlay(t,u.getRemoteStreamSuc,l)}),3e3))}this.streamCenter.removeStreamFromSignal(!1,t)}if(o)return this.stopMaxTime(),this.invalid(),void this.streamCenter.onPlayStateUpdate(e,t,r);if(r&&0!==r.code&&this.activePull(void 0)){var p=n.getReportSeq();this.streamCenter.dataReport.newReport(p),this.streamCenter.dataReport.addMsgInfo(p,{stream:a.ZegoRTCLogEvent.kZegoTaskRePlay.stream(this.streamID)}),this.streamCenter.dataReport.uploadReport(p,a.ZegoRTCLogEvent.kZegoTaskRePlay.event),this.streamCenter.onPlayStateUpdate(2,t,r)}this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAY_STATE_HANDLE+" end "+t)},t}(s.RetryHandler);t.RetryStreamHandler=u},1691:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.GatewaySignal=void 0;var n=r(6348),s=r(608),a=function(){function e(e){this.streamSignal=e,this.callbackMap={}}return e.prototype.mediaStreamSEIUUIDReq=function(e,t,r,a){return i(this,void 0,void 0,(function(){var i=this;return o(this,(function(o){return[2,new Promise((function(o,d){var c={sei_filter:a},u=n.webrtc_cmd.WebrtcCmdReqMsg.encode({usr_sei_filter:c}).finish(),l=s.ClientUtil.uint8arrayToBase64(u);i.streamSignal.sendGWCmd(e,t,{peer_id:r,cmd_id:5,body:l},(function(e,t,r){var i=s.ClientUtil.base64ToUint8Array(r.body),a=n.webrtc_cmd.WebrtcCmdRspMsg.decode(i);o(a)}),(function(e){d(e)}))}))]}))}))},e.prototype.metadataAck=function(e,t,r){return i(this,void 0,void 0,(function(){var i,a,d;return o(this,(function(o){return i={result:1},a=n.webrtc_cmd.WebrtcCmdRspMsg.encode({meta_data_ack:i}).finish(),d=s.ClientUtil.uint8arrayToBase64(a),this.streamSignal.sendGWAck(e,t,{peer_id:r,cmd_id:1,body:d}),[2]}))}))},e.prototype.registerPushCallback=function(e,t,r){var i,o=this,a=this.callbackMap[t];a?a[e]=r:(this.callbackMap[t]=((i={})[e]=r,i),this.streamSignal.registerPushCallback("CmdPush",t,(function(e,t,r){var i=s.ClientUtil.base64ToUint8Array(r.body),a=n.webrtc_cmd.WebrtcCmdReqMsg.decode(i),d=Object.keys(a)[0];console.error("CmdPush",d,a),d=d||"meta_data_push";var c=o.callbackMap[t];if(c){var u=c[d];u&&u(e,t,r.body)}})))},e.prototype.unregisterPushCallback=function(e,t){var r=this.callbackMap[t];r&&(delete r[e],0===Object.keys(r).length&&(this.streamSignal.unregisterPushCallback("CmdPush",t),delete this.callbackMap[t]))},e}();t.GatewaySignal=a},908:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.RTCModules=void 0;var n=r(6706),s=r(6706),a=r(3529),d=r(608),c=r(7560),u=r(361),l=r(4865),h=r(1089),p=r(2752),g=r(9595),f=function(){function e(e,t,r,i,o,n){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=i,this.rtm=o,this.ac=n,this.mediaEleSources=[],this.publishModule=new u.PublishModule(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.rtm),this.playModule=new l.PlayModule(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.rtm),this.initAdvance(),this.initAudioMix(),this.init()}return e.prototype.init=function(){this.bindWindowListener(),this.bindRTMListener(),this.bindStreamCenterHandler()},e.prototype.initAudioMix=function(){},e.prototype.initAdvance=function(){},e.prototype.bindWindowListener=function(){var e=this,t=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i),r=this.stateCenter.browser,i=t?"pagehide":"firefox"===r?"beforeunload":"unload";window.addEventListener(i,(function(){for(var t in window.event&&(window.event.cancelBubble=!0),e.streamCenter.publisherList)e.publishModule.stopPublishingStream(t);for(var t in e.streamCenter.playerList)e.playModule.stopPlayingStream(t)})),window.addEventListener("message",(function(t){var r=t.data,i=r.type,o=r.streamId,n=r.canRequestAudioTrack;"SS_DIALOG_SUCCESS"===i&&e.screenStreamFrom(o,n,d.ClientUtil.actionSuccessCallback("screenShare",e.stateCenter.callbackList)),"SS_DIALOG_CANCEL"===i&&d.ClientUtil.actionSuccessCallback("screenShare",e.stateCenter.callbackList)(!1,null,i)})),window.addEventListener("offline",(function(){if(e.logger.info("zc.off.0 network is broken"),e.stateCenter.networkState=s.ENUM_NETWORK_STATE.offline,e.stateCenter.useNetAgent)e.logger.info("zc.off.0 use netAgent");else{for(var t in e.streamCenter.publisherList)(r=e.streamCenter.publisherList[t].retryStreamHandler).stopMaxTime(),r.invalid();for(var t in e.streamCenter.playerList){var r;(r=e.streamCenter.playerList[t].retryStreamHandler).stopMaxTime(),r.invalid()}}})),window.addEventListener("online",(function(t){for(var r in e.logger.info("zc.on.0 network is online"),e.stateCenter.networkState=s.ENUM_NETWORK_STATE.online,e.streamCenter.publisherList){var i=e.streamCenter.publisherList[r].publisher,o=e.streamCenter.publisherList[r].retryStreamHandler;i.state==s.ENUM_PUBLISH_STATE.stop||i.stateNego!==s.ENUM_PUBLISH_STATE_NEGO.iceConnected?!o.isOverTime&&o.publishStateHandle(s.ENUM_PUBLISH_STATE_UPDATE.error,r,a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNetworkBrokenError):i.state==s.ENUM_PUBLISH_STATE.publishing&&o.stopMaxTime()}for(var r in e.streamCenter.playerList){var n=e.streamCenter.playerList[r].player;o=e.streamCenter.playerList[r].retryStreamHandler,n.state==s.ENUM_PLAY_STATE.stop||n.stateNego!==s.ENUM_PLAY_STATE_NEGO.iceConnected?!o.isOverTime&&o.playStateHandle(s.ENUM_PLAY_STATE_UPDATE.error,r,a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNetworkBrokenError):n.state==s.ENUM_PLAY_STATE.playing&&o.stopMaxTime()}})),window.addEventListener("visibilitychange",(function(t){if(Object.keys(e.streamCenter.publisherList).length>0||Object.keys(e.streamCenter.playerList).length>0){var r=s.getReportSeq();e.dataReport.newReport(r,a.ZegoRTCLogEvent.kZegoVisibilityChange.event),e.dataReport.uploadReport(r)}}))},e.prototype.bindRTMListener=function(){var e,t,r=this;this.rtm._on("_settingCanFetch",(function(e){return i(r,void 0,void 0,(function(){var e=this;return o(this,(function(t){return this.rtm.cloudSetting.fetchSetting(g.RTC).then((function(t){e.logger.info("zc.scf stream config "+JSON.stringify(t)),e.rtm._on("_cloudSettingNotify",(function(t,r){var i=s.getReportSeq();e.dataReport.newReport(i,a.ZegoRTCLogEvent.kZegoTaskCloudSettingRefresh.event);var o=e.rtm.cloudSetting.getEnvVariables();e.dataReport.addMsgInfo(i,{params:o,files:[{name:t,content:r.setting,versions:r.versions}]}),e.dataReport.uploadReport(i),g.RTC}))})),[2]}))}))})),this.rtm._on("_appConfigRsp",(function(){r.stateCenter.appConfig=r.rtm.getAppConfig(),r.publishModule.startWaitPublish(),r.playModule.startWaitPlay()})),this.rtm._on("_roomLogin",(function(e,t){r.stateCenter.appid=r.rtm.getAppID(),r.stateCenter.idName=r.rtm.getUserID(),r.stateCenter.testEnvironment=r.rtm.isTestEnvironment(),r.stateCenter.isMultiRoom=r.rtm.getMultiRoom(),r.stateCenter.useNetAgent=r.rtm.getUseNetAgent(),r.streamCenter.setSessionInfo(r.stateCenter.appid,r.stateCenter.idName,r.stateCenter.testEnvironment);var i=r.stateCenter.getRoomByRoomID(e);if(!i){var o=new c.StreamHandler(r.logger,r.stateCenter,r.rtm,r.streamCenter,e);r.bindStreamHandler(o),i={roomID:e,streamHandler:o,sessionID:"",roomSessionID:"",token:t,isResetRoom:!1,streamList:[],streamInfoList:[]},r.stateCenter.roomList.push(i)}})),this.rtm._on("roomLoginResponse",(function(e){r.logger.info("zc.rlr call "+JSON.stringify(e));var t=e.header.room_id||e.body.room_id;r.stateCenter.appConfig=r.rtm.getAppConfig();var i=r.rtm.getToken(t),o=r.rtm.getSessionId(t),n=r.rtm.getRoomSessionID(t),s=r.stateCenter.getRoomByRoomID(t);if(!s){var a=new c.StreamHandler(r.logger,r.stateCenter,r.rtm,r.streamCenter,t);r.bindStreamHandler(a),s={roomID:t,streamHandler:a,sessionID:o,roomSessionID:n,token:i,isResetRoom:!1,streamList:[],streamInfoList:[]},r.stateCenter.roomList.push(s)}if(s.sessionID=o,s.roomSessionID=n,1===e.body.stream_fetch_flag)return r.logger.info("zc.rlr stream fetch "+t),s.streamHandler.room=s,void s.streamHandler.fetchStreamList();s.streamHandler.handleStreamStart(e,s),r.logger.info("zc.rlr end "+t)})),this.rtm._on("HBResponse",(function(e){var t,i=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,o=r.stateCenter.getRoomByRoomID(i);"PUBLIC"===r.stateCenter.type&&(null==o||o.streamHandler.patchStreamList(e))})),this.rtm._on("_roomStateUpdate",(function(e,t,i,o){if("DISCONNECTED"==t){r.logger.info("zc.rsu "+e+" disconnected "+(i?i+" ":"")+(o||""));var n=r.stateCenter.getRoomByRoomID(e);if(n){var s=r.stateCenter.roomList.findIndex((function(t){return t.roomID==e}));n.isResetRoom=!0,n.streamHandler.reset(),r.streamCenter.reset(e,i),r.stateCenter.roomList.splice(s,1)}}else r.logger.info("zc.rsu "+e+" state: "+t)})),this.rtm._on("_tokenRenewed",(function(e,t){r.logger.info("zc.tr roomID:"+t+" "+e);var i=r.stateCenter.getRoomByRoomID(t);i&&(i.token=e)})),this.rtm._on("_tokenExpired",(function(e){var t,i;((null===(i=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.stop_stream)||void 0===i?void 0:i.stream_id_list)||[]).forEach((function(e){r.publishModule.stopPublishingStream(e,p.errorCodeList.TOKEN_EXPIRED)}))})),this.rtm.service.on("stream",(function(e){var t,i=(null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id)||"",o=r.stateCenter.getRoomByRoomID(i);o?o.streamHandler.handleStreamUpdateRsp(e):r.logger.error(h.ZEGO_WEBRTC_ACTION.ON_STREAM+" room no found")})),this.rtm.liveRoomHandler.handlePushStreamMsg=function(e){var t=n.streamMap[e.header.sub_cmd];e.body.stream_cmd=t,r.handlePushStreamMsg(e)},null===(e=this.rtm.service)||void 0===e||e.on("push_stream_update",(function(e){r.handlePushStreamMsg(e)})),null===(t=this.rtm.service)||void 0===t||t.on("zegochat_js.push_room_stream_update_req",(function(e){var t,i=(null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id)||"",o=r.stateCenter.getRoomByRoomID(i);o?o.streamHandler.handlePriPushStreamUpdateMsg(e):r.logger.error(h.ZEGO_WEBRTC_ACTION.ON_STREAM+" room no found")}))},e.prototype.handlePushStreamMsg=function(e){var t,r=(null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id)||"",i=this.stateCenter.getRoomByRoomID(r);i?i.streamHandler.handlePushStreamUpdateMsg(e):this.logger.error(h.ZEGO_WEBRTC_ACTION.ON_PUSH_STREAM_UPDATE+" room no found")},e.prototype.bindStreamCenterHandler=function(){var e=this;this.streamCenter.onPlayStateUpdate=function(t,r,i){var o=e.stateCenter.reportSeqList.startPlay[r],n=e.streamCenter.playerList[r];if(1==t&&n&&d.ClientUtil.isReDispatch(i)){var s=n.player,a=n.retryDispatchHandler,c=n.playOption;return 0!=s.sessionId&&s.signal&&s.shouldSendCloseSession()&&(s.signal.sendCloseSession(e.stateCenter.getSeq(),s.sessionId,1),s.signal.removeSession(s.sessionId),s.closeSessionSignal=!0),s.resetPlay(),a.stopMaxTime(),a.invalid(),a.initStream(r,c,!1),void(e.rtm.isLogin()?(a.startMaxTime(),a.active(0)):e.streamCenter.playerList[r].isReDispatch=!0)}n&&n.player&&(0==t||1==t)&&o&&(e.dataReport.eventEndWithMsgInfo(o,"PlayState",{type:t}),1==t&&i&&e.dataReport.addMsgInfo(o,i),e.dataReport.addMsgInfo(o,{session_id:n.player.sessionId}),e.dataReport.uploadReport(o),delete e.stateCenter.reportSeqList.startPlay[r]),1===t&&e.streamCenter.playErrorCallBackList[r]?(e.streamCenter.playErrorCallBackList[r]({errorCode:i&&i.code,extendedData:i&&i.message}),delete e.streamCenter.playErrorCallBackList[r],e.logger.info("zc.opsu.1 stop play called by sdk"),e.playModule.stopPlayingStream(r,i)):e.stateCenter.actionListener("playerStateUpdate",{state:d.ClientUtil.getPlayerStateType(t),streamID:r,errorCode:i&&i.code,extendedData:i&&i.message})},this.streamCenter.onPublishStateUpdate=function(t,r,i){e.onPublishStateUpdateHandle(t,r,i)},this.streamCenter.onPublishQualityUpdate=function(t,r){e.stateCenter.actionListener("publishQualityUpdate",t,r)},this.streamCenter.onPlayQualityUpdate=function(t,r){e.stateCenter.actionListener("playQualityUpdate",t,r)},this.streamCenter.onRemoteCameraStatusUpdate=function(t,r,i){var o=s.getReportSeq();e.dataReport.newReport(o,a.ZegoRTCLogEvent.kZegoTaskRemoteCameraUpdate.event),e.dataReport.addMsgInfo(o,{stream:a.ZegoRTCLogEvent.kZegoTaskRemoteCameraUpdate.stream(t),status:a.ZegoRTCLogEvent.kZegoTaskRemoteCameraUpdate.status(r)}),e.dataReport.uploadReport(o),e.stateCenter.actionListener("remoteCameraStatusUpdate",t,r),e.stateCenter.actionListener("_remoteCameraStatusUpdate",t,i)},this.streamCenter.onRemoteMicStatusUpdate=function(t,r,i){var o=s.getReportSeq();e.dataReport.newReport(o,a.ZegoRTCLogEvent.kZegoTaskRemoteMicUpdate.event),e.dataReport.addMsgInfo(o,{stream:a.ZegoRTCLogEvent.kZegoTaskRemoteMicUpdate.stream(t),status:a.ZegoRTCLogEvent.kZegoTaskRemoteMicUpdate.status(r)}),e.dataReport.uploadReport(o),e.stateCenter.actionListener("remoteMicStatusUpdate",t,r),e.stateCenter.actionListener("_remoteMicStatusUpdate",t,i)},this.streamCenter.onSoundLevelUpdate=function(t){e.stateCenter.actionListener("soundLevelUpdate",t)},this.streamCenter.onMicSoundLevelUpdate=function(t){e.stateCenter.actionListener("capturedSoundLevelUpdate",t)}},e.prototype.bindStreamHandler=function(e){var t=this;e.onStreamUpdated=function(e,r,i){var o;o="PRIVATE"===t.stateCenter.type?i.map((function(e){return{streamID:e.stream_id,user:{userID:e.user_id,userName:e.user_name},extraInfo:e.extra_info,title:e.title,streamVer:e.stream_ver}})):i.map((function(e){return{streamID:e.streamID,user:e.user,extraInfo:e.extraInfo,urlsFLV:e.urlFlv,urlsRTMP:e.urlRtmp,urlsHLS:e.urlHls,urlsHttpsFLV:e.urlHttpsFlv,urlsHttpsHLS:e.urlHttpsHls}}));var n={};if(0===r){var c=i.map((function(e){return{stream_id:e.streamID,code:s.STREAM_DELETE_REASON[e.closeType]&&s.STREAM_DELETE_REASON[e.closeType].code||0,description:s.STREAM_DELETE_REASON[e.closeType]&&s.STREAM_DELETE_REASON[e.closeType].description||"unknown"}}));n.stream_delete_reason=c}var u=s.getReportSeq();if(t.dataReport.newReport(u,a.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamUpdateInfo.event),t.dataReport.addMsgInfo(u,{stream_update_type:a.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamUpdateInfo.stream_update_type(1===r?"added":"deleted"),update_stream:a.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamUpdateInfo.update_stream(o)}),t.dataReport.uploadReport(u),t.stateCenter.actionListener("roomStreamUpdate",e,d.ClientUtil.getSteamUpdateType(r),o,Object.keys(n).length>0?JSON.stringify(n):""),t.stateCenter.actionListener("_streamUpdated",r,i),1===r){var l=[];o.forEach((function(e){e.extraInfo&&l.push({streamID:e.streamID,user:e.user,extraInfo:e.extraInfo})})),l.length>0&&t.stateCenter.actionListener("streamExtraInfoUpdate",e,l)}},e.onPublishStateUpdate=function(e,r,i){t.logger.info("zb.opsu ",r);var o=t.stateCenter.reportSeqList.startPublish[r],n=t.streamCenter.publisherList[r];n&&n.publisher&&(0==e||1==e)&&o&&(t.dataReport.eventEndWithMsgInfo(o,"PublishState",{type:e}),1==e&&t.dataReport.addMsgInfo(o,i),t.dataReport.addMsgInfo(o,{session_id:n.publisher.sessionId}),t.dataReport.uploadReport(o),delete t.stateCenter.reportSeqList.startPublish[r]),t.stateCenter.actionListener("publisherStateUpdate",{state:d.ClientUtil.getPublisherStateType(e),streamID:r,errorCode:i.code,extendedData:i.message})},e.onStreamExtraInfoUpdated=function(e,r){var i;i="PUBLIC"===t.stateCenter.type?r.map((function(e){return{streamID:e.streamID,user:e.user,extraInfo:e.extraInfo}})):r.map((function(e){return{streamID:e.stream_id,user:{userID:e.user_id,userName:e.user_name},extraInfo:e.extra_info,title:e.title,streamVer:e.stream_ver}}));var o=s.getReportSeq();t.dataReport.newReport(o,a.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamExtraInfo.event),t.dataReport.addMsgInfo(o,{update_stream:a.ZegoRTCLogEvent.kZegoTaskLiveRoomGetStreamExtraInfo.update_stream(i)}),t.dataReport.uploadReport(o),t.stateCenter.actionListener("streamExtraInfoUpdate",e,i)}},e.prototype.screenStreamFrom=function(e,t,r){var i={};i.audio={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e}},i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxWidth:window.screen.width,maxHeight:window.screen.height}},!t&&(i.audio=!1),navigator.mediaDevices.getUserMedia(i).then((function(e){r(!0,e)})).catch((function(e){r(!1,null,e)}))},e.prototype.onPublishStateUpdateHandle=function(e,t,r){var i=this;this.logger.info("zc.opsuh.0 call");var o=this.streamCenter.publisherList[t],n=o.room;if(n)if(0==e){if(this.stateCenter.publishStreamList[t])if([s.ENUM_PUBLISH_STREAM_STATE.tryPublish,s.ENUM_PUBLISH_STREAM_STATE.retryPublish].includes(this.stateCenter.publishStreamList[t].state)&&!n.streamList.find((function(e){return e.stream_id==t}))){this.stateCenter.publishStreamList[t].state=s.ENUM_PUBLISH_STREAM_STATE.update_info;var a;a="PUBLIC"===this.stateCenter.type?s.ENUM_STREAM_SUB_CMD.liveBegin:s.ENUM_STREAM_CMD_PRI.liveBegin,n.streamHandler.updateStreamInfo(t,a,this.stateCenter.publishStreamList[t].extra_info,(function(e){"PRIVATE"===i.stateCenter.type&&i.stateCenter.publishStreamList[t]&&i.stateCenter.publishStreamList[t].state==s.ENUM_PUBLISH_STREAM_STATE.update_info&&(i.stateCenter.publishStreamList[t].state=s.ENUM_PUBLISH_STREAM_STATE.stop,n.streamHandler.onPublishStateUpdate(1,t,e),i.publishModule.stopPublishingStream(t))}))}else this.stateCenter.publishStreamList[t].state=s.ENUM_PUBLISH_STREAM_STATE.publishing,this.WebrtcOnPublishStateUpdateHandle(e,t,r)}else{if(1==e&&o&&d.ClientUtil.isReDispatch(r)){var c=o.publisher,u=o.retryDispatchHandler,l=o.publishOption;return 0!=c.sessionId&&c.signal&&c.shouldSendCloseSession()&&(c.signal.sendCloseSession(this.stateCenter.getSeq(),c.sessionId,1),c.signal.removeSession(c.sessionId),c.closeSessionSignal=!0),c.resetPublish(),u.stopMaxTime(),u.invalid(),u.initStream(t,l,!0),void(this.rtm.isLogin()?(u.startMaxTime(),u.active(0)):this.streamCenter.publisherList[t].isReDispatch=!0)}n.streamHandler.onPublishStateUpdate(e,t,r),1==e&&(this.logger.info("zc.opsuh.0 stop publish called by sdk"),this.publishModule.stopPublishingStream(t,r))}else this.logger.error("zc.opsuh.0 room not exist")},e.prototype.WebrtcOnPublishStateUpdateHandle=function(e,t,r){if(this.stateCenter.publishStreamList[t].state==s.ENUM_PUBLISH_STREAM_STATE.publishing){var i=this.streamCenter.getRoomByStreamID(t);i&&i.streamHandler.onPublishStateUpdate(e,t,r)}},e.prototype.bindListener=function(e,t){return this.stateCenter.listenerList[e]?"function"!=typeof t?(this.logger.error("zc.o.0 listener callBack must be funciton"),!1):(-1==this.stateCenter.listenerList[e].indexOf(t)&&this.stateCenter.listenerList[e].push(t),!0):(this.logger.error("zc.o.0 event "+e+" no found"),!1)},e.prototype.deleteListener=function(e,t){if(!this.stateCenter.listenerList[e])return this.logger.error("zc.o.1 listener no found"),!1;var r=this.stateCenter.listenerList[e];return t?r.splice(r.indexOf(t),1):this.stateCenter.listenerList[e]=[],!0},e}();t.RTCModules=f},4865:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.PlayModule=void 0;var o=r(1089),n=r(6706),s=r(3529),a=r(608),d=function(){function e(e,t,r,i,o){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=i,this.rtm=o}return e.prototype.startPlayingStream=function(e,t,r){var i=this;return this.logger.info(o.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM+" call ",e),new Promise((function(o,n){return i._handlePlayStream(e,t,o,n,r)}))},e.prototype._handlePlayStream=function(e,t,r,d,c){var u=this,l=n.getReportSeq();this.stateCenter.reportSeqList.startPlay[e]=l,this.dataReport.newReport(l,s.ZegoRTCLogEvent.kZegoTaskPlayStart.event);var h,p=function(t,r){u.logger.error(o.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM+" "+(r||t.message)),u.dataReport.uploadReport(l,void 0,t,r),delete u.stateCenter.reportSeqList.startPlay[e],d&&d(i(i({},t),{errorCode:t.code,extendedData:t.message+(r?" "+r:"")}))};if(void 0===e||"string"!=typeof e||""===e)return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayParamError,"stream id type error"),!1;if(e.length>n.MAX_STREAM_ID_LENGTH)return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayStreamIDToLongError,"stream id length limit "+n.MAX_STREAM_ID_LENGTH),!1;if(!a.ClientUtil.checkIllegalCharacters(e))return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayStreamIDInvalidCharacterError),!1;if(void 0!==t&&"object"!=typeof t)return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayParamError,"playOption must be object"),!1;if(this.stateCenter.customUrl&&0!=this.stateCenter.customUrl.length)this.logger.info("zc.p.sps.1 customUrl "+JSON.stringify(this.stateCenter.customUrl)),h=this.stateCenter.customUrl;else{var g=this.stateCenter.settingConfig.getSetting("signal_nodes",!0);g&&g instanceof Array&&g.length>0&&(h=g,this.logger.info("zc.p.sps.1 setting config signal_nodes "+JSON.stringify(g)))}if(h)return this.streamCenter.setPlayStateStart(e,t,c)?(this.streamCenter.onPlayStateUpdate(n.ENUM_PLAY_STATE_UPDATE.retry,e,{code:0,message:""}),this.streamCenter.playerList[e].serverUrls=h,this.streamCenter.startPlayingStream(e,!1,(function(e){r&&r(e)}))):(p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRepeatedPullError,"cannot start play"),!1);if(this.dataReport.addMsgInfo(l,{stream:s.ZegoRTCLogEvent.kZegoTaskPlayStart.stream(e),playOption:s.ZegoRTCLogEvent.kZegoTaskPlayStart.playOption(t),use_na:this.stateCenter.useNetAgent?1:0}),this.stateCenter.useNetAgent&&this.stateCenter.playAccelerate&&this.stateCenter.roomList.length>0)this.logger.info(o.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM+" play accelerate");else if(this.rtm.isDisConnect())return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNoLoginError),!1;this.stateCenter.pullLimited||(e=NaN+e),t&&t.videoCodec&&(t.videoCodec=t.videoCodec.toUpperCase());var f=this.stateCenter.settingConfig.getSetting("resource_mode",!0);if(f&&(this.logger.info(o.ZEGO_WEBRTC_ACTION.START_PLAYING_STREAM," setting resource_mode "+f),!t&&(t={}),t.resourceMode=f),!this.streamCenter.setPlayStateStart(e,t,c))return p(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRepeatedPullError,"cannot start play"),!1;this.streamCenter.onPlayStateUpdate(n.ENUM_PLAY_STATE_UPDATE.retry,e,{code:0,message:""}),this.streamCenter.playSuccessCallBackList[e]=function(e){r&&r(e)},d&&(this.streamCenter.playErrorCallBackList[e]=d);var _=this.stateCenter.useNetAgent;if(_)return this.stateCenter.appConfig?(this.streamCenter.playerList[e].serverUrls=2===(null==t?void 0:t.resourceMode)?["unified_l3"]:["unified_rtc"],this.streamCenter.startPlayingStream(e,_,this.streamCenter.playSuccessCallBackList[e]),!0):(this.streamCenter.waitPlayList.push(e),!0);var m=this.streamCenter.playerList[e].retryDispatchHandler;return m.stopMaxTime(),m.invalid(),m.initStream(e,t,!1),m.startMaxTime(),m.active(0)},e.prototype.stopPlayingStream=function(e,t){var r,i;this.logger.info(o.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" call",e);var a=n.getReportSeq();if(this.stateCenter.reportSeqList.stopPlay[e]=a,this.dataReport.newReport(a,s.ZegoRTCLogEvent.kZegoTaskPlayStop.event),this.dataReport.addMsgInfo(a,{stream:s.ZegoRTCLogEvent.kZegoTaskPlayStop.stream(e)}),"string"!=typeof e||""===e)return this.logger.error(o.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" streamid must be string and not empty"),this.dataReport.uploadReport(a,void 0,s.ZegoRTCLogEvent.kZegoTaskPlayStop.error.kParamError,"stream id type error"),void delete this.stateCenter.reportSeqList.stopPlay[e];var d=this.streamCenter.playerList[e],c=d&&d.player&&d.player.state!==n.ENUM_PLAY_STATE.stop||(null===(r=null==d?void 0:d.retryStreamHandler)||void 0===r?void 0:r.isRetrying());for(var u in this.streamCenter.stopPlayingStream(e),this.stateCenter.streamUrlMap)if(this.stateCenter.streamUrlMap[u]===e){delete this.stateCenter.streamUrlMap[u];break}this.dataReport.addMsgInfo(a,{session_id:null===(i=null==d?void 0:d.player)||void 0===i?void 0:i.sessionId}),this.dataReport.uploadReport(a),c&&this.streamCenter.onPlayStateUpdate(n.ENUM_PLAY_STATE_UPDATE.error,e,t||{code:0,message:""}),this.logger.debug(o.ZEGO_WEBRTC_ACTION.STOP_PLAYING_STREAM+" call success")},e.prototype.mutePlayStream=function(e,t,r){return new Promise((function(e,t){e(!1)}))},e.prototype.setStreamAudioOutput=function(e,t){return!1},e.prototype.startWaitPlay=function(){var e=this;this.streamCenter.waitPlayList.forEach((function(t){e.streamCenter.startPlayingStream(t,e.stateCenter.useNetAgent,e.streamCenter.playSuccessCallBackList[t])})),this.streamCenter.waitPlayList=[]},e.prototype.getStreamStats=function(e){var t,r,i;return this.logger.info(o.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" call"),"string"==typeof e&&(i=null===(t=this.streamCenter.playerList[e])||void 0===t?void 0:t.player),i&&(null===(r=null==i?void 0:i.qualityHandler)||void 0===r?void 0:r.currentQuality)?i.qualityHandler.currentQuality||null:(this.logger.error("zsc.sp.0 stream is not playing"),null)},e}();t.PlayModule=d},5634:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.PlayStreamQuality=void 0;var o=r(6706),n=r(1089),s=r(3529),a=r(608),d=function(){function e(e,t,r,i){this.player=t,this.logger=r,this.dataReport=i,this.playQualityList=[],this.maxQualityListCount=10,this.qualityTimer=null,this.lastPlayStats={audioPacketsLost:0,videoPacketsLost:0,time:0,audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,audioPacketsReceived:0,videoPacketsReceived:0,framesDecoded:0,framesReceived:0,framesDropped:0,audioBitrate:0},this.currentQuality={video:{videoBitrate:0,videoFPS:0,videoTransferFPS:0,frameHeight:0,frameWidth:0,muteState:"1",videoQuality:-1,googCodecName:"",videoPacketsLost:0,videoPacketsLostRate:0,videoFramesDecoded:0,videoFramesDropped:0},audio:{audioBitrate:0,audioCodec:"opus",muteState:"1",audioQuality:-1,audioFPS:0,audioJitter:0,audioLevel:0,audioPacketsLost:0,audioPacketsLostRate:0,audioSamplingRate:0,audioSendLevel:0,googCodecName:""},peerToPeerDelay:0,peerToPeerPacketLostRate:0},this.decodeStartTime=0,this.netQuality=0,this.probeTime=0,this.probeInterval=6e4,this.probeState=o.ENUM_PROBE_STATE.probed,this.probeTimer=null,this.probeTimeoutInterval=3e4,this.qualityUpload=!1,this.qualityUploadInterval=3e4,this.qualityUploadLastTime=0,this.cumulativeQuality={},this.audioBreakThreshold=200,this.videoBreakThreshold=500,this.videoBreak={breakStartTime:void 0,cumulativeBreakDuration:0,cumulativeDecodeDuration:0,decodeStartTime:void 0,decodeEndTime:void 0,totalDuration:0,noBreakNoDecodeDuration:0,resumeRecv:!0},this.audioBreak={breakStartTime:void 0,cumulativeBreakDuration:0,cumulativeDecodeDuration:0,decodeStartTime:void 0,decodeEndTime:void 0,totalDuration:0,noBreakNoDecodeDuration:0,resumeRecv:!0},this.lastSampleTime=0,this.videoBreakReport={breakDuration:0,breakCancelDuration:0,decodeTime:0},this.audioBreakReport={breakDuration:0,breakCancelDuration:0,decodeTime:0},this.totalQuality={totalSquaredInterFrameDelay:0,totalInterFrameDelay:0,framesDecode:0,totalSamplesReceived:0,concealedSamples:0,audioBytesReceived:0},this.currentSecondQuality={totalSquaredInterFrameDelay:0,totalInterFrameDelay:0,framesDecode:0,totalSamplesReceived:0,concealedSamples:0},this.onBreakEnd=function(e,t,r,i){if(void 0===i&&(i="video"),t.breakStartTime){var o=e-t.breakStartTime;o>=r&&(t.cumulativeBreakDuration+=o),t.breakStartTime=void 0}},this.p2pNetStats={p2pLostRate:0,p2pRTT:0},this.sampleTimes=0,this.qualitySampleInterval=1e3,this.qualityTimeInterval=e,this.currentQuality.video.muteState=this.player.videoMuteState,this.currentQuality.audio.muteState=this.player.audioMuteState}return Object.defineProperty(e.prototype,"streamId",{get:function(){return this.player.streamId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.player.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"peerID",{get:function(){return this.player.peerID},enumerable:!1,configurable:!0}),e.prototype.getPlayStats=function(e,t){var r=this;if(null!=e){var i=this.sampleTimes%parseInt((this.qualityTimeInterval/this.qualitySampleInterval).toString())==0;this.sampleTimes,parseInt((this.qualityTimeInterval/this.qualitySampleInterval).toString()),i&&this.getP2PNetStats();for(var d,c=document.querySelectorAll("video, audio"),u=0;u<c.length;u++)c[u].srcObject===this.player.playStream&&(d=c[u]);var l={sampleTimeWindow:this.qualityTimeInterval,audioFractionLost:0,audioPacketsLost:0,audioPacketsLostRate:0,audioBitrate:0,audioLevel:0,audioSendLevel:0,audioSamplingRate:0,audioCodec:"opus",audioQuality:0,audioFPS:0,videoQuality:0,videoPacketsLost:0,videoPacketsLostRate:0,videoBitrate:0,videoFPS:0,nackCount:0,pliCount:0,audioJitter:0,videoFractionLost:0,videoFramesDecoded:0,frameHeight:0,frameWidth:0,videoTransferFPS:0,videoFramesDropped:0,totalRoundTripTime:0,currentRoundTripTime:0,googBandwidthLimitedResolution:void 0,videoCodecName:"",audioCodecName:"",googCpuLimitedResolution:void 0,googAvailableSendBandwidth:0,audioMuteState:this.player.audioMuteState,videoMuteState:this.player.videoMuteState,muted:d?d.muted:void 0,paused:d?d.paused:void 0,volume:d?d.volume:void 0,sinkId:d?d.sinkId:void 0},h=this.lastPlayStats.time,p=0,g=0,f=0,_=0,m=0,v=0,E=0,S=null,T=null;e.forEach((function(e){["ssrc","inbound-rtp"].includes(e.type)&&("video"==e.mediaType||e.id.indexOf("VideoStream")>=0)&&(S=e),("inbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesReceived)&&("audio"==e.mediaType||e.id.indexOf("AudioStream")>=0)&&(T=e)}));var C=function(e,t,i,o,s,a,d,c,u){if(void 0===c&&(c=d),void 0===u&&(u="video"),s>1e3&&(s=1e3),o.breakStartTime)if(i)if(0===t)e-o.breakStartTime>=22e3&&r.onBreakEnd(e,o,s,u),a.breakDuration+=1e3;else if(d>=s)if(d<500)if(d+c<1e3){var l=e-(1e3-c);r.onBreakEnd(l,o,s,u),o.breakStartTime=e-d,a.breakDuration+=c+d,a.decodeTime+=1e3-(c+d)}else r.onBreakEnd(e-1e3+c,o,s,u),o.breakStartTime=e-1e3+c,a.breakDuration+=1e3;else d>=500&&(r.onBreakEnd(e-d,o,s,u),o.breakStartTime=e-d,a.breakDuration+=1e3);else c<=s?(r.onBreakEnd(e-1e3+c,o,s,u),o.breakStartTime=void 0,a.breakDuration+=c,a.decodeTime+=1e3-c):a.breakDuration+=1e3;else{o.resumeRecv=!1;var h=e-1e3,p=h-o.breakStartTime;p<=0&&(r.logger.error(n.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" breakCancelDuration less than 0.  ("+o.breakStartTime+", "+h+")"),p=0),o.breakStartTime=void 0,o.noBreakNoDecodeDuration+=p,a.breakCancelDuration+=p}else i?0===t?o.resumeRecv?(o.breakStartTime=e-1e3,a.breakDuration+=1e3):o.noBreakNoDecodeDuration+=1e3:c>s?o.resumeRecv?(o.breakStartTime=e-c,a.breakDuration+=c,a.decodeTime+=1e3-c):o.noBreakNoDecodeDuration+=1e3:a.decodeTime+=1e3:o.decodeStartTime&&(0===t?(o.resumeRecv=!1,o.noBreakNoDecodeDuration+=1e3):a.decodeTime+=1e3);i&&t&&(o.resumeRecv=!0)},y=(new Date).getTime(),R=function(e,t){return e>t?e-t:0};if(this.lastSampleTime||(this.lastSampleTime=y-1e3),S){var b=S.totalInterFrameDelay,I=S.framesDecoded,O=S.totalSquaredInterFrameDelay,P=R(I,this.totalQuality.framesDecode);this.totalQuality.framesDecode=I;var k=R(b,this.totalQuality.totalInterFrameDelay);this.totalQuality.totalInterFrameDelay=b;var L=R(O,this.totalQuality.totalSquaredInterFrameDelay);this.totalQuality.totalSquaredInterFrameDelay=O;var A=(L-Math.pow(k,2)/(P||1))/(P||1);A=A>0?A:-A;var N=parseInt((1e3/(P+1)).toString()),M=1e3*Math.sqrt(A),w=k/(P||1)*1e3||N,D=(w=parseInt((w>1e3?1e3:w).toString()))+M;D=parseInt((D>1e3?1e3:D).toString()),P>0&&0===this.player.cameraStatus&&!this.videoBreak.decodeStartTime&&(this.videoBreak.decodeStartTime=y-1e3),this.videoBreak.decodeStartTime&&C(y,P,0===this.player.cameraStatus&&this.player.playMediaStatus.video,this.videoBreak,this.videoBreakThreshold,this.videoBreakReport,w,D)}if(T){var U=T,B=U.totalSamplesReceived,x=U.concealedSamples,Z=U.bytesReceived,G=R(B,this.totalQuality.totalSamplesReceived);this.totalQuality.totalSamplesReceived=B;var H=R(x,this.totalQuality.concealedSamples);this.totalQuality.concealedSamples=x;var W=R(Z,this.totalQuality.audioBytesReceived);this.totalQuality.audioBytesReceived=Z;var q=parseInt((H/(G||1)*1e3).toString());W>0&&0===this.player.micStatus&&!this.audioBreak.decodeStartTime&&(this.audioBreak.decodeStartTime=y-1e3),this.audioBreak.decodeStartTime&&C(y,W,0===this.player.micStatus&&this.player.playMediaStatus.audio,this.audioBreak,this.audioBreakThreshold,this.audioBreakReport,q,q,"audio")}if(t&&t.result().forEach((function(e){i&&("ssrc"==e.type&&(e.names().indexOf("googBandwidthLimitedResolution")>=0&&(l.googBandwidthLimitedResolution=e.stat("googBandwidthLimitedResolution")),e.names().indexOf("codecImplementationName")>=0&&(l.codecImplementationName=e.stat("codecImplementationName")),"video"==e.stat("mediaType")&&(e.names().indexOf("googCodecName")>=0&&(l.videoCodecName=e.stat("googCodecName")),e.names().indexOf("googCurrentDelayMs")>=0&&(E=e.stat("googCurrentDelayMs"))),"audio"==e.stat("mediaType")&&(e.names().indexOf("googCodecName")>=0&&(l.audioCodecName=e.stat("googCodecName")),e.names().indexOf("googCurrentDelayMs")>=0&&(v=e.stat("googCurrentDelayMs"))),e.names().indexOf("googCpuLimitedResolution")>=0&&(l.googCpuLimitedResolution=e.stat("googCpuLimitedResolution"))),"VideoBwe"==e.type&&e.names().indexOf("googAvailableSendBandwidth")>=0&&(l.googAvailableSendBandwidth=e.stat("googAvailableSendBandwidth")))})),i){e.forEach((function(e){if(("inbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesReceived)&&("audio"==e.mediaType||e.id.indexOf("AudioStream")>=0)){0!=h&&(l.audioBitrate=8*(e.bytesReceived-r.lastPlayStats.audioBytesReceived)/(e.timestamp-h),(i=e.packetsLost-r.lastPlayStats.audioPacketsLost)>0&&(g=i/(i+e.packetsReceived-r.lastPlayStats.audioPacketsReceived))),l.audioBitrate<0&&(l.audioBitrate=0),l.audioJitter=e.jitter,e.packetsLost>0&&(l.audioPacketsLost=e.packetsLost),l.audioFractionLost=e.fractionLost;var t=e.packetsLost-r.lastPlayStats.audioPacketsLost;l.audioFPS=(e.packetsReceived-r.lastPlayStats.audioPacketsReceived)/(e.timestamp-h)*1e3,l.audioPacketsLostRate=t>0?t/(e.packetsReceived-r.lastPlayStats.audioPacketsReceived+t):0,r.lastPlayStats.audioBytesReceived=e.bytesReceived,e.packetsLost>0&&(r.lastPlayStats.audioPacketsLost=e.packetsLost),r.lastPlayStats.audioPacketsReceived=e.packetsReceived,r.lastPlayStats.audioTime=e.timestamp,r.lastPlayStats.time=e.timestamp,r.lastPlayStats.audioBitrate=l.audioBitrate,_=e.jitter}else if(("inbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesReceived)&&("video"==e.mediaType||e.id.indexOf("VideoStream")>=0)){var i;0!=h?(l.videoBitrate=8*(e.bytesReceived-r.lastPlayStats.videoBytesReceived)/(e.timestamp-h),l.videoFPS=1e3*(e.framesDecoded-r.lastPlayStats.framesDecoded)/(e.timestamp-h),(i=e.packetsLost-r.lastPlayStats.videoPacketsLost)>0&&(f=i/(i+e.packetsReceived-r.lastPlayStats.videoPacketsReceived))):"number"==typeof e.framesPerSecond&&(l.videoFPS=e.framesPerSecond),l.videoBitrate<0&&(l.videoBitrate=0),l.videoFPS<0&&(l.videoFPS=0),l.nackCount=e.nackCount,l.pliCount=e.pliCount,l.videoFractionLost=e.fractionLost,l.videoFramesDecoded=e.framesDecoded,e.packetsLost>0&&(l.videoPacketsLost=e.packetsLost),t=e.packetsLost-r.lastPlayStats.videoPacketsLost,l.videoPacketsLostRate=t>0?t/(e.packetsReceived-r.lastPlayStats.videoPacketsReceived+t):0,r.lastPlayStats.videoBytesReceived=e.bytesReceived,r.lastPlayStats.framesDecoded=e.framesDecoded,e.packetsLost>0&&(r.lastPlayStats.videoPacketsLost=e.packetsLost),r.lastPlayStats.videoPacketsReceived=e.packetsReceived,r.lastPlayStats.videoTime=e.timestamp,r.lastPlayStats.time=e.timestamp,m=e.jitter}else if("track"==e.type&&("video"==e.kind||e.id.indexOf("video")>=0)||e.frameWidth){if(l.frameHeight=e.frameHeight,l.frameWidth=e.frameWidth,0===h||r.lastPlayStats.frameHeight===e.frameHeight&&r.lastPlayStats.frameWidth===e.frameWidth)0===h&&(r.lastPlayStats.frameHeight=e.frameHeight,r.lastPlayStats.frameWidth=e.frameWidth);else{var n=o.getReportSeq();r.dataReport.newReport(n,s.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.event),r.dataReport.addMsgInfo(n,{session_id:s.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.session_id(r.sessionId),w:s.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.w(e.frameWidth),h:s.ZegoRTCLogEvent.kZegoTaskVideoPlaySize.h(e.frameHeight)}),!r.player.isProbe&&r.dataReport.uploadReport(n),r.lastPlayStats.frameHeight=e.frameHeight,r.lastPlayStats.frameWidth=e.frameWidth}0!=h&&(l.videoTransferFPS=1e3*(e.framesReceived-r.lastPlayStats.framesReceived)/(e.timestamp-h),l.videoFramesDropped=e.framesDropped-r.lastPlayStats.framesDropped),l.videoTransferFPS<0&&(l.videoTransferFPS=0),l.videoFramesDropped<0&&(l.videoFramesDropped=0),r.lastPlayStats.framesReceived=e.framesReceived,r.lastPlayStats.framesDropped=e.framesDropped}else"track"==e.type&&("audio"==e.kind||e.id.indexOf("audio")>=0)?(l.audioLevel=e.audioLevel||0,l.audioSendLevel=e.totalAudioEnergy,l.audioSamplingRate=e.totalSamplesDuration):"candidate-pair"==e.type&&(null!=e.totalRoundTripTime&&(l.totalRoundTripTime=e.totalRoundTripTime),null!=e.currentRoundTripTime&&(l.currentRoundTripTime=e.currentRoundTripTime,p=1e3*l.currentRoundTripTime))})),this.lastPlayStats.googCurrentDelayMs=Number(v)||Number(E)||0,f=isNaN(f)||f<0?0:f,m=isNaN(m)||m<0?0:m,g=isNaN(g)||g<0?0:g,_=isNaN(_)||_<0?0:_;var z=a.ClientUtil.getNetQuality(p,f,m),F=a.ClientUtil.getNetQuality(p,g,_);l.audioQuality=h>0?a.ClientUtil.quality2QualityGrade(z):0,l.videoQuality=h>0?a.ClientUtil.quality2QualityGrade(F):0;var j=Math.min(z,F);this.netQuality=j,l.peerToPeerDelay=isNaN(this.p2pNetStats.p2pRTT)?0:parseInt((this.p2pNetStats.p2pRTT/2+this.lastPlayStats.googCurrentDelayMs).toString()),l.peerToPeerPacketLostRate=this.p2pNetStats.p2pLostRate,h>0&&j<=o.QUALITY_CONSTANT.MiddleMinQuality&&y>this.probeTime+this.probeInterval&&(this.logger.info(n.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" netQuality "+j+" start net probe"),this.probeState=o.ENUM_PROBE_STATE.tryProbe,this.player.streamCenter.startNetProbe(!1,this.player,this.player.gwNodeList),this.probeTime=y),this.uploadPlayQuality(l,y),this.updateCurrentQualityStats(l),0!=h&&this.player.onPlayQualityUpdate(this.streamId,this.currentQuality)}}},e.prototype.updateCurrentQualityStats=function(e){var t=e.videoBitrate,r=e.videoFPS,o=e.videoTransferFPS,n=e.frameHeight,s=e.frameWidth,a=e.videoMuteState,d=e.videoQuality,c=e.videoFramesDecoded,u=e.videoFramesDropped,l=e.videoPacketsLost,h=e.videoPacketsLostRate,p=e.audioBitrate,g=e.audioCodec,f=e.audioMuteState,_=e.audioQuality,m=e.audioFPS,v=e.audioJitter,E=e.audioLevel,S=e.audioPacketsLost,T=e.audioPacketsLostRate,C=e.audioSamplingRate,y=e.audioSendLevel,R=e.nackCount,b=e.pliCount,I=e.totalRoundTripTime,O=e.currentRoundTripTime,P=e.peerToPeerDelay,k=e.peerToPeerPacketLostRate,L=e.sampleTimeWindow,A={video:i(i({},this.currentQuality.video),{videoBitrate:t,videoFPS:r,videoTransferFPS:o,frameHeight:n,frameWidth:s,videoQuality:d,videoFramesDecoded:c,videoFramesDropped:u,videoPacketsLost:l,videoPacketsLostRate:h,muteState:a}),audio:i(i({},this.currentQuality.audio),{audioBitrate:p,audioCodec:g,audioQuality:_,audioFPS:m,audioJitter:v,audioLevel:E,audioPacketsLost:S,audioPacketsLostRate:T,audioSamplingRate:C,audioSendLevel:y,muteState:f}),nackCount:R,pliCount:b,totalRoundTripTime:I,currentRoundTripTime:O,peerToPeerDelay:P,peerToPeerPacketLostRate:(k||0)/255,sampleTimeWindow:L};if(void 0!==e.muted){var N=e.muted,M=e.paused,w=e.volume,D=e.sinkId;A.muted=N,A.paused=M,A.volume=w,A.sinkId=D}if(void 0!==e.videoCodecName){var U=e.videoCodecName,B=e.audioCodecName,x=e.codecImplementationName,Z=e.googAvailableSendBandwidth;A.video.googCodecName=U,A.audio.googCodecName=B,A.codecImplementationName=x,A.googAvailableSendBandwidth=Z}this.currentQuality=A},e.prototype.uploadPlayQuality=function(e,t){if(this.qualityUpload&&this.player.signal.isServerConnected){var r=t;(0==this.qualityUploadLastTime||r-this.qualityUploadLastTime>=2e3)&&(e.stream_type="play",e.stream_id=this.streamId,e.timeStamp=parseInt((r/1e3).toString()),e.video_break_duration=this.videoBreakReport.breakDuration,e.video_break_cancel_duration=this.videoBreakReport.breakCancelDuration,e.video_decode_time=this.videoBreakReport.decodeTime,this.videoBreakReport.breakCancelDuration=0,this.videoBreakReport.breakDuration=0,this.videoBreakReport.decodeTime=0,e.audio_break_duration=this.audioBreakReport.breakDuration,e.audio_break_cancel_duration=this.audioBreakReport.breakCancelDuration,e.audio_decode_time=this.audioBreakReport.decodeTime,this.audioBreakReport.breakCancelDuration=0,this.audioBreakReport.breakDuration=0,this.audioBreakReport.decodeTime=0,e.real_sampling_interval=r-this.lastSampleTime,this.lastSampleTime=r,this.logger.info(n.ZEGO_WEBRTC_ACTION.PLAYER_UPLOAD_PLAYER_QUALITY+" "+this.streamId+" upload"+JSON.stringify(e)),this.player.streamCenter.updateQuality(1,e),this.qualityUploadLastTime=r)}},e.prototype.getP2PNetStats=function(){var e=this;this.player.signal.getP2PNetStats(o.getSeq(),this.sessionId,this.peerID,(function(t,r,i){var o=i.p2p_lost_rate,n=i.p2p_rtt;e.p2pNetStats.p2pLostRate=o||0,e.p2pNetStats.p2pRTT=n||0}),(function(e){}))},e.prototype.setPlayQualityTimer=function(){var e=this;null==this.qualityTimer&&(this.logger.info(n.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" "+this.streamId+" startTimer"),this.clearPlayQualityTimer(),this.getP2PNetStats(),this.qualityTimer=setInterval((function(){e.sampleTimes++;var t=e.player.peerConnection;if(t){var r=[t.getStats(null)];"chrome"==e.player.stateCenter.browser&&r.push(new Promise((function(e,r){t.getStats((function(t){return e(t)}),(function(e){return r(e)}))}))),Promise.all(r).then((function(t){e.getPlayStats(t[0],t[1])})).catch((function(t){e.logger.error(n.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" "+e.streamId+" getStats error "+t.toString())}))}}),1e3),this.lastPlayStats={audioPacketsLost:0,videoPacketsLost:0,time:0,audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,videoPacketsReceived:0,audioPacketsReceived:0,framesDecoded:0,framesReceived:0,framesDropped:0,audioBitrate:0})},e.prototype.clearPlayQualityTimer=function(){if(null!=this.qualityTimer){clearInterval(this.qualityTimer),this.qualityTimer=null;var e=(new Date).getTime();this.lastSampleTime=0,this.sampleTimes=0,this.totalQuality={totalSquaredInterFrameDelay:0,totalInterFrameDelay:0,framesDecode:0,totalSamplesReceived:0,concealedSamples:0,audioBytesReceived:0};var t=function(t,r,i,o,n){if(void 0===n&&(n="video"),i=i>1e3?1e3:i,r.breakDuration=0,r.breakCancelDuration=0,r.decodeTime=0,t.decodeStartTime){var s=e,a=s-t.decodeStartTime;if(t.decodeStartTime=void 0,t.totalDuration+=a,t.breakStartTime){var d=s-t.breakStartTime;t.breakStartTime=void 0,o?d>i&&(t.cumulativeBreakDuration+=d):t.noBreakNoDecodeDuration+=d}var c=t.cumulativeBreakDuration,u=t.totalDuration-t.cumulativeBreakDuration-t.noBreakNoDecodeDuration;return t.cumulativeDecodeDuration=u,{cumulativeBreakDuration:c,cumulativeDecodeDuration:u}}return{cumulativeBreakDuration:0,cumulativeDecodeDuration:0}},r=0===this.player.cameraStatus&&this.player.playMediaStatus.video;t(this.videoBreak,this.videoBreakReport,this.videoBreakThreshold,r);var i=0===this.player.micStatus&&this.player.playMediaStatus.audio;t(this.audioBreak,this.audioBreakReport,this.audioBreakThreshold,i,"audio")}this.lastPlayStats={audioPacketsLost:0,videoPacketsLost:0,time:0,audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,videoPacketsReceived:0,audioPacketsReceived:0,framesDecoded:0,framesDropped:0,framesReceived:0,audioBitrate:0}},e.prototype.startProbeTimeout=function(){var e=this;this.probeTimer=setTimeout((function(){e.logger.error(n.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" probe timeout"),e.player.playStateUpdateError(s.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kProbeTimeOutError)}),this.probeTimeoutInterval)},e.prototype.stopProbeTimeout=function(){this.probeTimer&&(clearTimeout(this.probeTimer),this.probeTimer=null)},e}();t.PlayStreamQuality=d},3849:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoPlayWeb=void 0;var o=r(6706),n=r(4767),s=r(608),a=r(3529),d=r(1089),c=r(5634),u=r(7646),l=function(){function e(e,t,r,i,n,a,d){var l=this;this.state=o.ENUM_PLAY_STATE.stop,this.candidateInfo=[],this.broadcasterStatus=o.ENUM_BROADCASTER_STATUS.stop,this.playQualityList=[],this.maxQualityListCount=10,this.reportSeq=NaN,this.streamReportSeq=o.getSeq(),this.videoSizeCallback=!1,this.remoteStream=null,this.playStream=null,this.playOption={},this.playMediaStatus={video:!0,audio:!0},this.closeSessionSignal=!1,this.stateNego=o.ENUM_PLAY_STATE_NEGO.stop,this.negoTimer=null,this.negoInterval=25e3,this.cameraStatus=0,this.micStatus=0,this.hasSentStreamStatus=!1,this.playEvent=!1,this.gotStreamStatus=!1,this.soundLevel=0,this.mic=null,this.script=null,this.beginTime=0,this.firstFrameTime=0,this.resourceMode=0,this.gwNode="",this.gwNodeList=[],this.gwNodeTTL=0,this.isPeer=!1,this.peerFailCount=0,this.isProbe=!1,this.peerID=0,this.isRecvClientInfo=!1,this.videoCodec="",this.videoCodecTimes=0,this.answerSdpTime=0,this.audioMuteState="0",this.videoMuteState="0",this.first_pkt=!0,this.next_sn=[],this.pkt_list=[],this.onDataChannelList=[],this.sideMediaConfig={isSEIStart:!1,unregisterSeiFilter:"",filterSize:0},this.iceDisconnectedMaxTime=15e3,this.decodeVideoFrame=function(e,t){if("VP8"===l.videoCodec)t.terminate();else{for(var r=new DataView(e.data),i=0,o=new u.H264Parser(r),n=0,a=!1;o.NextNalu(a);)if(7!=(n=31&r.getUint8(o.nalu_start+o.start_code_size))&&8!=n&&9!=n){if(i=o.nalu_start+o.start_code_size+1,6!=n)break;a=!0;for(var d=0;255===r.getUint8(i);)d+=255,i++;if(243===(d+=r.getUint8(i++))||5===d||100===d){for(var c=0;255===r.getUint8(i);)c+=255,i++;if(c+=r.getUint8(i++),e.data.byteLength-i<c)break;var h=new Uint8Array(4+c);switch(h[0]=0,h[1]=0,d){case 100:h[2]=3,h[3]=235;break;case 5:h[2]=3,h[3]=236;break;case 243:h[2]=3,h[3]=237}for(var p=[],g=i;g<i+c;)0!==r.getInt8(g)||0!==r.getInt8(g+1)||3!==r.getInt8(g+2)||0!==r.getInt8(g+3)&&1!==r.getInt8(g+3)&&2!==r.getInt8(g+3)&&3!==r.getInt8(g+3)?g++:(p.push(g+2),g+=4);for(var f=0,_=0;_<c+p.length;_++)p.includes(i)?(i++,f++):h[4+_-f]=r.getUint8(i++);var m=!1;if(243===d)m=!0;else if(5===d&&l.sideMediaConfig.unregisterSeiFilter){var v=h.slice(4,4+l.sideMediaConfig.filterSize);s.ClientUtil.decodeString(v)===l.sideMediaConfig.unregisterSeiFilter&&(m=!0)}m&&l.stateCenter.actionListener("playerRecvSEI",l.streamId,h)}}t.enqueue(e)}},this.decodeAudioFrame=function(e,t){t.enqueue(e)},this.logger=e,this.signal=t,this.dataReport=r,this.streamCenter=n,this.ac=a,this.stateCenter=d,this.dataReport.newReport(this.streamReportSeq),this.dataReport.addMsgInfo(this.streamReportSeq,{abs_time:Date.now()}),this.qualityHandler=new c.PlayStreamQuality(i,this,this.logger,this.dataReport),this.resourceMode=this.stateCenter.settingConfig.getSetting("resource_mode")}return Object.defineProperty(e.prototype,"probeState",{get:function(){return this.qualityHandler.probeState},set:function(e){this.qualityHandler.probeState=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"netQuality",{get:function(){return this.qualityHandler.netQuality},set:function(e){this.qualityHandler.netQuality=e},enumerable:!1,configurable:!0}),e.prototype.startPlay=function(e,t,r){var i,o,n,c,u=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" called ",e),this.playEvent=!1,this.signal&&this.signal.negoInterval&&(this.negoInterval=this.signal.negoInterval),e){if(this.streamId=e,this.getRemoteStreamSuc=t,this.playOption=r||{},this.playMediaStatus={video:void 0===this.playOption.video||!!this.playOption.video,audio:void 0===this.playOption.audio||!!this.playOption.audio},r&&r.videoCodec&&(this.playOption.videoCodec=r.videoCodec),"boolean"==typeof(null==r?void 0:r.isSEIStart)&&(this.sideMediaConfig.isSEIStart=null==r?void 0:r.isSEIStart),this.sideMediaConfig.isSEIStart){var l=s.ClientUtil.isSupportEncodedTransforms();((null===(i=this.playOption)||void 0===i?void 0:i.videoCodec)&&"H264"!==(null===(o=this.playOption)||void 0===o?void 0:o.videoCodec)||!l)&&(this.sideMediaConfig.isSEIStart=!1)}(null===(n=this.stateCenter.seiConfig)||void 0===n?void 0:n.unregisterSEIFilter)&&(this.sideMediaConfig.unregisterSeiFilter=null===(c=this.stateCenter.seiConfig)||void 0===c?void 0:c.unregisterSEIFilter,this.sideMediaConfig.filterSize=s.ClientUtil.encodeString(this.sideMediaConfig.unregisterSeiFilter).byteLength),null==(null==r?void 0:r.streamType)&&void 0!==this.stateCenter.streamType&&(this.playOption.streamType=this.stateCenter.streamType);var h=this.stateCenter.settingConfig.getSetting("play_video_codec",!0);h&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" setting play_video_codec "+h),this.playOption.videoCodec=h),this.dataReport.addMsgInfo(this.reportSeq,{audio_activate:a.ZegoRTCLogEvent.kZegoTaskPlayStart.audio_activate(1==this.playOption.audio?1:0==this.playOption.audio?0:1),video_activate:a.ZegoRTCLogEvent.kZegoTaskPlayStart.video_activate(1==this.playOption.video?1:0==this.playOption.video?0:1)}),this.isPeer?this.createOffer({encodedInsertableStreams:this.sideMediaConfig.isSEIStart}):this.createSession(),this.negoTimer=setTimeout((function(){u.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" waiting timeout"),u.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNegoTimeoutError)}),this.negoInterval),this.isProbe&&this.qualityHandler.startProbeTimeout()}else this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" streamId is null")},e.prototype.onCreatePlaySessionSuccess=function(e){var t=this;this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+this.streamId+" success");var r=[];if(e.turn_server){var i=e.turn_server,o=this.stateCenter.turnOverTcpOnly,n=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);n&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" setting udp_or_tcp "+n),o="tcp"===n),o&&(i=i.replace("udp","tcp")),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" turn over tcp "+i),r.push(i)}e.stun_server&&r.push(e.stun_server);var s={iceTransportPolicy:"relay",iceServers:[{urls:r,username:e.turn_username,credential:e.turn_auth_key}],encodedInsertableStreams:!0};this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+this.streamId+" username: "+e.turn_username),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+this.streamId+" credential: "+e.turn_auth_key),this.createOffer(s),this.signal.registerPushCallback("MediaDescPush",this.sessionId,(function(e,r,i){t.onRecvMediaDesc(e,r,i)})),this.signal.registerPushCallback("CandidateInfoPush",this.sessionId,(function(e,r,i){t.onRecvCandidateInfo(e,r,i)})),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,r,i){t.onRecvCloseSession(e,r,i)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,r,i){t.onRecvResetSession(e,r,i)})),this.signal.registerPushCallback("StreamStatusNotifyPush",this.sessionId,(function(e,r,i){t.gotStreamStatus=!0,t.streamStatus=i,t.playStream&&t.onRecvStreamStatus(i)})),this.signal.registerPushCallback("PlayEventPush",this.sessionId,(function(e,r,i){t.onRecvPlayEvent(e,r,i)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,r,i){t.onRecvClientInfo(e,r,i)})),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+this.streamId+" call success")},e.prototype.createOffer=function(e){var t=this;this.peerConnection=new RTCPeerConnection(e),this.peerConnection.onicecandidate=function(e){t.onIceCandidate(e)},this.peerConnection.onsignalingstatechange=function(e){t.onConnectionStateChange(e)},this.peerConnection.oniceconnectionstatechange=function(e){t.onIceConnectionStateChange(e)},this.peerConnection.ontrack=function(e){t.onGotRemoteStream(e.streams[0],e.receiver)},this.streamCenter.isDataChannelEnabled&&(this.dataChannel=this.peerConnection.createDataChannel(this.streamId),this.dataChannel.binaryType="arraybuffer",this.dataChannel.onopen=function(e){t.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+t.streamId+" data channel open")},this.dataChannel.onmessage=function(e){if(t.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+t.streamId+" data channel onmessage"),e.data instanceof Blob){var r=new FileReader,i={};r.readAsArrayBuffer(e.data),r.onload=function(){i.data=r.result,t.onReceivedDataChannel(i)}}else t.onReceivedDataChannel(e)});var r={offerToReceiveAudio:1,offerToReceiveVideo:1};this.playOption&&!1===this.playOption.video&&(r.offerToReceiveVideo=0),this.playOption&&!1===this.playOption.audio&&(r.offerToReceiveAudio=0),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+this.streamId+" createOffer: "+JSON.stringify(r)),this.dataReport.eventStart(this.reportSeq,"CreateOffer"),this.dataReport.eventStart(this.streamReportSeq,"CreateOffer"),this.peerConnection.createOffer(r).then((function(e){t.dataReport.eventEnd(t.reportSeq,"CreateOffer"),t.dataReport.eventEnd(t.streamReportSeq,"CreateOffer"),t.onCreateOfferSuccess(e)}),(function(e){t.dataReport.eventEndWithMsg(t.reportSeq,"CreateOffer",{error:e.toString()}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"CreateOffer",{error:e.toString()}),t.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_PLAY_SESSION_SUCCESS+" "+t.streamId+" create offer error "+e.toString()),t.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kCreateOfferError,!0)}))},e.prototype.createSession=function(e){var t=this;this.sessionSeq=o.getSeq();var r=this.streamId;1==this.streamCenter.testEnvironment&&(r="zegotest-"+this.streamCenter.appid+"-"+this.streamId),this.streamCenter.gwNode&&(this.gwNode=this.streamCenter.gwNode);var i=this.stateCenter.settingConfig.getSetting("gw_nodes");if(i&&i instanceof Array&&i.length>0&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" setting "+JSON.stringify(i)),this.gwNodeList=i,this.gwNode=this.gwNodeList[0]||this.gwNode),this.isPeer){this.dataReport.eventStart(this.reportSeq,"CreateSessionWithSdp"),this.dataReport.eventStart(this.streamReportSeq,"CreateSessionWithSdp");var n=this.stateCenter.settingConfig.getSetting("l3_play_buffer_ms"),s=(new Date).getTime(),c="";"number"==typeof this.playOption.streamType&&(c+=""==c?"video_stream_type="+this.playOption.streamType:"&&video_stream_type="+this.playOption.streamType),this.signal.createSessionWithSdp({seq:this.sessionSeq,type:this.isProbe?2:1,mode:0,streamId:r,strAuthParam:this.playOption&&this.playOption.streamParams||"",sdp:e.sdp,serverHost:this.gwNode,playBufLevel:2==this.resourceMode?n:void 0,params:c},(function(e,r,i){var o=(new Date).getTime();t.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" create session time "+(o-s)),t.handleCreateSessionWithSdpResp(e,r,i)}),(function(e,r){t.dataReport.eventEndWithMsg(t.reportSeq,"CreateSession",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"CreateSession",{error:e}),t.playStateUpdateError(e==o.SEND_MSG_TIMEOUT?a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionTimeoutError:a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionRequestError)}))}else this.dataReport.eventStart(this.reportSeq,"CreateSession"),this.dataReport.eventStart(this.streamReportSeq,"CreateSession"),this.signal.createSession(this.sessionSeq,1,0,r,this.playOption&&this.playOption.streamParams,this.gwNode,(function(e,r,i){t.handleCreateSessionResp(e,r,i)}),(function(e,r){t.dataReport.eventEndWithMsg(t.reportSeq,"CreateSession",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"CreateSession",{error:e}),t.playStateUpdateError(e==o.SEND_MSG_TIMEOUT?a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionTimeoutError:a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionRequestError)}));this.state=o.ENUM_PLAY_STATE.waitingSessionRsp,this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" "+this.streamId+" called success"),this.stateNego=o.ENUM_PLAY_STATE_NEGO.start},e.prototype.handleCreateSessionResp=function(e,t,r){var i=r.turn_server,o=i.split("?")[0]&&i.split("?")[0].slice(5),n=this.streamCenter.server.split("?"),s=n[1]&&n[1].slice(2);this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSession",{sessionId:r.session_id,url:"webrtc://"+o+"/"+s+"/"+this.streamId}),this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSession",{sessionId:r.session_id,url:"webrtc://"+o+"/"+s+"/"+this.streamId}),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" "+this.streamId+" sessionId:"+r.session_id),this.sessionSeq==e?(this.gwNodeList=r.gw_nodes&&r.gw_nodes.length>0?r.gw_nodes:this.gwNodeList,this.gwNode=r.gw_nodes&&r.gw_nodes.length>0?this.gwNodeList[0]:this.gwNode,this.gwNodeTTL=r.gw_nodes_ttl?(new Date).getTime()+1e3*r.gw_nodes_ttl:this.gwNodeTTL,this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,0!==r.result?(this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" "+this.streamId+" create error"),this.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionRequestError)):(this.sessionId=r.session_id,this.sessionToken=r.session_token,this.dataReport.addMsgInfo(this.reportSeq,{session_id:a.ZegoRTCLogEvent.kZegoTaskPlayStart.session_id(this.sessionId)}),this.onCreatePlaySessionSuccess(r))):this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_START_PLAY+" seq is not match.")},e.prototype.handleCreateSessionWithSdpResp=function(e,t,r){var i=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" sessionId:"+t),this.sessionSeq==e){this.gwNodeList=r.gw_nodes&&r.gw_nodes.length>0?r.gw_nodes:this.gwNodeList,this.gwNode=r.gw_nodes&&r.gw_nodes.length>0?this.gwNodeList[0]:this.gwNode,this.gwNodeTTL=r.gw_nodes_ttl?(new Date).getTime()+1e3*r.gw_nodes_ttl:this.gwNodeTTL,this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSessionWithSdp",{sessionId:t});var o=0,n=(new Date).getTime();if(this.dataReport.dataStatistics[this.reportSeq]&&(o=n-this.dataReport.dataStatistics[this.reportSeq].event_time,this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" "+this.streamId+" create sdp time "+o)),this.answerSdpTime=n,this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSessionWithSdp",{sessionId:t,sessionTime:o}),0!==r.result){if(this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" create session failed "+r.result),this.stateCenter.useNetAgent&&1004===(null==r?void 0:r.result))return void this.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayStreamNotFound,!0);this.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSessionRequestError)}else this.sessionId=t,this.sessionToken=r.session_token,this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" create session success ",this.streamId),this.dataReport.eventStart(this.reportSeq,"IceConnected"),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,t,r){i.onRecvCloseSession(e,t,r)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,t,r){i.onRecvResetSession(e,t,r)})),this.signal.registerPushCallback("StreamStatusNotifyPush",this.sessionId,(function(e,t,r){i.gotStreamStatus=!0,i.streamStatus=r,i.playStream&&i.onRecvStreamStatus(r)})),this.signal.registerPushCallback("PlayEventPush",this.sessionId,(function(e,t,r){i.onRecvPlayEvent(e,t,r)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,t,r){i.onRecvClientInfo(e,t,r)})),this.signal.registerPushCallback("NetQualityProbeRsp",this.sessionId,(function(e,t,r){i.onRecvPlayEvent(e,t,r)})),this.signal.registerPushCallback("NetQualityInfoPush",this.sessionId,(function(e,t,r){i.onRecvNetQualityInfo(e,t,r)})),this.onGetRemoteOfferSuccess(r.sdp)}else this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_HANDLE_CREATE_SESSION_WITH_SDP+" seq is not match.")},e.prototype.onCreateOfferSuccess=function(e){var t=this;this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp1 "+e.sdp.substr(0,e.sdp.length/2)),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp2 "+e.sdp.substr(e.sdp.length/2)),e.sdp=e.sdp.replace(/sendrecv/g,"recvonly"),e.sdp=e.sdp.replace(/useinbandfec=/,"stereo=1;useinbandfec=");var r=e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)?e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)[0]:null;if(r){var i=r.replace(/recvonly/,"sendrecv");e.sdp=e.sdp.replace(r,i)}var o=e.sdp.match(/m=video(.|\r|\n)*a=rtpmap(.|\r|\n)*(a=fmtp:(102).*)/);if(null!==o){var s=o[3];e.sdp=e.sdp.replace(s,s+";sps-pps-idr-in-keyframe=1")}this.playOption.videoCodec&&(e.sdp=n.SdpUtil.getSDPByVideDecodeType(e.sdp,this.playOption.videoCodec)),this.dataReport.eventStart(this.reportSeq,"SetLocalDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetLocalDescription"),this.peerConnection.setLocalDescription(e).then((function(){t.dataReport.eventEnd(t.reportSeq,"SetLocalDescription"),t.dataReport.eventEnd(t.streamReportSeq,"SetLocalDescription"),t.onSetLocalDescriptionSuccess(e)}),(function(e){t.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CREATE_OFFER_SUCCESS+" "+t.streamId+" set error "+e.toString()),t.dataReport.eventEnd(t.reportSeq,"SetLocalDescription",{error:e.toString()}),t.dataReport.eventEnd(t.streamReportSeq,"SetLocalDescription",{error:e.toString()}),t.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSetLocalDescError,!0)}))},e.prototype.onSetLocalDescriptionSuccess=function(e){var t=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" success"),this.isPeer)this.createSession(e);else{var r={sdp:e.sdp};2==this.resourceMode&&(r.min_play_buf_level_ms=500),this.answerSeq=o.getSeq(),this.dataReport.eventStart(this.reportSeq,"SendMediaDesc"),this.dataReport.eventStart(this.streamReportSeq,"SendMediaDesc"),this.signal.sendMediaDesc(this.answerSeq,this.sessionId,0,r,(function(e,r,i){t.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" sendMediaDesc resp"),t.answerSeq==e&&t.sessionId==r?(t.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" send success stateNego:waiterAnswer"),t.stateNego=o.ENUM_PLAY_STATE_NEGO.waiterAnswer,t.dataReport.eventEnd(t.reportSeq,"SendMediaDesc"),t.dataReport.eventEnd(t.streamReportSeq,"SendMediaDesc"),t.state=o.ENUM_PLAY_STATE.waitingServerAnswer):t.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" seq or sessionId is not equal "+t.answerSeq+" "+e,0+t.sessionId+" "+r)}),(function(e,r){t.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+t.streamId+" failed to send "+e),t.dataReport.eventEndWithMsg(t.reportSeq,"SendMediaDesc",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"SendMediaDesc",{error:e}),t.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kMediaDescError)})),this.state=o.ENUM_PLAY_STATE.waitingOfferRsp}},e.prototype.onRecvMediaDesc=function(e,t,r){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received ",r),this.stateNego=o.ENUM_PLAY_STATE_NEGO.waitingCandidate,this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received stateNego:waitingCandidate"),this.state===o.ENUM_PLAY_STATE.waitingServerAnswer?(this.dataReport.addEvent(this.reportSeq,"RecvMediaDesc"),this.dataReport.addEvent(this.streamReportSeq,"RecvMediaDesc"),this.signal.sendMediaDescAck(e,this.sessionId,0),this.onGetRemoteOfferSuccess(r.sdp)):this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onGetRemoteOfferSuccess=function(e){var t,r=this,i={type:"answer",sdp:e,toJSON:function(){}};this.dataReport.eventStart(this.reportSeq,"SetRemoteDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetRemoteDescription");var n=this.stateCenter.turnOverTcpOnly,s=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);s&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" setting udp_or_tcp "+s),n="tcp"===s),n&&(null===(t=i.sdp.match(/candidate.*/g))||void 0===t||t.forEach((function(e){var t=e.replace(/udp/,"tcp");i.sdp=i.sdp.replace(e,t)}))),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" remoteSdp ",i.sdp),this.peerConnection.setRemoteDescription(new RTCSessionDescription(i)).then((function(){r.dataReport.eventEnd(r.reportSeq,"SetRemoteDescription"),r.dataReport.eventEnd(r.streamReportSeq,"SetRemoteDescription"),r.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+r.streamId+" set success")}),(function(e){r.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+r.streamId+" set remote error "+e.toString()),r.dataReport.eventEndWithMsg(r.reportSeq,"SetRemoteDescription",{error:e.toString()}),r.dataReport.eventEndWithMsg(r.streamReportSeq,"SetRemoteDescription",{error:e.toString()}),r.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kSetRemoteDescError,!0)})),this.state=o.ENUM_PLAY_STATE.waitingServerICE,this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_MEDIA_DESC+" "+this.streamId+" call success")},e.prototype.onRecvCandidateInfo=function(e,t,r){var i=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" received "),this.state==o.ENUM_PLAY_STATE.waitingServerICE){this.dataReport.addEvent(this.reportSeq,"RecvIceCandidate"),this.dataReport.addEvent(this.streamReportSeq,"RecvIceCandidate"),this.signal.sendCandidateInfoAck(e,this.sessionId,0),this.sendCandidateInfo(this.candidateInfo),this.candidateInfo=[];for(var n=0;n<r.infos.length;n++){var s={sdpMid:r.infos[n].sdpMid,sdpMLineIndex:r.infos[n].sdpMLineIndex,candidate:r.infos[n].candidate};this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" candidate "+s.candidate),this.peerConnection.addIceCandidate(new RTCIceCandidate(s)).then((function(){i.logger.debug(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+i.streamId+" add success")}),(function(e){i.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+i.streamId+" add error "+e.toString()),i.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kCandidateError,!0)}))}this.state=o.ENUM_PLAY_STATE.connecting,this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" call success")}else this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onRecvPlayEvent=function(e,t,r){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_PLAY_EVENT+" "+this.streamId+" received"),!0===this.playEvent&&0==r.event){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_PLAY_EVENT+" "+this.streamId+" retry: "+this.streamId);var i=this.streamId,n=this.playOption;this.signal.sendCloseSession(o.getSeq(),this.sessionId,1),this.resetPlay(),this.startPlay(i,this.getRemoteStreamSuc,n)}else this.playEvent=!0},e.prototype.onRecvClientInfo=function(e,t,r){this.stateCenter.clientIP!==r.clientip&&this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CLIENT_INFO+" client ip changed "+this.stateCenter.clientIP+" "+r.clientip),this.stateCenter.clientIP=r.clientip,this.peerID=r.peer_id,this.isProbe&&this.stateNego==o.ENUM_PLAY_STATE_NEGO.iceConnected&&this.signal.sendNetProbe(o.getSeq(),this.sessionId,this.peerID,(function(){}),(function(){})),this.isRecvClientInfo=!0},e.prototype.onRecvNetQualityInfo=function(e,t,r){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_NET_QUALITY_INFO+" call"),this.qualityHandler.stopProbeTimeout();var i=0,n=r.lossrate,a=r.rtt;this.peerID===r.peer_id&&null!=typeof n&&null!=typeof a||(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_NET_QUALITY_INFO+" local peerID:"+this.peerID+" remote peerID:"+r.peer_id+" lossrate:"+n+" rtt:"+a),i=1),this.signal.sendNetQualityInfoPushAck(o.getSeq(),this.sessionId,this.peerID,i),0==i&&"number"==typeof n&&"number"==typeof a?this.onCalNetQualityResult(0,s.ClientUtil.getNetQuality(a,n)):this.onCalNetQualityResult(1)},e.prototype.onIceCandidate=function(e){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" called"),null!=e.candidate)if(this.logger.debug(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" candidate "+e.candidate.candidate),this.state<o.ENUM_PLAY_STATE.connecting||this.state==o.ENUM_PLAY_STATE.stop)this.logger.debug(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" cached"),this.candidateInfo.push({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex});else{this.logger.debug(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CANDIDATE+" "+this.streamId+" send");var t={candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex};this.sendCandidateInfo([t])}},e.prototype.onConnectionStateChange=function(e){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_CONNECTION_STATE_CHANGE+" "+this.streamId+" called "+e.target.signalingState)},e.prototype.onIceConnectionStateChange=function(e){var t=this;if(this.state!=o.ENUM_PLAY_STATE.stop&&null!=this.peerConnection)if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateChanged "+this.peerConnection.iceConnectionState),"connected"===this.peerConnection.iceConnectionState){if(this.stateNego=o.ENUM_PLAY_STATE_NEGO.iceConnected,this.isProbe&&this.isPeer&&this.isRecvClientInfo)return this.signal.sendNetProbe(o.getSeq(),this.sessionId,this.peerID,(function(){}),(function(){})),void(null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null));if(null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.dataReport.addEvent(this.reportSeq,"IceConnected"),this.dataReport.addEvent(this.streamReportSeq,"IceConnected"),this.answerSdpTime){var r=(new Date).getTime()-this.answerSdpTime;this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" ice time "+r)}for(var i in this.isProbe||this.state==o.ENUM_PLAY_STATE.playing||(this.onPlayStateUpdate(o.ENUM_PLAY_STATE_UPDATE.start,this.streamId,{code:0,message:""},!0),this.getRemoteStreamSuc&&this.getRemoteStreamSuc(this.playStream)),this.state=o.ENUM_PLAY_STATE.playing,this.dataReport.eventStart(this.reportSeq,"PlayState"),this.dataReport.eventStart(this.streamReportSeq,"PlayState"),this.streamCenter.publisherList)if(this.streamCenter.publisherList[i].publisher.state==o.ENUM_PUBLISH_STATE.publishing&&this.broadcasterStatus==o.ENUM_BROADCASTER_STATUS.stop){this.signal&&this.signal.sendBroadcasterStatus(o.getSeq(),this.sessionId,1),this.broadcasterStatus=o.ENUM_BROADCASTER_STATUS.start;break}if(!this.isProbe&&this.qualityHandler.setPlayQualityTimer(),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateNego:iceConnected"),this.isPeer&&(this.peerFailCount=0),0==this.firstFrameTime){this.firstFrameTime=(new Date).getTime()-this.beginTime;var n=o.getReportSeq();this.dataReport.newReport(n,a.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.event),this.dataReport.addMsgInfo(n,{session_id:a.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.session_id(this.sessionId),fft_consumed:a.ZegoRTCLogEvent.kZegoTaskPlayDecodeFirstVideoFrame.fft_consumed(this.firstFrameTime)}),!this.isProbe&&this.dataReport.uploadReport(n)}}else"closed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceClosed"),this.stateNego=o.ENUM_PLAY_STATE_NEGO.iceClosed,this.checkPlayConnectionFailedState(this.peerConnection.iceConnectionState)):"failed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceFailed"),this.stateNego=o.ENUM_PLAY_STATE_NEGO.iceFailed,this.checkPlayConnectionFailedState(this.peerConnection.iceConnectionState)):"disconnected"===this.peerConnection.iceConnectionState&&(this.dataReport.addEvent(this.reportSeq,"IceDisconnected"),this.stateNego=o.ENUM_PLAY_STATE_NEGO.iceDisconnected,this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+" ice disconnected"),this.iceDisconnectedTimer||(this.iceDisconnectedTimer=setTimeout((function(){t.checkPlayConnectionFailedState("disconnected")}),this.iceDisconnectedMaxTime)))},e.prototype.checkPlayConnectionFailedState=function(e){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_ICE_CONNECTION_STATE_CHANGE+"  state "+this.state+" connectionState "+e),this.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kMediaConnectionError)},e.prototype.resetPlay=function(){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_RESET_PLAY+" "+this.streamId+" call"),this.state=o.ENUM_PLAY_STATE.stop,this.playEvent=!1,this.isRecvClientInfo=!1,null!=this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.stopVideocTimer(),this.qualityHandler.stopProbeTimeout(),this.qualityHandler.clearPlayQualityTimer(),this.signal&&(this.signal.unregisterPushCallback("MediaDescPush",this.sessionId),this.signal.unregisterPushCallback("CandidateInfoPush",this.sessionId),this.signal.unregisterPushCallback("CloseSessionPush",this.sessionId),this.signal.unregisterPushCallback("SessionResetPush",this.sessionId),this.signal.unregisterPushCallback("PublishEventPush",this.sessionId),this.signal.unregisterPushCallback("ClientInfoPush",this.sessionId),this.signal.unregisterPushCallback("NetQualityProbeRsp",this.sessionId),this.signal.unregisterPushCallback("NetQualityInfoPush",this.sessionId)),this.sessionSeq=0,this.answerSeq=0,this.videoSizeCallback=!1,this.stopSoundLevel()},e.prototype.onRecvResetSession=function(e,t,r){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_RESET_SESSION+" "+this.streamId+" received "),t==this.sessionId){this.signal.sendCloseSessionAck(e,this.sessionId,0);var i=JSON.parse(JSON.stringify(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlaySessionClosedError));this.negoTimer&&clearTimeout(this.negoTimer),this.playStateUpdateError(i)}else this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_RESET_SESSION+" "+this.streamId+" cannot find session")},e.prototype.onRecvCloseSession=function(e,t,r){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_CLOSE_SESSION+" "+this.streamId+" "+JSON.stringify(r)),this.signal.sendCloseSessionAck(e,this.sessionId,0);var i=r.err_info?JSON.parse(r.err_info.toLowerCase()):{},o=i.action?i.action:null,n=1*r.reason,s=JSON.parse(JSON.stringify(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlaySessionClosedError));s.message+=" reason:"+n+" "+(o?" action:"+o:""),this.negoTimer&&clearTimeout(this.negoTimer);var c=![4,8,10,11,12,14,24,26,27,28].includes(n)&&![2,5,6].includes(o);this.playStateUpdateError(s,c)},e.prototype.onRecvStreamStatus=function(e){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS+" "+this.streamId+" call"),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS+" "+this.streamId+" status camera_status: "+e.camera_status+" mic_status: "+e.mic_status),(!this.hasSentStreamStatus||this.cameraStatus!==e.camera_status)&&this.onRemoteCameraStatusUpdate(this.streamId,this.getCameraMicStatus(e.camera_status),e.camera_status),(!this.hasSentStreamStatus||this.micStatus!==e.mic_status)&&this.onRemoteMicStatusUpdate(this.streamId,this.getCameraMicStatus(e.mic_status),e.mic_status),this.hasSentStreamStatus=!0,this.cameraStatus=e.camera_status,this.micStatus=e.mic_status,this.videoMuteState=0===e.camera_status?"0":"1",this.audioMuteState=0===e.mic_status?"0":"1","boolean"==typeof this.playOption.video)this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS+" "+this.streamId+" has set video option, ignore stream status");else{var t=this.playStream;if(0!==e.camera_status&&20!==e.camera_status?t.getVideoTracks().forEach((function(e){e.enabled=!1,e.stop(),t.removeTrack(e)})):0===t.getVideoTracks().length&&t.addTrack(this.remoteStream.clone().getVideoTracks()[0]),"safari"===this.stateCenter.browser)for(var r=document.querySelectorAll("video, audio"),i=0;i<r.length;i++){var o=r[i];o.srcObject===this.playStream&&!0===o.paused&&(o.srcObject=this.playStream)}}this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_RECV_STREAM_STATUS+" "+this.streamId+" call success")},e.prototype.onGotRemoteStream=function(e,t){var r=this;this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_GOT_REMOTE_STREAM+" "+this.streamId+" called "+e),e?(this.sideMediaConfig.isSEIStart&&"function"==typeof t.createEncodedStreams&&("video"===t.track.kind?this.createVideoReceiverTransform(t):"audio"===t.track.kind&&this.createAudioReceiverTransform(t)),this.playStream?(this.playStream.getTracks().forEach((function(e){return r.playStream.removeTrack(e)})),e.clone().getTracks().forEach((function(e){return r.playStream.addTrack(e)}))):this.playStream=e.clone(),this.audioMuteState=this.playStream.getAudioTracks().length>0?"0":"1",this.videoMuteState=this.playStream.getVideoTracks().length>0?"0":"1",this.remoteStream=e,this.getVideoCodec(),this.gotStreamStatus&&this.onRecvStreamStatus(this.streamStatus),this.dataReport.addEvent(this.reportSeq,"GetRemoteStream"),this.streamCenter.soundLevelDelegate&&!this.isProbe&&this.startSoundLevel()):this.logger.warn(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_GOT_REMOTE_STREAM+" "+this.streamId+" remote stream is empty")},e.prototype.createVideoReceiverTransform=function(e){var t=e.createEncodedStreams(),r=new TransformStream({transform:this.decodeVideoFrame});this.receiverStreams=t,t.readable.pipeThrough(r).pipeTo(t.writable)},e.prototype.createAudioReceiverTransform=function(e){var t=e.createEncodedStreams(),r=new TransformStream({transform:this.decodeAudioFrame});t.readable.pipeThrough(r).pipeTo(t.writable)},e.prototype.sendCandidateInfo=function(e){var t=this;this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+this.streamId+" called"),!(e=e.filter((function(e){return!(e.candidate.indexOf("tcp")>0)&&(!!e.candidate||void 0)})))||e.length<1?this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+this.streamId+" cancelled"):(this.dataReport.eventStart(this.reportSeq,"SendIceCandidate"),this.dataReport.eventStart(this.streamReportSeq,"SendIceCandidate"),this.stateNego!==o.ENUM_PLAY_STATE_NEGO.iceConnected&&(this.stateNego=o.ENUM_PLAY_STATE_NEGO.sendCandidate),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+this.streamId+" stateNego:sendCandidate"),this.signal.sendCandidateInfo(o.getSeq(),this.sessionId,e,(function(e,r,i){t.logger.debug(d.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+t.streamId+" send success"),t.dataReport.eventEnd(t.reportSeq,"SendIceCandidate"),t.dataReport.eventEnd(t.streamReportSeq,"SendIceCandidate")}),(function(e,r){t.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_SEND_CANDIDATE_INFO+" "+t.streamId+" failed to send: "+e.toString()),t.dataReport.eventEndWithMsg(t.reportSeq,"SendIceCandidate",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"SendIceCandidate",{error:e}),t.playStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kCandidateError)})))},e.prototype.shouldSendCloseSession=function(){return this.state!=o.ENUM_PLAY_STATE_UPDATE.stop&&this.state!=o.ENUM_PLAY_STATE.waitingSessionRsp},e.prototype.playStateUpdateError=function(e,t){this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_STATE_ERROR+" call ",this.streamId,JSON.stringify(e)),this.isProbe?this.onCalNetQualityResult(1):this.streamId&&this.onPlayStateUpdate(o.ENUM_PLAY_STATE_UPDATE.error,this.streamId,e,t),this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_STATE_ERROR+" "+this.streamId+" ended")},e.prototype.getCameraMicStatus=function(e){return 0==e?"OPEN":"MUTE"},e.prototype.onPlayStateUpdate=function(e,t,r,i){},e.prototype.onPlayQualityUpdate=function(e,t){},e.prototype.onRemoteCameraStatusUpdate=function(e,t,r){},e.prototype.onRemoteMicStatusUpdate=function(e,t,r){},e.prototype.stopPlay=function(){var e;for(var t in this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_STOP_PLAY+" "+this.streamId+" called"),this.streamCenter.publisherList)if(this.streamCenter.publisherList[t].publisher.state==o.ENUM_PUBLISH_STATE.publishing&&this.broadcasterStatus==o.ENUM_BROADCASTER_STATUS.start){this.signal&&this.signal.sendBroadcasterStatus(o.getSeq(),this.sessionId,0),this.broadcasterStatus=o.ENUM_BROADCASTER_STATUS.stop;break}this.sessionId&&!this.closeSessionSignal&&this.signal.sendCloseSession(o.getSeq(),this.sessionId,0),this.dataReport.eventEndWithMsg(this.streamReportSeq,"PlayState",{state:this.state+""}),this.dataReport.addEvent(this.streamReportSeq,"StopPlay"),this.dataReport.addMsgExt(this.streamReportSeq,{stream:this.streamId,sessionId:this.sessionId}),this.resetPlay();var r=this.qualityHandler,n=r.videoBreak,s=r.audioBreak,a=2===this.resourceMode?"l3":"rtc",c=((e={})[a+"_a_break_time"]=s.cumulativeBreakDuration,e[a+"_a_decode_time"]=s.cumulativeDecodeDuration,e[a+"_v_break_time"]=n.cumulativeBreakDuration,e[a+"_v_decode_time"]=n.cumulativeDecodeDuration,e);this.dataReport.addMsgInfo(this.streamReportSeq,i({itemtype:"RTCPlayStream",use_na:this.stateCenter.useNetAgent?1:0,cdn_a_break_time:0,cdn_a_decode_time:0,cdn_v_break_time:0,cdn_v_decode_time:0,l3_a_break_time:0,l3_a_decode_time:0,l3_v_break_time:0,l3_v_decode_time:0,rtc_a_break_time:0,rtc_a_decode_time:0,rtc_v_break_time:0,rtc_v_decode_time:0},c)),!this.isProbe&&this.dataReport.uploadReport(this.streamReportSeq,"RTCPlayStream")},e.prototype.onDisconnect=function(e){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_ON_DISCONNECT+" "+this.streamId+" call"),this.dataReport.addEvent(this.reportSeq,"OnDisconnect"),this.playStateUpdateError(e||a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kWebsocketDisconnectedError,!!e)},e.prototype.startSoundLevel=function(){var e=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_SOUND_LEVEL+" call streamID: "+this.streamId),!this.isProbe)if(this.remoteStream&&0!=this.remoteStream.getAudioTracks().length){this.script&&this.script.disconnect()&&(this.script=null),this.mic&&this.mic.disconnect()&&(this.mic=null);try{this.mic=this.ac.createMediaStreamSource(this.remoteStream),this.script=this.ac.createScriptProcessor(4096,1,1),this.mic.connect(this.script),this.script.connect(this.ac.destination),this.script.onaudioprocess=function(t){for(var r=t.inputBuffer.getChannelData(0),i=0,o=0;o<r.length;o++)i<r[o]&&(i=r[o]);e.soundLevel=100*i},this.ac.resume()}catch(e){this.logger.error(d.ZEGO_WEBRTC_ACTION.PLAYER_START_SOUND_LEVEL+" get sound level failed "+e)}}else this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_START_SOUND_LEVEL+" "+this.streamId+" remote stream no found")},e.prototype.stopSoundLevel=function(){this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_STOP_SOUND_LEVEL+" call streamID: "+this.streamId),this.script&&this.script.disconnect(),this.mic&&this.mic.disconnect(),this.script=null,this.mic=null},e.prototype.onCalNetQualityResult=function(e,t){},e.prototype.onReceivedDataChannel=function(e){var t,r,i=this,o=new Uint8Array(e.data,0,10),n=e.data.byteLength-10,s=new Uint8Array(e.data,10,n);if(1==o[0]){var a=o[1],d=o[2]<<8|o[3],c=o[4]<<8|o[5],u=(new Date).getTime();if(this.first_pkt&&(this.next_sn[0]=d==c?d:c,this.first_pkt=!1),this.pkt_list.push({sn:d,sn0:c,recv_ts:u,flags:a,payload_len:n,payloadArray:s}),this.pkt_list.sort(this.compareShort),d==this.next_sn[0]){var l=this.pkt_list.filter((function(e){return e.sn0==c}));if(l.sort(this.compareShort),null!=l.find((function(e){return 1&e.flags}))&&l.length==this.compareShort(d,c)+1){for(var h=0,p=new ArrayBuffer(65536),g=0;g<l.length;g++)new Uint8Array(p).set(l[g].payloadArray,h),h+=l[g].payload_len;null===(t=this.onDataChannelList)||void 0===t||t.forEach((function(e){e(p,h,i.streamId)})),this.pkt_list=[],this.first_pkt=!0}this.next_sn[0]++}else for(var f=function(){var e=_.pkt_list.filter((function(e){return e.sn0==i.pkt_list[0].sn0}));if(e.sort(_.compareShort),null!=e.find((function(e){return 1&e.flags}))&&e.length==_.compareShort(e[e.length-1].sn,e[0].sn0)+1){for(var t=0,o=new ArrayBuffer(65536),n=0;n<e.length;n++)new Uint8Array(o).set(e[n].payloadArray,t),t+=e[n].payload_len;_.next_sn[0]=e[0].sn0+e.length,null===(r=_.onDataChannelList)||void 0===r||r.forEach((function(e){e(o,t,i.streamId)})),_.pkt_list=[],_.first_pkt=!0}else if(u-e[0].ts<4e3){var s=e[0].sn0;for(n=0;n<e.length&&s==e[n].sn;n++)s++;return _.next_sn[0]=s,"break"}for(n=0;n<e.length;n++)_.pkt_list.shift()},_=this;this.pkt_list.length>0&&"break"!==f(););}},e.prototype.compareShort=function(e,t){var r=new Uint16Array(1);r[0]=e-t;var i=new Int16Array(1);return i[0]=r[0],i[0]},e.prototype.getVideoCodec=function(){var e=this;this.peerConnection&&(this.peerConnection.getStats().then((function(t){t.forEach((function(r){if("inbound-rtp"===r.type&&"video"===r.kind&&r.codecId){var i=t.get(r.codecId).mimeType.toLowerCase();i.indexOf("h264")>-1?e.videoCodec="H264":i.indexOf("vp8")>-1&&(e.videoCodec="VP8",e.sideMediaConfig.isSEIStart&&e.logger.error(d.ZEGO_WEBRTC_ACTION.PAYER_GET_VIDEO_CODEC+" video code VP8 is not support SEI"))}}))})),this.videoCodecTimes++,this.videoCodec||this.videoCodecTimes>=5)?this.stopVideocTimer():this.videoCodecTimer=setTimeout((function(){e.getVideoCodec()}),100)},e.prototype.stopVideocTimer=function(){this.videoCodecTimer&&(clearTimeout(this.videoCodecTimer),this.videoCodecTimer=null)},e}();t.ZegoPlayWeb=l},361:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.PublishModule=void 0;var o=r(1089),n=r(6706),s=r(3529),a=r(608),d=r(2752),c=r(3770),u=r(5321),l=function(){function e(e,t,r,i,o){this.logger=e,this.dataReport=t,this.stateCenter=r,this.streamCenter=i,this.rtm=o,this.recordDevices()}return e.prototype.createStream=function(e){var t=this;return this.logger.info(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" call"),e&&e.camera&&e.camera.audioBitRate&&(e.camera.audioBitrate=e.camera.audioBitRate),e&&e.camera&&e.camera.bitrate&&(e.camera.bitRate=e.camera.bitrate),e&&e.screen&&"object"==typeof e.screen&&e.screen.bitrate&&(e.screen.bitRate=e.screen.bitrate),e&&e.custom&&e.custom.bitrate&&(e.custom.bitRate=e.custom.bitrate),new Promise((function(r,d){var c="camera",l=n.getReportSeq();t.dataReport.newReport(l,s.ZegoRTCLogEvent.kZegoTaskCreateStream.event);var h=function(e){var i=t.streamCenter.checkPreview(e),o=e;if(i&&navigator.userAgent){var n=navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/);n&&n[1]&&n[1].includes("15_1")&&(o=t.getStreamThroughCanvas(e),i.localStream=o)}if(0==o.getAudioTracks().length){var s=t.streamCenter.ac.createMediaStreamDestination(),a=s?s.stream:null,d=a?a.getAudioTracks()[0]:null;d&&(d.enabled=!1,o.addTrack(d),i&&(i.hasEmptyAudioTrack=!0))}t.dataReport.uploadReport(l),!t.stateCenter.deviceInfos&&t.recordDevices(),r(o),t.streamCenter.activeSoundLevel()},p=function(e,r){void 0===r&&(r=""),t.dataReport.addMsgInfo(l,{error:e.code,message:e.message+r}),t.dataReport.uploadReport(l),d({code:e.code,msg:e.message+r})};if("https:"!==window.location.protocol&&"file:"!==window.location.protocol&&-1==window.location.hostname.indexOf("127.0.0.1")&&-1==window.location.hostname.indexOf("localhost"))return t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" https or localhost required "),void p({code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError.message+" https or localhost required"});if(e&&e.screen){if(c="screen",!a.ClientUtil.checkScreenParams(e.screen,p))return;var g=t.stateCenter.browser,f=t.streamCenter.getScreenConstrains(e.screen);t.dataReport.addMsgInfo(l,{stream_type:s.ZegoRTCLogEvent.kZegoTaskCreateStream.stream_type("screen"),screen:s.ZegoRTCLogEvent.kZegoTaskCreateStream.screen(f)});var _=function(e){t.streamCenter.createScreenPreviewer(e,f)&&h(e),e.getVideoTracks()[0].onended=function(){var r=n.getReportSeq();t.dataReport.newReport(r),t.dataReport.uploadReport(r,s.ZegoRTCLogEvent.kZegoTaskScreenSharingEnded),e&&t.stopPreview(e),t.stateCenter.actionListener("screenSharingEnded",e)}};"firefox"==g||"object"==typeof e.screen&&"firefox"==e.screen.type?t.startScreenShotFirFox("screen",f,(function(e,t,r){e?t&&_(t):r&&p(r)})):"chrome"==g&&u.ZegoWebRTC.screenShotReady||"object"==typeof e.screen&&"shot"==e.screen.type?t.startScreenShotChrome((function(r,i,n){r?(t.logger.info(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" using extension"),i&&_(i)):(n&&t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" extension "+n),"SS_DIALOG_CANCEL"===n||"object"==typeof e.screen&&"shot"==e.screen.type?n&&p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenCancelError):t.startScreenSharing(f,(function(e,r,i){e?r&&_(r):(t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" "+i),i&&p(i))})))})):"Electron"==g||"object"==typeof e.screen&&"Electron"==e.screen.type?t.startScreenShotElectron(f,(function(e,t,r){e?t&&_(t):r&&p(r)})):t.startScreenSharing(f,(function(e,t,r){e?t&&_(t):r&&p(r)}))}else{if(e&&"object"==typeof e.camera&&void 0!==e.camera.videoQuality&&!a.ClientUtil.checkInteger(e.camera.videoQuality))return t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" videoQuality must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," videoQuality must be integer number");if(e&&e.camera&&e.camera.audioBitrate){if(!a.ClientUtil.checkInteger(e.camera.audioBitrate))return t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" audioBitrate must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate must be integer number");if(e.camera.audioBitrate<6)return t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" audioBitrate cannot less 6 kbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot less 6 kbps");if(e.camera.audioBitrate>510)return t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" audioBitrate cannot greater than 510 kbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot greater than 510 kbps");t.stateCenter.audioBitRate=1e3*e.camera.audioBitrate}if(e&&e.camera&&e.camera.bitRate){if("number"!=typeof e.camera.bitRate)return t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be integer number");if(e.camera.bitRate>10240)return t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate cannot greater than 10 Mbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate cannot greater than 10 Mbps")}if(e&&e.camera&&void 0!==e.camera.channelCount&&!a.ClientUtil.checkInteger(e.camera.channelCount))return t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" channelCount must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," channelCount must be integer number");if(e&&e.camera&&4===e.camera.videoQuality&&!a.ClientUtil.checkCameraParams(e.camera,p))return;if(e&&e.custom&&e.custom.bitRate){if(!a.ClientUtil.checkInteger(e.custom.bitRate))return t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate must be integer number");if(e.custom.bitRate>10240)return t.logger.error(o.ZEGO_WEBRTC_ACTION.CREATE_STREAM+" bitrate cannot greater than 10 Mbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," bitrate cannot greater than 10 Mbps")}if(e&&e.custom&&e.custom.audioBitrate){if(!a.ClientUtil.checkInteger(e.custom.audioBitrate))return t.logger.error("ze.cs.0 audioBitrate must be integer number"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate must be integer number");if(e.custom.audioBitrate<6)return t.logger.error("ze.cs.0 audioBitrate cannot less 6 kbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot less 6 kbps");if(e.custom.audioBitrate>510)return t.logger.error("ze.cs.0 audioBitrate cannot greater than 510 kbps"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," audioBitrate cannot greater than 510 kbps")}if(e&&e.custom&&void 0!==e.custom.channelCount&&1!==e.custom.channelCount&&2!==e.custom.channelCount)return t.logger.error("ze.cs.0 channelCount must number 1 or 2"),void p(s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError," channelCount must number 1 or 2");var m={};if(e&&e.camera)c="camera",m=e.camera,t.dataReport.addMsgInfo(l,{stream_type:s.ZegoRTCLogEvent.kZegoTaskCreateStream.stream_type("camera"),camera:s.ZegoRTCLogEvent.kZegoTaskCreateStream.camera(e.camera)}),"boolean"!=typeof m.video&&(m.video=!0),"boolean"!=typeof m.audio&&(m.audio=!0);else if(e&&e.custom){c="custom",m=e.custom;var v=e.custom.source instanceof MediaStream?"MediaStream":"HTMLElement";t.dataReport.addMsgInfo(l,{stream_type:s.ZegoRTCLogEvent.kZegoTaskCreateStream.stream_type("custom"),custom:s.ZegoRTCLogEvent.kZegoTaskCreateStream.custom(i(i({},e.custom),{source:v}))})}t.startPreview(m,c,h,p)}}))},e.prototype.destroyStream=function(e){this.logger.info(o.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" call");var t=n.getReportSeq();if(this.dataReport.newReport(t),!(e instanceof MediaStream))return this.logger.error(o.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" localStream is not mediaStream or tracks is null"),this.dataReport.addMsgInfo(t,s.ZegoRTCLogEvent.kZegoTaskDestroyStream.error.kLocalStreamError),void this.dataReport.uploadReport(t,s.ZegoRTCLogEvent.kZegoTaskDestroyStream.event);e instanceof MediaStream&&0==e.getTracks().length&&this.logger.info(o.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" tracks is null"),this.stopPreview(e),this.dataReport.uploadReport(t,s.ZegoRTCLogEvent.kZegoTaskDestroyStream.event)},e.prototype.startPublishingStream=function(e,t,r,i){this.logger.info(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" call ",e);var d,c=!0,u="",l=n.getReportSeq();this.stateCenter.reportSeqList.startPublish[e]=l,this.dataReport.newReport(l,s.ZegoRTCLogEvent.kZegoTaskPublishStart.event),c&&void 0===e&&(u="stream id required",this.logger.error(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+u),c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError),!c||e&&"string"==typeof e||(u="stream id type wrong",this.logger.error(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError),c&&e.length>n.MAX_STREAM_ID_LENGTH&&(u="stream id length limit",this.logger.error(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError),c&&!a.ClientUtil.checkIllegalCharacters(e)&&(u="stream ID contains illegal characters",this.logger.error(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError),c&&(!t||t instanceof MediaStream&&0==t.getTracks().length)&&(u="localStream wrong",this.logger.error(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError);var h=this.streamCenter.checkPreview(t);if(c&&!h&&(u="stream is not from zego",this.logger.error(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNoPreviewError),(null==h?void 0:h.isVideoEffectStarting)&&(u=(d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishEffectIsStarting).message,this.logger.error(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),c=!1),c&&void 0!==r&&"object"!=typeof r&&(c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError,u="publishOption must be object"),c&&void 0!==r&&void 0!==r.streamParams&&"string"!=typeof r.streamParams&&(this.logger.error(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" publishOption streamParams must be string"),c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError,u=" publishOption streamParams must be string"),c&&void 0!==r&&void 0!==r.extraInfo&&"string"!=typeof r.extraInfo&&(this.logger.error(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" publishOption extraInfo must be string"),c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError,u=" publishOption extraInfo must be string"),c&&void 0!==r&&void 0!==r.videoCodec&&"string"!=typeof r.videoCodec&&(this.logger.error(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" publishOption videoCodec must be string"),c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError,u=" publishOption videoCodec must be string"),!c||!this.stateCenter.isMultiRoom||r&&"string"==typeof r.roomID&&""!=r.roomID||(c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishParamError,u=" roomID is need if set multi room"),r&&r.videoCodec&&(r.videoCodec=r.videoCodec.toUpperCase()),c&&this.rtm.isDisConnect()&&(this.logger.error("zc.p.sps.1 not login"),c=!1,d=s.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNoLoginError),!c)throw this.logger.error(o.ZEGO_WEBRTC_ACTION.START_PUBLISHING_STREAM+" "+u),this.dataReport.uploadReport(l,void 0,d,u),delete this.stateCenter.reportSeqList.startPublish[e],{errorCode:null==d?void 0:d.code,extendedData:u};r||(r={}),this.dataReport.addMsgInfo(l,{stream:s.ZegoRTCLogEvent.kZegoTaskPublishStart.stream(e),publishOption:s.ZegoRTCLogEvent.kZegoTaskPublishStart.publishOption(r),use_na:this.stateCenter.useNetAgent?1:0}),r.audioBitRate=this.stateCenter.audioBitRate;var p,g=r.roomID?r.roomID:this.stateCenter.roomList[0]?this.stateCenter.roomList[0].roomID:"",f=this.stateCenter.getRoomByRoomID(g);if(!f)return this.logger.error("zc.p.sps.1 room no found"),!1;if(this.dataReport.addMsgInfo(l,{publish_room_id:g,isMulti:this.stateCenter.isMultiRoom}),this.stateCenter.customUrl&&0!=this.stateCenter.customUrl.length)this.logger.info("zc.p.sps.1 customUrl "+JSON.stringify(this.stateCenter.customUrl)),p=this.stateCenter.customUrl;else{var _=this.stateCenter.settingConfig.getSetting("signal_nodes",!0);_&&_ instanceof Array&&_.length>0&&(p=_,this.logger.info("zc.p.sps.1 setting config signal_nodes "+JSON.stringify(_)))}if(p)return this.stateCenter.publishStreamList[e]={state:n.ENUM_PUBLISH_STREAM_STATE.tryPublish,extra_info:r.extraInfo?r.extraInfo:null},this.streamCenter.setPublishStateStart(f,e,t,r,i)?(f.streamHandler.onPublishStateUpdate(n.ENUM_PUBLISH_STATE_UPDATE.retry,e,{code:0,message:""}),this.streamCenter.publisherList[e].serverUrls=p,this.streamCenter.startPublishingStream(e)):(this.logger.info("zc.p.sps.1 cannot start publish"),!1);if(!this.streamCenter.setPublishStateStart(f,e,t,r,i))return this.logger.error("zc.p.sps.1 cannot start publish"),!1;this.stateCenter.publishStreamList[e]={state:n.ENUM_PUBLISH_STREAM_STATE.tryPublish,extra_info:r.extraInfo?r.extraInfo:null},this.logger.info("zc.p.sps.1 start publish"),f.streamHandler.onPublishStateUpdate(n.ENUM_PUBLISH_STATE_UPDATE.retry,e,{code:0,message:""});var m=this.stateCenter.useNetAgent,v=this.streamCenter.publisherList[e];if(m)return this.stateCenter.appConfig?(this.streamCenter.publisherList[e].serverUrls=["unified_rtc"],this.streamCenter.startPublishingStream(e,m),!0):(this.streamCenter.waitPublishList.push(e),!0);var E=v.retryDispatchHandler;return E.stopMaxTime(),E.invalid(),E.initStream(e,r,!0),E.startMaxTime(),E.active(0)},e.prototype.activateSEIInsert=function(e,t,r){return void 0===r&&(r=0),!1},e.prototype.sendSEI=function(e,t){if(!a.ClientUtil.isSupportEncodedTransforms())return this.logger.warn(o.ZEGO_WEBRTC_ACTION.SEND_MEDIA_SIDE_INFO+" browser not support "),!1;if(!(t instanceof Uint8Array))return this.logger.error(o.ZEGO_WEBRTC_ACTION.SEND_MEDIA_SIDE_INFO+" inData required Uint8Array"),!1;if(t.byteLength>4096)return this.logger.error(o.ZEGO_WEBRTC_ACTION.SEND_MEDIA_SIDE_INFO+" inData length limit"),!1;var r=this.streamCenter.publisherList[e];return r&&r.publisher?r.publisher.sendSEI(t):(this.logger.warn(o.ZEGO_WEBRTC_ACTION.SEND_MEDIA_SIDE_INFO+" publish not exist"),!1)},e.prototype.stopPublishingStream=function(e,t){var r,i;this.logger.info(o.ZEGO_WEBRTC_ACTION.STOP_PUBLISHING_STREAM+" call ",e+(t?t.toString():""));var a=n.getReportSeq();if(this.stateCenter.reportSeqList.stopPublish[e]=a,this.dataReport.newReport(a,s.ZegoRTCLogEvent.kZegoTaskPublishStop.event),this.dataReport.addMsgInfo(a,{streamID:s.ZegoRTCLogEvent.kZegoTaskPublishStop.stream(e)}),"string"!=typeof e||""==e)return this.logger.error(o.ZEGO_WEBRTC_ACTION.STOP_PUBLISHING_STREAM+" streamID must be string and not empty"),this.dataReport.uploadReport(a,void 0,s.ZegoRTCLogEvent.kZegoTaskPublishStop.error.kParamError,"stream id type error"),delete this.stateCenter.reportSeqList.stopPublish[e],!1;var d=this.streamCenter.publisherList[e],c=this.streamCenter.getRoomByStreamID(e),u=d&&d.publisher&&d.publisher.state!==n.ENUM_PUBLISH_STATE.stop||(null===(r=null==d?void 0:d.retryStreamHandler)||void 0===r?void 0:r.isRetrying());if(this.streamCenter.stopPublishingStream(e),this.stateCenter.publishStreamList[e]){if(this.stateCenter.publishStreamList[e].state>=n.ENUM_PUBLISH_STREAM_STATE.update_info&&c){if(!t||1102018!==t.code){var l;l="PUBLIC"===this.stateCenter.type?n.ENUM_STREAM_SUB_CMD.liveEnd:n.ENUM_STREAM_CMD_PRI.liveEnd,c.streamHandler.updateStreamInfo(e,l)}for(var h=0;h<c.streamList.length;h++)if(c.streamList[h].stream_id==e){c.streamList.splice(h--,1);break}}delete this.stateCenter.publishStreamList[e]}return this.dataReport.addMsgInfo(a,{session_id:null===(i=null==d?void 0:d.publisher)||void 0===i?void 0:i.sessionId}),this.dataReport.uploadReport(a),c&&u&&c.streamHandler.onPublishStateUpdate(n.ENUM_PUBLISH_STATE_UPDATE.error,e,t||{code:0,message:""}),!0},e.prototype.setCaptureVolume=function(e,t){var r=this;return new Promise((function(i){var n;r.logger.info(o.ZEGO_WEBRTC_ACTION.PUBLISH_SET_CAPTURE_VOLUME+" call");var a=function(e){r.logger.error(o.ZEGO_WEBRTC_ACTION.PUBLISH_SET_CAPTURE_VOLUME+" "+e),i({errorCode:s.ZegoRTCLogEvent.kZegoSetCaptureVolume.error.kParamError.code,extendedData:JSON.stringify({fail_reason:s.ZegoRTCLogEvent.kZegoSetCaptureVolume.error.kParamError.message+" "+e})})},d=r.streamCenter.ac,c=r.streamCenter.checkPreview(e);if(e instanceof MediaStream&&c)if(0!=e.getAudioTracks().length)if("number"!=typeof t||t<0||t>100)a(" volume must be number between 0 to 100");else{if(c.gainNode)c.gainNode.gain.value=t/100;else{c.audioTrackSrc=d.createMediaStreamSource(e);var u=d.createGain(),l=d.createMediaStreamDestination();c.audioTrackSrc.connect(u),u.connect(l);var h=l.stream.getAudioTracks()[0];for(var p in r.streamCenter.publisherList){var g=r.streamCenter.publisherList[p];if(g.localStream==e){var f=null===(n=g.publisher.peerConnection)||void 0===n?void 0:n.getSenders().find((function(e){return e.track&&"audio"===e.track.kind}));f&&(f.replaceTrack(h),g.localStream.removeTrack(g.publisher.localStream.getAudioTracks()[0]),g.localStream.addTrack(h));break}}var _=e.getAudioTracks()[0];_&&(h.enabled=_.enabled,e.removeTrack(_)),e.addTrack(h),c.gainNode=u,c.gainNode.gain.value=t/100}d.resume(),i({errorCode:0,extendedData:""}),r.logger.info(o.ZEGO_WEBRTC_ACTION.PUBLISH_SET_CAPTURE_VOLUME+" call success")}else a(" stream audioTrack no found");else a(" stream must be created by zego")}))},e.prototype.getElectronScreenSources=function(){var e=this;return new Promise((function(t,r){var i=window.require("electron");i||(e.logger.error("zc.gess.0 Electron is not exist"),r({message:"Electron is not exist"})),i.desktopCapturer.getSources({types:["window","screen"]}).then((function(e){var r=e.map((function(e){return{id:e.id,name:e.name,thumbnail:e.thumbnail}}));t(r)})).catch((function(t){e.logger.error("zc.gess.0 "+t),r(t)}))}))},e.prototype.startScreenShotChrome=function(e){if(u.ZegoWebRTC.screenShotReady)window.postMessage({type:"SS_UI_REQUEST",text:"start"},"*"),a.ClientUtil.registerCallback("screenShare",{success:e},this.stateCenter.callbackList);else{var t='zc.b.ss Please install the extension:1. Go to chrome://extensions  2. Check: "Enable Developer mode   3. Click: "Load the unpacked extension... 4. Choose "extension" folder from the repository 5. Reload this page';this.logger.error(t),e(!1,null,{code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+t})}},e.prototype.startScreenSharing=function(e,t){var r=this;"getDisplayMedia"in navigator.mediaDevices?navigator.mediaDevices.getDisplayMedia({audio:e.audio,video:e.video}).then((function(e){t(!0,e)})).catch((function(e){r.logger.error("zc.b.sss "+e),e.message&&"permission denied"==e.message.toLowerCase()?t(!1,null,s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenCancelError):t(!1,null,{code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+e})})):(this.logger.error("zc.b.sss brower does not support getDisplayMedia"),t(!1,null,s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError))},e.prototype.startScreenShotFirFox=function(e,t,r){var o=this,n={video:i(i({},t.video),{mediaSource:e}),audio:t.audio};navigator.mediaDevices.getUserMedia(n).then((function(e){r(!0,e)})).catch((function(e){o.logger.error("ze.ssf.1 "+e),r(!1,null,{code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+e})}))},e.prototype.startScreenShotElectron=function(e,t){var r=this;if(!window.require("electron"))return this.logger.error("ze.sse.1 Electron is not exist"),void t(!1,null,{code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" Electron is not exist"});var i={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e.sourceID,maxWidth:window.screen.width,maxHeight:window.screen.height}},audio:!1};navigator.mediaDevices.getUserMedia(i).then((function(e){t(!0,e)})).catch((function(e){r.logger.error("ze.sse.1 "+e),t(!1,null,{code:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.code,message:s.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kScreenFailedError.message+" "+e})}))},e.prototype.startPreview=function(e,t,r,i){var o=this,n=null;return n=new c.ZegoPreview(this.logger,this.streamCenter.ac,this.stateCenter,this.streamCenter,t),this.streamCenter.previewStreamList.push(n),n.startPreview(e,(function(i){var s;o.streamCenter.soundLevelDelegate&&(null==n||n.startSoundLevel()),"camera"===t&&(!1===(null===(s=e)||void 0===s?void 0:s.audio)&&n&&(n.hasMicTrack=!1),(null==n?void 0:n.micTrack)&&(n.micTrack.enabled=o.streamCenter.isMicEnabled)),(null==e?void 0:e.videoOptimizationMode)&&o.streamCenter.setVideoTrackContentHint(i,null==e?void 0:e.videoOptimizationMode),o.logger.debug("zsc.sp.0 call success"),!o.stateCenter.deviceInfos&&o.recordDevices(),r&&r(i)}),(function(e){o.streamCenter.previewStreamList=o.streamCenter.previewStreamList.filter((function(e){return e!==n})),i&&i(e)})),!0},e.prototype.stopPreview=function(e){if(!e)return this.logger.warn("zsc.sp.0 localStream null"),!1;for(var t in this.streamCenter.publisherList)this.streamCenter.publisherList[t].localStream===e&&(this.streamCenter.publisherList[t].localStream=null);var r=this.streamCenter.checkPreview(e);return r?(r.previewSuc&&(r.stopPreview(),this.streamCenter.removePreview(r)),!0):(this.logger.warn("zsc.sp.0 no preview"),!1)},e.prototype.recordDevices=function(e,t){var r,i=this;this.logger.info("zsc.rd.0 call"),a.ClientUtil.getDevices((function(t){i.stateCenter.deviceInfos={microphones:t.microphones,speakers:t.speakers,cameras:t.cameras},e&&e(t)}),(function(e){i.logger.warn("zsc.rd.0 getDevices err:",e),t&&t(e)})),void 0!==(null===(r=navigator.mediaDevices)||void 0===r?void 0:r.ondevicechange)&&(navigator.mediaDevices.ondevicechange=null,navigator.mediaDevices.ondevicechange=function(e){i.logger.info("zsc.rd.0 devicechange"),i.stateCenter.deviceChangeTimer&&(clearTimeout(i.stateCenter.deviceChangeTimer),i.stateCenter.deviceChangeTimer=null),i.stateCenter.deviceChangeTimer=setTimeout((function(){a.ClientUtil.getDevices((function(e){for(var t=[],r=function(r){var o=i.stateCenter.deviceInfos.cameras[r];e.cameras.find((function(e){return e.deviceID===o.deviceID}))||t.push(o)},o=0;o<i.stateCenter.deviceInfos.cameras.length;o++)r(o);i.stateCenter.deviceStateOut=!1;var a=!1;t.length>0&&(a=!0),t.forEach((function(e){for(var t in i.streamCenter.publisherList){var r=i.streamCenter.publisherList[t],o=r.publisher;r.localStream&&""!==r.cameraLabel&&r.cameraLabel===e.deviceName&&(a=!1,o.sendStreamStatus(-6,o.mic_status),i.stateCenter.actionListener("_deviceError",d.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,e.deviceName,"camera"),i.stateCenter.actionListener("deviceError",d.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,e.deviceName)),r.localStream&&0===r.localStream.getAudioTracks().length&&(a=!1)}var c=n.getReportSeq();i.dataReport.newReport(c,s.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),i.dataReport.addMsgInfo(c,{interrupt:0}),i.dataReport.uploadReport(c),i.stateCenter.actionListener("videoDeviceStateChanged","DELETE",e)})),a&&(i.stateCenter.deviceStateOut=!0),i.stateCenter.deviceInfos.microphones.filter((function(t){return!e.microphones.find((function(e){return e.deviceID===t.deviceID}))})).forEach((function(e){for(var t in i.streamCenter.publisherList){var r=i.streamCenter.publisherList[t],o=r.publisher;r.localStream&&""!==r.microLabel&&(r.microLabel===e.deviceName||""!==r.microLabel&&r.microLabel.includes(e.deviceName))&&(o.sendStreamStatus(o.camera_status,-6),i.stateCenter.actionListener("_deviceError",d.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,i.streamCenter.publisherList[t].microLabel,"micro"),i.stateCenter.actionListener("deviceError",d.errorCodeList.DEVICE_ERROR_TYPE_UNPLUGGED.code,i.streamCenter.publisherList[t].microLabel))}var a=n.getReportSeq();i.dataReport.newReport(a,s.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),i.dataReport.addMsgInfo(a,{interrupt:0}),i.dataReport.uploadReport(a),i.stateCenter.actionListener("audioDeviceStateChanged","DELETE","Input",e)}));var c=i.stateCenter.deviceInfos.speakers.filter((function(t){return!e.speakers.find((function(e){return e.deviceID===t.deviceID}))})),u=e.cameras.filter((function(e){return!i.stateCenter.deviceInfos.cameras.find((function(t){return t.deviceID===e.deviceID}))})),l=e.microphones.filter((function(e){return!i.stateCenter.deviceInfos.microphones.find((function(t){return t.deviceID===e.deviceID}))})),h=e.speakers.filter((function(e){return!i.stateCenter.deviceInfos.speakers.find((function(t){return t.deviceID===e.deviceID}))}));c.forEach((function(e){var t=n.getReportSeq();i.dataReport.newReport(t,s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.event),i.dataReport.addMsgInfo(t,{reason:s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.reason("delete"),device:s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.device(e)}),i.dataReport.uploadReport(t),i.stateCenter.actionListener("audioDeviceStateChanged","DELETE","Output",e)})),u.forEach((function(e){var t=n.getReportSeq();i.dataReport.newReport(t,s.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),i.dataReport.addMsgInfo(t,{interrupt:1}),i.dataReport.uploadReport(t),i.stateCenter.actionListener("videoDeviceStateChanged","ADD",e)})),l.forEach((function(e){var t=n.getReportSeq();i.dataReport.newReport(t,s.ZegoRTCLogEvent.kZegoTaskDeviceInterrupt.event),i.dataReport.addMsgInfo(t,{interrupt:1}),i.dataReport.uploadReport(t),i.stateCenter.actionListener("audioDeviceStateChanged","ADD","Input",e)})),h.forEach((function(e){var t=n.getReportSeq();i.dataReport.newReport(t,s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.event),i.dataReport.addMsgInfo(t,{reason:s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.reason("add"),device:s.ZegoRTCLogEvent.kZegoTaskAudioOutputChanged.device(e)}),i.dataReport.uploadReport(t),i.stateCenter.actionListener("audioDeviceStateChanged","ADD","Output",e)})),i.stateCenter.deviceInfos={microphones:e.microphones,speakers:e.speakers,cameras:e.cameras}}),(function(e){i.logger.warn("zsc.rd.0 getDevices err:",e)}))}),500)})},e.prototype.getStreamThroughCanvas=function(e){if(0==e.getVideoTracks().length)return e;var t=document.createElement("video"),r=document.createElement("canvas"),i=r.getContext("2d");t.setAttribute("style","display:none"),r.setAttribute("style","display:none"),t.setAttribute("muted",""),t.muted=!0,t.setAttribute("autoplay",""),t.autoplay=!0,t.setAttribute("playsinline",""),document.body.append(t),document.body.append(r),t.srcObject=e;var o=function(){null==i||i.drawImage(t,0,0,r.width,r.height),window.requestAnimationFrame(o),t.srcObject=e};t.oncanplay=function(){r.width=t.videoWidth,r.height=t.videoHeight,t.play(),o()};var n=r.captureStream(15),s=n.getVideoTracks()[0],a=s.stop;if(s.stop=function(){a.call(s),o(),t.remove(),r.width=0,r.remove()},e instanceof MediaStream&&e.getAudioTracks().length){var d=e.getAudioTracks()[0];n.addTrack(d)}return n},e.prototype.getStreamStats=function(e){var t,r,i;return this.logger.info(o.ZEGO_WEBRTC_ACTION.DESTROY_STREAM+" call"),e instanceof MediaStream&&e.getTracks().length>0?i=null===(t=this.streamCenter.checkPublish(e))||void 0===t?void 0:t.publisher:"string"==typeof e&&(i=null===(r=this.streamCenter.publisherList[e])||void 0===r?void 0:r.publisher),i?(null==i?void 0:i.currentQuality)||null:(this.logger.error("zsc.sp.0 stream is not publishing"),null)},e.prototype.startWaitPublish=function(){var e=this;this.streamCenter.waitPublishList.forEach((function(t){e.streamCenter.startPublishingStream(t,e.stateCenter.useNetAgent)})),this.streamCenter.waitPublishList=[]},e}();t.PublishModule=l},3770:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoPreview=void 0;var s=r(6706),a=r(3529),d=r(1089),c=function(){function e(e,t,r,i,o){var n=this;this.logger=e,this.ac=t,this.stateCenter=r,this.streamCenter=i,this.previewType=o,this.localStream=null,this.videoInfo={},this.previewSuc=!1,this.soundLevel=0,this.hasEmptyAudioTrack=!1,this.script=null,this.mic=null,this._audioTrack=null,this._videoTrack=null,this.cloneVideoTrack=null,this.originVideoTrack=null,this.activateSEIConfig=null,this.isAudioEnabled=!0,this.isVideoEnabled=!0,this.audioTrackSrc=null,this.gainNode=null,this.cameraMaxResolution={},this.enableDualStream=!1,this.lowStreamConfig={width:160,height:120,frameRate:15,bitRate:50},this.muteImage=null,this.hasMicTrack=!0,this.enableMicrophoneOnly=function(e,t){var r;if(!n.localStream)return n.logger.error("zp.em.2 no localStream"),!1;var i=null===(r=t.checkPublish(n.localStream))||void 0===r?void 0:r.publisher;if(i){var o=i.camera_status,s=n.isAudioEnabled&&e?0:20;i.sendStreamStatus(o,s)}return n.micTrack?(n.micTrack.enabled=n.isAudioEnabled&&e,n.logger.debug("zp.emo.2 call success"),!0):(n.logger.info("zp.emo.2 no micTrack"),!0)},this.audioMixManager=null}return Object.defineProperty(e.prototype,"audioTrack",{get:function(){var e;return this._audioTrack||(null===(e=this.localStream)||void 0===e?void 0:e.getAudioTracks()[0])||null},set:function(e){this._audioTrack=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"videoTrack",{get:function(){var e;return this._videoTrack||(null===(e=this.localStream)||void 0===e?void 0:e.getVideoTracks()[0])||null},set:function(e){this._videoTrack=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"micTrack",{get:function(){return this.hasMicTrack&&"camera"===this.previewType&&this.audioTrack||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isVideoEffectStarting",{get:function(){return!!this.videoEffect&&this.videoEffect.isStarting},enumerable:!1,configurable:!0}),e.prototype.getMediaStreamConstraints=function(e,t){var r={audio:null,video:null};if(r.audio=!0,r.video={width:640,height:480,frameRate:15,bitRate:this.stateCenter.settingConfig.getSetting("camera_video_bitrate")},e.audio?void 0===e.audioInput&&void 0===e.ANS&&void 0===e.AGC&&void 0===e.AEC&&void 0===e.channelCount?(r.audio={},r.audio.noiseSuppression=this.stateCenter.settingConfig.getSetting("ANS"),r.audio.autoGainControl=this.stateCenter.settingConfig.getSetting("AGC"),r.audio.echoCancellation=this.stateCenter.settingConfig.getSetting("AEC"),r.audio.channelCount=1):(r.audio={},void 0!==e.audioInput&&null!==e.audioInput&&(r.audio.deviceId={exact:e.audioInput}),void 0!==e.ANS&&(r.audio.noiseSuppression=e.ANS),void 0!==e.AGC&&(r.audio.autoGainControl=e.AGC),void 0!==e.AEC&&(r.audio.echoCancellation=e.AEC),void 0!==e.channelCount&&(r.audio.channelCount=e.channelCount)):!1===e.audio&&(r.audio=!1),e.video){var i=640,o=480,n=15,a=this.stateCenter.settingConfig.getSetting("camera_video_bitrate");if(1===e.videoQuality?(i=s.ENUM_RESOLUTION_TYPE.LOW.width,o=s.ENUM_RESOLUTION_TYPE.LOW.height,n=s.ENUM_RESOLUTION_TYPE.LOW.frameRate,a=s.ENUM_RESOLUTION_TYPE.LOW.bitRate):2===e.videoQuality?(i=s.ENUM_RESOLUTION_TYPE.MEDIUM.width,o=s.ENUM_RESOLUTION_TYPE.MEDIUM.height,n=s.ENUM_RESOLUTION_TYPE.MEDIUM.frameRate,a=s.ENUM_RESOLUTION_TYPE.MEDIUM.bitRate):3===e.videoQuality?(i=s.ENUM_RESOLUTION_TYPE.HIGH.width,o=s.ENUM_RESOLUTION_TYPE.HIGH.height,n=s.ENUM_RESOLUTION_TYPE.HIGH.frameRate,a=s.ENUM_RESOLUTION_TYPE.HIGH.bitRate):4===e.videoQuality?(i=e.width,o=e.height,n=e.frameRate,a=e.bitRate||this.stateCenter.settingConfig.getSetting("camera_video_bitrate")):this.logger.info("zp.gmsc.2 use default"),t&&!e.videoQuality&&(e.width&&(i=e.width),e.height&&(o=e.height),e.frameRate&&(n=e.frameRate),e.bitRate&&(a=e.bitRate)),!1===e.horizontal){var d=o;o=i,i=d}!0===e.isSwitch&&(d=o,o=i,i=d),r.video={width:i,height:o,frameRate:n,bitRate:a},null!=e.facingMode?r.video.facingMode=e.facingMode:null!=e.videoInput&&null!=e.videoInput&&""!=e.videoInput&&(r.video.deviceId={exact:e.videoInput}),this.logger.info("zp.gmsc.2 width: "+i+" height: "+o+" rate: "+n)}else!1===e.video&&(e.audioBitrate&&(r.video={}),r.video=!1);return r},e.prototype.startPreview=function(e,t,r){return o(this,void 0,void 0,(function(){var o,s,d,c,u,l,h,p=this;return n(this,(function(n){return this.logger.debug("zp.sv.2 called"),this.mediaStreamConfig=e,void 0===navigator.mediaDevices||null==navigator.mediaDevices.getUserMedia?(r&&r(a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError),[2]):e.source instanceof MediaStream?(o=e.source.getVideoTracks(),s=o.length>0?o[0].getSettings():{width:0,height:0,frameRate:0},this.logger.debug("zp.sv.2 use external media stream"),this.previewSuc=!0,this.localStream=e.source,this.initMediaTrack(e.source),this.videoInfo={width:s.width,height:s.height,frameRate:s.frameRate,bitRate:e.bitRate||this.stateCenter.settingConfig.getSetting("custom_video_bitrate"),startBitrate:e.startBitrate||this.stateCenter.settingConfig.getSetting("bitrate_mode"),channelCount:e.channelCount||(this.audioTrack&&this.audioTrack.getSettings?this.audioTrack.getSettings().channelCount:1),audioBitrate:1e3*e.audioBitrate||48e3},t&&t(this.localStream),[2]):e.source instanceof HTMLMediaElement?((d=this.captureStream(e.source,e))?(this.videoInfo.bitRate=e.bitRate||this.stateCenter.settingConfig.getSetting("custom_video_bitrate"),this.previewSuc=!0,this.initMediaTrack(d),t&&t(d)):r&&r(a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kBrowserNotSupportError),[2]):((c=this.getMediaStreamConstraints(e)).audio&&(u=this.stateCenter.settingConfig.getSetting("AEC",!0),l=this.stateCenter.settingConfig.getSetting("AGC",!0),h=this.stateCenter.settingConfig.getSetting("ANS",!0),"boolean"==typeof u&&(this.logger.info("zp.sv.2 setting AEC "+u),c.audio.echoCancellation=u),"boolean"==typeof l&&(this.logger.info("zp.sv.2 setting AGC "+l),c.audio.autoGainControl=l),"boolean"==typeof h&&(this.logger.info("zp.sv.2 setting ANS "+h),c.audio.noiseSuppression=h)),this.videoInfo=i({},c.video),this.videoInfo?(this.videoInfo.audioBitrate=1e3*e.audioBitrate||48e3,this.videoInfo.startBitrate=e.startBitrate||this.stateCenter.settingConfig.getSetting("bitrate_mode")):e.audioBitrate&&(this.videoInfo={audioBitrate:1e3*e.audioBitrate||48e3}),this.mediaStreamConfig.video=!!c.video,this.mediaStreamConfig.audio=!!c.audio,this.logger.info("zp.sv.2 ",JSON.stringify(c)),e.unlimitedCaptureResolution&&c.video.width&&(c.video.width={ideal:4096},c.video.height={ideal:2160},this.logger.info("zp.sv.2 ","capture max resolution of camera")),navigator.mediaDevices.getUserMedia(c).then((function(r){p.logger.info("zp.sv.2 success"),p.localStream=r,p.previewSuc=!0,p.initMediaTrack(r),p.videoInfo&&(p.videoInfo.channelCount=e.channelCount||(p.audioTrack&&p.audioTrack.getSettings?p.audioTrack.getSettings().channelCount:1)),t&&t(r)}),(function(e){if(p.logger.info("zp.sv.2 failed ",e.name," ",e.message),r){var t=a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kGetUserMediaError;t.message=t.message+" "+e.name+" "+e.message,"NotAllowedError"===e.name||"SecurityError"===e.name?(t=i({},a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kDeviceNoAllowedError)).message=e.name+": "+t.message:"NotReadableError"===e.name?(t=i({},a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kDeviceNoReadableError)).message=e.name+": "+t.message:"OverconstrainedError"===e.name&&((t=i({},a.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kDeviceOverConstrainedError)).message=e.name+": "+t.message+(e.constraint?". such as "+e.constraint:"")),r(t)}})),[2])}))}))},e.prototype.captureStream=function(e,t){if(!e)return this.logger.info("zp.cs.2 no local video"),null;var r;if(e.captureStream)r=e.captureStream(),this.logger.debug("zp.cs.2 captureStream");else{if(!e.mozCaptureStream)return this.logger.info("zp.cs.2 don't support"),null;r=e.mozCaptureStream(),this.logger.debug("zp.cs.2 mozCaptureStream")}return 0==r.getTracks().length?(this.logger.error("zp.cs.2 external capture tracks no found"),null):(this.localStream=r,this.videoInfo={width:e.videoWidth,height:e.videoHeight,frameRate:0,bitRate:t.bitRate||this.stateCenter.settingConfig.getSetting("custom_video_bitrate"),channelCount:t.channelCount||(this.audioTrack&&this.audioTrack.getSettings?this.audioTrack.getSettings().channelCount:1),audioBitrate:1e3*t.audioBitrate||48e3,startBitrate:t.startBitrate||this.stateCenter.settingConfig.getSetting("bitrate_mode")},this.logger.debug("zp.cs.2 called success"),this.localStream)},e.prototype.stopPreview=function(){var e,t,r,i,o,n;this.logger.info("zp.sv.2.1 called"),this.localStream&&(this.videoEffect&&(this.videoEffect.setBeautyEffectOptions(!1),this.videoEffect.destroy()),null===(e=this.cloneVideoTrack)||void 0===e||e.stop(),this.muteImageAnID&&cancelAnimationFrame(this.muteImageAnID),null===(t=this.originVideoTrack)||void 0===t||t.stop(),null===(r=this.videoTrack)||void 0===r||r.stop(),null===(i=this.audioTrack)||void 0===i||i.stop(),null===(o=this.audioMixManager)||void 0===o||o.stopAudioManager(),this.localStream.getTracks().reverse().forEach((function(e){return e.stop()})),this.localStream=null,null===(n=this.lowStream)||void 0===n||n.getTracks().reverse().forEach((function(e){return e.stop()})),this.lowStream=void 0,this.videoInfo={})},e.prototype.enableMicrophone=function(e,t){return!1},e.prototype.enableCamera=function(e,t,r){return!1},e.prototype.enableCameraCapturing=function(e){return o(this,void 0,void 0,(function(){return n(this,(function(e){return[2,!1]}))}))},e.prototype.startSoundLevel=function(){var e=this;if(this.localStream&&0!=this.localStream.getAudioTracks().length){this.script&&this.script.disconnect(),this.mic&&this.mic.disconnect();try{this.mic=this.ac.createMediaStreamSource(this.localStream),this.script=this.ac.createScriptProcessor(4096,1,1),this.mic.connect(this.script),this.script.connect(this.ac.destination),this.script.onaudioprocess=function(t){for(var r=t.inputBuffer.getChannelData(0),i=0,o=0;o<r.length;o++)i<r[o]&&(i=r[o]);e.soundLevel=100*i},this.ac.resume()}catch(e){this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" get sound level failed "+e)}}},e.prototype.stopSoundLevel=function(){this.soundLevel=0,this.script&&this.script.disconnect(),this.mic&&this.mic.disconnect(),this.script=null,this.mic=null},e.prototype.restartSoundLevel=function(){this.streamCenter.soundLevelDelegate?(this.stopSoundLevel(),this.startSoundLevel()):this.stopSoundLevel()},e.prototype.setBeautyEffect=function(e,t){return o(this,void 0,void 0,(function(){return n(this,(function(e){return[2]}))}))},e.prototype.replacePreviewTrack=function(e,t){void 0===t&&(t=!1)},e.prototype.createLowStream=function(){var e,t,r,i=null===(e=this.localStream)||void 0===e?void 0:e.getVideoTracks()[0];if(i){var o=i.getSettings().height,n=i.getSettings().width,s=o&&n?o/n:1;try{this.lowStream=null===(t=this.localStream)||void 0===t?void 0:t.clone();var a=null===(r=this.lowStream)||void 0===r?void 0:r.getVideoTracks()[0],d=this.lowStreamConfig,c=d.width,u=d.frameRate,l=this.lowStreamConfig.height;l=Math.round(s*this.lowStreamConfig.width),null==a||a.applyConstraints({width:c,height:l,frameRate:u})}catch(e){this.logger.error("zp.cls "+e)}}},e.prototype.initMediaTrack=function(e){e.getVideoTracks().length>0&&(this.videoTrack=e.getVideoTracks()[0],this.originVideoTrack=this.videoTrack),e.getAudioTracks().length>0&&(this.audioTrack=e.getAudioTracks()[0])},e.prototype.onAudioTrackChange=function(e){},e}();t.ZegoPreview=c},1547:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoPublish=void 0;var o=r(6706),n=r(4767),s=r(608),a=r(3529),d=r(1089),c=r(7646),u=function(){function e(e,t,r,i,n,s,a){var d=this;this.state=o.ENUM_PUBLISH_STATE.stop,this.sessionId=0,this.sessionToken="",this.candidateInfo=[],this.qualityTimer=null,this.publishQualityList=[],this.maxQualityListCount=10,this.lastPublishStats={},this.currentQuality={video:{videoBitrate:0,videoFPS:0,videoTransferFPS:0,frameHeight:0,frameWidth:0,muteState:"1",videoQuality:-1,videoPacketsLost:0,videoPacketsLostRate:0,googCodecName:""},audio:{audioBitrate:0,audioCodec:"opus",muteState:"1",audioQuality:-1,audioFPS:0,audioPacketsLost:0,audioPacketsLostRate:0,googCodecName:""}},this.canvasTimer=null,this.reportSeq=NaN,this.streamReportSeq=o.getSeq(),this.qualityUpload=!1,this.qualityUploadInterval=3e4,this.qualityUploadLastTime=0,this.qualitySeq=0,this.videoInfo={width:0,height:0,frameRate:0,bitRate:0,channelCount:1,audioBitrate:48e3},this.mediaStreamConfig=null,this.offerSeq=0,this.peerConnection=null,this.qualityCount=0,this.closeSessionSignal=!1,this.channelCount=1,this.localSdpOrder=[],this.remoteSdpOrder=[],this.videoCodec="H264",this.stateNego=o.ENUM_PUBLISH_STATE_NEGO.stop,this.negoInterval=25e3,this.publishEvent=!1,this.cameraState="on",this.microState="on",this.gwNode="",this.gwNodeList=[],this.gwNodeTTL=0,this.needIncMax=!1,this.probeCount=0,this.gotMax=!1,this.initFitCnt=0,this.targetRate=0,this.totalBitrateArray=[],this.totalTargetRateArray=[],this.totalRetransRateArray=[],this.isPeer=!1,this.peerFailCount=0,this.peerID=0,this.netQuality=0,this.probeTime=0,this.probeInterval=6e4,this.probeState=o.ENUM_PROBE_STATE.probed,this.iceDisconnectedMaxTime=15e3,this.isUpdateSDP=!1,this.toBeReplacedTracks={},this.send_seq=0,this.dataChannelState=0,this.first_pkt=!0,this.next_sn=[],this.pkt_list=[],this.answerSdpTime=0,this.mediaSideInfos=[],this.sideMediaConfig={isSEIStart:!1,SEIType:o.ZegoSEIType.ZegoDefined,unregisterSeiFilter:"",uuidSend:!1},this.encodeVideoFrame=function(e,t){if(d.mediaSideInfos.length>0){for(var r=new DataView(e.data),i=[],o=0,n=0;n<d.mediaSideInfos.length;n++){var s=d.mediaSideInfos[n],a=d.encodeSEINalu(s);o+=5+(T=a.ebspLength),i.push(a)}d.mediaSideInfos=[];for(var u=new ArrayBuffer(o+e.data.byteLength),l=new DataView(u),h=0,p=new c.H264Parser(r),g=0,f=!1,_=!1;p.NextNalu();){var m=31&r.getUint8(p.nalu_start+p.start_code_size);if(7==m)f=!0,g+=p.nalu_size;else if(8==m)_=!0,g+=p.nalu_size;else if(9==m)continue;if(f&&_)break}for(var v=0;v<g;v++)l.setInt8(h++,r.getInt8(v));for(n=0;n<i.length;n++){var E=i[n],S=E.rbspView,T=E.ebspLength,C=E.ebspPreventProcessPos;l.setUint8(h++,0),l.setUint8(h++,0),l.setUint8(h++,0),l.setUint8(h++,1),l.setUint8(h++,6);for(var y=0,R=0;R<T;R++)C.indexOf(R)>-1?(l.setInt8(h++,3),y++):l.setInt8(h++,S.getInt8(R-y))}for(v=g;v<e.data.byteLength;v++)l.setInt8(h++,r.getInt8(v));e.data=u}t.enqueue(e)},this.camera_status=2,this.mic_status=2,this.streamId=e,this.logger=t,this.dataReport=r,this.qualityTimeInterval=i,this.streamCenter=n,this.stateCenter=s,this.dataReport.newReport(this.streamReportSeq),this.videoCodec=this.stateCenter.settingConfig.getSetting("publish_video_codec"),this.previewer=a,this.localStream=a.localStream,a.onAudioTrackChange=function(e){var t=d.peerConnection&&d.peerConnection.getSenders().find((function(t){var r;return(null===(r=t.track)||void 0===r?void 0:r.kind)===e.kind}));t?(t.replaceTrack(e),d.logger.info("zc.oatc remote audio track change success")):d.logger.warn("zc.oatc stream has not sender")}}return Object.defineProperty(e.prototype,"lowStream",{get:function(){var e;return null===(e=this.previewer)||void 0===e?void 0:e.lowStream},enumerable:!1,configurable:!0}),e.prototype.publishStateUpdateError=function(e,t){this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_STATE_ERROR+"  call ",this.streamId,JSON.stringify(e)),this.streamId&&this.onPublishStateUpdate(o.ENUM_PUBLISH_STATE_UPDATE.error,this.streamId,e,t),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_STATE_ERROR+"  ended")},e.prototype.resetPublish=function(){this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_RESET_PUBLISH+"   "+this.streamId+" call"),this.state=o.ENUM_PUBLISH_STATE.stop,this.publishEvent=!1,null==this.peerConnection&&null==this.peerConnection||(this.peerConnection.close(),this.peerConnection=null),null!=this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.clearPublishQualityTimer(),this.clearCanvasTimer(),this.signal&&(this.signal.unregisterPushCallback("CandidateInfoPush",this.sessionId),this.signal.unregisterPushCallback("MediaDescPush",this.sessionId),this.signal.unregisterPushCallback("CloseSessionPush",this.sessionId),this.signal.unregisterPushCallback("SessionResetPush",this.sessionId),this.signal.unregisterPushCallback("PublishEventPush",this.sessionId),this.signal.unregisterPushCallback("ClientInfoPush",this.sessionId)),this.sessionSeq=0,this.offerSeq=0,this.candidateInfo=[],this.publishQualityList=[],this.qualityUploadLastTime=0,this.resetEncBitrate(),this.isUpdateSDP=!1},e.prototype.clearPublishQualityTimer=function(){null!=this.qualityTimer&&(clearInterval(this.qualityTimer),this.qualityTimer=null),this.lastPublishStats={},this.qualityCount=0},e.prototype.clearCanvasTimer=function(){null!=this.canvasTimer&&(clearInterval(this.canvasTimer),this.canvasTimer=null)},e.prototype.shouldSendCloseSession=function(){return this.state!=o.ENUM_PUBLISH_STATE.stop&&this.state!=o.ENUM_PUBLISH_STATE.waitingSessionRsp},e.prototype.startPublish=function(e,t,r,i,o){var n,c,u,l,h,p=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+e+" called"),this.signal&&this.signal.negoInterval&&(this.negoInterval=this.signal.negoInterval),e){var g;this.localStream=t,this.mediaStreamConfig=i,this.channelCount=i.channelCount,this.publishOption=o||{},(null==o?void 0:o.SEIType)&&(this.sideMediaConfig.SEIType=o.SEIType),this.currentQuality.video.muteState=(null===(c=null===(n=this.previewer)||void 0===n?void 0:n.videoTrack)||void 0===c?void 0:c.enabled)?"0":"1",this.currentQuality.audio.muteState=this.localStream.getAudioTracks().length>0&&this.localStream.getAudioTracks()[0].enabled?"0":"1",navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&i&&(i.externalCapture||i.externalMediaStream)&&(this.localStream.onaddtrack=function(){var e,t,r,i;p.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+p.streamId+" Track added");var o=[];(null===(e=p.previewer)||void 0===e?void 0:e.videoTrack)&&o.push(null===(t=p.previewer)||void 0===t?void 0:t.videoTrack);var n=p.localStream.getAudioTracks();if(o.length>1){var s=null===(r=p.peerConnection)||void 0===r?void 0:r.getSenders().find((function(e){var t;return(null===(t=e.track)||void 0===t?void 0:t.id)===p.localStream.getVideoTracks()[0].id}));null==s||s.replaceTrack(o[1]),p.localStream.removeTrack(o[0])}else n.length>1&&(s=null===(i=p.peerConnection)||void 0===i?void 0:i.getSenders().find((function(e){var t;return(null===(t=e.track)||void 0===t?void 0:t.kind)===n[1].kind})),null==s||s.replaceTrack(n[1]),p.localStream.removeTrack(n[0]))}),r&&(this.videoInfo=r),o&&o.videoCodec&&(this.videoCodec=o.videoCodec);var f=null===(u=this.previewer)||void 0===u?void 0:u.previewType;switch(f){case"camera":g=this.stateCenter.settingConfig.getSetting("camera_video_bitrate",!0);break;case"screen":g=this.stateCenter.settingConfig.getSetting("screen_video_bitrate",!0);break;case"custom":g=this.stateCenter.settingConfig.getSetting("custom_video_bitrate",!0)}g&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting "+f+" "+g),this.videoInfo.bitRate=g);var _=this.stateCenter.settingConfig.getSetting("bitrate_mode",!0);_&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting bitrate_mode "+_),this.videoInfo.startBitrate=_);var m=this.stateCenter.settingConfig.getSetting("publish_video_codec",!0);if(m&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting publish_video_codec "+m),this.videoCodec=m),"boolean"==typeof(null==o?void 0:o.isSEIStart)&&(this.sideMediaConfig.isSEIStart=null==o?void 0:o.isSEIStart),this.sideMediaConfig.isSEIStart){var v=s.ClientUtil.isSupportEncodedTransforms();"H264"===this.videoCodec&&v||(this.sideMediaConfig.isSEIStart=!1)}(null===(l=this.stateCenter.seiConfig)||void 0===l?void 0:l.unregisterSEIFilter)&&(this.sideMediaConfig.unregisterSeiFilter=null===(h=this.stateCenter.seiConfig)||void 0===h?void 0:h.unregisterSEIFilter),this.dataReport.addMsgInfo(this.reportSeq,{video_en_codec_id:a.ZegoRTCLogEvent.kZegoTaskPublishStart.video_en_codec_id("VP8"==this.videoCodec?2:0),audio_c_channel_count:a.ZegoRTCLogEvent.kZegoTaskPublishStart.audio_c_channel_count(2==this.channelCount?2:1),audio_en_bps:a.ZegoRTCLogEvent.kZegoTaskPublishStart.audio_en_bps(this.videoInfo.audioBitrate),aec_level:a.ZegoRTCLogEvent.kZegoTaskPublishStart.aec_level(1==i.AEC?2:0==i.AEC?0:2),ans_level:a.ZegoRTCLogEvent.kZegoTaskPublishStart.ans_level(1==i.ANS?2:0==i.ANS?0:2),agc:a.ZegoRTCLogEvent.kZegoTaskPublishStart.agc(1==i.AGC?2:0==i.AGC?0:2),traffic_control_min_video_bitrate:a.ZegoRTCLogEvent.kZegoTaskPublishStart.traffic_control_min_video_bitrate(this.videoInfo.bitRate)});var E=this.sideMediaConfig.isSEIStart;this.isPeer?this.createOffer({encodedInsertableStreams:E}):this.createSession(),this.negoTimer=setTimeout((function(){p.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" waiting timeout"),p.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishNegoTimeoutError)}),this.negoInterval)}else this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+e+" streamId is null")},e.prototype.activateSEIInsert=function(e,t){return new Promise((function(e,t){e(!1)}))},e.prototype.createSession=function(e){var t=this;this.sessionSeq=o.getSeq();var r=this.streamId;1==this.streamCenter.testEnvironment&&(r="zegotest-"+this.streamCenter.appid+"-"+this.streamId),this.streamCenter.gwNode&&(this.gwNode=this.streamCenter.gwNode);var i=this.stateCenter.settingConfig.getSetting("gw_nodes");if(i&&i instanceof Array&&i.length>0&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" setting "+JSON.stringify(i)),this.gwNodeList=i,this.gwNode=this.gwNodeList[0]||this.gwNode),this.isPeer){this.dataReport.eventStart(this.reportSeq,"CreateSessionWithSdp"),this.dataReport.eventStart(this.streamReportSeq,"CreateSessionWithSdp");var n=(new Date).getTime();this.signal.createSessionWithSdp({seq:this.sessionSeq,type:0,mode:0,streamId:r,videoInfo:this.videoInfo,strAuthParam:this.publishOption&&this.publishOption.streamParams||"",sdp:e.sdp,serverHost:this.gwNode},(function(e,r,i){var o=(new Date).getTime();t.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" create session time "+(o-n)),t.handleCreateSessionWithSdpResp(e,r,i)}),(function(e,r){t.dataReport.eventEndWithMsg(t.reportSeq,"CreateSession",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"CreateSession",{error:e}),t.publishStateUpdateError(e==o.SEND_MSG_TIMEOUT?a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionTimeoutError:a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError)}))}else this.dataReport.eventStart(this.reportSeq,"CreateSession"),this.dataReport.eventStart(this.streamReportSeq,"CreateSession"),this.signal.createSession(this.sessionSeq,0,0,r,this.publishOption&&this.publishOption.streamParams,this.gwNode,(function(e,r,i){t.handleCreateSessionResp(e,r,i)}),(function(e,r){t.reportSeq,t.dataReport.eventEndWithMsg(t.reportSeq,"CreateSession",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"CreateSession",{error:e}),t.publishStateUpdateError(e==o.SEND_MSG_TIMEOUT?a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionTimeoutError:a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError)}));this.state=o.ENUM_PUBLISH_STATE.waitingSessionRsp,this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" called success"),this.stateNego=o.ENUM_PUBLISH_STATE_NEGO.start},e.prototype.handleCreateSessionResp=function(e,t,r){var i=r.turn_server,o=i.split("?")[0]&&i.split("?")[0].slice(5),n=this.streamCenter.server.split("?"),s=n[1]&&n[1].slice(2);this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSession",{sessionId:r.session_id,url:"webrtc://"+o+"/"+s+"/"+this.streamId}),this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSession",{sessionId:r.session_id,url:"webrtc://"+o+"/"+s+"/"+this.streamId}),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" sessionId:"+r.session_id),this.sessionSeq==e?(this.gwNodeList=r.gw_nodes&&r.gw_nodes.length>0?r.gw_nodes:this.gwNodeList,this.gwNode=r.gw_nodes&&r.gw_nodes.length>0?this.gwNodeList[0]:this.gwNode,this.gwNodeTTL=r.gw_nodes_ttl?(new Date).getTime()+1e3*r.gw_nodes_ttl:this.gwNodeTTL,this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,0!==r.result?(this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" create session failed "+r.result),this.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError)):(this.sessionId=r.session_id,this.sessionToken=r.session_token,this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" create session success "+this.sessionId),this.dataReport.addMsgInfo(this.reportSeq,{session_id:a.ZegoRTCLogEvent.kZegoTaskPublishStart.session_id(this.sessionId)}),this.onCreatePublishSessionSuccess(r))):this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" seq is not match.")},e.prototype.handleCreateSessionWithSdpResp=function(e,t,r){var i=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" sessionId:"+t),this.sessionSeq==e){this.gwNodeList=r.gw_nodes&&r.gw_nodes.length>0?r.gw_nodes:this.gwNodeList,this.gwNode=r.gw_nodes&&r.gw_nodes.length>0?this.gwNodeList[0]:this.gwNode,this.gwNodeTTL=r.gw_nodes_ttl?(new Date).getTime()+1e3*r.gw_nodes_ttl:this.gwNodeTTL,this.stateCenter.clientIP=r.clientip?r.clientip:this.stateCenter.clientIP,this.dataReport.eventEndWithMsg(this.streamReportSeq,"CreateSessionWithSdp",{sessionId:t});var o=0,n=(new Date).getTime();this.dataReport.dataStatistics[this.reportSeq]&&(o=n-this.dataReport.dataStatistics[this.reportSeq].event_time,this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" "+this.streamId+" create sdp time "+o)),this.answerSdpTime=n,this.dataReport.eventEndWithMsg(this.reportSeq,"CreateSessionWithSdp",{sessionId:t,sessionTime:o}),0!==r.result?(this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" create session failed "+r.result),this.publishStateUpdateError({code:a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError.code,message:a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSessionRequestError.message+" result:"+r.result})):(this.sessionId=t,this.sessionToken=r.session_token,this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" get remote session success "+this.streamId),this.dataReport.eventStart(this.reportSeq,"IceConnected"),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,t,r){i.onRecvCloseSession(e,t,r)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,t,r){i.onRecvResetSession(e,t,r)})),this.signal.registerPushCallback("PublishEventPush",this.sessionId,(function(e,t,r){i.onRecvPublishEvent(e,t,r)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,t,r){i.onRecvClientInfo(e,t,r)})),this.signal.registerPushCallback("MediaDescUpdatePush",this.sessionId,(function(e,t,r){i.onRecvUpdateMediaDescription(e,t,r)})),this.onGetRemoteOfferSuccess(r.sdp))}else this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_PUBLISH+" seq is not match.")},e.prototype.onCreatePublishSessionSuccess=function(e){var t=this;this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" called");var r=[];if(e.turn_server){var i=e.turn_server,o=this.stateCenter.turnOverTcpOnly,n=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);n&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" setting udp_or_tcp "+n),o="tcp"===n),o&&(i=i.replace("udp","tcp")),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" over tcp "+i),r.push(i)}e.stun_server&&r.push(e.stun_server);var s={iceTransportPolicy:"relay",iceServers:[{urls:r,username:e.turn_username,credential:e.turn_auth_key}],encodedInsertableStreams:this.sideMediaConfig.isSEIStart};this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" username: "+e.turn_username),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" credential: "+e.turn_auth_key),this.createOffer(s),this.signal.registerPushCallback("CandidateInfoPush",this.sessionId,(function(e,r,i){t.onRecvCandidateInfo(e,r,i)})),this.signal.registerPushCallback("CloseSessionPush",this.sessionId,(function(e,r,i){t.onRecvCloseSession(e,r,i)})),this.signal.registerPushCallback("MediaDescPush",this.sessionId,(function(e,r,i){t.onRecvMediaDescription(e,r,i)})),this.signal.registerPushCallback("SessionResetPush",this.sessionId,(function(e,r,i){t.onRecvResetSession(e,r,i)})),this.signal.registerPushCallback("PublishEventPush",this.sessionId,(function(e,r,i){t.onRecvPublishEvent(e,r,i)})),this.signal.registerPushCallback("ClientInfoPush",this.sessionId,(function(e,r,i){t.onRecvClientInfo(e,r,i)})),this.signal.registerPushCallback("MediaDescUpdatePush",this.sessionId,(function(e,r,i){t.onRecvUpdateMediaDescription(e,r,i)})),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" call success")},e.prototype.createOffer=function(e){var t,r,i,o=this;this.peerConnection=new RTCPeerConnection(e),this.peerConnection.onicecandidate=function(e){o.onIceCandidate(e)},this.peerConnection.onsignalingstatechange=function(e){o.onConnectionStateChange(e)},this.peerConnection.oniceconnectionstatechange=function(e){o.onIceConnectionStateChange(e)},this.streamCenter.isDataChannelEnabled&&(this.dataChannel=this.peerConnection.createDataChannel(this.streamId),this.dataChannel.binaryType="arraybuffer",this.dataChannel.onopen=function(e){o.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+o.streamId+" data channel open"),o.dataChannelState=1},this.dataChannel.onclose=function(e){o.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+o.streamId+" data channel close ")});var n=[],s=[];if(this.lowStream&&this.lowStream.getVideoTracks().forEach((function(e){var t;o.lowStream&&(null===(t=o.peerConnection)||void 0===t||t.addTrack(e,o.lowStream))})),this.localStream){if(this.localStream.getTracks().forEach((function(e){var t,r=null===(t=o.peerConnection)||void 0===t?void 0:t.addTrack(e,o.localStream);o.sideMediaConfig.isSEIStart&&r&&"function"==typeof r.createEncodedStreams&&("video"===e.kind?o.createVideoSenderTransform(r):"audio"===e.kind&&o.createAudioSenderTransform(r))})),!(null===(t=this.previewer)||void 0===t?void 0:t.videoTrack)&&this.sideMediaConfig.isSEIStart){this.videoInfo.bitRate||(this.videoInfo.bitRate=50);var c=this.addCanvasStreamVideoTrack(),u=this.peerConnection.addTrack(c,this.localStream);u&&"video"==c.kind&&this.createVideoSenderTransform(u)}(null===(r=this.previewer)||void 0===r?void 0:r.videoTrack)&&(n=[null===(i=this.previewer)||void 0===i?void 0:i.videoTrack]),s=this.localStream.getAudioTracks(),n.length>0&&this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" video device: "+n[0].label),s.length>0&&this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" audio device: "+s[0].label)}var l={offerToReceiveAudio:s.length>0?1:0,offerToReceiveVideo:n.length>0?1:0};this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+this.streamId+" createOffer: "+JSON.stringify(l)),this.dataReport.eventStart(this.reportSeq,"CreateOffer"),this.dataReport.eventStart(this.streamReportSeq,"CreateOffer"),this.peerConnection.createOffer(l).then((function(e){o.dataReport.eventEnd(o.reportSeq,"CreateOffer"),o.dataReport.eventEnd(o.streamReportSeq,"CreateOffer"),o.onCreateOfferSuccess(e)}),(function(e){o.dataReport.eventEndWithMsg(o.reportSeq,"CreateOffer",{error:e.toString()}),o.dataReport.eventEndWithMsg(o.streamReportSeq,"CreateOffer",{error:e.toString()}),o.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_PUBLISH_SESSION_SUCCESS+" "+o.streamId+" create offer error "+e.toString()),o.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kCreateOfferError,!0)}))},e.prototype.sendSEI=function(e){var t,r;if("H264"!==this.videoCodec)return this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_SEI+" code not support"),!1;if(!this.sideMediaConfig.isSEIStart)return this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_SEI+" not enable to send sei"),!1;var i=null===(t=this.peerConnection)||void 0===t?void 0:t.getSenders().filter((function(e){return e.track&&"video"===e.track.kind}));return i&&"function"!=typeof(null===(r=i[0])||void 0===r?void 0:r.createEncodedStreams)?(this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_SEI+" browser not support"),!1):this.sideMediaConfig.SEIType==o.ZegoSEIType.UserUnregister&&e.byteLength<=16?(this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_SEI+" inData size should greater than 16"),!1):this.mediaSideInfos.length>=10?(this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_SEI+" side info count limit"),!1):(this.mediaSideInfos.push(e.buffer),!0)},e.prototype.createAudioSenderTransform=function(e){var t=e.createEncodedStreams(),r=new TransformStream({transform:this.encodeAudioFrame});t.readable.pipeThrough(r).pipeTo(t.writable)},e.prototype.encodeAudioFrame=function(e,t){t.enqueue(e)},e.prototype.createVideoSenderTransform=function(e){var t=e.createEncodedStreams(),r=new TransformStream({transform:this.encodeVideoFrame});t.readable.pipeThrough(r).pipeTo(t.writable)},e.prototype.encodeSEINalu=function(e){var t=e.byteLength,r=parseInt(t/255),i=t%255,n=1+(r+1)+t+1,s=new ArrayBuffer(n),a=new DataView(s),d=0,c=this.sideMediaConfig.SEIType===o.ZegoSEIType.UserUnregister?5:243;a.setUint8(d++,c);for(var u=0;u<r;u++)a.setUint8(d++,255);a.setUint8(d++,i);var l=new DataView(e);for(u=0;u<(null==e?void 0:e.byteLength);u++)a.setInt8(d++,l.getInt8(u));a.setInt8(d++,128);var h=[];return{rbspView:a,ebspLength:n+h.length,ebspPreventProcessPos:h.map((function(e,t){return e+t}))}},e.prototype.onCreateOfferSuccess=function(e,t,r,i){var o,s=this;t&&(this.isUpdateSDP=!0,i&&(this.updateSDPCallBack=i)),this.videoInfo.bitRate>0&&(e.sdp=this.updateBandwidthRestriction(e.sdp,this.videoInfo.bitRate)),e.sdp=e.sdp.replace(/sendrecv/g,"sendonly");var c=e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)?e.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)[0]:null;if(c){var u=c.replace(/sendonly/,"sendrecv");e.sdp=e.sdp.replace(c,u)}e.sdp=e.sdp.replace(/useinbandfec=\d+/,(this.videoInfo.audioBitrate?"maxaveragebitrate="+this.videoInfo.audioBitrate:"")+(2===this.videoInfo.channelCount?";stereo=1":"")),this.localSdpOrder=e.sdp.match(/m=(.\w*)\s/g)||[],this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" local sdp revert "+this.localSdpOrder.join("")),e.sdp=n.SdpUtil.getSDPByVideDecodeType(e.sdp,this.videoCodec,this.stateCenter.softCoding),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp1 "+e.sdp.substr(0,e.sdp.length/2)),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+this.streamId+" localSdp2 "+e.sdp.substr(e.sdp.length/2)),this.dataReport.eventStart(this.reportSeq,"SetLocalDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetLocalDescription"),null===(o=this.peerConnection)||void 0===o||o.setLocalDescription(e).then((function(){s.dataReport.eventEnd(s.reportSeq,"SetLocalDescription"),s.dataReport.eventEnd(s.streamReportSeq,"SetLocalDescription"),s.onSetLocalDescriptionSuccess(e,r)}),(function(e){s.dataReport.eventEndWithMsg(s.reportSeq,"SetLocalDescription",{error:e.toString()}),s.dataReport.eventEndWithMsg(s.streamReportSeq,"SetLocalDescription",{error:e.toString()}),s.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CREATE_OFFER_SUCCESS+" "+s.streamId+" error "+e.toString()),s.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSetLocalDescError,!0)}))},e.prototype.updateBandwidthRestriction=function(e,t){var r="AS";return"firefox"===this.stateCenter.browser&&(t=1e3*(t>>>0),r="TIAS"),-1===e.indexOf("b="+r+":")?e.replace(/(m=video.*\r\nc=IN.*\r\n)/g,"$1b="+r+":"+t+"\r\n"):(e=e.replace(new RegExp("b="+r+":.*\r\n","g"),"b="+r+":"+t+"\r\n")).replace("b="+r+":"+t+"\r\n","")},e.prototype.onSetLocalDescriptionSuccess=function(e,t){var r=this;this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" success"),!this.isUpdateSDP&&(this.state=o.ENUM_PUBLISH_STATE.waitingOfferRsp),t&&(this.videoInfo=i(i({},this.videoInfo),t));var n={sdp:e.sdp,width:this.videoInfo.width,height:this.videoInfo.height,frameRate:this.videoInfo.frameRate,video_min_kpbs:this.videoInfo.bitRate,video_max_kpbs:this.videoInfo.bitRate,audio_kpbs:48,keyframe_intv:2};if(this.offerSeq=o.getSeq(),this.isUpdateSDP){this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" update sdp");var s=i(i({},n),{seq:this.sessionSeq,peerID:this.peerID,type:0});return this.dataReport.eventStart(this.reportSeq,"SendMediaDescUpdate"),this.dataReport.eventStart(this.streamReportSeq,"SendMediaDescUpdate"),void this.signal.sendMediaDescUpdateReq(this.offerSeq,this.sessionId,s,(function(e,t,r){}),(function(e,t){r.dataReport.eventEndWithMsg(r.reportSeq,"SendMediaDescUpdate",{error:e}),r.dataReport.eventEndWithMsg(r.streamReportSeq,"SendMediaDescUpdate",{error:e}),r.updateSDPCallBack&&r.updateSDPCallBack(-1),r.publishStateUpdateError(e==o.SEND_MSG_TIMEOUT?a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kUpdateMediaDescriptionTimeOut:a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kUpdateMediaDescriptionError)}))}this.isPeer?this.createSession(e):(this.dataReport.eventStart(this.reportSeq,"SendMediaDesc"),this.dataReport.eventStart(this.streamReportSeq,"SendMediaDesc"),this.signal.sendMediaDesc(this.offerSeq,this.sessionId,0,n,(function(e,t,i){r.offerSeq==e&&r.sessionId==t?(r.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+r.streamId+" send success"),r.dataReport.eventEndWithMsg(r.reportSeq,"SendMediaDesc",{mediaDescription:{width:n.width,height:n.height,frameRate:n.frameRate,video_min_kpbs:n.video_min_kpbs,video_max_kpbs:n.video_max_kpbs,audio_kpbs:n.audio_kpbs,keyframe_intv:n.keyframe_intv}}),r.dataReport.eventEndWithMsg(r.streamReportSeq,"SendMediaDesc",{mediaDescription:{width:n.width,height:n.height,frameRate:n.frameRate,video_min_kpbs:n.video_min_kpbs,video_max_kpbs:n.video_max_kpbs,audio_kpbs:n.audio_kpbs,keyframe_intv:n.keyframe_intv}}),r.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+r.streamId+" send success stateNego:waiterAnswer"),r.stateNego=o.ENUM_PUBLISH_STATE_NEGO.waiterAnswer,r.state=o.ENUM_PUBLISH_STATE.waitingServerAnswer):r.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+r.streamId+" seq or sessionId is not equal")}),(function(e,t){r.dataReport.eventEndWithMsg(r.reportSeq,"SendMediaDesc",{error:e}),r.dataReport.eventEndWithMsg(r.streamReportSeq,"SendMediaDesc",{error:e}),r.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaDescError)})),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_SET_LOCAL_DESCRIPTION_SUCCESS+" "+this.streamId+" call success"))},e.prototype.onRecvUpdateMediaDescription=function(e,t,r){this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_UPDATE_MEDIA_DESC+" "+this.streamId+" received"),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_UPDATE_MEDIA_DESC+" "+this.streamId+" received stateNego:waitingCandidate"),this.dataReport.addEvent(this.reportSeq,"RecvUpdateMediaDesc"),this.dataReport.addEvent(this.streamReportSeq,"RecvUpdateMediaDesc"),this.signal.sendUpdateMediaDescAck(e,this.sessionId,0,this.peerID),1==r.type?this.onGetRemoteOfferSuccess(r.sdp):this.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaDescError)},e.prototype.onRecvMediaDescription=function(e,t,r){this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received"),this.state==o.ENUM_PUBLISH_STATE.waitingServerAnswer?(this.stateNego=o.ENUM_PUBLISH_STATE_NEGO.waitingCandidate,this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_MEDIA_DESC+" "+this.streamId+" received stateNego:waitingCandidate"),this.dataReport.addEvent(this.reportSeq,"RecvMediaDesc"),this.dataReport.addEvent(this.streamReportSeq,"RecvMediaDesc"),this.signal.sendMediaDescAck(e,this.sessionId,0),1==r.type?this.onGetRemoteOfferSuccess(r.sdp):this.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaDescError)):this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_MEDIA_DESC+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onGetRemoteOfferSuccess=function(e){var t,r,i,n=this;this.videoInfo.audioBitrate&&48e3!==this.videoInfo.audioBitrate&&(e=e.replace(/maxaveragebitrate=(\d+)/,"maxaveragebitrate="+this.videoInfo.audioBitrate)),this.remoteSdpOrder=e.match(/m=(.\w*)\s/g)||[],this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+this.streamId+NaN+this.remoteSdpOrder.join(""));var s=this.stateCenter.turnOverTcpOnly,c=this.stateCenter.settingConfig.getSetting("udp_or_tcp",!0);if(c&&(this.logger.info("zp.oro.0 setting udp_or_tcp "+c),s="tcp"===c),s&&(null===(t=e.match(/candidate.*/g))||void 0===t||t.forEach((function(t){var r=t.replace(/udp/,"tcp");e=e.replace(t,r)}))),this.logger.info("zp.oro.0 "+this.streamId+" sdp revert "+this.localSdpOrder.join("")+" "+this.remoteSdpOrder.join("")),this.localSdpOrder.join()!==this.remoteSdpOrder.join()&&this.localSdpOrder.length==this.remoteSdpOrder.length){var u=new RegExp("[\\s\\S]*"+this.remoteSdpOrder[0]).exec(e)[0].replace(this.remoteSdpOrder[0],""),l=[],h="";this.localSdpOrder.forEach((function(t){var r=n.remoteSdpOrder.findIndex((function(e){return e==t})),i=new RegExp(t+"[\\s\\S]*"+(n.remoteSdpOrder[r+1]||"")).exec(e)[0].replace(n.remoteSdpOrder[r+1],""),o=/a=mid:(\w)/.exec(i)[1];l.push(o),h+=i||""})),e=u.replace(/a=group:BUNDLE.*/,"a=group:BUNDLE "+l.join(" "))+h,this.localSdpOrder=[],this.remoteSdpOrder=[]}var p=e.match(/m=video(.|\r|\n)*a=rtpmap(.|\r|\n)*(a=fmtp:(\d+).*)/);if("chrome"==this.stateCenter.browser){var g=0;if(this.videoInfo.bitRate&&"target"===this.videoInfo.startBitrate&&(g=this.videoInfo.bitRate),null!==p&&g){var f=p[3];e=-1!==f.indexOf("apt=")?e.replace(f,"a=fmtp:96 x-google-start-bitrate="+g+"\n"+f):e.replace(f,f+";x-google-start-bitrate="+g)}}if(this.videoInfo.bitRate>0){var _=/b=AS.*(\r\n|\n)/.test(e);e=_?e.replace(/AS:(\d+)/,"AS:"+this.videoInfo.bitRate):e.replace(/m=video.*(\r\n|\n)c=.*(\r\n|\n)/,"$&b=AS:"+this.videoInfo.bitRate+"\n");var m=null===(r=this.peerConnection)||void 0===r?void 0:r.getSenders().filter((function(e){return e.track&&"video"===e.track.kind}));null==m||m.forEach((function(e){var t,r,i,o,s,a;if(e&&e.getParameters&&e.setParameters){var d=e.getParameters();if(d.encodings&&0!=d.encodings.length||(d.encodings=[{}]),(null===(t=e.track)||void 0===t?void 0:t.id)==(null===(r=n.lowStream)||void 0===r?void 0:r.getVideoTracks()[0].id)){var c=null===(i=n.previewer)||void 0===i?void 0:i.lowStreamConfig.bitRate;c&&(d.encodings[0].maxBitrate=1e3*c)}else{d.encodings[0].maxBitrate=1e3*n.videoInfo.bitRate;var u=n.lastPublishStats.frameWidth,l=(null===(s=null===(o=n.previewer)||void 0===o?void 0:o.cameraMaxResolution)||void 0===s?void 0:s.maxWidth)||0,h=null===(a=n.previewer)||void 0===a?void 0:a.videoInfo.width,p=u?Math.min(l,u):l;if(l&&h){var g=Math.max(p/h,1);d.encodings[0].scaleResolutionDownBy=g}}e.setParameters(d)}}))}this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+this.streamId+" remoteSdp:",e);var v={type:"answer",sdp:e,toJSON:function(){}};this.dataReport.eventStart(this.reportSeq,"SetRemoteDescription"),this.dataReport.eventStart(this.streamReportSeq,"SetRemoteDescription"),null===(i=this.peerConnection)||void 0===i||i.setRemoteDescription(new RTCSessionDescription(v)).then((function(){n.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+n.streamId+" set success"),n.dataReport.eventEnd(n.reportSeq,"SetRemoteDescription"),n.dataReport.eventEnd(n.streamReportSeq,"SetRemoteDescription"),n.stateNego==o.ENUM_PUBLISH_STATE_NEGO.iceConnected&&n.updateSDPCallBack&&(n.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+n.streamId+" update sdp success"),n.updateSDPCallBack(0),n.updateSDPCallBack=void 0,n.isUpdateSDP=!1)}),(function(e){n.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+n.streamId+" failed: "+e.toString()),n.dataReport.eventEndWithMsg(n.reportSeq,"SetRemoteDescription",{error:e.toString()}),n.dataReport.eventEndWithMsg(n.streamReportSeq,"SetRemoteDescription",{error:e.toString()}),n.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kSetRemoteDescError,!0)})),this.state=o.ENUM_PUBLISH_STATE.waitingServerICE,this.logger.debug(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_GET_REMOTE_DESCRIPTION+" "+this.streamId+" call success")},e.prototype.onIceConnectionStateChange=function(e){var t=this;if(this.state!=o.ENUM_PUBLISH_STATE.stop&&null!=this.peerConnection)if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateChanged "+this.peerConnection.iceConnectionState),"connected"===this.peerConnection.iceConnectionState){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" connected state "+this.state),this.dataReport.eventEnd(this.reportSeq,"IceConnected"),this.dataReport.eventEnd(this.streamReportSeq,"IceConnected"),this.stateNego=o.ENUM_PUBLISH_STATE_NEGO.iceConnected,this.answerSdpTime){var r=(new Date).getTime()-this.answerSdpTime;this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" ice time "+r)}this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" "+this.streamId+" stateNego:iceConnected"),this.negoTimer&&(clearTimeout(this.negoTimer),this.negoTimer=null),null!=this.iceDisconnectedTimer&&(clearTimeout(this.iceDisconnectedTimer),this.iceDisconnectedTimer=null),this.publishEvent?this.publishSuccess():(this.firstGetStatsTimer&&clearTimeout(this.firstGetStatsTimer),this.firstGetStatsTimer=null,this.firstGetStatsTimer=setTimeout((function(){var e;t.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" get first stats state "+t.state),t.state!==o.ENUM_PUBLISH_STATE.publishing&&(null===(e=t.peerConnection)||void 0===e||e.getStats().then((function(e){t.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" get first stats suc"),e.size>0&&t.publishSuccess()})))}),1e3))}else"closed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceClosed"),this.stateNego=o.ENUM_PUBLISH_STATE_NEGO.iceClosed,this.checkPublishConnectionFailedState(this.peerConnection.iceConnectionState)):"failed"===this.peerConnection.iceConnectionState?(this.dataReport.addEvent(this.reportSeq,"IceFailed"),this.stateNego=o.ENUM_PUBLISH_STATE_NEGO.iceFailed,this.checkPublishConnectionFailedState(this.peerConnection.iceConnectionState)):"disconnected"===this.peerConnection.iceConnectionState&&(this.dataReport.addEvent(this.reportSeq,"IceDisconnected"),this.logger.warn(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" ice disconnected "),this.stateNego=o.ENUM_PUBLISH_STATE_NEGO.iceDisconnected,this.iceDisconnectedTimer||(this.iceDisconnectedTimer=setTimeout((function(){t.checkPublishConnectionFailedState("disconnected")}),this.iceDisconnectedMaxTime)))},e.prototype.onIceCandidate=function(e){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CANDIDATE+" "+this.streamId+" candidate"+e.candidate),e.candidate)if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CANDIDATE+" "+this.streamId+" candidate"+e.candidate.candidate),this.state<o.ENUM_PUBLISH_STATE.connecting||this.state==o.ENUM_PUBLISH_STATE.stop)this.candidateInfo.push({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex});else{var t={candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex};this.sendCandidateInfo([t])}},e.prototype.sendCandidateInfo=function(e){var t=this;this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+this.streamId+" called"),!(e=e.filter((function(e){return e.candidate.indexOf("relay")>0})))||e.length<1?this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+this.streamId+" cancelled"):(this.dataReport.eventStart(this.reportSeq,"SendIceCandidate"),this.dataReport.eventStart(this.streamReportSeq,"SendIceCandidate"),this.stateNego!==o.ENUM_PUBLISH_STATE_NEGO.iceConnected&&(this.stateNego=o.ENUM_PUBLISH_STATE_NEGO.sendCandidate),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+this.streamId+" stateNego:sendCandidate"),this.signal.sendCandidateInfo(o.getSeq(),this.sessionId,e,(function(e,r,i){t.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+t.streamId+" send success"),t.dataReport.eventEnd(t.reportSeq,"SendIceCandidate"),t.dataReport.eventEnd(t.streamReportSeq,"SendIceCandidate")}),(function(e,r){t.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SEND_CANDIDATE_INFO+" "+t.streamId+" failed to send: "+e.toString()),t.dataReport.eventEndWithMsg(t.reportSeq,"SendIceCandidate",{error:e}),t.dataReport.eventEndWithMsg(t.streamReportSeq,"SendIceCandidate",{error:e}),t.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kCandidateError)})))},e.prototype.onConnectionStateChange=function(e){this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_CONNECTION_STATE_CHANGE+" "+this.streamId+" called "+e.target.signalingState)},e.prototype.onRecvCandidateInfo=function(e,t,r){var i,n=this;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" received "+JSON.stringify(r.infos)),this.state==o.ENUM_PUBLISH_STATE.waitingServerICE){this.dataReport.addEvent(this.reportSeq,"RecvIceCandidate"),this.dataReport.addEvent(this.streamReportSeq,"RecvIceCandidate"),this.signal.sendCandidateInfoAck(e,this.sessionId,0),this.sendCandidateInfo(this.candidateInfo),this.candidateInfo=[];for(var s=0;s<r.infos.length;s++){var c={sdpMid:r.infos[s].sdpMid,sdpMLineIndex:r.infos[s].sdpMLineIndex,candidate:r.infos[s].candidate};this.logger.debug(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+""+this.streamId+" candidate "+c.candidate),null===(i=this.peerConnection)||void 0===i||i.addIceCandidate(new RTCIceCandidate(c)).then((function(){n.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+n.streamId+" add success")}),(function(e){n.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+n.streamId+" add error "+e.toString()),n.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kCandidateError,!0)}))}this.state=o.ENUM_PUBLISH_STATE.connecting,this.dataReport.eventStart(this.reportSeq,"IceConnected"),this.dataReport.eventStart(this.streamReportSeq,"IceConnected")}else this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CANDIDATE_INFO+" "+this.streamId+" current state "+this.state+" not allowed")},e.prototype.onRecvCloseSession=function(e,t,r){this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CLOSE_SESSION+""+this.streamId+" "+JSON.stringify(r)),this.dataReport.addEvent(this.reportSeq,"RecvCloseSession"),this.signal.sendCloseSessionAck(e,this.sessionId,0);var i=r.err_info?JSON.parse(r.err_info.toLowerCase()):{},o=i.action?i.action:null,n=1*r.reason,s=JSON.parse(JSON.stringify(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishSessionClosedError));s.message+=" reason:"+n+" "+(o?" action:"+o:""),1011===i.err&&(s=a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaServerForbidError),1014===i.err&&(s=a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishTokenExpiredError),this.negoTimer&&clearTimeout(this.negoTimer);var c=![4,8,10,11,12,14,26,27].includes(n)&&![2,5,6].includes(o);this.publishStateUpdateError(s,c)},e.prototype.onRecvResetSession=function(e,t,r){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_RESET_SESSION+" "+this.streamId+" received "),t==this.sessionId){this.signal.sendCloseSessionAck(e,this.sessionId,0);var i=a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishSessionClosedError;this.negoTimer&&clearTimeout(this.negoTimer),this.publishStateUpdateError(i)}else this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_RESET_SESSION+" "+this.streamId+" cannot find session")},e.prototype.onRecvPublishEvent=function(e,t,r){this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_PUBLISH_EVENT+" "+this.streamId+" received"),this.publishEvent=!0,this.firstGetStatsTimer&&(clearTimeout(this.firstGetStatsTimer),this.firstGetStatsTimer=null),this.stateNego===o.ENUM_PUBLISH_STATE_NEGO.iceConnected&&0==r.event&&this.publishSuccess()},e.prototype.onRecvClientInfo=function(e,t,r){this.stateCenter.clientIP!==r.clientip&&this.logger.warn(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_RECV_CLIENT_INFO+" client ip changed "+this.stateCenter.clientIP+" "+r.clientip),this.stateCenter.clientIP=r.clientip,this.peerID=r.peer_id,this.sideMediaConfig.isSEIStart&&this.sideMediaConfig.SEIType==o.ZegoSEIType.UserUnregister&&this.sendSEIUUID();var i=this.previewer;if(i&&null!==i.activateSEIConfig){var n=null==i?void 0:i.activateSEIConfig,s=n.action,a=n.infoType;this.activateSEIInsert(s,a)}},e.prototype.sendSEIUUID=function(){var e=this;this.signal.gw.mediaStreamSEIUUIDReq(o.getSeq(),this.sessionId,this.peerID,this.sideMediaConfig.unregisterSeiFilter).then((function(t){var r;0==(null===(r=null==t?void 0:t.usr_sei_filter)||void 0===r?void 0:r.result)&&(e.sideMediaConfig.uuidSend=!0)})).catch((function(e){console.error()}))},e.prototype.checkPublishConnectionFailedState=function(e){this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_ICE_CONNECTION_STATE_CHANGE+" streamID "+this.streamId," state "+this.state+" connectionState "+e),this.publishStateUpdateError(a.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kMediaConnectionError)},e.prototype.setPublishQualityTimer=function(){var e=this;null==this.qualityTimer&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_PLAYER_QUALITY_TIMER+" "+this.streamId+" called"),this.clearPublishQualityTimer(),this.qualityTimer=setInterval((function(){e.peerConnectionGetStats()}),this.qualityTimeInterval),this.lastPublishStats={audioPacketsLost:0,videoPacketsLost:0,videoPacketsSent:0,audioPacketsSent:0,audioRetransmittedPacketsSent:0,videoTime:(new Date).getTime(),audioTime:(new Date).getTime(),time:0,audioBytesSent:0,videoBytesSent:0,framesEncoded:0,framesSent:0,videoRetransmittedPacketsSent:0},this.qualitySeq=o.getSeq(),this.qualityCount=0)},e.prototype.peerConnectionGetStats=function(e){var t=this;if(this.peerConnection){var r=[this.peerConnection.getStats(null)];"chrome"==this.stateCenter.browser&&r.push(new Promise((function(e,r){var i;null===(i=t.peerConnection)||void 0===i||i.getStats((function(t){return e(t)}),(function(e){return r(e)}))}))),Promise.all(r).then((function(r){var i=t.getPublishStats(r[0],r[1]);e&&e(i,r[0],r[1])})).catch((function(e){t.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_SET_PLAYER_QUALITY_TIMER+" "+t.streamId+" getStats error "+e.toString())}))}},e.prototype.getPublishStats=function(e,t){var r,i=this;if(e){for(var n,c=document.querySelectorAll("video, audio"),u=0;u<c.length;u++)c[u].srcObject===this.localStream&&(n=c[u]);var l=this.streamCenter.checkPreview(this.localStream),h={sampleTimeWindow:this.qualityTimeInterval,audioCodec:"opus",audioTargetBitrate:this.videoInfo.audioBitrate/1e3||0,audioBitrate:0,videoTargetBitrate:this.videoInfo.bitRate||0,videoTargetFPS:this.videoInfo.frameRate||0,videoBitrate:0,audioFPS:0,audioLevel:0,audioInputLevel:0,audioPacketsLost:0,audioPacketsLostRate:0,sendLevel:0,samplingRate:0,videoFPS:0,nackCount:0,pliCount:0,audioQuality:0,videoQuality:0,frameHeight:0,frameWidth:0,videoTransferFPS:0,videoPacketsLost:0,videoPacketsLostRate:0,totalRoundTripTime:0,currentRoundTripTime:0,googBandwidthLimitedResolution:void 0,videoCodecName:"",audioCodecName:"",googCpuLimitedResolution:void 0,googAvailableSendBandwidth:0,googActualEncBitrate:0,googTargetEncBitrate:0,googFrameWidthInput:0,googFrameHeightInput:0,googFrameRateInput:0,codecImplementationName:"",videoMuteState:(null===(r=null==l?void 0:l.videoTrack)||void 0===r?void 0:r.enabled)?"0":"1",audioMuteState:this.localStream.getAudioTracks().length>0&&this.localStream.getAudioTracks()[0].enabled?"0":"1",muted:n?n.muted:void 0,paused:n?n.paused:void 0,volume:n?n.volume:void 0,sinkId:n?n.sinkId:void 0},p=this.lastPublishStats.time,g=0,f=0,_=0,m=0,v=0,E=0;e.forEach((function(e){if(("outbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesSent)&&"audio"==e.mediaType)0!=p&&(h.audioBitrate=8*(e.bytesSent-i.lastPublishStats.audioBytesSent)/(e.timestamp-p),e.retransmittedPacketsSent=e.retransmittedPacketsSent||0,e.packetsSent=e.packetsSent||0,h.audioFPS=(e.packetsSent-(e.retransmittedPacketsSent-i.lastPublishStats.audioRetransmittedPacketsSent)-i.lastPublishStats.audioPacketsSent)/(e.timestamp-p)*1e3||0,_=(e.retransmittedPacketsSent-i.lastPublishStats.audioRetransmittedPacketsSent)/(e.packetsSent-i.lastPublishStats.audioPacketsSent)),h.audioBitrate<0&&(h.audioBitrate=0),i.lastPublishStats.audioBytesSent=e.bytesSent,i.lastPublishStats.time=e.timestamp,i.lastPublishStats.audioPacketsSentTimeStamp=e.packetsSent-i.lastPublishStats.audioPacketsSent,i.lastPublishStats.audioPacketsSent=e.packetsSent,i.lastPublishStats.audioRetransmittedPacketsSent=e.retransmittedPacketsSent;else if(("outbound-rtp"==e.type||"ssrc"==e.type&&null!=e.bytesSent)&&"video"==e.mediaType)0!=p&&(h.videoBitrate=8*(e.bytesSent-i.lastPublishStats.videoBytesSent)/(e.timestamp-p),h.videoFPS=1e3*(e.framesEncoded-i.lastPublishStats.framesEncoded)/(e.timestamp-p),m=(e.retransmittedPacketsSent-i.lastPublishStats.videoRetransmittedPacketsSent)/(e.packetsSent-i.lastPublishStats.videoPacketsSent)),h.videoBitrate<0&&(h.videoBitrate=0),h.videoFPS<0&&(h.videoFPS=0),h.nackCount=e.nackCount,h.pliCount=e.pliCount,i.lastPublishStats.videoBytesSent=e.bytesSent,i.lastPublishStats.framesEncoded=e.framesEncoded,i.lastPublishStats.time=e.timestamp,i.lastPublishStats.videoPacketsSentTimeStamp=e.packetsSent-i.lastPublishStats.videoPacketsSent,i.lastPublishStats.videoPacketsSent=e.packetsSent,i.lastPublishStats.videoRetransmittedPacketsSent=e.retransmittedPacketsSent;else if("remote-inbound-rtp"==e.type&&"video"==e.kind){e.packetsLost>0&&(h.videoPacketsLost=e.packetsLost);var t=e.packetsLost-i.lastPublishStats.videoPacketsLost;h.videoPacketsLostRate=t>0?t/i.lastPublishStats.videoPacketsSentTimeStamp:0,e.packetsLost>0&&(i.lastPublishStats.videoPacketsLost=e.packetsLost),i.lastPublishStats.videoTime=e.timestamp,f=1e3*e.roundTripTime,E=e.jitter}else if("remote-inbound-rtp"==e.type&&"audio"==e.kind){e.packetsLost>0&&(h.audioPacketsLost=e.packetsLost);var r=e.packetsLost-i.lastPublishStats.audioPacketsLost;h.audioPacketsLostRate=r>0?r/i.lastPublishStats.audioPacketsSentTimeStamp:0,e.packetsLost>0&&(i.lastPublishStats.audioPacketsLost=e.packetsLost),i.lastPublishStats.audioTime=e.timestamp,g=1e3*e.roundTripTime,v=e.jitter}else if("media-source"==e.type&&("audio"==e.kind||e.id.toLowerCase().indexOf("audio")>=0))h.audioLevel=e.audioLevel||0,h.sendLevel=e.totalAudioEnergy,h.audioInputLevel=32767*e.totalAudioEnergy,h.samplingRate=e.totalSamplesDuration;else if("track"==e.type&&("video"==e.kind||e.id.indexOf("video")>=0||e.frameWidth)){if(h.frameHeight=e.frameHeight,h.frameWidth=e.frameWidth,0===p||i.lastPublishStats.frameHeight===e.frameHeight&&i.lastPublishStats.frameWidth===e.frameWidth)0===p&&(i.lastPublishStats.frameHeight=e.frameHeight,i.lastPublishStats.frameWidth=e.frameWidth);else{var n=o.getReportSeq();i.dataReport.newReport(n,a.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.event),i.dataReport.addMsgInfo(n,{session_id:a.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.session_id(i.sessionId),w:a.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.w(e.frameWidth),h:a.ZegoRTCLogEvent.kZegoTaskVideoCaptureSize.h(e.frameHeight)}),i.dataReport.uploadReport(n),i.lastPublishStats.frameHeight=e.frameHeight,i.lastPublishStats.frameWidth=e.frameWidth}0!=p&&(h.videoTransferFPS=1e3*(e.framesSent-i.lastPublishStats.framesSent)/(e.timestamp-p)),h.videoTransferFPS<0&&(h.videoTransferFPS=0),i.lastPublishStats.framesSent=e.framesSent}else"candidate-pair"==e.type&&(null!=e.totalRoundTripTime&&(h.totalRoundTripTime=e.totalRoundTripTime),null!=e.currentRoundTripTime&&(h.currentRoundTripTime=e.currentRoundTripTime))})),t&&t.result().forEach((function(e){"ssrc"==e.type&&e.names().indexOf("googBandwidthLimitedResolution")>=0&&(h.googBandwidthLimitedResolution=e.stat("googBandwidthLimitedResolution")),"ssrc"==e.type&&"video"==e.stat("mediaType")&&e.names().indexOf("googCodecName")>=0&&(h.videoCodecName=e.stat("googCodecName")),"ssrc"==e.type&&"audio"==e.stat("mediaType")&&e.names().indexOf("googCodecName")>=0&&(h.audioCodecName=e.stat("googCodecName")),"ssrc"==e.type&&e.names().indexOf("googCpuLimitedResolution")>=0&&(h.googCpuLimitedResolution=e.stat("googCpuLimitedResolution")),"ssrc"==e.type&&e.names().indexOf("googFrameWidthInput")>=0&&(h.googFrameWidthInput=e.stat("googFrameWidthInput")),"ssrc"==e.type&&e.names().indexOf("googFrameHeightInput")>=0&&(h.googFrameHeightInput=e.stat("googFrameHeightInput")),"ssrc"==e.type&&e.names().indexOf("googFrameRateInput")>=0&&(h.googFrameRateInput=e.stat("googFrameRateInput")),"ssrc"==e.type&&e.names().indexOf("codecImplementationName")>=0&&(h.codecImplementationName=e.stat("codecImplementationName")),"VideoBwe"==e.type&&e.names().indexOf("googAvailableSendBandwidth")>=0&&(h.googAvailableSendBandwidth=e.stat("googAvailableSendBandwidth")),"VideoBwe"==e.type&&e.names().indexOf("googActualEncBitrate")>=0&&(h.googActualEncBitrate=e.stat("googActualEncBitrate")),"VideoBwe"==e.type&&e.names().indexOf("googTargetEncBitrate")>=0&&(h.googTargetEncBitrate=e.stat("googTargetEncBitrate")),"VideoBwe"==e.type&&e.names().indexOf("googRetransmitBitrate")>=0&&(h.googRetransmitBitrate=e.stat("googRetransmitBitrate"))})),"chrome"===this.stateCenter.browser&&this.handleEncBitrate(Number.parseInt(h.googTargetEncBitrate),Number.parseInt(h.googActualEncBitrate),Number.parseInt(h.googRetransmitBitrate)),f=isNaN(f)||f<0?0:f,m=isNaN(m)||m<0?0:m,E=isNaN(E)||E<0?0:E,g=isNaN(g)||g<0?0:g,_=isNaN(_)||_<0?0:_,v=isNaN(v)||v<0?0:v;var S=s.ClientUtil.getNetQuality(f,m,E),T=s.ClientUtil.getNetQuality(g,_,v);h.videoQuality=p>0?s.ClientUtil.quality2QualityGrade(S):0,h.audioQuality=p>0?s.ClientUtil.quality2QualityGrade(T):0;var C=Math.min(S,T);this.netQuality=C,p>0&&C<=o.QUALITY_CONSTANT.MiddleMinQuality&&(new Date).getTime()>this.probeTime+this.probeInterval&&(this.logger.info(d.ZEGO_WEBRTC_ACTION.PLAYER_SET_PLAYER_QUALITY_TIMER+" netQuality "+C+" start net probe"),this.probeState=o.ENUM_PROBE_STATE.tryProbe,this.streamCenter.startNetProbe(!0,this,this.gwNodeList),this.probeTime=(new Date).getTime()),this.updateCurrentQualityStats(h),0!==p&&(this.uploadPublishQuality(h),this.onPublishQualityUpdate(this.streamId,this.currentQuality,e,t))}},e.prototype.updateCurrentQualityStats=function(e){var t=e.videoBitrate,r=e.videoFPS,o=e.videoTransferFPS,n=e.frameHeight,s=e.frameWidth,a=e.videoMuteState,d=e.videoQuality,c=e.audioBitrate,u=e.audioCodec,l=e.audioMuteState,h=e.audioQuality,p=e.audioFPS,g={video:i(i({},this.currentQuality.video),{videoBitrate:t,videoFPS:r,videoTransferFPS:o,frameHeight:n,frameWidth:s,muteState:a,videoQuality:d}),audio:i(i({},this.currentQuality.audio),{audioBitrate:c,audioCodec:u,muteState:l,audioQuality:h,audioFPS:p}),nackCount:e.nackCount,pliCount:e.pliCount,totalRoundTripTime:e.totalRoundTripTime,currentRoundTripTime:e.currentRoundTripTime};if(void 0!==e.videoPacketsLost){var f=e.videoPacketsLost,_=e.videoPacketsLostRate;g.video.videoPacketsLost=f,g.video.videoPacketsLostRate=_}if(void 0!==e.audioPacketsLost){var m=e.audioPacketsLost,v=e.audioPacketsLostRate;g.audio.audioPacketsLost=m,g.audio.audioPacketsLostRate=v}if(void 0!==e.muted&&(g.muted=e.muted,g.paused=e.paused,g.volume=e.volume,g.sinkId=e.sinkId),void 0!==e.googBandwidthLimitedResolution){var E=e.googBandwidthLimitedResolution,S=e.videoCodecName,T=e.audioCodecName,C=e.googFrameWidthInput,y=e.googFrameHeightInput,R=e.googCpuLimitedResolution,b=e.googFrameRateInput,I=e.codecImplementationName,O=e.googAvailableSendBandwidth,P=e.googActualEncBitrate,k=e.googTargetEncBitrate;g.googBandwidthLimitedResolution=E,g.video.googCodecName=S,g.audio.googCodecName=T,g.googCpuLimitedResolution=R,g.googFrameWidthInput=C,g.googFrameHeightInput=y,g.googFrameRateInput=b,g.codecImplementationName=I,g.googAvailableSendBandwidth=O,g.googActualEncBitrate=P,g.googTargetEncBitrate=k}this.currentQuality=g},e.prototype.uploadPublishQuality=function(e){if(this.qualityUpload&&this.signal.isServerConnected){var t=(new Date).getTime();(0==this.qualityUploadLastTime||t-this.qualityUploadLastTime>=2e3)&&(e.stream_type="publish",e.stream_id=this.streamId,e.timeStamp=Math.round(t/1e3),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_UPLOAD_PUBLISH_QUALITY+" "+this.streamId+" upload"+JSON.stringify(e)),this.streamCenter.updateQuality(0,e),this.qualityUploadLastTime=t)}},e.prototype.stopPublish=function(){if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_PUBLISH+"  .1 "+this.streamId+" called"),Object.keys(this.streamCenter.publisherList).length=1)for(var e in this.streamCenter.playerList){var t=this.streamCenter.playerList[e].player;t.state==o.ENUM_PLAY_STATE.playing&&t.broadcasterStatus==o.ENUM_BROADCASTER_STATUS.start&&(this.signal&&this.signal.sendBroadcasterStatus(o.getSeq(),t.sessionId,0),t.broadcasterStatus=o.ENUM_BROADCASTER_STATUS.stop)}this.sessionId&&!this.closeSessionSignal&&this.signal.sendCloseSession(o.getSeq(),this.sessionId,0),this.dataReport.eventEndWithMsg(this.streamReportSeq,"PublishState",{state:this.state+""}),this.dataReport.addEvent(this.streamReportSeq,"StopPublish"),this.dataReport.addMsgExt(this.streamReportSeq,{stream:this.streamId,sessionId:this.sessionId}),this.dataReport.addMsgInfo(this.streamReportSeq,{itemtype:"RTCPublishStream",use_na:this.stateCenter.useNetAgent?1:0}),this.dataReport.uploadReport(this.streamReportSeq,"RTCPublishStream"),this.resetPublish()},e.prototype.onPublishStateUpdate=function(e,t,r,i){},e.prototype.onPublishQualityUpdate=function(e,t,r,i){},e.prototype.onDisconnect=function(e){this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_DISCONNECT+" "+this.streamId+" call"),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_ON_DISCONNECT+" "+this.streamId+" websocket disconnect"),this.dataReport.addEvent(this.reportSeq,"OnDisconnect"),this.publishStateUpdateError(e||a.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kWebsocketDisconnectedError,!!e)},e.prototype.publishSuccess=function(){var e,t;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_PUBLISH_SUCCESS+" call"),this.isUpdateSDP&&this.updateSDPCallBack)return this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_PUBLISH_SUCCESS+" "+this.streamId+" update sdp success"),this.updateSDPCallBack(0),this.updateSDPCallBack=void 0,void(this.isUpdateSDP=!1);for(var r in this.state!=o.ENUM_PUBLISH_STATE.publishing&&this.onPublishStateUpdate(o.ENUM_PUBLISH_STATE_UPDATE.start,this.streamId,{code:0,message:""},!0),this.isPeer&&(this.peerFailCount=0),this.state=o.ENUM_PUBLISH_STATE.publishing,this.dataReport.eventStart(this.reportSeq,"PublishState"),this.dataReport.eventStart(this.streamReportSeq,"PublishState"),this.streamCenter.playerList){var i=this.streamCenter.playerList[r].player;i.state==o.ENUM_PLAY_STATE.playing&&i.broadcasterStatus==o.ENUM_BROADCASTER_STATUS.stop&&(this.signal&&this.signal.sendBroadcasterStatus(o.getSeq(),i.sessionId,1),i.broadcasterStatus=o.ENUM_BROADCASTER_STATUS.start)}this.setPublishQualityTimer();var n=2,s=2,a=null===(e=this.previewer)||void 0===e?void 0:e.videoTrack,c=0!==this.localStream.getAudioTracks().length&&this.localStream.getAudioTracks()[0];(a&&"live"===a.readyState&&!0===a.enabled||(null===(t=this.previewer)||void 0===t?void 0:t.muteImage))&&(n=0),c&&"live"===c.readyState&&!0===c.enabled&&(s=0),this.sendStreamStatus(n,s,!0),this.streamCenter.soundLevelDelegate&&this.previewer&&this.previewer.startSoundLevel(),this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_PUBLISH_SUCCESS+" call success")},e.prototype.startSoundLevel=function(){var e;if(this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" call streamID: "+this.streamId),this.localStream&&0!=this.localStream.getAudioTracks().length)try{null===(e=this.previewer)||void 0===e||e.startSoundLevel()}catch(e){this.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" "+this.streamId+" get sound level failed "+e)}else this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_START_SOUND_LEVEL+" "+this.streamId+" local stream no found")},e.prototype.stopSoundLevel=function(){var e;this.logger.info(d.ZEGO_WEBRTC_ACTION.PUBLISHER_STOP_SOUND_LEVEL+" call streamID: "+this.streamId),null===(e=this.previewer)||void 0===e||e.stopSoundLevel()},e.prototype.handleEncBitrate=function(e,t,r){var i,o=this,n=1e3*this.videoInfo.bitRate,a=0;if(t>0){this.needIncMax||this.gotMax||(this.probeCount++,t>=.75*e?(this.probeCount>=10&&this.initFitCnt>=.6*this.probeCount&&(this.gotMax=!0,this.targetRate=n),this.initFitCnt++):this.probeCount>=10&&this.initFitCnt/this.probeCount<.3&&(this.needIncMax=!0));var c=s.ClientUtil.arrAvg(this.totalBitrateArray,t,10);if(this.needIncMax)if(c>=1.05*n){if(this.targetRate>n){var u=void 0;c>e?(u=c-e,this.targetRate-=u):(u=c-n,this.targetRate-=u),this.targetRate=Math.max(this.targetRate,n),this.targetRate=Math.min(this.targetRate,2*n),a=this.targetRate}}else c<.8*n&&(0===this.targetRate&&(this.targetRate=e),this.targetRate>=n?this.targetRate=this.targetRate+.08*n:this.targetRate=1.05*this.targetRate,this.targetRate=Math.min(this.targetRate,2*n),a=this.targetRate)}if(r>0&&r<n){var l=s.ClientUtil.arrAvg(this.totalRetransRateArray,r,5);this.needIncMax?l+t>1.05*n&&(u=l+t-n,this.targetRate-=u,this.targetRate=Math.max(this.targetRate,n-l),a=this.targetRate):a=this.targetRate-l}else this.targetRate<n&&(this.targetRate=n,a=this.targetRate);if(a>0){a=s.ClientUtil.arrAvg(this.totalTargetRateArray,a,5);var h=null===(i=this.peerConnection)||void 0===i?void 0:i.getSenders().filter((function(e){return e.track&&"video"===e.track.kind}));if(!h)return;var p=h.length>1?h[1]:h[0]?h[0]:null;if(!p)return;var g=p.getParameters();g.encodings||(g.encodings=[{}]),g.encodings[0].maxBitrate=a,p.setParameters(g).catch((function(e){o.logger.error(d.ZEGO_WEBRTC_ACTION.PUBLISHER_HANDLE_ENC_BITRATE+" "+e)}))}},e.prototype.resetEncBitrate=function(){this.needIncMax=!1,this.probeCount=0,this.gotMax=!1,this.initFitCnt=0,this.targetRate=0,this.totalBitrateArray=[],this.totalTargetRateArray=[],this.totalRetransRateArray=[]},e.prototype.replacePublishedTrack=function(e,t){return void 0===t&&(t=!1),{errorCode:-1,extendedData:"should install advanced module first"}},e.prototype.sendStreamStatus=function(e,t,r,i){var n=this;void 0===r&&(r=!1),void 0===i&&(i=0),(r||this.camera_status!==e||this.mic_status!==t)&&this.signal&&(this.camera_status=e,this.mic_status=t,i++,this.signal.sendStreamStatus(o.getSeq(),this.sessionId,e,t,this.streamId,(function(){n.camera_status===e&&n.mic_status===t&&i<=1&&n.sendStreamStatus(e,t,!0,i)})))},e.prototype.addCanvasStreamVideoTrack=function(e){var t=document.createElement("canvas"),r=new Image;return r.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAFFJREFUOE9jZGBgaGBgYLBnYGBwYCANHGBgYDjIyMDAcIWBgUGbNL1w1VdBBvwnUzNY26gBo2EwjNLBfjJyIiz7HADlBVB2DiEjR15lYGBYAwAypRSY53SYoAAAAABJRU5ErkJggg==",t.width=80,t.height=80,this.canvasTimer=setInterval((function(){var e;(e=t.getContext("2d"))&&e.drawImage(r,0,0,16,16)}),200),t.captureStream().getVideoTracks()[0]},e}();t.ZegoPublish=u},5019:function(e,t,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSignal=void 0;var o=r(6706),n=r(1089),s=r(2752),a=r(1691),d=r(746),c=function(){function e(e,t,r,i){void 0===i&&(i=!1),this.netAgent=r,this.useNetAgent=i,this.sendDataMap={},this.sendDataList=new o.LinkedList,this.sendDataCheckOnceCount=100,this.signalSeq=0,this.pushCallback={},this.sessionInfos={},this.tryHeartbeatCount=0,this.heartbeatInterval=1e4,this.sendDataTimeout=5e3,this.sendDataDropTimeout=1e4,this.sendDataCheckTimer=null,this.sendDataCheckInterval=2e3,this.checkMessageList=["ActivateVideoPlayStreamReq","ActivateAudioPlayStreamReq","CreateSessionReq","CreateSessionWithSdpReq","ActivateSEIInsertReq","StreamStatusNotify","MediaDescUpdateReq"],this.tryConnectCount=1,this.tryConnectTimer=null,this.tryConnectInterval=3e3,this.state=o.ENUM_CONNECT_STATE.disconnect,this.tokenType=0,this.browser=this.getBrowserAndVersion(),this.platform=navigator.platform,this._websocket=null,this.negoInterval=25e3,this.negoTryCount=1,this.negoTryMaxCount=2,this.logger=e,this.stateCenter=t,this.stateCenter.streamConnectTime&&(this.tryConnectInterval=this.stateCenter.streamConnectTime),this.gw=new a.GatewaySignal(this)}return Object.defineProperty(e.prototype,"wsReadyState",{get:function(){var e;return null===(e=this.websocket)||void 0===e?void 0:e.readyState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocket",{get:function(){return this._websocket},set:function(e){null===e&&this.useNetAgent||(this._websocket=e)},enumerable:!1,configurable:!0}),e.prototype.getBrowserAndVersion=function(){var e,t=navigator.userAgent,r=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[];return/trident/i.test(r[1])?{name:"IE",version:(e=/\brv[ :]+([\d\.]+)/g.exec(t)||[])[1]||""}:"Chrome"===r[1]&&null!=(e=t.match(/\bOPR|Edge\/([\d\.]+)/))?{name:"Opera",version:e[1]}:(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/([\d+\.]+)/i))&&r.splice(1,1,e[1]),{name:r[0],version:r[1]})},e.prototype.setSessionInfo=function(e,t){this.logger.debug(n.ZEGO_WEBRTC_ACTION.SIGNAL_SET_SESSION_INFO+" call"),this.appid=e+"",this.userid=t},e.prototype.onDisconnect=function(e,t){},e.prototype.onUpdateHeartBeatInterval=function(e){},e.prototype.resetConnectTimer=function(){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_RESET_CONNECT_TIMER+" call"),clearTimeout(this.tryConnectTimer),this.tryConnectTimer=null,this.tryConnectCount=0},e.prototype.handleWsMessage=function(e){var t=JSON.parse(e.data);this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" signmsg= ",t.header.cmd),this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" signmsg= "+JSON.stringify(t)),t.header.appid==this.appid&&t.header.user_id===this.userid?this.handleServerPush(t):this.logger.warn(n.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" check header failed")},e.prototype.bindWebSocketEvents=function(){var e=this;this.tryHeartbeatCount=0,this.tryConnectInterval=this.stateCenter.streamConnectTime?this.stateCenter.streamConnectTime:3e3,this.websocket&&(this.websocket.onclose=function(t){if(e.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" close msg = "+JSON.stringify((null==t?void 0:t.code)?null==t?void 0:t.code:t)),e.state!=o.ENUM_CONNECT_STATE.disconnect){if(e.useNetAgent)return void e.disconnectCallback(s.errorCodeList.PUBLISHER_RETRY_TIMEOUT);e.resetConnectTimer(),e.startConnectTimer((function(t){1008===t&&e.disconnectCallback(s.errorCodeList.TOKEN_EXPIRED)})),e.resetCheckMessage()}},this.websocket.onerror=function(t){e.logger.error(n.ZEGO_WEBRTC_ACTION.SIGNAL_BIND_WEBSOCKET_HANDLE+" msg = "+JSON.stringify(t))})},e.prototype.resetCheckMessage=function(){this.logger.debug(n.ZEGO_WEBRTC_ACTION.SIGNAL_RESET_CHECK_MESSAGE+" call"),clearTimeout(this.sendDataCheckTimer),this.sendDataCheckTimer=null;for(var e=this.sendDataList.getFirst();null!=e;)this.sendDataList.remove(e),e._data.error&&e._data.error(o.SEND_MSG_RESET,e._data.seq),e=this.sendDataList.getFirst();this.sendDataMap={}},e.prototype.handleServerPush=function(e){switch(e.header.cmd){case"LoginRsp":this.handleRespondData("LoginReq",e);break;case"CreateSessionRsp":this.handleRespondData("CreateSessionReq",e),0===e.body.result&&this.addSession(e.header.session_id,e.body.session_token);break;case"CreateSessionWithSdpRsp":this.handleRespondData("CreateSessionWithSdpReq",e),0===e.body.result&&this.addSession(e.header.session_id,e.body.session_token);break;case"MediaDescRsp":this.handleRespondData("MediaDescReq",e);break;case"CandidateInfoRsp":this.handleRespondData("CandidateInfoReq",e);break;case"CloseSessionRsp":this.handleRespondData("CloseSessionReq",e),this.removeSession(e.header.session_id);break;case"ClientHBRsp":this.handleRespondData("ClientHBReq",e);break;case"MediaDescPush":case"CandidateInfoPush":case"StreamStatusNotifyPush":case"PublishEventPush":case"PlayEventPush":case"ClientInfoPush":case"NetQualityInfoPush":case"MediaDescUpdatePush":case"CmdPush":this.handlePushData(e);break;case"CloseSessionPush":this.handlePushData(e),this.removeSession(e.header.session_id);break;case"QualityReportRsp":this.handleRespondData("QualityReportReq",e);break;case"SessionResetPush":this.handlePushResetSessionData(e);break;case"ActivateVideoPlayStreamRsp":this.handleRespondData("ActivateVideoPlayStreamReq",e);break;case"ActivateAudioPlayStreamRsp":this.handleRespondData("ActivateAudioPlayStreamReq",e);break;case"NetQualityProbeRsp":this.handleRespondData("NetQualityProbeReq",e);break;case"ActivateSEIInsertRsp":this.handleRespondData("ActivateSEIInsertReq",e);break;case"StreamStatusNotifyAck":this.handleRespondData("StreamStatusNotify",e);break;case"Peer2PeerNetStatsGetRsp":this.handleRespondData("Peer2PeerNetStatsGetReq",e);break;case"MediaDescUpdateRsp":this.handleRespondData("MediaDescUpdateReq",e);break;case"CmdRsp":this.handleRespondData("CmdReq",e)}},e.prototype.disconnectCallback=function(e,t){this.connectCallback&&(this.connectCallback(t||-1,this.server,void 0),this.connectCallback=null);var r=this.server;this.disconnectServer(),this.onDisconnect(r,e)},e.prototype.updateToken=function(){var e=this;this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_UPDATE_TOKEN+" call");var t={token:this.token,tokenType:this.tokenType,roomid:this.roomID,anchorname:this.stateCenter.anchor_info.anchor_id,sdkversion:o.PROTO_VERSION,osinfo:navigator.appVersion};if(0!=Object.keys(this.sessionInfos).length){var r=[];for(var i in this.sessionInfos){var s=parseInt(i);r.push({session_id:s,session_token:this.sessionInfos[s].token})}t.sessions=r}this.sendMessageWithCallback("LoginReq",this.stateCenter.getSeq(),0,t,(function(t,r,i){if(0==i.result){e.token=i.token,e.tokenType=i.tokenType;var o={report:i.report,report_interval:i.report_interval_ms};i.negoInterval&&(e.negoInterval=i.negoInterval),i.negoTryCount&&(e.negoTryCount=i.negoTryCount),i.negoTryMaxCount&&(e.negoTryMaxCount=i.negoTryMaxCount),null!=e.connectCallback&&(e.connectCallback(0,e.server,o),e.connectCallback=null),e.checkMessageTimeout()}else{var n={error:i.strError};null!=e.connectCallback&&(e.connectCallback(i.result,e.server,n),e.connectCallback=null)}}),(function(){null!=e.connectCallback&&(e.connectCallback(-1,e.server,void 0),e.connectCallback=null)}))},e.prototype.sendMessageWithCallback=function(e,t,r,i,s,a){var d;if(void 0===s&&(s=null),void 0===a&&(a=null),this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" call "+e+" "+(null===(d=this.websocket)||void 0===d?void 0:d.readyState)),!this.websocket||"LoginReq"!==e&&this.websocket.readyState!==WebSocket.OPEN)return this.logger.error(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" connect not establish"),void(a&&a(o.SEND_MSG_TIMEOUT,t));var c={header:this.getHeader(e,t,r),body:i},u={seq:t,deleted:!1,cmd:e,time:(new Date).getTime(),success:s,error:a},l=this.sendDataList.push(u);this.sendDataMap[u.seq]=l;var h=JSON.stringify(c);this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" "+h),this.websocket.send(h),this.logger.debug(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE_WITH_CALLBACK+" success")},e.prototype.getHeader=function(e,t,r){return{version:"1.0.1",cmd:e,appid:this.appid+"",seq:t,user_id:this.userid,session_id:r}},e.prototype.connectServer=function(e,t,r,i){var a,c=this;if(this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" "+r),this.roomID=e,this.token=t,this.server=r,this.state=o.ENUM_CONNECT_STATE.connecting,this.connectCallback=i,this.isServerConnected)this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket is connected"),this.resetConnectTimer(),this.state=o.ENUM_CONNECT_STATE.connected;else try{if(this.useNetAgent){if(!this.stateCenter.appConfig)return void this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" no app config ");var u=this.stateCenter.appConfig.media_config.publish_config.resource_info.find((function(e){return e.resource_type===o.SignalResourceType.RTC}));if(!u)return void(i&&i(s.errorCodeList.GET_CONFIG_FAIL));var l=null===(a=null==u?void 0:u.service_info)||void 0===a?void 0:a.find((function(e){return e.protocol===o.ProtocolType.WEBRTC}));if(!l)return void(i&&i(s.errorCodeList.GET_CONFIG_FAIL));var h=l.url_template.split("{IP}")[1].split("?"),p={path:h[0],query:h[1]};this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" signal "+JSON.stringify(p)),this.websocket instanceof WebSocket&&(this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null),!this.websocket&&(this.websocket=new d.AnalogSocket(this.server,this.netAgent,p,this.logger)),this.websocket.open()}else this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" need new websocket"),this.websocket&&(this.logger.warn(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" close error websocket"),this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close()),this.websocket=new WebSocket(this.server);this.websocket.onclose=function(e){c.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket close call  "+JSON.stringify(e)),c.useNetAgent&&c.state!=o.ENUM_CONNECT_STATE.disconnect&&(c.resetConnectTimer(),c.startConnectTimer((function(e){1008===e&&c.disconnectCallback(s.errorCodeList.TOKEN_EXPIRED)})))},this.websocket.onerror=function(e){c.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket onerror call  "+JSON.stringify(e)),c.stateCenter.useNetAgent&&(null==e?void 0:e.code)&&c.disconnectCallback(void 0,null==e?void 0:e.code)},this.useNetAgent&&this.websocket instanceof d.AnalogSocket?(this.websocket.onopen=function(){c.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket open call"),c.bindWebSocketEvents(),c.state=o.ENUM_CONNECT_STATE.connected,c.websocket&&(c.websocket.onmessage=c.handleWsMessage.bind(c))},this.websocket.onreconnnecting=function(){c.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket reconnecting"),c.updateToken()},this.websocket.onmessage=this.handleWsMessage.bind(this),this.updateToken()):this.websocket.onopen=function(){c.resetConnectTimer(),c.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket open call"),c.websocket&&(c.websocket.onmessage=c.handleWsMessage.bind(c)),c.bindWebSocketEvents(),c.updateToken(),c.state=o.ENUM_CONNECT_STATE.connected}}catch(e){this.logger.error(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" websocket error "+e)}this.useNetAgent||(this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CONNECT_SERVER+" "+this.tryConnectInterval),this.tryConnectTimer=setTimeout((function(){c.startConnectTimer(i)}),this.tryConnectInterval))},e.prototype.startConnectTimer=function(e){if(this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_START_CONNECT_TIMER+" call"),this.tryConnectCount>=o.MAX_TRY_CONNECT_COUNT)return this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_START_CONNECT_TIMER+" beyond "+this.server+"max limit"),void this.disconnectCallback();this.websocket&&this.websocket.readyState===WebSocket.OPEN?(this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_START_CONNECT_TIMER+" websocket is connected"),this.resetConnectTimer()):(this.tryConnectCount+=1,this.connectServer(this.roomID,this.token,this.server,e))},e.prototype.disconnectServer=function(){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_DISCONNECT_SERVER+" call"),this.connectCallback=null,this.resetCheckMessage(),this.resetConnectTimer(),this.websocket&&(this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null),this.token="",this.sessionInfos={},this.tokenType=0,this.tryHeartbeatCount=0,this.tryConnectCount=0,this.state=o.ENUM_CONNECT_STATE.disconnect},Object.defineProperty(e.prototype,"isServerConnected",{get:function(){var e;return(null===(e=this.websocket)||void 0===e?void 0:e.readyState)===WebSocket.OPEN},enumerable:!1,configurable:!0}),e.prototype.createSession=function(e,t,r,i,s,a,d,c){void 0===s&&(s=""),void 0===a&&(a=""),this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CREATE_SESSION+" call: "+i);var u="";o.PROTO_VERSION.split(".").forEach((function(e,t){return 1==e.length&&1==t?u+="0"+e:u+=e}));var l={type:t,stream_id:i,platform:this.platform,browser:this.browser.name,version:this.browser.version,app_id:this.appid,negotiate_mode:r,strAuthParam:s,sdk_version:1*u,turn_server_host:"string"==typeof a?a:""};this.sendMessageWithCallback("CreateSessionReq",e,0,l,d,c)},e.prototype.createSessionWithSdp=function(e,t,r){var i=e.seq,s=e.type,a=e.streamId,d=e.strAuthParam,c=e.sdp,u=e.serverHost,l=e.playBufLevel,h=e.params;this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CREATE_SESSION+" call: "+a);var p="";o.PROTO_VERSION.split(".").forEach((function(e,t){return 1==e.length&&1==t?p+="0"+e:p+=e}));var g={type:s,app_id:this.appid,stream_id:a,sdp:c,user_id:this.userid,platform:this.platform,browser:this.browser.name,sdk_vers:parseInt(p),clientIp:"",media_server_host:"string"==typeof u?u:"",strAuthParam:d,params:h};l&&(g.min_play_buf_level_ms=l),this.sendMessageWithCallback("CreateSessionWithSdpReq",i,0,g,t,r)},e.prototype.sendMediaDescUpdateReq=function(e,t,r,i,o){var n={peer_id:r.peerID,type:r.type,sdp:r.sdp,width:r.width,height:r.height,framerate:r.frameRate,video_min_kpbs:r.video_min_kpbs,video_max_kpbs:r.video_max_kpbs,audio_kpbs:r.audio_kpbs,keyframe_intv:r.keyframe_intv};this.sendMessageWithCallback("MediaDescUpdateReq",e,t,n,i,o)},e.prototype.removeSession=function(e){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_REMOVE_SESSION+" call"+e),this.sessionInfos[e]&&delete this.sessionInfos[e]},e.prototype.sendCloseSession=function(e,t,r,i,o){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_REMOVE_SESSION+" call: "+t);var s={reason:r};this.removeSession(t),this.sendMessageWithCallback("CloseSessionReq",e,t,s,i,o)},e.prototype.sendMessage=function(e,t,r,i){if(this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE+" call "+e),this.websocket&&this.websocket.readyState===WebSocket.OPEN){var o={header:this.getHeader(e,t,r),body:i},s=JSON.stringify(o);this.websocket.send(s),this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE+" success")}else this.logger.error(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MESSAGE+" connect not establish")},e.prototype.handleRespondData=function(e,t){this.logger.debug(n.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_RESPOND_DATA+" call");var r=this.sendDataMap[t.header.seq];if(null!=r){delete this.sendDataMap[t.header.seq],this.sendDataList.remove(r);var i=r._data;i.cmd!==e?this.logger.error(n.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_RESPOND_DATA+" command is not match"):i.success&&i.success(t.header.seq,t.header.session_id,t.body)}else{if("CloseSessionRsp"==t.header.cmd)return;this.logger.error(n.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_RESPOND_DATA+" cannot find data "+e)}},e.prototype.addSession=function(e,t){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_ADD_SESSION+" call"+e),this.sessionInfos[e]={token:t}},e.prototype.handlePushData=function(e){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_DATA+" call "+e.header.cmd+" session "+e.header.session_id);var t=this.pushCallback[e.header.cmd+e.header.session_id];t?t.callback&&t.callback(e.header.seq,e.header.session_id,e.body):this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_DATA+" no callbackData "+e.header.cmd+" session: "+e.header.session_id)},e.prototype.handlePushResetSessionData=function(e){this.logger.debug(n.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA+" call ");var t=[];if(0==e.body.cResetType)t=Object.keys(this.sessionInfos);else if(1==e.body.cResetType)for(var r=0;r<e.body.session_ids.length;r++)t.push(e.body.session_ids[r]);if(this.sendResetSessionAck(e.header.seq,0,0),0!=t.length)for(var i=0;i<t.length;i++){var o=this.pushCallback[e.header.cmd+t[i]];null==o?this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA+" no callbackData "+t[i]):o.callback&&o.callback(e.header.seq,t[i],e.body)}else this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_HANDLE_PUSH_RESET_SESSION_DATA+" no session to callback")},e.prototype.sendMediaDesc=function(e,t,r,i,o,s){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MEDIA_DESC+" call: "+t);var a={type:r,sdp:i.sdp};null!=i.width&&(a.width=i.width),null!=i.height&&(a.height=i.height),null!=i.frameRate&&(a.framerate=i.frameRate),null!=i.video_min_kpbs&&(a.video_min_kpbs=i.video_min_kpbs),null!=i.video_max_kpbs&&(a.video_max_kpbs=i.video_max_kpbs),null!=i.audio_kpbs&&(a.audio_kpbs=i.audio_kpbs),null!=i.keyframe_intv&&(a.keyframe_intv=i.keyframe_intv),null!=i.min_play_buf_level_ms&&(a.min_play_buf_level_ms=i.min_play_buf_level_ms),this.sendMessageWithCallback("MediaDescReq",e,t,a,o,s)},e.prototype.sendCandidateInfo=function(e,t,r,i,o){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_CANDIDATE_INFO+" call: "+t);for(var s=[],a=0;a<r.length;a++){var d={candidate:r[a].candidate,sdpMid:r[a].sdpMid,sdpMLineIndex:r[a].sdpMLineIndex};s.push(d)}var c={infos:s};this.sendMessageWithCallback("CandidateInfoReq",e,t,c,i,o)},e.prototype.sendMediaDescAck=function(e,t,r){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MEDIA_DESC_ACK+" call: "+t);var i={result:r};this.sendMessage("MediaDescAck",e,t,i)},e.prototype.sendUpdateMediaDescAck=function(e,t,r,i){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_MEDIA_DESC_ACK+" call: "+t);var o={peer_id:i,result:r};this.sendMessage("MediaDescUpdateAck",e,t,o)},e.prototype.sendCandidateInfoAck=function(e,t,r){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_CANDIDATE_INFO_ACK+" call: "+t);var i={result:r};this.sendMessage("CandidateInfoAck",e,t,i)},e.prototype.sendCloseSessionAck=function(e,t,r){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_CLOSE_SESSION_ACK+" call: "+t);var i={result:r};this.sendMessage("CloseSessionAck",e,t,i)},e.prototype.sendResetSessionAck=function(e,t,r){this.logger.debug(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_RESET_SESSION_ACK+" call: "+t);var i={result:r};this.sendMessage("SessionResetAck",e,t,i)},e.prototype.registerPushCallback=function(e,t,r){r&&"function"==typeof r&&(this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_REGISTER_PUSH_CALLBACK+" set callback "+t),this.pushCallback[e+t]={callback:r})},e.prototype.unregisterPushCallback=function(e,t){delete this.pushCallback[e+t]},e.prototype.checkMessageTimeout=function(){for(var e=this,t=this.sendDataList.getFirst(),r=(new Date).getTime(),i=0,s=0,a=0;null!=t&&!(t._data.time+this.sendDataTimeout>r);)if(delete this.sendDataMap[t._data.seq],this.sendDataList.remove(t),++s,-1!=this.checkMessageList.indexOf(t._data.cmd)){if(null==t._data.error||this.sendDataDropTimeout>0&&t._data.time+this.sendDataDropTimeout<r?++a:(this.logger.warn(n.ZEGO_WEBRTC_ACTION.SIGNAL_CHECK_MESSAGE_TIMEOUT+" error cmd = "+t._data.cmd),t._data.error&&t._data.error(o.SEND_MSG_TIMEOUT,t._data.seq)),++i>=this.sendDataCheckOnceCount)break;t=this.sendDataList.getFirst()}else t=this.sendDataList.getFirst();this.sendDataCheckTimer=setTimeout((function(){e.checkMessageTimeout()}),this.sendDataCheckInterval),0==s&&0==a||this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_CHECK_MESSAGE_TIMEOUT+" call success, state: timeout="+s+" drop="+a)},e.prototype.sendHeartbeat=function(){var e=this;if(this.logger.debug(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+"call tryHeartbeatCount:"+this.tryHeartbeatCount),0!=Object.keys(this.sessionInfos).length)if(this.state===o.ENUM_CONNECT_STATE.connected){if(++this.tryHeartbeatCount>o.MAX_TRY_HEARTBEAT_COUNT)return this.logger.error(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+" heartbeat try limit"),void this.disconnectCallback();var t=[];for(var r in this.sessionInfos)t.push(parseInt(r));var i={session_ids:t},s=(new Date).getTime();this.sendMessageWithCallback("ClientHBReq",this.stateCenter.getSeq(),0,i,(function(t,r,i){e.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+" hb time "+((new Date).getTime()-s)),e.heartbeatInterval!=i.hb_interval&&(e.heartbeatInterval=i.hb_interval,e.onUpdateHeartBeatInterval(i.hb_interval)),e.tryHeartbeatCount=0}),(function(e,t){}))}else this.logger.warn(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+" state error");else this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_HEARTBEAT+" no need to heartbeat")},e.prototype.QualityReport=function(e,t,r,o,s){this.logger.debug(n.ZEGO_WEBRTC_ACTION.SIGNAL_QUALITY_REPORT+" call");var a={streams:[i(i({},r),{aid:t})]};this.sendMessageWithCallback("QualityReportReq",e,t,a,o,s)},e.prototype.sendStreamStatus=function(e,t,r,i,s,a){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_STREAM_STATUS+" call "+t);var d={mic_status:i,camera_status:r};this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_STREAM_STATUS+" stream "+(s||"")+" status "+JSON.stringify(d)),this.sendMessageWithCallback("StreamStatusNotify",e,t,d,(function(){}),(function(e){e===o.SEND_MSG_TIMEOUT&&a&&a()}))},e.prototype.ActivatePlayVideoStream=function(e,t,r,i,o){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_VIDEO_STREAM+" call");var s={active:r?0:1,layer:0};this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_VIDEO_STREAM+" activate video "+JSON.stringify(s)),this.sendMessageWithCallback("ActivateVideoPlayStreamReq",e,t,s,i,o)},e.prototype.ActivatePlayAudioStream=function(e,t,r,i,o){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_AUDIO_STREAM+" call");var s={active:r?0:1,layer:0};this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_ACTIVE_PLAY_AUDIO_STREAM+" activate audio "+JSON.stringify(s)),this.sendMessageWithCallback("ActivateAudioPlayStreamReq",e,t,s,i,o)},e.prototype.sendBroadcasterStatus=function(e,t,r){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_BROADCAST_STATUS+" call "+t);var i={status:r};this.sendMessage("BroadcasterStatusNotify",e,t,i)},e.prototype.sendNetProbe=function(e,t,r,i,o){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_NET_PROBE+" call "+t);var s={peer_id:r,action:1};this.sendMessageWithCallback("NetQualityProbeReq",e,t,s,i,o)},e.prototype.sendNetQualityInfoPushAck=function(e,t,r,i){this.logger.info(n.ZEGO_WEBRTC_ACTION.SIGNAL_SEND_NET_PROBE+" call "+t);var o={peer_id:r,result:i};this.sendMessage("NetQualityInfoAck",e,t,o)},e.prototype.activateSEIInsert=function(e,t,r,i,o,n,s){},e.prototype.getP2PNetStats=function(e,t,r,i,o){var n={peer_id:r};this.sendMessageWithCallback("Peer2PeerNetStatsGetReq",e,t,n,i,o)},e.prototype.sendGWCmd=function(e,t,r,i,o){this.sendMessageWithCallback("CmdReq",e,t,r,i,o)},e.prototype.sendGWAck=function(e,t,r){this.sendMessage("CmdAck",e,t,r)},e}();t.ZegoSignal=c},3409:function(e,t,r){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},s=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{d(i.next(e))}catch(e){n(e)}}function a(e){try{d(i.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,i,o,n,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoStreamCenterWeb=void 0;var d=r(6706),c=r(3770),u=r(1547),l=r(5740),h=r(6706),p=r(5019),g=r(3849),f=r(6014),_=r(8493),m=r(2752),v=r(3529),E=r(2990),S=r(1089),T=function(e){function t(t,r,i,o,n,s){var a=e.call(this)||this;return a.logger=t,a.stateCenter=r,a.dataReport=i,a.rtm=o,a.ac=n,a.mediaEleSources=s,a.testEnvironment=!1,a.heartbeatTimer=null,a.heartbeatInterval=1e4,a.qualityTimerInterval=3e3,a.previewStreamList=[],a.signalList={},a.chargeInfos={itemtype:"ChargeInfos",timestamp_begin:0,timestamp_end:0,timestamp_diff_flag:0,timestamp_diff:0,infos:[]},a.chargeInfosTimer=null,a.chargeInfosInterval=6e4,a.chargeInfoSeq=0,a.soundLevelDelegate=!1,a.soundLevelInterval=1e3,a.enableInBackground=!1,a.isPeer=!0,a.probeList={},a.isMicEnabled=!0,a.isDataChannelEnabled=!1,a.publishQualityInfos=[],a.playQualityInfos=[],a.qualityUploadTimestamp=0,a.qualityHeadTimestamp=0,a.gwNode="",a.playerList={},a.publisherList={},a.playSuccessCallBackList={},a.playErrorCallBackList={},a.waitPublishList=[],a.waitPlayList=[],a.tryCountConnectInterval=3e3,a.checkMessageTimeout=function(){for(var e in a.signalList)a.signalList[e].signal&&a.signalList[e].signal.checkMessageTimeout()},a.getAllInUseUrl=function(){var e=[];for(var t in a.signalList)e.push(t);return e},a.onDisconnectHandle=function(e,t){if(a.logger.info("zsc.od.0 call"),a.signalList[e]){for(var r=a.signalList[e],i=0;i<r.publishConnectedList.length;i++){var o=a.publisherList[r.publishConnectedList[i]];o&&o.publisher&&o.publisher.onDisconnect(t)}for(i=0;i<r.playConnectedList.length;i++){var n=a.playerList[r.playConnectedList[i]];n&&n.player&&n.player.onDisconnect(t)}delete a.signalList[e],a.stopSignalHeartbeat(),a.stopChargeInfosUpload(),a.stopSoundLevel()}},a.eventHandler={visibilitychange:function(){var e=!document.hidden;!a.enableInBackground&&a.soundLevelDelegate&&(e?(a.enableSoundLevelProcessor(!0),a.activeSoundLevel()):(a.soundLevelTimer&&clearTimeout(a.soundLevelTimer),a.soundLevelTimer=null,a.enableSoundLevelProcessor(!1)))}},"PRIVATE"==a.stateCenter.type&&(a.isPeer=!1),document.addEventListener("visibilitychange",a.eventHandler.visibilitychange),a}return o(t,e),Object.defineProperty(t.prototype,"cameraPreviewStream",{get:function(){return this.previewStreamList.find((function(e){return"camera"===e.previewType}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"microphonePreviewStream",{get:function(){return this.previewStreamList.find((function(e){return"camera"===e.previewType&&e.micTrack}))},enumerable:!1,configurable:!0}),t.prototype.onSignalDisconnected=function(e){},t.prototype.setQualityMonitorCycle=function(e){var t=this;return this.logger.debug("zsc.qmc.0 timeInterval "+e),0==Object.keys(this.publisherList).length?this.qualityTimerInterval=e:Object.keys(this.publisherList).forEach((function(r){t.publisherList[r].publisher.qualityTimeInterval=e,t.publisherList[r].publisher.setPublishQualityTimer()})),!0},t.prototype.setSessionInfo=function(e,t,r){this.logger.debug("zsc.ssi.0 called"),this.appid=e,this.userid=t,this.testEnvironment=r},t.prototype.onPlayStateUpdate=function(e,t,r){},t.prototype.onPlayQualityUpdate=function(e,t){},t.prototype.onPublishStateUpdate=function(e,t,r){},t.prototype.onPublishQualityUpdate=function(e,t){},t.prototype.onUpdateHeartBeatIntervalHandle=function(e){e!=this.heartbeatInterval&&(this.logger.debug("zsc.uhb.0 update "+e),this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null),this.heartbeatInterval=e,this.startSignalHeartbeat())},t.prototype.setPublishStateStart=function(e,t,r,i,o){var n,s,a=this;if(this.logger.info("zsc.pss.0 call "+t),this.stateCenter.networkState==d.ENUM_NETWORK_STATE.offline)return this.logger.error("zsc.pss.0 network offline"),!1;var c=this.checkPreview(r);if(!c)return this.logger.error("zsc.pss.0 stream not found"),!1;var l=this.publisherList[t],p=this.stateCenter.reportSeqList.startPublish[t];if(this.dataReport.eventStart(p,"setPublishState"),l)return this.logger.error("zsc.pss.0 publisher already exist"),this.dataReport.eventEndWithMsgInfo(p,"setPublishState",{message:"publisher already exist"}),this.dataReport.uploadReport(p,void 0,v.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kIsPublishing),delete this.stateCenter.reportSeqList.startPublish[t],!1;var g=new u.ZegoPublish(t,this.logger,this.dataReport,this.qualityTimerInterval,this,this.stateCenter,c);g.state=h.ENUM_PUBLISH_STATE.start,g.isPeer=this.isPeer,g.reportSeq=this.stateCenter.reportSeqList.startPublish[t];var m=null===(n=null==c?void 0:c.videoTrack)||void 0===n?void 0:n.label,E=r.getAudioTracks()[0]&&r.getAudioTracks()[0].label,S=null===(s=null==c?void 0:c.videoTrack)||void 0===s?void 0:s.getSettings().deviceId,T=r.getAudioTracks()[0]&&r.getAudioTracks()[0].getSettings().deviceId,C=new f.RetryStreamHandler(this.logger,this.stateCenter,this,!0);return this.publisherList[t]={seq:0,room:e,localStream:r,publisher:g,serverUrls:[],ttl:0,isCenterNode:!0,streamID:t,publishOption:i,cameraLabel:m||"",microLabel:E||"",cameraDeviceId:S||"",microDeviceId:T||"",deviceStateCount:0,retryStreamHandler:C,retryDispatchHandler:new _.RetryDispatchHandler(this.logger,this.stateCenter,this.rtm,this),isDataChannel:o},g.onPublishStateUpdate=function(e,r,i,o){var n=a.publisherList[r];n?C.publishStateHandle(e,n.streamID,i,o):a.logger.error("zsc.psuh.0 cannot find publish "+t)},g.onPublishQualityUpdate=function(e,r){var i=a.publisherList[e];i?(a.stateCenter.deviceStateOut&&0===r.audio.audioBitrate?(i.deviceStateCount++,i.deviceStateCount>=2&&(i.deviceStateCount=0,a.stateCenter.deviceStateOut=!1,a.logger.warn("zsc.pss.0 publish audio error by device"))):i.deviceStateCount=0,a.onPublishQualityUpdate(i.streamID,r)):a.logger.error("zsc.psuh.0 cannot find publish "+t)},this.dataReport.eventStart(g.reportSeq,"GetSignalUrl"),this.dataReport.eventStart(g.streamReportSeq,"GetSignalUrl"),!0},t.prototype.startPublishingStream=function(e,t){void 0===t&&(t=!1),this.logger.info("zsc.sps.0 call");var r=this.publisherList[e];if(!r)return this.logger.error("zsc.sps.0 publisher don't exist"),!1;var i=r.publisher;if(!t){if(this.dataReport.eventEndWithMsg(i.reportSeq,"GetSignalUrl",{urls:r.serverUrls,is_center:r.isCenterNode}),this.dataReport.eventEndWithMsg(i.streamReportSeq,"GetSignalUrl",{urls:r.serverUrls,is_center:r.isCenterNode}),!r.serverUrls||0===r.serverUrls.length)return r.retryStreamHandler.publishStateHandle(h.ENUM_PUBLISH_STATE_UPDATE.error,e,m.errorCodeList.DISPATCH_ERROR),this.logger.info("zsc.sps.0 server don't have signal url"),!0;var o=r.serverUrls.indexOf(this.server);-1!==o&&(r.serverUrls.splice(o,1),r.serverUrls.unshift(this.server))}var n=r.retryStreamHandler;return n.invalid(),n.init(this.stateCenter.streamRetryTime),n.initStream(e,r.serverUrls),n.startMaxTime(),n.activePublish(0)},t.prototype.updateWaitingList=function(e,t,r,i,o){var n={streamID:r,success:i,error:o};t?e.publishWaitingList.push(n):e.playWaitingList.push(n)},t.prototype.publishStream=function(e){var t=this.publisherList[e].publisher;if(t){var r=null,i=null,o=this.publisherList[e].publishOption,n=this.checkPreview(this.publisherList[e].localStream);if(n){r=n.localStream,i=n.videoInfo;var s=this.stateCenter.reportSeqList.startPublish[e];this.dataReport.addMsgInfo(s,{cap_w:v.ZegoRTCLogEvent.kZegoTaskPublishStart.cap_w(n.videoInfo.width),cap_h:v.ZegoRTCLogEvent.kZegoTaskPublishStart.cap_h(n.videoInfo.height),w:v.ZegoRTCLogEvent.kZegoTaskPublishStart.w(n.videoInfo.width),h:v.ZegoRTCLogEvent.kZegoTaskPublishStart.h(n.videoInfo.height),video_en_fps:v.ZegoRTCLogEvent.kZegoTaskPublishStart.video_en_fps(n.videoInfo.frameRate),video_en_bps:v.ZegoRTCLogEvent.kZegoTaskPublishStart.video_en_bps(n.videoInfo.bitRate)}),r?(this.logger.info("zsc.ps.0 call success"),t.gwNodeTTL<(new Date).getTime()&&!this.gwNode?(t.gwNode="",t.gwNodeList=[],t.gwNodeTTL=0):this.gwNode&&(t.gwNode=this.gwNode),t.startPublish(e,r,i,n.mediaStreamConfig,o)):this.logger.error("zsc.ps.0 no localStream found")}else this.logger.error("zsc.ps.0 no preview found")}else this.logger.info("zsc.ps.0 publisher don't exist")},t.prototype.connectPublishServer=function(e,t){var r=this,i=this.publisherList[e];return i?(this.dataReport.eventStart(i.publisher.reportSeq,"ConnectServer"),this.dataReport.eventStart(i.publisher.streamReportSeq,"ConnectServer"),this.connectWithReuseSignalServer(e,!0,t,(function(e,t,i){var o=r.publisherList[e];if(o){var n=o.publisher;if(n){r.dataReport.eventEndWithMsg(n.reportSeq,"ConnectServer",{result:0,server:i}),r.dataReport.eventEndWithMsg(n.streamReportSeq,"ConnectServer",{result:0,server:i});var s=t.tokenInfo;r.logger.info("zsc.cps.0 update token success"),s&&s.report&&(n.qualityUpload=s.report,n.qualityUploadInterval=s.report_interval),n.signal=t.signal,r.server=i,r.publishStream(e),r.getTokenSuccess()}else r.logger.info("zsc.cps.1 check publisher don't exist")}else r.logger.info("zsc.cps.0 after connect publisher don't exist")}),(function(e,t){r.logger.error("zsc.cps.0 "+e+" connect fail "+t);var i=r.publisherList[e];if(i){var o=i.publisher;if(o){var s;r.dataReport.eventEndWithMsg(o.reportSeq,"ConnectServer",{result:t}),r.dataReport.uploadReport(o.reportSeq),delete r.stateCenter.reportSeqList.startPublish[e];var a=!1;t&&t.code===m.errorCodeList.GET_CONFIG_FAIL.code?(s=n({},m.errorCodeList.GET_CONFIG_FAIL),a=!0):((s=n({},m.errorCodeList.CONNECT_FAILED)).message=s.message+" "+t,1008===t&&(s=m.errorCodeList.TOKEN_EXPIRED,a=!0),20010===t&&(a=!0,s=JSON.parse(JSON.stringify(m.errorCodeList.PUBLISHER_SESSION_REQUEST_FAIL)))),i.retryStreamHandler.publishStateHandle(h.ENUM_PUBLISH_STATE_UPDATE.error,e,s,a)}else r.logger.info("zsc.cps.1 check publisher don't exist")}else r.logger.info("zsc.cps.0 after connect publisher don't exist")})),!0):(this.logger.error("zsc.cps.0 publisher don't exist"),!1)},t.prototype.getTokenSuccess=function(){this.logger.debug("zsc.gts.0 call")},t.prototype.stopPublishingStream=function(e){var t=this.publisherList[e];if(t){var r=t.retryStreamHandler;for(var i in r&&(r.stopMaxTime(),r.invalid()),this.signalList)this.signalList[i].publishWaitingList=this.signalList[i].publishWaitingList.filter((function(t){return t.streamID!==e}));delete this.publisherList[e],t.publisher&&(t.publisher.stopPublish(),delete t.publisher),this.removeStreamFromSignal(!0,e),this.stopSignalHeartbeat(),this.stopChargeInfosUpload(),this.stopSoundLevel(),this.logger.debug("zsc.sps.0.1 call success")}else this.logger.warn("zsc.sps.0.1 publisher don't exist")},t.prototype.connectWithReuseSignalServer=function(e,t,r,i,o){var n=this;this.logger.info("zsc.crss.0 begin "+r);var s=null;if(this.signalList[r])(s=this.signalList[r]).state==h.ENUM_SIGNAL_STATE.connected?(this.logger.info("zsc.crss.0 already connected "+r+" streamId: "+e),t?s.publishConnectedList.push(e):s.playConnectedList.push(e),i(e,s,r)):s.state==h.ENUM_SIGNAL_STATE.connecting&&(this.logger.info("zsc.crss.0 signal is connecting "+r+" streamId: "+e),this.updateWaitingList(s,t,e,i,o));else{this.logger.info("zsc.crss.0 new signal "+r+", streamId: "+e);var a=["unified_rtc","unified_l3"].includes(r),d=new p.ZegoSignal(this.logger,this.stateCenter,this.rtm.netAgent,a);d.setSessionInfo(this.appid,this.userid),a||(d.onUpdateHeartBeatInterval=this.onUpdateHeartBeatIntervalHandle.bind(this)),d.onDisconnect=this.onDisconnectHandle;var c=this.publisherList[e]||this.playerList[e]||null,u=null==c?void 0:c.retryStreamHandler;if(this.stateCenter.streamConnectTime)d.tryConnectInterval=this.stateCenter.streamConnectTime;else if(u&&u.retryActiveCount){var l=u.retryActiveCount*(u.retryActiveCount-1)/2+2;l=l>h.MAX_RETRY_CONNECT_INTERVAL?h.MAX_RETRY_CONNECT_INTERVAL:l,d.tryConnectInterval=1e3*l}this.signalList[r]={signal:d,state:h.ENUM_SIGNAL_STATE.connecting,publishWaitingList:[],playWaitingList:[],publishConnectedList:[],playConnectedList:[],tokenInfo:null},this.updateWaitingList(this.signalList[r],t,e,i,o);var g=null==c?void 0:c.room.token,f=null==c?void 0:c.room.roomID;this.logger.info("zsc.crss.0 "+g),d.connectServer(f||this.stateCenter.roomList[0].roomID,g||this.stateCenter.roomList[0].token,r,(function(e,t,i){s=n.signalList[r],0!=e?(n.logger.info("zsc.crss.0 connect failed "+t),s.publishWaitingList.forEach((function(t){t.error&&t.error(t.streamID,e)})),s.playWaitingList.forEach((function(t){t.error&&t.error(t.streamID,e)})),delete n.signalList[r]):(n.logger.debug("zsc.crss.0 connected success "+t),s.state=h.ENUM_SIGNAL_STATE.connected,s.tokenInfo=i,s.publishWaitingList.forEach((function(e){e.success&&e.success(e.streamID,s,t),s&&s.publishConnectedList.push(e.streamID)})),s.playWaitingList.forEach((function(e){e.success&&e.success(e.streamID,s,t),s&&s.playConnectedList.push(e.streamID)})),s.publishWaitingList=[],s.playWaitingList=[],a||null!=n.heartbeatTimer||n.startSignalHeartbeat(),null==n.chargeInfosTimer&&n.startChargeInfosUpload(),n.activeSoundLevel())}))}},t.prototype.setPlayStateStart=function(e,t,r){var i=this;if(this.logger.info("zsc.pss.1 call "+e),this.stateCenter.networkState==d.ENUM_NETWORK_STATE.offline)return this.logger.error("zsc.pss.1 network offline"),!1;var o=this.playerList[e],n=this.stateCenter.reportSeqList.startPlay[e];if(this.dataReport.eventStart(n,"setPlayState"),o)return this.logger.error("zsc.pss.1 player already exist"),this.dataReport.eventEndWithMsgInfo(n,"setPlayState",{message:"player already exist"}),this.dataReport.uploadReport(n,void 0,v.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kIsPlaying),delete this.stateCenter.reportSeqList.startPlay[e],!1;var s=this.getPlayRoom(e)||this.stateCenter.roomList[0];if(!s)return this.logger.error("zsc.pss.1 not login room"),this.dataReport.eventEndWithMsgInfo(n,"setPlayState",{message:"not login room"}),this.dataReport.uploadReport(n,void 0,v.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayNoLoginError),!1;var a=new g.ZegoPlayWeb(this.logger,null,this.dataReport,this.qualityTimerInterval,this,this.ac,this.stateCenter);t&&[0,2,3].includes(t.resourceMode)&&(a.resourceMode=t.resourceMode),this.dataReport.addMsgInfo(n,{resourceMode:a.resourceMode,play_room_id:null==s?void 0:s.roomID,isMulti:this.stateCenter.isMultiRoom}),a.state=h.ENUM_PLAY_STATE.start,a.isPeer=this.isPeer,a.reportSeq=this.stateCenter.reportSeqList.startPlay[e],a.beginTime=(new Date).getTime();var c=new f.RetryStreamHandler(this.logger,this.stateCenter,this,!1);return this.playerList[e]={seq:0,room:s,player:a,signal:null,serverUrls:[],ttl:0,isCenterNode:!0,streamID:e,playOption:t,retryStreamHandler:c,retryDispatchHandler:new _.RetryDispatchHandler(this.logger,this.stateCenter,this.rtm,this),isDataChannel:r},a.onPlayStateUpdate=function(e,t,r,o){var n=i.playerList[t];n?c.playStateHandle(e,n.streamID,r,o):i.logger.error("zsc.pss.1 cannot find play "+t)},a.onPlayQualityUpdate=function(e,t){var r=i.playerList[e];r?i.onPlayQualityUpdate(r.streamID,t):i.logger.error("zsc.pss.1 cannot find play "+e)},a.onRemoteCameraStatusUpdate=function(e,t,r){var o=i.playerList[e];o?i.onRemoteCameraStatusUpdate(o.streamID,t,r):i.logger.error("zsc.pss.1 cannot find play "+e)},a.onRemoteMicStatusUpdate=function(e,t,r){var o=i.playerList[e];o?i.onRemoteMicStatusUpdate(o.streamID,t,r):i.logger.error("zsc.pss.1 cannot find play "+e)},this.dataReport.eventStart(a.reportSeq,"GetSignalUrl"),this.dataReport.eventStart(a.streamReportSeq,"GetSignalUrl"),!0},t.prototype.onRemoteMicStatusUpdate=function(e,t,r){},t.prototype.onRemoteCameraStatusUpdate=function(e,t,r){},t.prototype.startPlayingStream=function(e,t,r){void 0===t&&(t=!1),this.logger.info("zsc.sps.1 start play called");var i=this.playerList[e];if(!i)return this.logger.error("zsc.sps.1 player don't exist"),!1;var o=i.player;if(!t){if(this.dataReport.eventEndWithMsg(o.reportSeq,"GetSignalUrl",{urls:i.serverUrls}),this.dataReport.eventEndWithMsg(o.streamReportSeq,"GetSignalUrl",{urls:i.serverUrls}),0==i.serverUrls.length)return i.retryStreamHandler.playStateHandle(h.ENUM_PLAY_STATE_UPDATE.error,e,m.errorCodeList.DISPATCH_ERROR),this.logger.info("zsc.sps.1 server don't have signal url"),!1;var n=i.serverUrls.indexOf(this.server);-1!==n&&(i.serverUrls.splice(n,1),i.serverUrls.unshift(this.server))}var s=i.retryStreamHandler;return s.invalid(),s.init(this.stateCenter.streamRetryTime),s.initStream(e,i.serverUrls),s.startMaxTime(),s.activePull(0,r)},t.prototype.connectPlayServer=function(e,t,r){var i=this,o=this.playerList[e];return o?(this.dataReport.eventStart(o.player.reportSeq,"ConnectServer"),this.dataReport.eventStart(o.player.streamReportSeq,"ConnectServer"),this.connectWithReuseSignalServer(e,!1,r,(function(e,r,o){var n=i.playerList[e];if(n){var s=n.player;if(s){i.dataReport.eventEndWithMsg(s.reportSeq,"ConnectServer",{result:0,server:o}),i.dataReport.eventEndWithMsg(s.streamReportSeq,"ConnectServer",{result:0,server:o});var a=r.tokenInfo;i.logger.info("zsc.cps.1 update token success"),a&&a.report&&(s.qualityHandler.qualityUpload=a.report,s.qualityHandler.qualityUploadInterval=a.report_interval),s.signal=r.signal,i.server=o,i.playStream(e,t),i.getTokenSuccess()}else i.logger.error("zsc.cps.1 checkplayer don't exist")}else i.logger.error("zsc.cps.1 after connect player don't exist")}),(function(t,o){var s=i.playerList[t];if(s){i.dataReport.eventEndWithMsg(s.player.reportSeq,"ConnectServer",{result:o}),!s.player.isProbe&&i.dataReport.uploadReport(s.player.reportSeq),delete i.stateCenter.reportSeqList.startPlay[e];var a=n({},m.errorCodeList.CONNECT_FAILED);a.message=a.message+" "+o,1008===o&&(a=m.errorCodeList.TOKEN_EXPIRED);var d=1008==o;20010===o&&(d=!0,a="unified_l3"===r?m.errorCodeList.PLAYER_UNSUPPORTED_PROTOCOL:m.errorCodeList.PLAYER_SESSION_REQUEST_FAIL),s.retryStreamHandler.playStateHandle(h.ENUM_PLAY_STATE_UPDATE.error,t,a,d)}else i.logger.error("zsc.cps.1 after connect player don't exist")})),!0):(this.logger.error("zsc.cps.1 player don't exist"),!1)},t.prototype.playStream=function(e,t){var r=this.playerList[e].player;r?(this.logger.info("zsc.ps.1 call success"),r.gwNodeTTL<(new Date).getTime()&&!this.gwNode?(r.gwNode="",r.gwNodeList=[],r.gwNodeTTL=0):this.gwNode&&(r.gwNode=this.gwNode),r.startPlay(e,t,this.playerList[e].playOption)):this.logger.warn("zsc.ps.1 player don't exist")},t.prototype.stopSignalHeartbeat=function(){this.logger.debug("zsc.ssh.1 call");var e=0;for(var t in this.signalList)e+=1;this.heartbeatTimer&&0==e&&(this.logger.info("zsc.ssh.1 stop"),clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null)},t.prototype.removeStreamFromSignal=function(e,t){var r=[];for(var i in this.signalList){var o=this.signalList[i];if(e){for(var n=0;n<o.publishConnectedList.length;n++)if(o.publishConnectedList[n]===t){this.logger.debug("zsc.rsfs.0 found from publish"),o.publishConnectedList.splice(n,1);break}for(n=0;n<o.publishWaitingList.length;n++)if(o.publishWaitingList[n].streamID===t){this.logger.debug("zsc.rsfs.0 found from publish"),o.publishWaitingList.splice(n,1);break}}else{for(var s=0;s<o.playConnectedList.length;s++)if(o.playConnectedList[s]===t){this.logger.debug("zsc.rsfs.0 found from play"),o.playConnectedList.splice(s,1);break}for(s=0;s<o.playWaitingList.length;s++)if(o.playWaitingList[s].streamID===t){this.logger.debug("zsc.rsfs.0 found from play"),o.playWaitingList.splice(s,1);break}}0==o.publishConnectedList.length&&0==o.playConnectedList.length&&0==o.publishWaitingList.length&&0==o.playWaitingList.length&&(o.signal.disconnectServer(),r.push(i))}for(var a=0;a<r.length;a++)delete this.signalList[r[a]],this.server==r[a]&&(this.server="")},t.prototype.stopPlayingStream=function(e){var t=this.playerList[e];if(t){var r=t.retryStreamHandler;for(var i in r&&(r.stopMaxTime(),r.invalid()),this.signalList)this.signalList[i].playWaitingList=this.signalList[i].playWaitingList.filter((function(t){return t.streamID!==e}));delete this.playerList[e],t.player&&(t.player.stopPlay(),delete t.player),this.removeStreamFromSignal(!1,e),this.stopSignalHeartbeat(),this.stopChargeInfosUpload(),this.stopSoundLevel(),delete this.playSuccessCallBackList[e],delete this.playErrorCallBackList[e],this.logger.debug("zsc.sps.1.1 call success")}else this.logger.info("zsc.sps.1.1 player don't exist")},t.prototype.reset=function(e,t){var r,i;for(var o in this.publisherList)this.publisherList[o].room.roomID!=e&&e||(null===(i=null===(r=this.publisherList[o].room)||void 0===r?void 0:r.streamHandler)||void 0===i||i.onPublishStateUpdate(h.ENUM_PUBLISH_STATE_UPDATE.error,o,1002031==t?v.ZegoRTCLogEvent.kZegoTaskPublishStart.error.kPublishRetryTimeoutError:{code:0,message:""}),this.stopPublishingStream(o));var n=function(r){var i=s.playerList[r].room;if(i.roomID!=e||!i.streamList.find((function(e){return e.stream_id==r}))&&1!=s.stateCenter.roomList.length){if(i.roomID==e&&s.stateCenter.roomList.length>1){var o=s.stateCenter.roomList.find((function(t){return t.roomID!==e}));o?s.playerList[r].room=o:(s.stopPlayingStream(r),s.onPlayStateUpdate(h.ENUM_PLAY_STATE_UPDATE.error,r,v.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRetryTimeoutError))}}else s.onPlayStateUpdate(h.ENUM_PLAY_STATE_UPDATE.error,r,1002031==t?v.ZegoRTCLogEvent.kZegoTaskPlayStart.error.kPlayRetryTimeoutError:{code:0,message:""}),s.stopPlayingStream(r)},s=this;for(var a in this.playerList)n(a);0==Object.keys(this.publisherList).length&&0==Object.keys(this.playerList).length&&(this.probeList={}),this.waitPublishList=[],this.waitPlayList=[],this.publishQualityInfos=[],this.playQualityInfos=[],this.qualityHeadTimestamp=0,this.qualityUploadTimestamp=0,this.qualityWebsocket&&(this.qualityWebsocket.close(),this.qualityWebsocket=void 0)},t.prototype.startSignalHeartbeat=function(){var e=this;this.logger.debug("zsc.ssh.0 call"),this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null),this.heartbeatTimer=setTimeout((function(){e.checkSignalHeartbeat()}),this.heartbeatInterval)},t.prototype.startChargeInfosUpload=function(){var e=this;this.logger.debug("zsc.sciu.0 call"),this.chargeInfosTimer&&(clearTimeout(this.chargeInfosTimer),this.chargeInfosTimer=null),this.chargeInfosTimer=setTimeout((function(){e.checkChargeInfos()}),this.chargeInfosInterval)},t.prototype.checkChargeInfos=function(){this.logger.debug("zsc.cci.0 call");var e={is_publishing:0,play_max_audio_bitrate:0,play_stream_resolution_infos:[]};for(var t in this.chargeInfos.timestamp_begin=(new Date).getTime(),this.publisherList){this.publisherList[t].publisher.state===h.ENUM_PUBLISH_STATE.publishing&&(e.is_publishing=1);break}e.play_max_audio_bitrate=0;var r=function(t){var r=i.playerList[t].player.playStream,o=r&&0!==r.getVideoTracks().length?r.getVideoTracks()[0].getSettings():void 0,n={video_width:o&&o.width?o.width:0,video_height:o&&o.height?o.height:0,count:1};if(!e.play_stream_resolution_infos.find((function(e){return e.video_width==n.video_width&&e.video_height==n.video_height&&(e.count++,!0)}))&&e.play_stream_resolution_infos.push(n),0==n.video_width&&0==n.video_height){var s=1e3*i.playerList[t].player.qualityHandler.lastPlayStats.audioBitrate;s>e.play_max_audio_bitrate&&(e.play_max_audio_bitrate=s)}},i=this;for(var o in this.playerList)r(o);0!==this.chargeInfos.timestamp_end?(this.chargeInfos.timestamp_diff=this.chargeInfos.timestamp_begin-this.chargeInfos.timestamp_end,this.chargeInfos.timestamp_diff_flag=1):(this.chargeInfos.timestamp_diff=0,this.chargeInfos.timestamp_diff_flag=0),this.chargeInfos.timestamp_end=(new Date).getTime(),this.chargeInfos.infos=[e],0!==e.play_stream_resolution_infos.length&&this.logger.report(this.chargeInfos),this.chargeInfosTimer&&this.startChargeInfosUpload()},t.prototype.checkSignalHeartbeat=function(){for(var e in this.logger.debug("zsc.csh.0 call"),this.signalList)this.signalList[e].signal&&this.signalList[e].signal.sendHeartbeat();this.heartbeatTimer&&this.startSignalHeartbeat()},t.prototype.stopChargeInfosUpload=function(){this.logger.debug("zsc.sciu.0 call");var e=0;for(var t in this.signalList)e+=1;this.chargeInfosTimer&&0==e&&(this.logger.info("zsc.sciu.0 stop"),clearTimeout(this.chargeInfosTimer),this.chargeInfosTimer=null)},t.prototype.getPublisher=function(e){var t=null;if("string"==typeof e&&this.publisherList[e]&&this.publisherList[e].publisher)t=this.publisherList[e].publisher;else if(e instanceof MediaStream){var r=this.checkPublish(e);r&&(t=null==r?void 0:r.publisher)}return t},t.prototype.getPreviewer=function(e){var t,r=null;return"string"==typeof e&&this.publisherList[e]&&this.publisherList[e].publisher?r=null===(t=this.publisherList[e].publisher)||void 0===t?void 0:t.previewer:e instanceof MediaStream&&(r=this.checkPreview(e)),r},t.prototype.checkPreview=function(e){for(var t=0;t<this.previewStreamList.length;t++)if(this.previewStreamList[t].localStream===e)return this.previewStreamList[t];return null},t.prototype.checkPublish=function(e){for(var t in this.publisherList)if(this.publisherList[t].localStream==e)return this.publisherList[t];return null},t.prototype.removePreview=function(e){for(var t=0;t<this.previewStreamList.length;t++)if(this.previewStreamList[t]===e){this.previewStreamList.splice(t,1);break}},t.prototype.onPlayerStreamUrlUpdate=function(e,t,r){},t.prototype.getScreenConstrains=function(e){var t={};if("boolean"==typeof e&&e)t={audio:!1,video:{frameRate:h.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.frameRate},bitRate:this.stateCenter.settingConfig.getSetting("screen_video_bitrate")||h.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.bitRate};else if("object"==typeof e){switch(e.videoQuality){case 1:t={video:{frameRate:h.ENUM_SCREEM_RESOLUTION_TYPE.LOW.frameRate},bitRate:h.ENUM_SCREEM_RESOLUTION_TYPE.LOW.bitRate};break;case 3:t={video:{frameRate:h.ENUM_SCREEM_RESOLUTION_TYPE.HIGH.frameRate},bitRate:h.ENUM_SCREEM_RESOLUTION_TYPE.HIGH.bitRate};break;case 4:t={video:{frameRate:e.frameRate,width:e.width,height:e.height},bitRate:e.bitRate};break;case 2:t={video:{frameRate:h.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.frameRate},bitRate:h.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.bitRate};break;default:t={video:{frameRate:h.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.frameRate},bitRate:this.stateCenter.settingConfig.getSetting("screen_video_bitrate")||h.ENUM_SCREEM_RESOLUTION_TYPE.MEDIUM.bitRate}}t.audio="boolean"==typeof e.audio&&e.audio}return t},t.prototype.createScreenPreviewer=function(e,t){var r=new c.ZegoPreview(this.logger,this.ac,this.stateCenter,this,"screen"),i=e.getVideoTracks()[0].getSettings();return this.previewStreamList.push(r),r.mediaStreamConfig=t,e.getAudioTracks().length>0&&(r.audioTrack=e.getAudioTracks()[0]),r.localStream=e,r.videoInfo={width:i.width,height:i.height,frameRate:i.frameRate||15,bitRate:(null==t?void 0:t.bitRate)||1e3,startBitrate:(null==t?void 0:t.startBitrate)||this.stateCenter.settingConfig.getSetting("bitrate_mode")},r.previewSuc=!0,r.previewType="screen",(null==t?void 0:t.videoOptimizationMode)&&this.setVideoTrackContentHint(e,null==t?void 0:t.videoOptimizationMode),r},t.prototype.setSoundLevelDelegate=function(e,t,r){void 0===r&&(r=!0),this.logger.info("zsc.ssd.0 call"),t&&(this.soundLevelInterval=t),this.soundLevelDelegate=e,this.enableInBackground=r,this.enableSoundLevelProcessor(e),e?(this.logger.info("zsc.ssd.0 start getting sound"),this.activeSoundLevel()):(this.logger.info("zsc.ssd.0 stop getting sound"),this.soundLevelTimer&&clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null,this.soundLevelInterval=1e3)},t.prototype.enableSoundLevelProcessor=function(e){for(var t in this.previewStreamList){var r=this.previewStreamList[t];e?r.startSoundLevel():r.stopSoundLevel()}for(var t in this.playerList){var i=this.playerList[t].player;e?i.startSoundLevel():i.stopSoundLevel()}},Object.defineProperty(t.prototype,"hasRemoteStream",{get:function(){return Object.keys(this.signalList).length>0},enumerable:!1,configurable:!0}),t.prototype.activeSoundLevel=function(){!this.soundLevelTimer&&this.soundLevelDelegate&&this.startSoundLevel()},t.prototype.startSoundLevel=function(){var e=this;this.soundLevelTimer&&(clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null),this.soundLevelDelegate&&(this.hasRemoteStream&&this.checkSoundLevel(),this.checkMicSoundLevel(),this.soundLevelTimer=setTimeout((function(){e.startSoundLevel()}),this.soundLevelInterval))},t.prototype.checkSoundLevel=function(){this.logger.debug("zsc.csl.0 call");var e=[];for(var t in this.publisherList){var r=0,i=this.publisherList[t].publisher,o=i.previewer;o&&(r=o.soundLevel),e.push({streamID:this.getBackStreamId(i.streamId),soundLevel:r,type:"push"})}for(var t in this.playerList){var n=this.playerList[t].player;n.streamId&&!n.isProbe&&e.push({streamID:this.getBackStreamId(n.streamId),soundLevel:n.soundLevel,type:"pull"})}this.soundLevelDelegate&&e.length>0&&this.onSoundLevelUpdate(e)},t.prototype.checkMicSoundLevel=function(){if(this.microphonePreviewStream&&this.soundLevelDelegate){var e=this.microphonePreviewStream.soundLevel;this.onMicSoundLevelUpdate(e)}},t.prototype.getBackStreamId=function(e){return this.testEnvironment&&e?e.replace("zegotest-"+this.appid+"-",""):e},t.prototype.onSoundLevelUpdate=function(e){},t.prototype.onMicSoundLevelUpdate=function(e){},t.prototype.stopSoundLevel=function(){var e=this.previewStreamList.length;this.soundLevelTimer&&!this.hasRemoteStream&&0===e&&(this.logger.info("zsc.ssl.0 stop"),clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null)},t.prototype.startNetProbe=function(e,t,r){var i=this,o=d.getReportSeq();if(this.dataReport.newReport(o,v.ZegoRTCLogEvent.kZegoNetProbe.event),this.isPeer){var n=!0;0==r.length&&(n=!1,r=e?this.publisherList[t.streamId].serverUrls:this.playerList[t.streamId].serverUrls),r.forEach((function(r){if(!(i.probeList[r]&&i.probeList[r].timeStamp+9e5<(new Date).getTime()||t.probeState==h.ENUM_PROBE_STATE.probed)){var o="zegoprobe-"+(new Date).getTime();i.setPlayStateStart(o);var s=i.playerList[o]?i.playerList[o].player:null;s&&(s.isProbe=!0,n?(s.gwNode=r,s.signal=t.signal,s.startPlay(o,(function(){}))):i.connectPlayServer(o,(function(){}),r),s.onCalNetQualityResult=function(n,a){i.logger.info("zc.ocnqr.0 "+s.gwNode+" "+n+" "+a),i.probeList[r]={result:n,netQuality:a,timeStamp:(new Date).getTime()},t.gwNode==r||t.signal.server==r?t.netQuality=a:i.handleCalNetQualityResult(e,n,a,t,r),i.stopPlayingStream(o)})}})),this.dataReport.addMsgInfo(o,{netQuality:t.netQuality,nodeList:r}),this.dataReport.uploadReport(o)}else this.dataReport.uploadReport(o,void 0,{code:-1,message:"not support peer"})},t.prototype.handleCalNetQualityResult=function(e,t,r,i,o){if(this.logger.info("zc.hcqr.0 "+i.netQuality+" probe "+r+" "+o),0===t){var n=d.getReportSeq();this.dataReport.newReport(n,v.ZegoRTCLogEvent.kZegoNetProbeResult.event);var s=!1;if(r>Math.max(75,i.netQuality+20)&&i.probeState==h.ENUM_PROBE_STATE.tryProbe)if(s=!0,e){var a=i,c=a.streamId,u=a.localStream,l=a.videoInfo,p=a.mediaStreamConfig,g=a.publishOption;0!=a.sessionId&&a.signal&&a.shouldSendCloseSession()&&(a.signal.sendCloseSession(this.stateCenter.getSeq(),a.sessionId,1),a.signal.removeSession(a.sessionId),a.closeSessionSignal=!0),a.resetPublish(),this.publisherList[c].isCenterNode?(a.gwNode=o,a.startPublish(c,u,l,p,g)):this.connectPublishServer(c,o)}else{var f=i,_=(c=f.streamId,f.getRemoteStreamSuc),m=f.playOption;0!=f.sessionId&&f.signal&&f.shouldSendCloseSession()&&(f.signal.sendCloseSession(this.stateCenter.getSeq(),f.sessionId,1),f.signal.removeSession(f.sessionId),f.closeSessionSignal=!0),f.resetPlay(),this.playerList[c].isCenterNode?(f.gwNode=o,f.startPlay(c,_,m)):this.connectPlayServer(c,_,o)}else s=!1,this.logger.warn("zc.hcqr.0 "+i.netQuality+" probe "+r+" "+o);this.dataReport.addMsgInfo(n,{isSwitch:s,isPublish:e,streamID:i.streamId,result:t,node:o,netQuality:i.netQuality,probeNetQuality:r}),this.dataReport.uploadReport(n),i.probeState=h.ENUM_PROBE_STATE.probed}},t.prototype.getRoomByStreamID=function(e){return this.publisherList[e]?this.publisherList[e].room:this.playerList[e]?this.playerList[e].room:void 0},t.prototype.setVideoTrackContentHint=function(e,t){if("string"==typeof t){var r=t.toLowerCase();if(["default","motion","detail","text"].includes(r)){var i=e.getVideoTracks()[0];i?"contentHint"in i?(this.logger.info("zc.svtch "+r),i.contentHint="default"==r?"":r):this.logger.warn("zc.svtch mediaStreamTrack contentHint attribute not supported"):this.logger.warn("zc.svtch video track no found")}else this.logger.warn("zc.svtch videoOptimizationMode wrong")}else this.logger.warn("zc.svtch videoOptimizationMode type wrong")},t.prototype.getPlayRoom=function(e){return this.stateCenter.roomList.find((function(t){return!!t.streamList.find((function(t){return t.stream_id==e}))}))},t.prototype.getQualityHead=function(e,t){var r=new Uint8Array(12);r[0]=0,r[1]=12,r[2]=e.length>>8,r[3]=e.length-(r[2]<<8),r[4]=t.length>>24,r[5]=t.length-(r[4]<<24)>>16,r[6]=t.length-(r[4]<<24)-(r[5]<<16)>>8,r[7]=t.length-(r[4]<<24)-(r[5]<<16)-(r[6]<<8);var i=Math.ceil((new Date).getTime()/1e3);return r[8]=i>>24,r[9]=i-(r[8]<<24)>>16,r[10]=i-(r[8]<<24)-(r[9]<<16)>>8,r[11]=i-(r[8]<<24)-(r[9]<<16)-(r[10]<<8),r},t.prototype.streamQualityUpload=function(){var e,t=this;if(Object.keys(this.publisherList).length>0||Object.keys(this.playerList).length>0){var r={version:2,timestamp:this.qualityHeadTimestamp,event:0,app_id:this.stateCenter.appid,user_id:this.stateCenter.idName,biz_type:1},i={publish_quality_infos:this.publishQualityInfos,play_quality_infos:this.playQualityInfos},o=E.logreport.SpeedLogHead.create(r),n=E.logreport.QualityEvent.create(i),d=E.logreport.SpeedLogHead.encode(o).finish(),c=E.logreport.QualityEvent.encode(n).finish(),u=this.getQualityHead(d,c),l=new Uint8Array(12+d.length+c.length);l.set(u),l.set(d,12),l.set(c,12+d.length);var h=null===(e=this.logger.url)||void 0===e?void 0:e.split("/")[2];if(!h)return;var p=function(){return new Promise((function(e){if(t.qualityWebsocket&&2!=t.qualityWebsocket.readyState&&3!=t.qualityWebsocket.readyState)1==t.qualityWebsocket.readyState&&e(t.qualityWebsocket);else{var r=t.stateCenter.appid,i=t.stateCenter.idName,o=t.stateCenter.roomList[0].token,n="wss://"+h+"/ws/report/stream?appid="+r+"&product=rtc&token="+encodeURIComponent(o)+"&id_name="+i;t.qualityWebsocket=new WebSocket(n),t.qualityWebsocket.onopen=function(){t.qualityWebsocket&&e(t.qualityWebsocket)},t.qualityWebsocket.onclose=function(){t.logger.info(S.ZEGO_WEBRTC_ACTION.UPLOAD_SPEED_LOG_QUALITY+" speed log socket close")}}}))};p().then((function(e){var r=Date.now()%1e4,i=!1;e.onmessage=function(o){(o.data+"").includes("success")&&(t.logger.info(S.ZEGO_WEBRTC_ACTION.UPLOAD_SPEED_LOG_QUALITY+" quality ("+r+") upload success"),i=!0),e.onmessage=null},setTimeout((function(){return s(t,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return i?[3,2]:[4,p()];case 1:e.sent().send(l),this.logger.info(S.ZEGO_WEBRTC_ACTION.UPLOAD_SPEED_LOG_QUALITY+" retry upload quality ("+r+"), length: "+l.length+"."),e.label=2;case 2:return[2]}}))}))}),3e3),e.send(l),t.logger.info(S.ZEGO_WEBRTC_ACTION.UPLOAD_SPEED_LOG_QUALITY+" upload quality ("+r+"), length: "+l.length+".")}))}},t.prototype.updateQuality=function(e,t){var r=this,i=(new Date).getTime(),o=JSON.stringify(this.publishQualityInfos).length+JSON.stringify(this.playQualityInfos).length;0!==this.qualityUploadTimestamp&&i-this.qualityUploadTimestamp>6e4||o>8e3?(this.publishQualityInfos.forEach((function(e){return e.timestamp_offset_end=Math.round(i/1e3)-r.qualityHeadTimestamp})),this.playQualityInfos.forEach((function(e){return e.timestamp_offset_end=Math.round(i/1e3)-r.qualityHeadTimestamp})),this.streamQualityUpload(),this.publishQualityInfos=[],this.playQualityInfos=[],this.qualityHeadTimestamp=Math.round((new Date).getTime()/1e3),this.qualityUploadTimestamp=i):0==this.qualityHeadTimestamp&&(this.qualityHeadTimestamp=Math.round((new Date).getTime()/1e3),this.qualityUploadTimestamp=i),0==e?this.handlePublishQualityData(t):this.handlePlayQualityData(t)},t.prototype.handlePublishQualityData=function(e){var t=this.publishQualityInfos.find((function(t){return t.stream_id==e.stream_id&&t.video_width==e.frameWidth&&t.video_height==e.frameHeight}));if(!t){var r=this.getRoomByStreamID(e.stream_id);t={timestamp_offset_begin:Math.abs(Number(e.timeStamp-this.qualityHeadTimestamp)),timestamp_offset_end:0,stream_id:e.stream_id,session_id:r?Number(r.sessionID):0,video_width:e.frameWidth,video_height:e.frameHeight,infos:[],room_id:r?r.roomID:"",evnvironment:1,room_session_id:r?Number(r.roomSessionID):0,resource_type:2},this.publishQualityInfos.push(t)}t.infos.push({audio_bitrate:Math.round(e.audioBitrate)||0,video_bitrate:Math.round(e.videoBitrate)||0,video_capture_fps:Math.round(10*e.videoFPS)||0,video_network_fps:Math.round(10*e.videoTransferFPS)||0,uplink_plr:e.audioPacketsLostRate,rtt:Math.round(e.currentRoundTripTime),audio_network_fps:Math.round(10*e.audioFPS),captured_sound_level:Math.round(e.audioLevel),sample_time_window:Math.round(e.sampleTimeWindow/10)})},t.prototype.handlePlayQualityData=function(e){var t,r=this.playQualityInfos.find((function(t){return t.stream_id==e.stream_id&&t.video_width==e.frameWidth&&t.video_height==e.frameHeight}));if(!r){var i=this.getRoomByStreamID(e.stream_id),o=null===(t=this.playerList[e.stream_id])||void 0===t?void 0:t.player;r={timestamp_offset_begin:Math.abs(Number(e.timeStamp-this.qualityHeadTimestamp)),timestamp_offset_end:0,stream_id:e.stream_id,session_id:i?Number(i.sessionID):0,video_width:e.frameWidth,video_height:e.frameHeight,infos:[],room_id:i?i.roomID:"",room_session_id:i?Number(i.roomSessionID):0,resource_type:null==o?void 0:o.resourceMode},this.playQualityInfos.push(r)}r.infos.push({audio_bitrate:Math.round(e.audioBitrate)||0,video_bitrate:Math.round(e.videoBitrate)||0,video_network_fps:Math.round(10*e.videoFPS)||0,downlink_plr:Math.round(e.audioPacketsLostRate)||0,audio_network_fps:Math.round(10*e.audioFPS)||0,audio_break_duration:Math.round(e.audio_break_duration/10),video_break_duration:Math.round(e.video_break_duration/10),rtt:e.currentRoundTripTime,rendered_sound_level:Math.round(e.audioLevel),audio_break_cancel_duration:Math.round(e.audio_break_cancel_duration/10),video_break_cancel_duration:Math.round(e.video_break_cancel_duration/10),audio_decode_time:Math.round(e.audio_decode_time/10),video_decode_time:Math.round(e.video_decode_time/10),real_sampling_interval:Math.round(e.real_sampling_interval/10),video_frames_decoded:Math.round(e.videoFramesDecoded)||0,video_frames_dropped:Math.round(e.videoFramesDropped)||0,sample_time_window:Math.round(e.sampleTimeWindow/10),peer_to_peer_plr:e.peerToPeerPacketLostRate,peer_to_peer_delay:e.peerToPeerDelay})},t}(l.ZegoStreamCenter);t.ZegoStreamCenterWeb=T},2990:function(e,t,r){"use strict";var i,o=r(2100),n=o.Reader,s=o.Writer,a=o.util,d=o.roots.default||(o.roots.default={});d.logreport=((i={}).SpeedLogHead=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.version=0,e.prototype.signature=a.newBuffer([]),e.prototype.timestamp=0,e.prototype.event=0,e.prototype.app_id=0,e.prototype.user_id="",e.prototype.biz_type=0,e.prototype.device_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).uint32(e.version),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(18).bytes(e.signature),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(24).uint32(e.timestamp),null!=e.event&&Object.hasOwnProperty.call(e,"event")&&t.uint32(32).uint32(e.event),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(40).uint32(e.app_id),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(50).string(e.user_id),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(56).uint32(e.biz_type),null!=e.device_id&&Object.hasOwnProperty.call(e,"device_id")&&t.uint32(66).string(e.device_id),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.logreport.SpeedLogHead;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.version=e.uint32();break;case 2:i.signature=e.bytes();break;case 3:i.timestamp=e.uint32();break;case 4:i.event=e.uint32();break;case 5:i.app_id=e.uint32();break;case 6:i.user_id=e.string();break;case 7:i.biz_type=e.uint32();break;case 8:i.device_id=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.version&&e.hasOwnProperty("version")&&!a.isInteger(e.version)?"version: integer expected":null!=e.signature&&e.hasOwnProperty("signature")&&!(e.signature&&"number"==typeof e.signature.length||a.isString(e.signature))?"signature: buffer expected":null!=e.timestamp&&e.hasOwnProperty("timestamp")&&!a.isInteger(e.timestamp)?"timestamp: integer expected":null!=e.event&&e.hasOwnProperty("event")&&!a.isInteger(e.event)?"event: integer expected":null!=e.app_id&&e.hasOwnProperty("app_id")&&!a.isInteger(e.app_id)?"app_id: integer expected":null!=e.user_id&&e.hasOwnProperty("user_id")&&!a.isString(e.user_id)?"user_id: string expected":null!=e.biz_type&&e.hasOwnProperty("biz_type")&&!a.isInteger(e.biz_type)?"biz_type: integer expected":null!=e.device_id&&e.hasOwnProperty("device_id")&&!a.isString(e.device_id)?"device_id: string expected":null},e.fromObject=function(e){if(e instanceof d.logreport.SpeedLogHead)return e;var t=new d.logreport.SpeedLogHead;return null!=e.version&&(t.version=e.version>>>0),null!=e.signature&&("string"==typeof e.signature?a.base64.decode(e.signature,t.signature=a.newBuffer(a.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),null!=e.timestamp&&(t.timestamp=e.timestamp>>>0),null!=e.event&&(t.event=e.event>>>0),null!=e.app_id&&(t.app_id=e.app_id>>>0),null!=e.user_id&&(t.user_id=String(e.user_id)),null!=e.biz_type&&(t.biz_type=e.biz_type>>>0),null!=e.device_id&&(t.device_id=String(e.device_id)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.version=0,t.bytes===String?r.signature="":(r.signature=[],t.bytes!==Array&&(r.signature=a.newBuffer(r.signature))),r.timestamp=0,r.event=0,r.app_id=0,r.user_id="",r.biz_type=0,r.device_id=""),null!=e.version&&e.hasOwnProperty("version")&&(r.version=e.version),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?a.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&(r.timestamp=e.timestamp),null!=e.event&&e.hasOwnProperty("event")&&(r.event=e.event),null!=e.app_id&&e.hasOwnProperty("app_id")&&(r.app_id=e.app_id),null!=e.user_id&&e.hasOwnProperty("user_id")&&(r.user_id=e.user_id),null!=e.biz_type&&e.hasOwnProperty("biz_type")&&(r.biz_type=e.biz_type),null!=e.device_id&&e.hasOwnProperty("device_id")&&(r.device_id=e.device_id),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.ProtoVersion=(t={},(r=Object.create(t))[t[0]="PROTO_VERSION"]=0,r[t[1]="PROTO_VERSION1"]=1,r[t[2]="PROTO_VERSION2"]=2,r[t[3]="PROTO_VERSION3"]=3,r[t[4]="PROTO_VERSION4"]=4,r[t[5]="PROTO_VERSION5"]=5,r[t[6]="PROTO_VERSION6"]=6,r),e.Event=function(){var e={},t=Object.create(e);return t[e[0]="QUALITY_EVENT"]=0,t[e[100]="NO_BILLING_EVENT"]=100,t[e[300]="DETECT_QUALITY_EVENT"]=300,t}(),e.BizType=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN"]=0,t[e[1]="LIVE"]=1,t[e[2]="RTV"]=2,t}(),e}(),i.SpeedLogRsp=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.code=0,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).uint32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.logreport.SpeedLogRsp;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.code=e.uint32();break;case 2:i.message=e.string();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.code&&e.hasOwnProperty("code")&&!a.isInteger(e.code)?"code: integer expected":null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof d.logreport.SpeedLogRsp)return e;var t=new d.logreport.SpeedLogRsp;return null!=e.code&&(t.code=e.code>>>0),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.code=0,r.message=""),null!=e.code&&e.hasOwnProperty("code")&&(r.code=e.code),null!=e.message&&e.hasOwnProperty("message")&&(r.message=e.message),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.QualityEvent=function(){function e(e){if(this.publish_quality_infos=[],this.play_quality_infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t,r;return e.prototype.hardware_infos=null,e.prototype.publish_quality_infos=a.emptyArray,e.prototype.play_quality_infos=a.emptyArray,e.prototype.network_type=0,e.prototype.charge_infos=null,e.prototype.client_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.hardware_infos&&Object.hasOwnProperty.call(e,"hardware_infos")&&d.logreport.HardwareInfos.encode(e.hardware_infos,t.uint32(10).fork()).ldelim(),null!=e.publish_quality_infos&&e.publish_quality_infos.length)for(var r=0;r<e.publish_quality_infos.length;++r)d.logreport.PublishQualityInfos.encode(e.publish_quality_infos[r],t.uint32(18).fork()).ldelim();if(null!=e.play_quality_infos&&e.play_quality_infos.length)for(r=0;r<e.play_quality_infos.length;++r)d.logreport.PlayQualityInfos.encode(e.play_quality_infos[r],t.uint32(26).fork()).ldelim();return null!=e.network_type&&Object.hasOwnProperty.call(e,"network_type")&&t.uint32(32).uint32(e.network_type),null!=e.charge_infos&&Object.hasOwnProperty.call(e,"charge_infos")&&d.logreport.ChargeInfos.encode(e.charge_infos,t.uint32(42).fork()).ldelim(),null!=e.client_type&&Object.hasOwnProperty.call(e,"client_type")&&t.uint32(800).uint32(e.client_type),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.logreport.QualityEvent;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.hardware_infos=d.logreport.HardwareInfos.decode(e,e.uint32());break;case 2:i.publish_quality_infos&&i.publish_quality_infos.length||(i.publish_quality_infos=[]),i.publish_quality_infos.push(d.logreport.PublishQualityInfos.decode(e,e.uint32()));break;case 3:i.play_quality_infos&&i.play_quality_infos.length||(i.play_quality_infos=[]),i.play_quality_infos.push(d.logreport.PlayQualityInfos.decode(e,e.uint32()));break;case 4:i.network_type=e.uint32();break;case 5:i.charge_infos=d.logreport.ChargeInfos.decode(e,e.uint32());break;case 100:i.client_type=e.uint32();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.hardware_infos&&e.hasOwnProperty("hardware_infos")&&(r=d.logreport.HardwareInfos.verify(e.hardware_infos)))return"hardware_infos."+r;if(null!=e.publish_quality_infos&&e.hasOwnProperty("publish_quality_infos")){if(!Array.isArray(e.publish_quality_infos))return"publish_quality_infos: array expected";for(var t=0;t<e.publish_quality_infos.length;++t)if(r=d.logreport.PublishQualityInfos.verify(e.publish_quality_infos[t]))return"publish_quality_infos."+r}if(null!=e.play_quality_infos&&e.hasOwnProperty("play_quality_infos")){if(!Array.isArray(e.play_quality_infos))return"play_quality_infos: array expected";for(t=0;t<e.play_quality_infos.length;++t){var r;if(r=d.logreport.PlayQualityInfos.verify(e.play_quality_infos[t]))return"play_quality_infos."+r}}return null!=e.network_type&&e.hasOwnProperty("network_type")&&!a.isInteger(e.network_type)?"network_type: integer expected":null!=e.charge_infos&&e.hasOwnProperty("charge_infos")&&(r=d.logreport.ChargeInfos.verify(e.charge_infos))?"charge_infos."+r:null!=e.client_type&&e.hasOwnProperty("client_type")&&!a.isInteger(e.client_type)?"client_type: integer expected":null},e.fromObject=function(e){if(e instanceof d.logreport.QualityEvent)return e;var t=new d.logreport.QualityEvent;if(null!=e.hardware_infos){if("object"!=typeof e.hardware_infos)throw TypeError(".logreport.QualityEvent.hardware_infos: object expected");t.hardware_infos=d.logreport.HardwareInfos.fromObject(e.hardware_infos)}if(e.publish_quality_infos){if(!Array.isArray(e.publish_quality_infos))throw TypeError(".logreport.QualityEvent.publish_quality_infos: array expected");t.publish_quality_infos=[];for(var r=0;r<e.publish_quality_infos.length;++r){if("object"!=typeof e.publish_quality_infos[r])throw TypeError(".logreport.QualityEvent.publish_quality_infos: object expected");t.publish_quality_infos[r]=d.logreport.PublishQualityInfos.fromObject(e.publish_quality_infos[r])}}if(e.play_quality_infos){if(!Array.isArray(e.play_quality_infos))throw TypeError(".logreport.QualityEvent.play_quality_infos: array expected");for(t.play_quality_infos=[],r=0;r<e.play_quality_infos.length;++r){if("object"!=typeof e.play_quality_infos[r])throw TypeError(".logreport.QualityEvent.play_quality_infos: object expected");t.play_quality_infos[r]=d.logreport.PlayQualityInfos.fromObject(e.play_quality_infos[r])}}if(null!=e.network_type&&(t.network_type=e.network_type>>>0),null!=e.charge_infos){if("object"!=typeof e.charge_infos)throw TypeError(".logreport.QualityEvent.charge_infos: object expected");t.charge_infos=d.logreport.ChargeInfos.fromObject(e.charge_infos)}return null!=e.client_type&&(t.client_type=e.client_type>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.publish_quality_infos=[],r.play_quality_infos=[]),t.defaults&&(r.hardware_infos=null,r.network_type=0,r.charge_infos=null,r.client_type=0),null!=e.hardware_infos&&e.hasOwnProperty("hardware_infos")&&(r.hardware_infos=d.logreport.HardwareInfos.toObject(e.hardware_infos,t)),e.publish_quality_infos&&e.publish_quality_infos.length){r.publish_quality_infos=[];for(var i=0;i<e.publish_quality_infos.length;++i)r.publish_quality_infos[i]=d.logreport.PublishQualityInfos.toObject(e.publish_quality_infos[i],t)}if(e.play_quality_infos&&e.play_quality_infos.length)for(r.play_quality_infos=[],i=0;i<e.play_quality_infos.length;++i)r.play_quality_infos[i]=d.logreport.PlayQualityInfos.toObject(e.play_quality_infos[i],t);return null!=e.network_type&&e.hasOwnProperty("network_type")&&(r.network_type=e.network_type),null!=e.charge_infos&&e.hasOwnProperty("charge_infos")&&(r.charge_infos=d.logreport.ChargeInfos.toObject(e.charge_infos,t)),null!=e.client_type&&e.hasOwnProperty("client_type")&&(r.client_type=e.client_type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.ResourceType=(t={},(r=Object.create(t))[t[0]="UNKNOWN"]=0,r[t[1]="CDN"]=1,r[t[2]="RTC"]=2,r[t[3]="L3"]=3,r),e}(),i.HardwareInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.infos=a.emptyArray,e.prototype.sys_mem_total=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)d.logreport.HardwareInfo.encode(e.infos[r],t.uint32(26).fork()).ldelim();return null!=e.sys_mem_total&&Object.hasOwnProperty.call(e,"sys_mem_total")&&t.uint32(32).uint32(e.sys_mem_total),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.logreport.HardwareInfos;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.timestamp_offset_begin=e.uint32();break;case 2:i.timestamp_offset_end=e.uint32();break;case 3:i.infos&&i.infos.length||(i.infos=[]),i.infos.push(d.logreport.HardwareInfo.decode(e,e.uint32()));break;case 4:i.sys_mem_total=e.uint32();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&!a.isInteger(e.timestamp_offset_begin))return"timestamp_offset_begin: integer expected";if(null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&!a.isInteger(e.timestamp_offset_end))return"timestamp_offset_end: integer expected";if(null!=e.infos&&e.hasOwnProperty("infos")){if(!Array.isArray(e.infos))return"infos: array expected";for(var t=0;t<e.infos.length;++t){var r=d.logreport.HardwareInfo.verify(e.infos[t]);if(r)return"infos."+r}}return null!=e.sys_mem_total&&e.hasOwnProperty("sys_mem_total")&&!a.isInteger(e.sys_mem_total)?"sys_mem_total: integer expected":null},e.fromObject=function(e){if(e instanceof d.logreport.HardwareInfos)return e;var t=new d.logreport.HardwareInfos;if(null!=e.timestamp_offset_begin&&(t.timestamp_offset_begin=e.timestamp_offset_begin>>>0),null!=e.timestamp_offset_end&&(t.timestamp_offset_end=e.timestamp_offset_end>>>0),e.infos){if(!Array.isArray(e.infos))throw TypeError(".logreport.HardwareInfos.infos: array expected");t.infos=[];for(var r=0;r<e.infos.length;++r){if("object"!=typeof e.infos[r])throw TypeError(".logreport.HardwareInfos.infos: object expected");t.infos[r]=d.logreport.HardwareInfo.fromObject(e.infos[r])}}return null!=e.sys_mem_total&&(t.sys_mem_total=e.sys_mem_total>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.infos=[]),t.defaults&&(r.timestamp_offset_begin=0,r.timestamp_offset_end=0,r.sys_mem_total=0),null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&(r.timestamp_offset_begin=e.timestamp_offset_begin),null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&(r.timestamp_offset_end=e.timestamp_offset_end),e.infos&&e.infos.length){r.infos=[];for(var i=0;i<e.infos.length;++i)r.infos[i]=d.logreport.HardwareInfo.toObject(e.infos[i],t)}return null!=e.sys_mem_total&&e.hasOwnProperty("sys_mem_total")&&(r.sys_mem_total=e.sys_mem_total),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.PublishQualityInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.stream_id="",e.prototype.session_id=0,e.prototype.video_width=0,e.prototype.video_height=0,e.prototype.ipv4=0,e.prototype.ipv6="",e.prototype.resource_type=0,e.prototype.infos=a.emptyArray,e.prototype.room_id="",e.prototype.evnvironment=0,e.prototype.ap="",e.prototype.session="",e.prototype.room_session_id=a.Long?a.Long.fromBits(0,0,!0):0,e.prototype.protocol_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(26).string(e.stream_id),null!=e.session_id&&Object.hasOwnProperty.call(e,"session_id")&&t.uint32(32).uint32(e.session_id),null!=e.video_width&&Object.hasOwnProperty.call(e,"video_width")&&t.uint32(40).uint32(e.video_width),null!=e.video_height&&Object.hasOwnProperty.call(e,"video_height")&&t.uint32(48).uint32(e.video_height),null!=e.ipv4&&Object.hasOwnProperty.call(e,"ipv4")&&t.uint32(56).uint32(e.ipv4),null!=e.ipv6&&Object.hasOwnProperty.call(e,"ipv6")&&t.uint32(66).string(e.ipv6),null!=e.resource_type&&Object.hasOwnProperty.call(e,"resource_type")&&t.uint32(72).uint32(e.resource_type),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)d.logreport.PublishQualityInfo.encode(e.infos[r],t.uint32(82).fork()).ldelim();return null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(90).string(e.room_id),null!=e.evnvironment&&Object.hasOwnProperty.call(e,"evnvironment")&&t.uint32(104).uint32(e.evnvironment),null!=e.ap&&Object.hasOwnProperty.call(e,"ap")&&t.uint32(114).string(e.ap),null!=e.session&&Object.hasOwnProperty.call(e,"session")&&t.uint32(122).string(e.session),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(128).uint64(e.room_session_id),null!=e.protocol_type&&Object.hasOwnProperty.call(e,"protocol_type")&&t.uint32(136).uint32(e.protocol_type),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.logreport.PublishQualityInfos;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.timestamp_offset_begin=e.uint32();break;case 2:i.timestamp_offset_end=e.uint32();break;case 3:i.stream_id=e.string();break;case 4:i.session_id=e.uint32();break;case 5:i.video_width=e.uint32();break;case 6:i.video_height=e.uint32();break;case 7:i.ipv4=e.uint32();break;case 8:i.ipv6=e.string();break;case 9:i.resource_type=e.uint32();break;case 10:i.infos&&i.infos.length||(i.infos=[]),i.infos.push(d.logreport.PublishQualityInfo.decode(e,e.uint32()));break;case 11:i.room_id=e.string();break;case 13:i.evnvironment=e.uint32();break;case 14:i.ap=e.string();break;case 15:i.session=e.string();break;case 16:i.room_session_id=e.uint64();break;case 17:i.protocol_type=e.uint32();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&!a.isInteger(e.timestamp_offset_begin))return"timestamp_offset_begin: integer expected";if(null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&!a.isInteger(e.timestamp_offset_end))return"timestamp_offset_end: integer expected";if(null!=e.stream_id&&e.hasOwnProperty("stream_id")&&!a.isString(e.stream_id))return"stream_id: string expected";if(null!=e.session_id&&e.hasOwnProperty("session_id")&&!a.isInteger(e.session_id))return"session_id: integer expected";if(null!=e.video_width&&e.hasOwnProperty("video_width")&&!a.isInteger(e.video_width))return"video_width: integer expected";if(null!=e.video_height&&e.hasOwnProperty("video_height")&&!a.isInteger(e.video_height))return"video_height: integer expected";if(null!=e.ipv4&&e.hasOwnProperty("ipv4")&&!a.isInteger(e.ipv4))return"ipv4: integer expected";if(null!=e.ipv6&&e.hasOwnProperty("ipv6")&&!a.isString(e.ipv6))return"ipv6: string expected";if(null!=e.resource_type&&e.hasOwnProperty("resource_type")&&!a.isInteger(e.resource_type))return"resource_type: integer expected";if(null!=e.infos&&e.hasOwnProperty("infos")){if(!Array.isArray(e.infos))return"infos: array expected";for(var t=0;t<e.infos.length;++t){var r=d.logreport.PublishQualityInfo.verify(e.infos[t]);if(r)return"infos."+r}}return null!=e.room_id&&e.hasOwnProperty("room_id")&&!a.isString(e.room_id)?"room_id: string expected":null!=e.evnvironment&&e.hasOwnProperty("evnvironment")&&!a.isInteger(e.evnvironment)?"evnvironment: integer expected":null!=e.ap&&e.hasOwnProperty("ap")&&!a.isString(e.ap)?"ap: string expected":null!=e.session&&e.hasOwnProperty("session")&&!a.isString(e.session)?"session: string expected":null!=e.room_session_id&&e.hasOwnProperty("room_session_id")&&!(a.isInteger(e.room_session_id)||e.room_session_id&&a.isInteger(e.room_session_id.low)&&a.isInteger(e.room_session_id.high))?"room_session_id: integer|Long expected":null!=e.protocol_type&&e.hasOwnProperty("protocol_type")&&!a.isInteger(e.protocol_type)?"protocol_type: integer expected":null},e.fromObject=function(e){if(e instanceof d.logreport.PublishQualityInfos)return e;var t=new d.logreport.PublishQualityInfos;if(null!=e.timestamp_offset_begin&&(t.timestamp_offset_begin=e.timestamp_offset_begin>>>0),null!=e.timestamp_offset_end&&(t.timestamp_offset_end=e.timestamp_offset_end>>>0),null!=e.stream_id&&(t.stream_id=String(e.stream_id)),null!=e.session_id&&(t.session_id=e.session_id>>>0),null!=e.video_width&&(t.video_width=e.video_width>>>0),null!=e.video_height&&(t.video_height=e.video_height>>>0),null!=e.ipv4&&(t.ipv4=e.ipv4>>>0),null!=e.ipv6&&(t.ipv6=String(e.ipv6)),null!=e.resource_type&&(t.resource_type=e.resource_type>>>0),e.infos){if(!Array.isArray(e.infos))throw TypeError(".logreport.PublishQualityInfos.infos: array expected");t.infos=[];for(var r=0;r<e.infos.length;++r){if("object"!=typeof e.infos[r])throw TypeError(".logreport.PublishQualityInfos.infos: object expected");t.infos[r]=d.logreport.PublishQualityInfo.fromObject(e.infos[r])}}return null!=e.room_id&&(t.room_id=String(e.room_id)),null!=e.evnvironment&&(t.evnvironment=e.evnvironment>>>0),null!=e.ap&&(t.ap=String(e.ap)),null!=e.session&&(t.session=String(e.session)),null!=e.room_session_id&&(a.Long?(t.room_session_id=a.Long.fromValue(e.room_session_id)).unsigned=!0:"string"==typeof e.room_session_id?t.room_session_id=parseInt(e.room_session_id,10):"number"==typeof e.room_session_id?t.room_session_id=e.room_session_id:"object"==typeof e.room_session_id&&(t.room_session_id=new a.LongBits(e.room_session_id.low>>>0,e.room_session_id.high>>>0).toNumber(!0))),null!=e.protocol_type&&(t.protocol_type=e.protocol_type>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.infos=[]),t.defaults){if(r.timestamp_offset_begin=0,r.timestamp_offset_end=0,r.stream_id="",r.session_id=0,r.video_width=0,r.video_height=0,r.ipv4=0,r.ipv6="",r.resource_type=0,r.room_id="",r.evnvironment=0,r.ap="",r.session="",a.Long){var i=new a.Long(0,0,!0);r.room_session_id=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.room_session_id=t.longs===String?"0":0;r.protocol_type=0}if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&(r.timestamp_offset_begin=e.timestamp_offset_begin),null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&(r.timestamp_offset_end=e.timestamp_offset_end),null!=e.stream_id&&e.hasOwnProperty("stream_id")&&(r.stream_id=e.stream_id),null!=e.session_id&&e.hasOwnProperty("session_id")&&(r.session_id=e.session_id),null!=e.video_width&&e.hasOwnProperty("video_width")&&(r.video_width=e.video_width),null!=e.video_height&&e.hasOwnProperty("video_height")&&(r.video_height=e.video_height),null!=e.ipv4&&e.hasOwnProperty("ipv4")&&(r.ipv4=e.ipv4),null!=e.ipv6&&e.hasOwnProperty("ipv6")&&(r.ipv6=e.ipv6),null!=e.resource_type&&e.hasOwnProperty("resource_type")&&(r.resource_type=e.resource_type),e.infos&&e.infos.length){r.infos=[];for(var o=0;o<e.infos.length;++o)r.infos[o]=d.logreport.PublishQualityInfo.toObject(e.infos[o],t)}return null!=e.room_id&&e.hasOwnProperty("room_id")&&(r.room_id=e.room_id),null!=e.evnvironment&&e.hasOwnProperty("evnvironment")&&(r.evnvironment=e.evnvironment),null!=e.ap&&e.hasOwnProperty("ap")&&(r.ap=e.ap),null!=e.session&&e.hasOwnProperty("session")&&(r.session=e.session),null!=e.room_session_id&&e.hasOwnProperty("room_session_id")&&("number"==typeof e.room_session_id?r.room_session_id=t.longs===String?String(e.room_session_id):e.room_session_id:r.room_session_id=t.longs===String?a.Long.prototype.toString.call(e.room_session_id):t.longs===Number?new a.LongBits(e.room_session_id.low>>>0,e.room_session_id.high>>>0).toNumber(!0):e.room_session_id),null!=e.protocol_type&&e.hasOwnProperty("protocol_type")&&(r.protocol_type=e.protocol_type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.PlayQualityInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.stream_id="",e.prototype.session_id=0,e.prototype.video_width=0,e.prototype.video_height=0,e.prototype.ipv4=0,e.prototype.ipv6="",e.prototype.resource_type=0,e.prototype.infos=a.emptyArray,e.prototype.room_id="",e.prototype.session="",e.prototype.room_session_id=a.Long?a.Long.fromBits(0,0,!0):0,e.prototype.protocol_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(26).string(e.stream_id),null!=e.session_id&&Object.hasOwnProperty.call(e,"session_id")&&t.uint32(32).uint32(e.session_id),null!=e.video_width&&Object.hasOwnProperty.call(e,"video_width")&&t.uint32(40).uint32(e.video_width),null!=e.video_height&&Object.hasOwnProperty.call(e,"video_height")&&t.uint32(48).uint32(e.video_height),null!=e.ipv4&&Object.hasOwnProperty.call(e,"ipv4")&&t.uint32(56).uint32(e.ipv4),null!=e.ipv6&&Object.hasOwnProperty.call(e,"ipv6")&&t.uint32(66).string(e.ipv6),null!=e.resource_type&&Object.hasOwnProperty.call(e,"resource_type")&&t.uint32(72).uint32(e.resource_type),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)d.logreport.PlayQualityInfo.encode(e.infos[r],t.uint32(82).fork()).ldelim();return null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(90).string(e.room_id),null!=e.session&&Object.hasOwnProperty.call(e,"session")&&t.uint32(106).string(e.session),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(112).uint64(e.room_session_id),null!=e.protocol_type&&Object.hasOwnProperty.call(e,"protocol_type")&&t.uint32(120).uint32(e.protocol_type),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.logreport.PlayQualityInfos;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.timestamp_offset_begin=e.uint32();break;case 2:i.timestamp_offset_end=e.uint32();break;case 3:i.stream_id=e.string();break;case 4:i.session_id=e.uint32();break;case 5:i.video_width=e.uint32();break;case 6:i.video_height=e.uint32();break;case 7:i.ipv4=e.uint32();break;case 8:i.ipv6=e.string();break;case 9:i.resource_type=e.uint32();break;case 10:i.infos&&i.infos.length||(i.infos=[]),i.infos.push(d.logreport.PlayQualityInfo.decode(e,e.uint32()));break;case 11:i.room_id=e.string();break;case 13:i.session=e.string();break;case 14:i.room_session_id=e.uint64();break;case 15:i.protocol_type=e.uint32();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&!a.isInteger(e.timestamp_offset_begin))return"timestamp_offset_begin: integer expected";if(null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&!a.isInteger(e.timestamp_offset_end))return"timestamp_offset_end: integer expected";if(null!=e.stream_id&&e.hasOwnProperty("stream_id")&&!a.isString(e.stream_id))return"stream_id: string expected";if(null!=e.session_id&&e.hasOwnProperty("session_id")&&!a.isInteger(e.session_id))return"session_id: integer expected";if(null!=e.video_width&&e.hasOwnProperty("video_width")&&!a.isInteger(e.video_width))return"video_width: integer expected";if(null!=e.video_height&&e.hasOwnProperty("video_height")&&!a.isInteger(e.video_height))return"video_height: integer expected";if(null!=e.ipv4&&e.hasOwnProperty("ipv4")&&!a.isInteger(e.ipv4))return"ipv4: integer expected";if(null!=e.ipv6&&e.hasOwnProperty("ipv6")&&!a.isString(e.ipv6))return"ipv6: string expected";if(null!=e.resource_type&&e.hasOwnProperty("resource_type")&&!a.isInteger(e.resource_type))return"resource_type: integer expected";if(null!=e.infos&&e.hasOwnProperty("infos")){if(!Array.isArray(e.infos))return"infos: array expected";for(var t=0;t<e.infos.length;++t){var r=d.logreport.PlayQualityInfo.verify(e.infos[t]);if(r)return"infos."+r}}return null!=e.room_id&&e.hasOwnProperty("room_id")&&!a.isString(e.room_id)?"room_id: string expected":null!=e.session&&e.hasOwnProperty("session")&&!a.isString(e.session)?"session: string expected":null!=e.room_session_id&&e.hasOwnProperty("room_session_id")&&!(a.isInteger(e.room_session_id)||e.room_session_id&&a.isInteger(e.room_session_id.low)&&a.isInteger(e.room_session_id.high))?"room_session_id: integer|Long expected":null!=e.protocol_type&&e.hasOwnProperty("protocol_type")&&!a.isInteger(e.protocol_type)?"protocol_type: integer expected":null},e.fromObject=function(e){if(e instanceof d.logreport.PlayQualityInfos)return e;var t=new d.logreport.PlayQualityInfos;if(null!=e.timestamp_offset_begin&&(t.timestamp_offset_begin=e.timestamp_offset_begin>>>0),null!=e.timestamp_offset_end&&(t.timestamp_offset_end=e.timestamp_offset_end>>>0),null!=e.stream_id&&(t.stream_id=String(e.stream_id)),null!=e.session_id&&(t.session_id=e.session_id>>>0),null!=e.video_width&&(t.video_width=e.video_width>>>0),null!=e.video_height&&(t.video_height=e.video_height>>>0),null!=e.ipv4&&(t.ipv4=e.ipv4>>>0),null!=e.ipv6&&(t.ipv6=String(e.ipv6)),null!=e.resource_type&&(t.resource_type=e.resource_type>>>0),e.infos){if(!Array.isArray(e.infos))throw TypeError(".logreport.PlayQualityInfos.infos: array expected");t.infos=[];for(var r=0;r<e.infos.length;++r){if("object"!=typeof e.infos[r])throw TypeError(".logreport.PlayQualityInfos.infos: object expected");t.infos[r]=d.logreport.PlayQualityInfo.fromObject(e.infos[r])}}return null!=e.room_id&&(t.room_id=String(e.room_id)),null!=e.session&&(t.session=String(e.session)),null!=e.room_session_id&&(a.Long?(t.room_session_id=a.Long.fromValue(e.room_session_id)).unsigned=!0:"string"==typeof e.room_session_id?t.room_session_id=parseInt(e.room_session_id,10):"number"==typeof e.room_session_id?t.room_session_id=e.room_session_id:"object"==typeof e.room_session_id&&(t.room_session_id=new a.LongBits(e.room_session_id.low>>>0,e.room_session_id.high>>>0).toNumber(!0))),null!=e.protocol_type&&(t.protocol_type=e.protocol_type>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.infos=[]),t.defaults){if(r.timestamp_offset_begin=0,r.timestamp_offset_end=0,r.stream_id="",r.session_id=0,r.video_width=0,r.video_height=0,r.ipv4=0,r.ipv6="",r.resource_type=0,r.room_id="",r.session="",a.Long){var i=new a.Long(0,0,!0);r.room_session_id=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.room_session_id=t.longs===String?"0":0;r.protocol_type=0}if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&(r.timestamp_offset_begin=e.timestamp_offset_begin),null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&(r.timestamp_offset_end=e.timestamp_offset_end),null!=e.stream_id&&e.hasOwnProperty("stream_id")&&(r.stream_id=e.stream_id),null!=e.session_id&&e.hasOwnProperty("session_id")&&(r.session_id=e.session_id),null!=e.video_width&&e.hasOwnProperty("video_width")&&(r.video_width=e.video_width),null!=e.video_height&&e.hasOwnProperty("video_height")&&(r.video_height=e.video_height),null!=e.ipv4&&e.hasOwnProperty("ipv4")&&(r.ipv4=e.ipv4),null!=e.ipv6&&e.hasOwnProperty("ipv6")&&(r.ipv6=e.ipv6),null!=e.resource_type&&e.hasOwnProperty("resource_type")&&(r.resource_type=e.resource_type),e.infos&&e.infos.length){r.infos=[];for(var o=0;o<e.infos.length;++o)r.infos[o]=d.logreport.PlayQualityInfo.toObject(e.infos[o],t)}return null!=e.room_id&&e.hasOwnProperty("room_id")&&(r.room_id=e.room_id),null!=e.session&&e.hasOwnProperty("session")&&(r.session=e.session),null!=e.room_session_id&&e.hasOwnProperty("room_session_id")&&("number"==typeof e.room_session_id?r.room_session_id=t.longs===String?String(e.room_session_id):e.room_session_id:r.room_session_id=t.longs===String?a.Long.prototype.toString.call(e.room_session_id):t.longs===Number?new a.LongBits(e.room_session_id.low>>>0,e.room_session_id.high>>>0).toNumber(!0):e.room_session_id),null!=e.protocol_type&&e.hasOwnProperty("protocol_type")&&(r.protocol_type=e.protocol_type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.ChargeInfos=function(){function e(e){if(this.infos=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp_offset_begin=0,e.prototype.timestamp_offset_end=0,e.prototype.timestamp_diff_flag=0,e.prototype.timestamp_diff=0,e.prototype.room_id="",e.prototype.infos=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.timestamp_offset_begin&&Object.hasOwnProperty.call(e,"timestamp_offset_begin")&&t.uint32(8).uint32(e.timestamp_offset_begin),null!=e.timestamp_offset_end&&Object.hasOwnProperty.call(e,"timestamp_offset_end")&&t.uint32(16).uint32(e.timestamp_offset_end),null!=e.timestamp_diff_flag&&Object.hasOwnProperty.call(e,"timestamp_diff_flag")&&t.uint32(24).uint32(e.timestamp_diff_flag),null!=e.timestamp_diff&&Object.hasOwnProperty.call(e,"timestamp_diff")&&t.uint32(32).uint32(e.timestamp_diff),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(42).string(e.room_id),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)d.logreport.ChargeInfo.encode(e.infos[r],t.uint32(802).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.logreport.ChargeInfos;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.timestamp_offset_begin=e.uint32();break;case 2:i.timestamp_offset_end=e.uint32();break;case 3:i.timestamp_diff_flag=e.uint32();break;case 4:i.timestamp_diff=e.uint32();break;case 5:i.room_id=e.string();break;case 100:i.infos&&i.infos.length||(i.infos=[]),i.infos.push(d.logreport.ChargeInfo.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&!a.isInteger(e.timestamp_offset_begin))return"timestamp_offset_begin: integer expected";if(null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&!a.isInteger(e.timestamp_offset_end))return"timestamp_offset_end: integer expected";if(null!=e.timestamp_diff_flag&&e.hasOwnProperty("timestamp_diff_flag")&&!a.isInteger(e.timestamp_diff_flag))return"timestamp_diff_flag: integer expected";if(null!=e.timestamp_diff&&e.hasOwnProperty("timestamp_diff")&&!a.isInteger(e.timestamp_diff))return"timestamp_diff: integer expected";if(null!=e.room_id&&e.hasOwnProperty("room_id")&&!a.isString(e.room_id))return"room_id: string expected";if(null!=e.infos&&e.hasOwnProperty("infos")){if(!Array.isArray(e.infos))return"infos: array expected";for(var t=0;t<e.infos.length;++t){var r=d.logreport.ChargeInfo.verify(e.infos[t]);if(r)return"infos."+r}}return null},e.fromObject=function(e){if(e instanceof d.logreport.ChargeInfos)return e;var t=new d.logreport.ChargeInfos;if(null!=e.timestamp_offset_begin&&(t.timestamp_offset_begin=e.timestamp_offset_begin>>>0),null!=e.timestamp_offset_end&&(t.timestamp_offset_end=e.timestamp_offset_end>>>0),null!=e.timestamp_diff_flag&&(t.timestamp_diff_flag=e.timestamp_diff_flag>>>0),null!=e.timestamp_diff&&(t.timestamp_diff=e.timestamp_diff>>>0),null!=e.room_id&&(t.room_id=String(e.room_id)),e.infos){if(!Array.isArray(e.infos))throw TypeError(".logreport.ChargeInfos.infos: array expected");t.infos=[];for(var r=0;r<e.infos.length;++r){if("object"!=typeof e.infos[r])throw TypeError(".logreport.ChargeInfos.infos: object expected");t.infos[r]=d.logreport.ChargeInfo.fromObject(e.infos[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.infos=[]),t.defaults&&(r.timestamp_offset_begin=0,r.timestamp_offset_end=0,r.timestamp_diff_flag=0,r.timestamp_diff=0,r.room_id=""),null!=e.timestamp_offset_begin&&e.hasOwnProperty("timestamp_offset_begin")&&(r.timestamp_offset_begin=e.timestamp_offset_begin),null!=e.timestamp_offset_end&&e.hasOwnProperty("timestamp_offset_end")&&(r.timestamp_offset_end=e.timestamp_offset_end),null!=e.timestamp_diff_flag&&e.hasOwnProperty("timestamp_diff_flag")&&(r.timestamp_diff_flag=e.timestamp_diff_flag),null!=e.timestamp_diff&&e.hasOwnProperty("timestamp_diff")&&(r.timestamp_diff=e.timestamp_diff),null!=e.room_id&&e.hasOwnProperty("room_id")&&(r.room_id=e.room_id),e.infos&&e.infos.length){r.infos=[];for(var i=0;i<e.infos.length;++i)r.infos[i]=d.logreport.ChargeInfo.toObject(e.infos[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.HardwareInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.sys_cpu_used=0,e.prototype.app_cpu_used=0,e.prototype.sys_mem_used=0,e.prototype.app_mem_used=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.sys_cpu_used&&Object.hasOwnProperty.call(e,"sys_cpu_used")&&t.uint32(8).uint32(e.sys_cpu_used),null!=e.app_cpu_used&&Object.hasOwnProperty.call(e,"app_cpu_used")&&t.uint32(16).uint32(e.app_cpu_used),null!=e.sys_mem_used&&Object.hasOwnProperty.call(e,"sys_mem_used")&&t.uint32(24).uint32(e.sys_mem_used),null!=e.app_mem_used&&Object.hasOwnProperty.call(e,"app_mem_used")&&t.uint32(32).uint32(e.app_mem_used),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.logreport.HardwareInfo;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.sys_cpu_used=e.uint32();break;case 2:i.app_cpu_used=e.uint32();break;case 3:i.sys_mem_used=e.uint32();break;case 4:i.app_mem_used=e.uint32();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sys_cpu_used&&e.hasOwnProperty("sys_cpu_used")&&!a.isInteger(e.sys_cpu_used)?"sys_cpu_used: integer expected":null!=e.app_cpu_used&&e.hasOwnProperty("app_cpu_used")&&!a.isInteger(e.app_cpu_used)?"app_cpu_used: integer expected":null!=e.sys_mem_used&&e.hasOwnProperty("sys_mem_used")&&!a.isInteger(e.sys_mem_used)?"sys_mem_used: integer expected":null!=e.app_mem_used&&e.hasOwnProperty("app_mem_used")&&!a.isInteger(e.app_mem_used)?"app_mem_used: integer expected":null},e.fromObject=function(e){if(e instanceof d.logreport.HardwareInfo)return e;var t=new d.logreport.HardwareInfo;return null!=e.sys_cpu_used&&(t.sys_cpu_used=e.sys_cpu_used>>>0),null!=e.app_cpu_used&&(t.app_cpu_used=e.app_cpu_used>>>0),null!=e.sys_mem_used&&(t.sys_mem_used=e.sys_mem_used>>>0),null!=e.app_mem_used&&(t.app_mem_used=e.app_mem_used>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.sys_cpu_used=0,r.app_cpu_used=0,r.sys_mem_used=0,r.app_mem_used=0),null!=e.sys_cpu_used&&e.hasOwnProperty("sys_cpu_used")&&(r.sys_cpu_used=e.sys_cpu_used),null!=e.app_cpu_used&&e.hasOwnProperty("app_cpu_used")&&(r.app_cpu_used=e.app_cpu_used),null!=e.sys_mem_used&&e.hasOwnProperty("sys_mem_used")&&(r.sys_mem_used=e.sys_mem_used),null!=e.app_mem_used&&e.hasOwnProperty("app_mem_used")&&(r.app_mem_used=e.app_mem_used),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.PublishQualityInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.audio_bitrate=0,e.prototype.video_bitrate=0,e.prototype.video_capture_fps=0,e.prototype.video_network_fps=0,e.prototype.uplink_plr=0,e.prototype.rtt=0,e.prototype.audio_network_fps=0,e.prototype.captured_sound_level=0,e.prototype.sample_time_window=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.audio_bitrate&&Object.hasOwnProperty.call(e,"audio_bitrate")&&t.uint32(8).uint32(e.audio_bitrate),null!=e.video_bitrate&&Object.hasOwnProperty.call(e,"video_bitrate")&&t.uint32(16).uint32(e.video_bitrate),null!=e.video_capture_fps&&Object.hasOwnProperty.call(e,"video_capture_fps")&&t.uint32(24).uint32(e.video_capture_fps),null!=e.video_network_fps&&Object.hasOwnProperty.call(e,"video_network_fps")&&t.uint32(32).uint32(e.video_network_fps),null!=e.uplink_plr&&Object.hasOwnProperty.call(e,"uplink_plr")&&t.uint32(40).uint32(e.uplink_plr),null!=e.rtt&&Object.hasOwnProperty.call(e,"rtt")&&t.uint32(48).uint32(e.rtt),null!=e.audio_network_fps&&Object.hasOwnProperty.call(e,"audio_network_fps")&&t.uint32(56).uint32(e.audio_network_fps),null!=e.captured_sound_level&&Object.hasOwnProperty.call(e,"captured_sound_level")&&t.uint32(64).uint32(e.captured_sound_level),null!=e.sample_time_window&&Object.hasOwnProperty.call(e,"sample_time_window")&&t.uint32(800).uint32(e.sample_time_window),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.logreport.PublishQualityInfo;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.audio_bitrate=e.uint32();break;case 2:i.video_bitrate=e.uint32();break;case 3:i.video_capture_fps=e.uint32();break;case 4:i.video_network_fps=e.uint32();break;case 5:i.uplink_plr=e.uint32();break;case 6:i.rtt=e.uint32();break;case 7:i.audio_network_fps=e.uint32();break;case 8:i.captured_sound_level=e.uint32();break;case 100:i.sample_time_window=e.uint32();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.audio_bitrate&&e.hasOwnProperty("audio_bitrate")&&!a.isInteger(e.audio_bitrate)?"audio_bitrate: integer expected":null!=e.video_bitrate&&e.hasOwnProperty("video_bitrate")&&!a.isInteger(e.video_bitrate)?"video_bitrate: integer expected":null!=e.video_capture_fps&&e.hasOwnProperty("video_capture_fps")&&!a.isInteger(e.video_capture_fps)?"video_capture_fps: integer expected":null!=e.video_network_fps&&e.hasOwnProperty("video_network_fps")&&!a.isInteger(e.video_network_fps)?"video_network_fps: integer expected":null!=e.uplink_plr&&e.hasOwnProperty("uplink_plr")&&!a.isInteger(e.uplink_plr)?"uplink_plr: integer expected":null!=e.rtt&&e.hasOwnProperty("rtt")&&!a.isInteger(e.rtt)?"rtt: integer expected":null!=e.audio_network_fps&&e.hasOwnProperty("audio_network_fps")&&!a.isInteger(e.audio_network_fps)?"audio_network_fps: integer expected":null!=e.captured_sound_level&&e.hasOwnProperty("captured_sound_level")&&!a.isInteger(e.captured_sound_level)?"captured_sound_level: integer expected":null!=e.sample_time_window&&e.hasOwnProperty("sample_time_window")&&!a.isInteger(e.sample_time_window)?"sample_time_window: integer expected":null},e.fromObject=function(e){if(e instanceof d.logreport.PublishQualityInfo)return e;var t=new d.logreport.PublishQualityInfo;return null!=e.audio_bitrate&&(t.audio_bitrate=e.audio_bitrate>>>0),null!=e.video_bitrate&&(t.video_bitrate=e.video_bitrate>>>0),null!=e.video_capture_fps&&(t.video_capture_fps=e.video_capture_fps>>>0),null!=e.video_network_fps&&(t.video_network_fps=e.video_network_fps>>>0),null!=e.uplink_plr&&(t.uplink_plr=e.uplink_plr>>>0),null!=e.rtt&&(t.rtt=e.rtt>>>0),null!=e.audio_network_fps&&(t.audio_network_fps=e.audio_network_fps>>>0),null!=e.captured_sound_level&&(t.captured_sound_level=e.captured_sound_level>>>0),null!=e.sample_time_window&&(t.sample_time_window=e.sample_time_window>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.audio_bitrate=0,r.video_bitrate=0,r.video_capture_fps=0,r.video_network_fps=0,r.uplink_plr=0,r.rtt=0,r.audio_network_fps=0,r.captured_sound_level=0,r.sample_time_window=0),null!=e.audio_bitrate&&e.hasOwnProperty("audio_bitrate")&&(r.audio_bitrate=e.audio_bitrate),null!=e.video_bitrate&&e.hasOwnProperty("video_bitrate")&&(r.video_bitrate=e.video_bitrate),null!=e.video_capture_fps&&e.hasOwnProperty("video_capture_fps")&&(r.video_capture_fps=e.video_capture_fps),null!=e.video_network_fps&&e.hasOwnProperty("video_network_fps")&&(r.video_network_fps=e.video_network_fps),null!=e.uplink_plr&&e.hasOwnProperty("uplink_plr")&&(r.uplink_plr=e.uplink_plr),null!=e.rtt&&e.hasOwnProperty("rtt")&&(r.rtt=e.rtt),null!=e.audio_network_fps&&e.hasOwnProperty("audio_network_fps")&&(r.audio_network_fps=e.audio_network_fps),null!=e.captured_sound_level&&e.hasOwnProperty("captured_sound_level")&&(r.captured_sound_level=e.captured_sound_level),null!=e.sample_time_window&&e.hasOwnProperty("sample_time_window")&&(r.sample_time_window=e.sample_time_window),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.PlayQualityInfo=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.audio_bitrate=0,e.prototype.video_bitrate=0,e.prototype.video_network_fps=0,e.prototype.audio_break_count=0,e.prototype.video_break_count=0,e.prototype.downlink_plr=0,e.prototype.peer_to_peer_plr=0,e.prototype.peer_to_peer_delay=0,e.prototype.audio_network_fps=0,e.prototype.audio_break_duration=0,e.prototype.video_break_duration=0,e.prototype.audio_break_rate=0,e.prototype.video_break_rate=0,e.prototype.audio_break_cancel=0,e.prototype.video_break_cancel=0,e.prototype.rtt=0,e.prototype.rendered_sound_level=0,e.prototype.audio_break_cancel_duration=0,e.prototype.video_break_cancel_duration=0,e.prototype.audio_decode_time=0,e.prototype.video_decode_time=0,e.prototype.real_sampling_interval=0,e.prototype.mos=0,e.prototype.audio_decode_fps=0,e.prototype.video_decode_fps=0,e.prototype.video_frames_decoded=0,e.prototype.video_frames_dropped=0,e.prototype.sample_time_window=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.audio_bitrate&&Object.hasOwnProperty.call(e,"audio_bitrate")&&t.uint32(8).uint32(e.audio_bitrate),null!=e.video_bitrate&&Object.hasOwnProperty.call(e,"video_bitrate")&&t.uint32(16).uint32(e.video_bitrate),null!=e.video_network_fps&&Object.hasOwnProperty.call(e,"video_network_fps")&&t.uint32(24).uint32(e.video_network_fps),null!=e.audio_break_count&&Object.hasOwnProperty.call(e,"audio_break_count")&&t.uint32(32).uint32(e.audio_break_count),null!=e.video_break_count&&Object.hasOwnProperty.call(e,"video_break_count")&&t.uint32(40).uint32(e.video_break_count),null!=e.downlink_plr&&Object.hasOwnProperty.call(e,"downlink_plr")&&t.uint32(48).uint32(e.downlink_plr),null!=e.peer_to_peer_plr&&Object.hasOwnProperty.call(e,"peer_to_peer_plr")&&t.uint32(56).uint32(e.peer_to_peer_plr),null!=e.peer_to_peer_delay&&Object.hasOwnProperty.call(e,"peer_to_peer_delay")&&t.uint32(64).uint32(e.peer_to_peer_delay),null!=e.audio_network_fps&&Object.hasOwnProperty.call(e,"audio_network_fps")&&t.uint32(72).uint32(e.audio_network_fps),null!=e.audio_break_duration&&Object.hasOwnProperty.call(e,"audio_break_duration")&&t.uint32(80).uint32(e.audio_break_duration),null!=e.video_break_duration&&Object.hasOwnProperty.call(e,"video_break_duration")&&t.uint32(88).uint32(e.video_break_duration),null!=e.audio_break_rate&&Object.hasOwnProperty.call(e,"audio_break_rate")&&t.uint32(96).uint32(e.audio_break_rate),null!=e.video_break_rate&&Object.hasOwnProperty.call(e,"video_break_rate")&&t.uint32(104).uint32(e.video_break_rate),null!=e.audio_break_cancel&&Object.hasOwnProperty.call(e,"audio_break_cancel")&&t.uint32(112).uint32(e.audio_break_cancel),null!=e.video_break_cancel&&Object.hasOwnProperty.call(e,"video_break_cancel")&&t.uint32(120).uint32(e.video_break_cancel),null!=e.rtt&&Object.hasOwnProperty.call(e,"rtt")&&t.uint32(128).uint32(e.rtt),null!=e.rendered_sound_level&&Object.hasOwnProperty.call(e,"rendered_sound_level")&&t.uint32(136).uint32(e.rendered_sound_level),null!=e.audio_break_cancel_duration&&Object.hasOwnProperty.call(e,"audio_break_cancel_duration")&&t.uint32(144).uint32(e.audio_break_cancel_duration),null!=e.video_break_cancel_duration&&Object.hasOwnProperty.call(e,"video_break_cancel_duration")&&t.uint32(152).uint32(e.video_break_cancel_duration),null!=e.audio_decode_time&&Object.hasOwnProperty.call(e,"audio_decode_time")&&t.uint32(160).uint32(e.audio_decode_time),null!=e.video_decode_time&&Object.hasOwnProperty.call(e,"video_decode_time")&&t.uint32(168).uint32(e.video_decode_time),null!=e.real_sampling_interval&&Object.hasOwnProperty.call(e,"real_sampling_interval")&&t.uint32(176).uint32(e.real_sampling_interval),null!=e.mos&&Object.hasOwnProperty.call(e,"mos")&&t.uint32(184).int32(e.mos),null!=e.audio_decode_fps&&Object.hasOwnProperty.call(e,"audio_decode_fps")&&t.uint32(192).uint32(e.audio_decode_fps),null!=e.video_decode_fps&&Object.hasOwnProperty.call(e,"video_decode_fps")&&t.uint32(200).uint32(e.video_decode_fps),null!=e.video_frames_decoded&&Object.hasOwnProperty.call(e,"video_frames_decoded")&&t.uint32(208).uint32(e.video_frames_decoded),null!=e.video_frames_dropped&&Object.hasOwnProperty.call(e,"video_frames_dropped")&&t.uint32(216).uint32(e.video_frames_dropped),null!=e.sample_time_window&&Object.hasOwnProperty.call(e,"sample_time_window")&&t.uint32(800).uint32(e.sample_time_window),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.logreport.PlayQualityInfo;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.audio_bitrate=e.uint32();break;case 2:i.video_bitrate=e.uint32();break;case 3:i.video_network_fps=e.uint32();break;case 4:i.audio_break_count=e.uint32();break;case 5:i.video_break_count=e.uint32();break;case 6:i.downlink_plr=e.uint32();break;case 7:i.peer_to_peer_plr=e.uint32();break;case 8:i.peer_to_peer_delay=e.uint32();break;case 9:i.audio_network_fps=e.uint32();break;case 10:i.audio_break_duration=e.uint32();break;case 11:i.video_break_duration=e.uint32();break;case 12:i.audio_break_rate=e.uint32();break;case 13:i.video_break_rate=e.uint32();break;case 14:i.audio_break_cancel=e.uint32();break;case 15:i.video_break_cancel=e.uint32();break;case 16:i.rtt=e.uint32();break;case 17:i.rendered_sound_level=e.uint32();break;case 18:i.audio_break_cancel_duration=e.uint32();break;case 19:i.video_break_cancel_duration=e.uint32();break;case 20:i.audio_decode_time=e.uint32();break;case 21:i.video_decode_time=e.uint32();break;case 22:i.real_sampling_interval=e.uint32();break;case 23:i.mos=e.int32();break;case 24:i.audio_decode_fps=e.uint32();break;case 25:i.video_decode_fps=e.uint32();break;case 26:i.video_frames_decoded=e.uint32();break;case 27:i.video_frames_dropped=e.uint32();break;case 100:i.sample_time_window=e.uint32();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.audio_bitrate&&e.hasOwnProperty("audio_bitrate")&&!a.isInteger(e.audio_bitrate)?"audio_bitrate: integer expected":null!=e.video_bitrate&&e.hasOwnProperty("video_bitrate")&&!a.isInteger(e.video_bitrate)?"video_bitrate: integer expected":null!=e.video_network_fps&&e.hasOwnProperty("video_network_fps")&&!a.isInteger(e.video_network_fps)?"video_network_fps: integer expected":null!=e.audio_break_count&&e.hasOwnProperty("audio_break_count")&&!a.isInteger(e.audio_break_count)?"audio_break_count: integer expected":null!=e.video_break_count&&e.hasOwnProperty("video_break_count")&&!a.isInteger(e.video_break_count)?"video_break_count: integer expected":null!=e.downlink_plr&&e.hasOwnProperty("downlink_plr")&&!a.isInteger(e.downlink_plr)?"downlink_plr: integer expected":null!=e.peer_to_peer_plr&&e.hasOwnProperty("peer_to_peer_plr")&&!a.isInteger(e.peer_to_peer_plr)?"peer_to_peer_plr: integer expected":null!=e.peer_to_peer_delay&&e.hasOwnProperty("peer_to_peer_delay")&&!a.isInteger(e.peer_to_peer_delay)?"peer_to_peer_delay: integer expected":null!=e.audio_network_fps&&e.hasOwnProperty("audio_network_fps")&&!a.isInteger(e.audio_network_fps)?"audio_network_fps: integer expected":null!=e.audio_break_duration&&e.hasOwnProperty("audio_break_duration")&&!a.isInteger(e.audio_break_duration)?"audio_break_duration: integer expected":null!=e.video_break_duration&&e.hasOwnProperty("video_break_duration")&&!a.isInteger(e.video_break_duration)?"video_break_duration: integer expected":null!=e.audio_break_rate&&e.hasOwnProperty("audio_break_rate")&&!a.isInteger(e.audio_break_rate)?"audio_break_rate: integer expected":null!=e.video_break_rate&&e.hasOwnProperty("video_break_rate")&&!a.isInteger(e.video_break_rate)?"video_break_rate: integer expected":null!=e.audio_break_cancel&&e.hasOwnProperty("audio_break_cancel")&&!a.isInteger(e.audio_break_cancel)?"audio_break_cancel: integer expected":null!=e.video_break_cancel&&e.hasOwnProperty("video_break_cancel")&&!a.isInteger(e.video_break_cancel)?"video_break_cancel: integer expected":null!=e.rtt&&e.hasOwnProperty("rtt")&&!a.isInteger(e.rtt)?"rtt: integer expected":null!=e.rendered_sound_level&&e.hasOwnProperty("rendered_sound_level")&&!a.isInteger(e.rendered_sound_level)?"rendered_sound_level: integer expected":null!=e.audio_break_cancel_duration&&e.hasOwnProperty("audio_break_cancel_duration")&&!a.isInteger(e.audio_break_cancel_duration)?"audio_break_cancel_duration: integer expected":null!=e.video_break_cancel_duration&&e.hasOwnProperty("video_break_cancel_duration")&&!a.isInteger(e.video_break_cancel_duration)?"video_break_cancel_duration: integer expected":null!=e.audio_decode_time&&e.hasOwnProperty("audio_decode_time")&&!a.isInteger(e.audio_decode_time)?"audio_decode_time: integer expected":null!=e.video_decode_time&&e.hasOwnProperty("video_decode_time")&&!a.isInteger(e.video_decode_time)?"video_decode_time: integer expected":null!=e.real_sampling_interval&&e.hasOwnProperty("real_sampling_interval")&&!a.isInteger(e.real_sampling_interval)?"real_sampling_interval: integer expected":null!=e.mos&&e.hasOwnProperty("mos")&&!a.isInteger(e.mos)?"mos: integer expected":null!=e.audio_decode_fps&&e.hasOwnProperty("audio_decode_fps")&&!a.isInteger(e.audio_decode_fps)?"audio_decode_fps: integer expected":null!=e.video_decode_fps&&e.hasOwnProperty("video_decode_fps")&&!a.isInteger(e.video_decode_fps)?"video_decode_fps: integer expected":null!=e.video_frames_decoded&&e.hasOwnProperty("video_frames_decoded")&&!a.isInteger(e.video_frames_decoded)?"video_frames_decoded: integer expected":null!=e.video_frames_dropped&&e.hasOwnProperty("video_frames_dropped")&&!a.isInteger(e.video_frames_dropped)?"video_frames_dropped: integer expected":null!=e.sample_time_window&&e.hasOwnProperty("sample_time_window")&&!a.isInteger(e.sample_time_window)?"sample_time_window: integer expected":null},e.fromObject=function(e){if(e instanceof d.logreport.PlayQualityInfo)return e;var t=new d.logreport.PlayQualityInfo;return null!=e.audio_bitrate&&(t.audio_bitrate=e.audio_bitrate>>>0),null!=e.video_bitrate&&(t.video_bitrate=e.video_bitrate>>>0),null!=e.video_network_fps&&(t.video_network_fps=e.video_network_fps>>>0),null!=e.audio_break_count&&(t.audio_break_count=e.audio_break_count>>>0),null!=e.video_break_count&&(t.video_break_count=e.video_break_count>>>0),null!=e.downlink_plr&&(t.downlink_plr=e.downlink_plr>>>0),null!=e.peer_to_peer_plr&&(t.peer_to_peer_plr=e.peer_to_peer_plr>>>0),null!=e.peer_to_peer_delay&&(t.peer_to_peer_delay=e.peer_to_peer_delay>>>0),null!=e.audio_network_fps&&(t.audio_network_fps=e.audio_network_fps>>>0),null!=e.audio_break_duration&&(t.audio_break_duration=e.audio_break_duration>>>0),null!=e.video_break_duration&&(t.video_break_duration=e.video_break_duration>>>0),null!=e.audio_break_rate&&(t.audio_break_rate=e.audio_break_rate>>>0),null!=e.video_break_rate&&(t.video_break_rate=e.video_break_rate>>>0),null!=e.audio_break_cancel&&(t.audio_break_cancel=e.audio_break_cancel>>>0),null!=e.video_break_cancel&&(t.video_break_cancel=e.video_break_cancel>>>0),null!=e.rtt&&(t.rtt=e.rtt>>>0),null!=e.rendered_sound_level&&(t.rendered_sound_level=e.rendered_sound_level>>>0),null!=e.audio_break_cancel_duration&&(t.audio_break_cancel_duration=e.audio_break_cancel_duration>>>0),null!=e.video_break_cancel_duration&&(t.video_break_cancel_duration=e.video_break_cancel_duration>>>0),null!=e.audio_decode_time&&(t.audio_decode_time=e.audio_decode_time>>>0),null!=e.video_decode_time&&(t.video_decode_time=e.video_decode_time>>>0),null!=e.real_sampling_interval&&(t.real_sampling_interval=e.real_sampling_interval>>>0),null!=e.mos&&(t.mos=0|e.mos),null!=e.audio_decode_fps&&(t.audio_decode_fps=e.audio_decode_fps>>>0),null!=e.video_decode_fps&&(t.video_decode_fps=e.video_decode_fps>>>0),null!=e.video_frames_decoded&&(t.video_frames_decoded=e.video_frames_decoded>>>0),null!=e.video_frames_dropped&&(t.video_frames_dropped=e.video_frames_dropped>>>0),null!=e.sample_time_window&&(t.sample_time_window=e.sample_time_window>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.audio_bitrate=0,r.video_bitrate=0,r.video_network_fps=0,r.audio_break_count=0,r.video_break_count=0,r.downlink_plr=0,r.peer_to_peer_plr=0,r.peer_to_peer_delay=0,r.audio_network_fps=0,r.audio_break_duration=0,r.video_break_duration=0,r.audio_break_rate=0,r.video_break_rate=0,r.audio_break_cancel=0,r.video_break_cancel=0,r.rtt=0,r.rendered_sound_level=0,r.audio_break_cancel_duration=0,r.video_break_cancel_duration=0,r.audio_decode_time=0,r.video_decode_time=0,r.real_sampling_interval=0,r.mos=0,r.audio_decode_fps=0,r.video_decode_fps=0,r.video_frames_decoded=0,r.video_frames_dropped=0,r.sample_time_window=0),null!=e.audio_bitrate&&e.hasOwnProperty("audio_bitrate")&&(r.audio_bitrate=e.audio_bitrate),null!=e.video_bitrate&&e.hasOwnProperty("video_bitrate")&&(r.video_bitrate=e.video_bitrate),null!=e.video_network_fps&&e.hasOwnProperty("video_network_fps")&&(r.video_network_fps=e.video_network_fps),null!=e.audio_break_count&&e.hasOwnProperty("audio_break_count")&&(r.audio_break_count=e.audio_break_count),null!=e.video_break_count&&e.hasOwnProperty("video_break_count")&&(r.video_break_count=e.video_break_count),null!=e.downlink_plr&&e.hasOwnProperty("downlink_plr")&&(r.downlink_plr=e.downlink_plr),null!=e.peer_to_peer_plr&&e.hasOwnProperty("peer_to_peer_plr")&&(r.peer_to_peer_plr=e.peer_to_peer_plr),null!=e.peer_to_peer_delay&&e.hasOwnProperty("peer_to_peer_delay")&&(r.peer_to_peer_delay=e.peer_to_peer_delay),null!=e.audio_network_fps&&e.hasOwnProperty("audio_network_fps")&&(r.audio_network_fps=e.audio_network_fps),null!=e.audio_break_duration&&e.hasOwnProperty("audio_break_duration")&&(r.audio_break_duration=e.audio_break_duration),null!=e.video_break_duration&&e.hasOwnProperty("video_break_duration")&&(r.video_break_duration=e.video_break_duration),null!=e.audio_break_rate&&e.hasOwnProperty("audio_break_rate")&&(r.audio_break_rate=e.audio_break_rate),null!=e.video_break_rate&&e.hasOwnProperty("video_break_rate")&&(r.video_break_rate=e.video_break_rate),null!=e.audio_break_cancel&&e.hasOwnProperty("audio_break_cancel")&&(r.audio_break_cancel=e.audio_break_cancel),null!=e.video_break_cancel&&e.hasOwnProperty("video_break_cancel")&&(r.video_break_cancel=e.video_break_cancel),null!=e.rtt&&e.hasOwnProperty("rtt")&&(r.rtt=e.rtt),null!=e.rendered_sound_level&&e.hasOwnProperty("rendered_sound_level")&&(r.rendered_sound_level=e.rendered_sound_level),null!=e.audio_break_cancel_duration&&e.hasOwnProperty("audio_break_cancel_duration")&&(r.audio_break_cancel_duration=e.audio_break_cancel_duration),null!=e.video_break_cancel_duration&&e.hasOwnProperty("video_break_cancel_duration")&&(r.video_break_cancel_duration=e.video_break_cancel_duration),null!=e.audio_decode_time&&e.hasOwnProperty("audio_decode_time")&&(r.audio_decode_time=e.audio_decode_time),null!=e.video_decode_time&&e.hasOwnProperty("video_decode_time")&&(r.video_decode_time=e.video_decode_time),null!=e.real_sampling_interval&&e.hasOwnProperty("real_sampling_interval")&&(r.real_sampling_interval=e.real_sampling_interval),null!=e.mos&&e.hasOwnProperty("mos")&&(r.mos=e.mos),null!=e.audio_decode_fps&&e.hasOwnProperty("audio_decode_fps")&&(r.audio_decode_fps=e.audio_decode_fps),null!=e.video_decode_fps&&e.hasOwnProperty("video_decode_fps")&&(r.video_decode_fps=e.video_decode_fps),null!=e.video_frames_decoded&&e.hasOwnProperty("video_frames_decoded")&&(r.video_frames_decoded=e.video_frames_decoded),null!=e.video_frames_dropped&&e.hasOwnProperty("video_frames_dropped")&&(r.video_frames_dropped=e.video_frames_dropped),null!=e.sample_time_window&&e.hasOwnProperty("sample_time_window")&&(r.sample_time_window=e.sample_time_window),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i),e.exports=d},6348:function(e,t,r){"use strict";var i,o=r(2100),n=o.Reader,s=o.Writer,a=o.util,d=o.roots.default||(o.roots.default={});d.webrtc_cmd=((i={}).MetadataPush=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.width=0,e.prototype.height=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.width&&Object.hasOwnProperty.call(e,"width")&&t.uint32(8).uint32(e.width),null!=e.height&&Object.hasOwnProperty.call(e,"height")&&t.uint32(16).uint32(e.height),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.MetadataPush;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.width=e.uint32();break;case 2:i.height=e.uint32();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.width&&e.hasOwnProperty("width")&&!a.isInteger(e.width)?"width: integer expected":null!=e.height&&e.hasOwnProperty("height")&&!a.isInteger(e.height)?"height: integer expected":null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.MetadataPush)return e;var t=new d.webrtc_cmd.MetadataPush;return null!=e.width&&(t.width=e.width>>>0),null!=e.height&&(t.height=e.height>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.width=0,r.height=0),null!=e.width&&e.hasOwnProperty("width")&&(r.width=e.width),null!=e.height&&e.hasOwnProperty("height")&&(r.height=e.height),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.MetadataAck=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.result=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.result&&Object.hasOwnProperty.call(e,"result")&&t.uint32(8).sint32(e.result),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.MetadataAck;e.pos<r;){var o=e.uint32();o>>>3==1?i.result=e.sint32():e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.result&&e.hasOwnProperty("result")&&!a.isInteger(e.result)?"result: integer expected":null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.MetadataAck)return e;var t=new d.webrtc_cmd.MetadataAck;return null!=e.result&&(t.result=0|e.result),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.result=0),null!=e.result&&e.hasOwnProperty("result")&&(r.result=e.result),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.VideoStreamSubscribeReq=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).uint32(e.type),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.VideoStreamSubscribeReq;e.pos<r;){var o=e.uint32();o>>>3==1?i.type=e.uint32():e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.type&&e.hasOwnProperty("type")&&!a.isInteger(e.type)?"type: integer expected":null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.VideoStreamSubscribeReq)return e;var t=new d.webrtc_cmd.VideoStreamSubscribeReq;return null!=e.type&&(t.type=e.type>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.type=0),null!=e.type&&e.hasOwnProperty("type")&&(r.type=e.type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.VideoStreamSubscribeRsp=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.result=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.result&&Object.hasOwnProperty.call(e,"result")&&t.uint32(8).sint32(e.result),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.VideoStreamSubscribeRsp;e.pos<r;){var o=e.uint32();o>>>3==1?i.result=e.sint32():e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.result&&e.hasOwnProperty("result")&&!a.isInteger(e.result)?"result: integer expected":null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.VideoStreamSubscribeRsp)return e;var t=new d.webrtc_cmd.VideoStreamSubscribeRsp;return null!=e.result&&(t.result=0|e.result),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.result=0),null!=e.result&&e.hasOwnProperty("result")&&(r.result=e.result),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.VideoStreamFallbackTypeReq=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).uint32(e.type),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.VideoStreamFallbackTypeReq;e.pos<r;){var o=e.uint32();o>>>3==1?i.type=e.uint32():e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.type&&e.hasOwnProperty("type")&&!a.isInteger(e.type)?"type: integer expected":null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.VideoStreamFallbackTypeReq)return e;var t=new d.webrtc_cmd.VideoStreamFallbackTypeReq;return null!=e.type&&(t.type=e.type>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.type=0),null!=e.type&&e.hasOwnProperty("type")&&(r.type=e.type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.VideoStreamFallbackTypeRsp=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.result=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.result&&Object.hasOwnProperty.call(e,"result")&&t.uint32(8).sint32(e.result),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.VideoStreamFallbackTypeRsp;e.pos<r;){var o=e.uint32();o>>>3==1?i.result=e.sint32():e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.result&&e.hasOwnProperty("result")&&!a.isInteger(e.result)?"result: integer expected":null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.VideoStreamFallbackTypeRsp)return e;var t=new d.webrtc_cmd.VideoStreamFallbackTypeRsp;return null!=e.result&&(t.result=0|e.result),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.result=0),null!=e.result&&e.hasOwnProperty("result")&&(r.result=e.result),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.VideoStreamChangePush=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.change_type=0,e.prototype.video_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.change_type&&Object.hasOwnProperty.call(e,"change_type")&&t.uint32(8).uint32(e.change_type),null!=e.video_type&&Object.hasOwnProperty.call(e,"video_type")&&t.uint32(16).uint32(e.video_type),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.VideoStreamChangePush;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.change_type=e.uint32();break;case 2:i.video_type=e.uint32();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.change_type&&e.hasOwnProperty("change_type")&&!a.isInteger(e.change_type)?"change_type: integer expected":null!=e.video_type&&e.hasOwnProperty("video_type")&&!a.isInteger(e.video_type)?"video_type: integer expected":null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.VideoStreamChangePush)return e;var t=new d.webrtc_cmd.VideoStreamChangePush;return null!=e.change_type&&(t.change_type=e.change_type>>>0),null!=e.video_type&&(t.video_type=e.video_type>>>0),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.change_type=0,r.video_type=0),null!=e.change_type&&e.hasOwnProperty("change_type")&&(r.change_type=e.change_type),null!=e.video_type&&e.hasOwnProperty("video_type")&&(r.video_type=e.video_type),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.VideoStreamChangeAck=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.result=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.result&&Object.hasOwnProperty.call(e,"result")&&t.uint32(8).sint32(e.result),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.VideoStreamChangeAck;e.pos<r;){var o=e.uint32();o>>>3==1?i.result=e.sint32():e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.result&&e.hasOwnProperty("result")&&!a.isInteger(e.result)?"result: integer expected":null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.VideoStreamChangeAck)return e;var t=new d.webrtc_cmd.VideoStreamChangeAck;return null!=e.result&&(t.result=0|e.result),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.result=0),null!=e.result&&e.hasOwnProperty("result")&&(r.result=e.result),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.UserUnregisteredSEIFilterReq=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.sei_filter="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.sei_filter&&Object.hasOwnProperty.call(e,"sei_filter")&&t.uint32(10).string(e.sei_filter),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.UserUnregisteredSEIFilterReq;e.pos<r;){var o=e.uint32();o>>>3==1?i.sei_filter=e.string():e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sei_filter&&e.hasOwnProperty("sei_filter")&&!a.isString(e.sei_filter)?"sei_filter: string expected":null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.UserUnregisteredSEIFilterReq)return e;var t=new d.webrtc_cmd.UserUnregisteredSEIFilterReq;return null!=e.sei_filter&&(t.sei_filter=String(e.sei_filter)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.sei_filter=""),null!=e.sei_filter&&e.hasOwnProperty("sei_filter")&&(r.sei_filter=e.sei_filter),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.UserUnregisteredSEIFilterRsp=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.result=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.result&&Object.hasOwnProperty.call(e,"result")&&t.uint32(8).sint32(e.result),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.UserUnregisteredSEIFilterRsp;e.pos<r;){var o=e.uint32();o>>>3==1?i.result=e.sint32():e.skipType(7&o)}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.result&&e.hasOwnProperty("result")&&!a.isInteger(e.result)?"result: integer expected":null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.UserUnregisteredSEIFilterRsp)return e;var t=new d.webrtc_cmd.UserUnregisteredSEIFilterRsp;return null!=e.result&&(t.result=0|e.result),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.result=0),null!=e.result&&e.hasOwnProperty("result")&&(r.result=e.result),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.WebrtcCmdReqMsg=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.meta_data_push=null,e.prototype.video_stream_sub=null,e.prototype.video_fallback_type=null,e.prototype.video_change_push=null,e.prototype.usr_sei_filter=null,Object.defineProperty(e.prototype,"body",{get:a.oneOfGetter(t=["meta_data_push","video_stream_sub","video_fallback_type","video_change_push","usr_sei_filter"]),set:a.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.meta_data_push&&Object.hasOwnProperty.call(e,"meta_data_push")&&d.webrtc_cmd.MetadataPush.encode(e.meta_data_push,t.uint32(10).fork()).ldelim(),null!=e.video_stream_sub&&Object.hasOwnProperty.call(e,"video_stream_sub")&&d.webrtc_cmd.VideoStreamSubscribeReq.encode(e.video_stream_sub,t.uint32(18).fork()).ldelim(),null!=e.video_fallback_type&&Object.hasOwnProperty.call(e,"video_fallback_type")&&d.webrtc_cmd.VideoStreamFallbackTypeReq.encode(e.video_fallback_type,t.uint32(26).fork()).ldelim(),null!=e.video_change_push&&Object.hasOwnProperty.call(e,"video_change_push")&&d.webrtc_cmd.VideoStreamChangePush.encode(e.video_change_push,t.uint32(34).fork()).ldelim(),null!=e.usr_sei_filter&&Object.hasOwnProperty.call(e,"usr_sei_filter")&&d.webrtc_cmd.UserUnregisteredSEIFilterReq.encode(e.usr_sei_filter,t.uint32(42).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.WebrtcCmdReqMsg;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.meta_data_push=d.webrtc_cmd.MetadataPush.decode(e,e.uint32());break;case 2:i.video_stream_sub=d.webrtc_cmd.VideoStreamSubscribeReq.decode(e,e.uint32());break;case 3:i.video_fallback_type=d.webrtc_cmd.VideoStreamFallbackTypeReq.decode(e,e.uint32());break;case 4:i.video_change_push=d.webrtc_cmd.VideoStreamChangePush.decode(e,e.uint32());break;case 5:i.usr_sei_filter=d.webrtc_cmd.UserUnregisteredSEIFilterReq.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.meta_data_push&&e.hasOwnProperty("meta_data_push")&&(t.body=1,r=d.webrtc_cmd.MetadataPush.verify(e.meta_data_push)))return"meta_data_push."+r;if(null!=e.video_stream_sub&&e.hasOwnProperty("video_stream_sub")){if(1===t.body)return"body: multiple values";if(t.body=1,r=d.webrtc_cmd.VideoStreamSubscribeReq.verify(e.video_stream_sub))return"video_stream_sub."+r}if(null!=e.video_fallback_type&&e.hasOwnProperty("video_fallback_type")){if(1===t.body)return"body: multiple values";if(t.body=1,r=d.webrtc_cmd.VideoStreamFallbackTypeReq.verify(e.video_fallback_type))return"video_fallback_type."+r}if(null!=e.video_change_push&&e.hasOwnProperty("video_change_push")){if(1===t.body)return"body: multiple values";if(t.body=1,r=d.webrtc_cmd.VideoStreamChangePush.verify(e.video_change_push))return"video_change_push."+r}if(null!=e.usr_sei_filter&&e.hasOwnProperty("usr_sei_filter")){if(1===t.body)return"body: multiple values";var r;if(t.body=1,r=d.webrtc_cmd.UserUnregisteredSEIFilterReq.verify(e.usr_sei_filter))return"usr_sei_filter."+r}return null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.WebrtcCmdReqMsg)return e;var t=new d.webrtc_cmd.WebrtcCmdReqMsg;if(null!=e.meta_data_push){if("object"!=typeof e.meta_data_push)throw TypeError(".webrtc_cmd.WebrtcCmdReqMsg.meta_data_push: object expected");t.meta_data_push=d.webrtc_cmd.MetadataPush.fromObject(e.meta_data_push)}if(null!=e.video_stream_sub){if("object"!=typeof e.video_stream_sub)throw TypeError(".webrtc_cmd.WebrtcCmdReqMsg.video_stream_sub: object expected");t.video_stream_sub=d.webrtc_cmd.VideoStreamSubscribeReq.fromObject(e.video_stream_sub)}if(null!=e.video_fallback_type){if("object"!=typeof e.video_fallback_type)throw TypeError(".webrtc_cmd.WebrtcCmdReqMsg.video_fallback_type: object expected");t.video_fallback_type=d.webrtc_cmd.VideoStreamFallbackTypeReq.fromObject(e.video_fallback_type)}if(null!=e.video_change_push){if("object"!=typeof e.video_change_push)throw TypeError(".webrtc_cmd.WebrtcCmdReqMsg.video_change_push: object expected");t.video_change_push=d.webrtc_cmd.VideoStreamChangePush.fromObject(e.video_change_push)}if(null!=e.usr_sei_filter){if("object"!=typeof e.usr_sei_filter)throw TypeError(".webrtc_cmd.WebrtcCmdReqMsg.usr_sei_filter: object expected");t.usr_sei_filter=d.webrtc_cmd.UserUnregisteredSEIFilterReq.fromObject(e.usr_sei_filter)}return t},e.toObject=function(e,t){t||(t={});var r={};return null!=e.meta_data_push&&e.hasOwnProperty("meta_data_push")&&(r.meta_data_push=d.webrtc_cmd.MetadataPush.toObject(e.meta_data_push,t),t.oneofs&&(r.body="meta_data_push")),null!=e.video_stream_sub&&e.hasOwnProperty("video_stream_sub")&&(r.video_stream_sub=d.webrtc_cmd.VideoStreamSubscribeReq.toObject(e.video_stream_sub,t),t.oneofs&&(r.body="video_stream_sub")),null!=e.video_fallback_type&&e.hasOwnProperty("video_fallback_type")&&(r.video_fallback_type=d.webrtc_cmd.VideoStreamFallbackTypeReq.toObject(e.video_fallback_type,t),t.oneofs&&(r.body="video_fallback_type")),null!=e.video_change_push&&e.hasOwnProperty("video_change_push")&&(r.video_change_push=d.webrtc_cmd.VideoStreamChangePush.toObject(e.video_change_push,t),t.oneofs&&(r.body="video_change_push")),null!=e.usr_sei_filter&&e.hasOwnProperty("usr_sei_filter")&&(r.usr_sei_filter=d.webrtc_cmd.UserUnregisteredSEIFilterReq.toObject(e.usr_sei_filter,t),t.oneofs&&(r.body="usr_sei_filter")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i.WebrtcCmdRspMsg=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var t;return e.prototype.meta_data_ack=null,e.prototype.video_stream_sub=null,e.prototype.video_fallback_type=null,e.prototype.video_change_ack=null,e.prototype.usr_sei_filter=null,Object.defineProperty(e.prototype,"body",{get:a.oneOfGetter(t=["meta_data_ack","video_stream_sub","video_fallback_type","video_change_ack","usr_sei_filter"]),set:a.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.meta_data_ack&&Object.hasOwnProperty.call(e,"meta_data_ack")&&d.webrtc_cmd.MetadataAck.encode(e.meta_data_ack,t.uint32(10).fork()).ldelim(),null!=e.video_stream_sub&&Object.hasOwnProperty.call(e,"video_stream_sub")&&d.webrtc_cmd.VideoStreamSubscribeRsp.encode(e.video_stream_sub,t.uint32(18).fork()).ldelim(),null!=e.video_fallback_type&&Object.hasOwnProperty.call(e,"video_fallback_type")&&d.webrtc_cmd.VideoStreamFallbackTypeRsp.encode(e.video_fallback_type,t.uint32(26).fork()).ldelim(),null!=e.video_change_ack&&Object.hasOwnProperty.call(e,"video_change_ack")&&d.webrtc_cmd.VideoStreamChangeAck.encode(e.video_change_ack,t.uint32(34).fork()).ldelim(),null!=e.usr_sei_filter&&Object.hasOwnProperty.call(e,"usr_sei_filter")&&d.webrtc_cmd.UserUnregisteredSEIFilterRsp.encode(e.usr_sei_filter,t.uint32(42).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof n||(e=n.create(e));for(var r=void 0===t?e.len:e.pos+t,i=new d.webrtc_cmd.WebrtcCmdRspMsg;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.meta_data_ack=d.webrtc_cmd.MetadataAck.decode(e,e.uint32());break;case 2:i.video_stream_sub=d.webrtc_cmd.VideoStreamSubscribeRsp.decode(e,e.uint32());break;case 3:i.video_fallback_type=d.webrtc_cmd.VideoStreamFallbackTypeRsp.decode(e,e.uint32());break;case 4:i.video_change_ack=d.webrtc_cmd.VideoStreamChangeAck.decode(e,e.uint32());break;case 5:i.usr_sei_filter=d.webrtc_cmd.UserUnregisteredSEIFilterRsp.decode(e,e.uint32());break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof n||(e=new n(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";var t={};if(null!=e.meta_data_ack&&e.hasOwnProperty("meta_data_ack")&&(t.body=1,r=d.webrtc_cmd.MetadataAck.verify(e.meta_data_ack)))return"meta_data_ack."+r;if(null!=e.video_stream_sub&&e.hasOwnProperty("video_stream_sub")){if(1===t.body)return"body: multiple values";if(t.body=1,r=d.webrtc_cmd.VideoStreamSubscribeRsp.verify(e.video_stream_sub))return"video_stream_sub."+r}if(null!=e.video_fallback_type&&e.hasOwnProperty("video_fallback_type")){if(1===t.body)return"body: multiple values";if(t.body=1,r=d.webrtc_cmd.VideoStreamFallbackTypeRsp.verify(e.video_fallback_type))return"video_fallback_type."+r}if(null!=e.video_change_ack&&e.hasOwnProperty("video_change_ack")){if(1===t.body)return"body: multiple values";if(t.body=1,r=d.webrtc_cmd.VideoStreamChangeAck.verify(e.video_change_ack))return"video_change_ack."+r}if(null!=e.usr_sei_filter&&e.hasOwnProperty("usr_sei_filter")){if(1===t.body)return"body: multiple values";var r;if(t.body=1,r=d.webrtc_cmd.UserUnregisteredSEIFilterRsp.verify(e.usr_sei_filter))return"usr_sei_filter."+r}return null},e.fromObject=function(e){if(e instanceof d.webrtc_cmd.WebrtcCmdRspMsg)return e;var t=new d.webrtc_cmd.WebrtcCmdRspMsg;if(null!=e.meta_data_ack){if("object"!=typeof e.meta_data_ack)throw TypeError(".webrtc_cmd.WebrtcCmdRspMsg.meta_data_ack: object expected");t.meta_data_ack=d.webrtc_cmd.MetadataAck.fromObject(e.meta_data_ack)}if(null!=e.video_stream_sub){if("object"!=typeof e.video_stream_sub)throw TypeError(".webrtc_cmd.WebrtcCmdRspMsg.video_stream_sub: object expected");t.video_stream_sub=d.webrtc_cmd.VideoStreamSubscribeRsp.fromObject(e.video_stream_sub)}if(null!=e.video_fallback_type){if("object"!=typeof e.video_fallback_type)throw TypeError(".webrtc_cmd.WebrtcCmdRspMsg.video_fallback_type: object expected");t.video_fallback_type=d.webrtc_cmd.VideoStreamFallbackTypeRsp.fromObject(e.video_fallback_type)}if(null!=e.video_change_ack){if("object"!=typeof e.video_change_ack)throw TypeError(".webrtc_cmd.WebrtcCmdRspMsg.video_change_ack: object expected");t.video_change_ack=d.webrtc_cmd.VideoStreamChangeAck.fromObject(e.video_change_ack)}if(null!=e.usr_sei_filter){if("object"!=typeof e.usr_sei_filter)throw TypeError(".webrtc_cmd.WebrtcCmdRspMsg.usr_sei_filter: object expected");t.usr_sei_filter=d.webrtc_cmd.UserUnregisteredSEIFilterRsp.fromObject(e.usr_sei_filter)}return t},e.toObject=function(e,t){t||(t={});var r={};return null!=e.meta_data_ack&&e.hasOwnProperty("meta_data_ack")&&(r.meta_data_ack=d.webrtc_cmd.MetadataAck.toObject(e.meta_data_ack,t),t.oneofs&&(r.body="meta_data_ack")),null!=e.video_stream_sub&&e.hasOwnProperty("video_stream_sub")&&(r.video_stream_sub=d.webrtc_cmd.VideoStreamSubscribeRsp.toObject(e.video_stream_sub,t),t.oneofs&&(r.body="video_stream_sub")),null!=e.video_fallback_type&&e.hasOwnProperty("video_fallback_type")&&(r.video_fallback_type=d.webrtc_cmd.VideoStreamFallbackTypeRsp.toObject(e.video_fallback_type,t),t.oneofs&&(r.body="video_fallback_type")),null!=e.video_change_ack&&e.hasOwnProperty("video_change_ack")&&(r.video_change_ack=d.webrtc_cmd.VideoStreamChangeAck.toObject(e.video_change_ack,t),t.oneofs&&(r.body="video_change_ack")),null!=e.usr_sei_filter&&e.hasOwnProperty("usr_sei_filter")&&(r.usr_sei_filter=d.webrtc_cmd.UserUnregisteredSEIFilterRsp.toObject(e.usr_sei_filter,t),t.oneofs&&(r.body="usr_sei_filter")),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),i),e.exports=d},5515:function(e){e.exports=function e(t,r,i){function o(s,a){if(!r[s]){if(!t[s]){if(n)return n(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var c=r[s]={exports:{}};t[s][0].call(c.exports,(function(e){return o(t[s][1][e]||e)}),c,c.exports,e,t,r,i)}return r[s].exports}for(var n=void 0,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,t,r){"use strict";var i=(0,e("./adapter_factory.js").adapterFactory)({window:window});t.exports=i},{"./adapter_factory.js":2}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},r=i.log,c=i.detectBrowser(e),u={browserDetails:c,commonShim:d,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(c.browser){case"chrome":if(!o||!o.shimPeerConnection||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),u;r("adapter.js shimming chrome."),u.browserShim=o,o.shimGetUserMedia(e),o.shimMediaStream(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimAddTrackRemoveTrack(e),o.shimGetSendersWithDtmf(e),o.shimGetStats(e),o.shimSenderReceiverGetStats(e),o.fixNegotiationNeeded(e),d.shimRTCIceCandidate(e),d.shimConnectionState(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e),d.removeAllowExtmapMixed(e);break;case"firefox":if(!s||!s.shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),u;r("adapter.js shimming firefox."),u.browserShim=s,s.shimGetUserMedia(e),s.shimPeerConnection(e),s.shimOnTrack(e),s.shimRemoveStream(e),s.shimSenderGetStats(e),s.shimReceiverGetStats(e),s.shimRTCDataChannel(e),d.shimRTCIceCandidate(e),d.shimConnectionState(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e);break;case"edge":if(!n||!n.shimPeerConnection||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),u;r("adapter.js shimming edge."),u.browserShim=n,n.shimGetUserMedia(e),n.shimGetDisplayMedia(e),n.shimPeerConnection(e),n.shimReplaceTrack(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e);break;case"safari":if(!a||!t.shimSafari)return r("Safari shim is not included in this adapter release."),u;r("adapter.js shimming safari."),u.browserShim=a,a.shimRTCIceServerUrls(e),a.shimCreateOfferLegacy(e),a.shimCallbacksAPI(e),a.shimLocalStreamsAPI(e),a.shimRemoteStreamsAPI(e),a.shimTrackEventTransceiver(e),a.shimGetUserMedia(e),d.shimRTCIceCandidate(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e),d.removeAllowExtmapMixed(e);break;default:r("Unsupported browser!")}return u};var i=c(e("./utils")),o=c(e("./chrome/chrome_shim")),n=c(e("./edge/edge_shim")),s=c(e("./firefox/firefox_shim")),a=c(e("./safari/safari_shim")),d=c(e("./common_shim"));function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}});var n=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return n.shimGetDisplayMedia}}),r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},r.shimOnTrack=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(i){var o;o=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===i.track.id})):{track:i.track};var n=new Event("track");n.track=i.track,n.receiver=o,n.transceiver={receiver:o},n.streams=[t.stream],r.dispatchEvent(n)})),t.stream.getTracks().forEach((function(i){var o;o=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===i.id})):{track:i};var n=new Event("track");n.track=i,n.receiver=o,n.transceiver={receiver:o},n.streams=[t.stream],r.dispatchEvent(n)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else s.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))},r.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){var o=r.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};var o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){o.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((function(e){r._senders.push(t(r,e))}))};var s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],s.apply(this,[e]),e.getTracks().forEach((function(e){var r=t._senders.find((function(t){return t.track===e}));r&&t._senders.splice(t._senders.indexOf(r),1)}))}}else if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},r.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,r,i){var o=this,n=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof arguments[0]))return t.apply(this,[]);var s=function(e){var t={};return e.result().forEach((function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){r[t]=e.stat(t)})),t[r.id]=r})),t},a=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var d=function(e){n[1](a(s(e)))};return t.apply(this,[d,arguments[0]])}return new Promise((function(e,r){t.apply(o,[function(t){e(a(s(t)))},r])})).then(r,i)}}},r.shimSenderReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return s.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var o=e.RTCPeerConnection.prototype.getReceivers;o&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=o.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),s.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return s.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],r=void 0,i=void 0,o=void 0;return this.getSenders().forEach((function(e){e.track===t&&(r?o=!0:r=e)})),this.getReceivers().forEach((function(e){return e.track===t&&(i?o=!0:i=e),e.track===t})),o||r&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return n.apply(this,arguments)}}}},r.shimAddTrackRemoveTrackWithNative=a,r.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=s.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return a(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(r.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var o=new e.MediaStream(t.getTracks());this._streams[t.id]=o,this._reverseStreams[o.id]=t,t=o}i.apply(this,[t])};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var i=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var o=[].slice.call(arguments,1);if(1!==o.length||!o[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var n=this._streams[r.id];if(n)n.addTrack(t),Promise.resolve().then((function(){i.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new e.MediaStream([t]);this._streams[r.id]=s,this._reverseStreams[s.id]=r,this.addStream(s)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(r){var i=c(e,r);t[0].apply(null,[i])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then((function(t){return c(e,t)}))}}));var n=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=u(this,arguments[0]),n.apply(this,arguments)):n.apply(this,arguments)};var d=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=d.get.apply(this);return""===e.type?e:c(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var r=void 0;Object.keys(this._streams).forEach((function(i){t._streams[i].getTracks().find((function(t){return e.track===t}))&&(r=t._streams[i])})),r&&(1===r.getTracks().length?this.removeStream(this._reverseStreams[r.id]):r.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function c(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],o=e._streams[i.id];r=r.replace(new RegExp(o.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})}function u(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],o=e._streams[i.id];r=r.replace(new RegExp(i.id,"g"),o.id)})),new RTCSessionDescription({type:t.type,sdp:r})}},r.shimPeerConnection=function(e){if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}}));var t=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},r.fixNegotiationNeeded=function(e){s.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils.js"));function a(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(i)&&this._shimmedLocalStreams[r.id].push(i):this._shimmedLocalStreams[r.id]=[r,i],i};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var i=this.getSenders();r.apply(this,arguments);var o=this.getSenders().filter((function(e){return-1===i.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(o)};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};var o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(r){var i=t._shimmedLocalStreams[r].indexOf(e);-1!==i&&t._shimmedLocalStreams[r].splice(i,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]})),o.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((function(t){var i=r.video&&r.video.width,o=r.video&&r.video.height,n=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:n||3}},i&&(r.video.mandatory.maxWidth=i),o&&(r.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var r=o.detectBrowser(e),s=function(e){if("object"!==(void 0===e?"undefined":i(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var o="object"===i(e[r])?e[r]:{ideal:e[r]};void 0!==o.exact&&"number"==typeof o.exact&&(o.min=o.max=o.exact);var n=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==o.ideal){t.optional=t.optional||[];var s={};"number"==typeof o.ideal?(s[n("min",r)]=o.ideal,t.optional.push(s),(s={})[n("max",r)]=o.ideal,t.optional.push(s)):(s[n("",r)]=o.ideal,t.optional.push(s))}void 0!==o.exact&&"number"!=typeof o.exact?(t.mandatory=t.mandatory||{},t.mandatory[n("",r)]=o.exact):["min","max"].forEach((function(e){void 0!==o[e]&&(t.mandatory=t.mandatory||{},t.mandatory[n(e,r)]=o[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},a=function(e,o){if(r.version>=61)return o(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var a=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};a((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),a(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=s(e.audio)}if(e&&"object"===i(e.video)){var d=e.video.facingMode;d=d&&("object"===(void 0===d?"undefined":i(d))?d:{ideal:d});var c=r.version<66;if(d&&("user"===d.exact||"environment"===d.exact||"user"===d.ideal||"environment"===d.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||c)){delete e.video.facingMode;var u=void 0;if("environment"===d.exact||"environment"===d.ideal?u=["back","rear"]:"user"!==d.exact&&"user"!==d.ideal||(u=["front"]),u)return t.mediaDevices.enumerateDevices().then((function(t){var r=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return u.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!r&&t.length&&u.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=d.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=s(e.video),n("chrome: "+JSON.stringify(e)),o(e)}))}e.video=s(e.video)}return n("chrome: "+JSON.stringify(e)),o(e)},d=function(e){return r.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,r,i){a(e,(function(e){t.webkitGetUserMedia(e,r,(function(e){i&&i(d(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var c=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return a(e,(function(e){return c(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(d(e))}))}))}}}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils.js"));var n=o.log},{"../utils.js":15}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimRTCIceCandidate=function(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e),o=n.default.parseCandidate(e.candidate),s=Object.assign(r,o);return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,s.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},r.shimMaxMessageSize=function(e){if(!e.RTCSctpTransport&&e.RTCPeerConnection){var t=s.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=function(e){if(!e||!e.sdp)return!1;var t=n.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=n.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r},o=function(e){var r=65536;return"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),r},a=function(e,r){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var o=n.default.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(i=2147483637),i},d=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,r(arguments[0])){var e=i(arguments[0]),t=o(e),n=a(arguments[0],e),s=void 0;s=0===t&&0===n?Number.POSITIVE_INFINITY:0===t||0===n?Math.max(t,n):Math.min(t,n);var c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return s}}),this._sctp=c}return d.apply(this,arguments)}}},r.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},s.wrapPeerConnectionEvent(e,"datachannel",(function(e){return r(e.channel,e.target),e}))}function r(e,t){var r=e.send;e.send=function(){var i=arguments[0],o=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}},r.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}},r.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=s.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),r.apply(this,arguments)}}}};var o,n=(o=e("sdp"))&&o.__esModule?o:{default:o},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var i=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var o=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}}),r.shimPeerConnection=function(e){var t=s.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var i=(0,d.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,a.filterIceServers)(e.iceServers,t.version),s.log("ICE servers after filtering:",e.iceServers)),new i(e)},e.RTCPeerConnection.prototype=i.prototype},r.shimReplaceTrack=function(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var n,s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils")),a=e("./filtericeservers"),d=(n=e("rtcpeerconnection-shim"))&&n.__esModule?n:{default:n}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filterIceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var o="string"==typeof t;return o&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!r?(r=!0,!0):t&&!r})),delete e.url,e.urls=o?t[0]:t,!!t.length}}))};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}});var n=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return n.shimGetDisplayMedia}}),r.shimOnTrack=function(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimPeerConnection=function(e){var t=s.detectBrowser(e);if("object"===(void 0===e?"undefined":i(e))&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}}));var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,r,i){return n.apply(this,[e||null]).then((function(e){if(t.version<53&&!r)try{e.forEach((function(e){e.type=o[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,r){e.set(r,Object.assign({},t,{type:o[t.type]||t.type}))}))}return e})).then(r,i)}}},r.shimSenderGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},r.shimReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r}),s.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},r.shimRemoveStream=function(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(r){r.track&&e.getTracks().includes(r.track)&&t.removeTrack(r)}))})},r.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=o.detectBrowser(e),r=e&&e.navigator,n=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,i){o.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var s=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},a=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":i(e))&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),s(e.audio,"autoGainControl","mozAutoGainControl"),s(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},n&&n.prototype.getSettings){var d=n.prototype.getSettings;n.prototype.getSettings=function(){var e=d.apply(this,arguments);return s(e,"mozAutoGainControl","autoGainControl"),s(e,"mozNoiseSuppression","noiseSuppression"),e}}if(n&&n.prototype.applyConstraints){var c=n.prototype.applyConstraints;n.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":i(e))&&(e=JSON.parse(JSON.stringify(e)),s(e,"autoGainControl","mozAutoGainControl"),s(e,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[e])}}}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimLocalStreamsAPI=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getTracks().forEach((function(i){return t.call(r,i,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e,r){return r&&(this._localStreams?this._localStreams.includes(r)||this._localStreams.push(r):this._localStreams=[r]),t.call(this,e,r)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var i=e.getTracks();this.getSenders().forEach((function(e){i.includes(e.track)&&t.removeTrack(e)}))}})}},r.shimRemoteStreamsAPI=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),t.apply(e,arguments)}}},r.shimCallbacksAPI=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,o=t.createAnswer,n=t.setLocalDescription,s=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var i=arguments.length>=2?arguments[2]:arguments[0],o=r.apply(this,[i]);return t?(o.then(e,t),Promise.resolve()):o},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=o.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var d=function(e,t,r){var i=n.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i};t.setLocalDescription=d,d=function(e,t,r){var i=s.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i},t.setRemoteDescription=d,d=function(e,t,r){var i=a.apply(this,[e]);return r?(i.then(t,r),Promise.resolve()):i},t.addIceCandidate=d}},r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,i=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return i(n(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,i){t.mediaDevices.getUserMedia(e).then(r,i)}.bind(t))},r.shimConstraints=n,r.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var i=[],n=0;n<e.iceServers.length;n++){var s=e.iceServers[n];!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")?(o.deprecated("RTCIceServer.url","RTCIceServer.urls"),(s=JSON.parse(JSON.stringify(s))).urls=s.url,delete s.url,i.push(s)):i.push(e.iceServers[n])}e.iceServers=i}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},r.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video")}return t.apply(this,arguments)}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"));function n(e){return e&&void 0!==e.video?Object.assign({},e,{video:o.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.extractVersion=s,r.wrapPeerConnectionEvent=function(e,t,r){if(e.RTCPeerConnection){var i=e.RTCPeerConnection.prototype,o=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return o.apply(this,arguments);var n=function(e){var t=r(e);t&&i(t)};return this._eventMap=this._eventMap||{},this._eventMap[i]=n,o.apply(this,[e,n])};var n=i.removeEventListener;i.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r])return n.apply(this,arguments);var i=this._eventMap[r];return delete this._eventMap[r],n.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},r.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean."):(o=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},r.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean."):(n=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},r.log=function(){if("object"===("undefined"==typeof window?"undefined":i(window))){if(o)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},r.deprecated=function(e,t){n&&console.warn(e+" is deprecated, please use "+t+" instead.")},r.detectBrowser=function(e){var t=e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=s(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=s(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=s(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=s(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return r},r.compactObject=function e(t){return"object"!==(void 0===t?"undefined":i(t))?t:Object.keys(t).reduce((function(r,o){var n="object"===i(t[o]),s=n?e(t[o]):t[o],a=n&&!Object.keys(s).length;return void 0===s||a?r:Object.assign(r,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},o,s))}),{})},r.walkStats=a,r.filterStats=function(e,t,r){var i=r?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;var n=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&n.push(e)})),n.forEach((function(t){e.forEach((function(r){r.type===i&&r.trackId===t.id&&a(e,r,o)}))})),o};var o=!0,n=!0;function s(e,t,r){var i=e.match(t);return i&&i.length>=r&&parseInt(i[r],10)}function a(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((function(i){i.endsWith("Id")?a(e,e.get(t[i]),r):i.endsWith("Ids")&&t[i].forEach((function(t){a(e,e.get(t),r)}))})))}},{}],16:[function(e,t,r){"use strict";var i=e("sdp");function o(e,t,r,o,n){var s=i.writeRtpDescription(e.kind,t);if(s+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":n||"active"),s+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?s+="a=sendrecv\r\n":e.rtpSender?s+="a=sendonly\r\n":e.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var d="msid:"+(o?o.id:"-")+" "+a+"\r\n";s+="a="+d,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+d,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+d,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),s}function n(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},o=function(e,t,r,o){var n=i(e.parameters.apt,r),s=i(t.parameters.apt,o);return n&&s&&n.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(i){for(var n=0;n<t.codecs.length;n++){var s=t.codecs[n];if(i.name.toLowerCase()===s.name.toLowerCase()&&i.clockRate===s.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&s.parameters.apt&&!o(i,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(i.numChannels,s.numChannels),r.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var i=0;i<t.headerExtensions.length;i++){var o=t.headerExtensions[i];if(e.uri===o.uri){r.headerExtensions.push(o);break}}})),r}function s(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function a(e,t){var r=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return r||e.addRemoteCandidate(t),!r}function d(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}t.exports=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function c(t,r,i,o){var n=new Event("track");n.track=r,n.receiver=i,n.transceiver={receiver:i},n.streams=o,e.setTimeout((function(){t._dispatchEvent("track",n)}))}var u=function(r){var o=this,n=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){o[e]=n[e].bind(n)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw d("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var o="string"==typeof i;return o&&(i=[i]),i=i.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)})),delete e.url,e.urls=o?i[0]:i,!!i.length}}))}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var s=r.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=i.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(u.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(u.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),u.prototype.onicecandidate=null,u.prototype.onaddstream=null,u.prototype.ontrack=null,u.prototype.onremovestream=null,u.prototype.onsignalingstatechange=null,u.prototype.oniceconnectionstatechange=null,u.prototype.onconnectionstatechange=null,u.prototype.onicegatheringstatechange=null,u.prototype.onnegotiationneeded=null,u.prototype.ondatachannel=null,u.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},u.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},u.prototype.getConfiguration=function(){return this._config},u.prototype.getLocalStreams=function(){return this.localStreams},u.prototype.getRemoteStreams=function(){return this.remoteStreams},u.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var o=this._createIceAndDtlsTransports();i.iceTransport=o.iceTransport,i.dtlsTransport=o.dtlsTransport}return t||this.transceivers.push(i),i},u.prototype.addTrack=function(t,r){if(this._isClosed)throw d("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find((function(e){return e.track===t})))throw d("InvalidAccessError","Track already exists.");for(var o=0;o<this.transceivers.length;o++)this.transceivers[o].track||this.transceivers[o].kind!==t.kind||(i=this.transceivers[o]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),i.track=t,i.stream=r,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},u.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach((function(t){r.addTrack(t,e)}));else{var i=e.clone();e.getTracks().forEach((function(e,t){var r=i.getTracks()[t];e.addEventListener("enabled",(function(e){r.enabled=e.enabled}))})),i.getTracks().forEach((function(e){r.addTrack(e,i)}))}},u.prototype.removeTrack=function(t){if(this._isClosed)throw d("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find((function(e){return e.rtpSender===t}));if(!r)throw d("InvalidAccessError","Sender was not created by this connection.");var i=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},u.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var r=t.getSenders().find((function(t){return t.track===e}));r&&t.removeTrack(r)}))},u.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},u.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},u.prototype._createIceGatherer=function(t,r){var i=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var o=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(o,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;o.state=r?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},o.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),o},u.prototype._gather=function(t,r){var o=this,n=this.transceivers[r].iceGatherer;if(!n.onlocalcandidate){var s=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,n.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),n.onlocalcandidate=function(e){if(!(o.usingBundle&&r>0)){var s=new Event("icecandidate");s.candidate={sdpMid:t,sdpMLineIndex:r};var a=e.candidate,d=!a||0===Object.keys(a).length;if(d)"new"!==n.state&&"gathering"!==n.state||(n.state="completed");else{"new"===n.state&&(n.state="gathering"),a.component=1,a.ufrag=n.getLocalParameters().usernameFragment;var c=i.writeCandidate(a);s.candidate=Object.assign(s.candidate,i.parseCandidate(c)),s.candidate.candidate=c,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var u=i.getMediaSections(o._localDescription.sdp);u[s.candidate.sdpMLineIndex]+=d?"a=end-of-candidates\r\n":"a="+s.candidate.candidate+"\r\n",o._localDescription.sdp=i.getDescription(o._localDescription.sdp)+u.join("");var l=o.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==o.iceGatheringState&&(o.iceGatheringState="gathering",o._emitGatheringStateChange()),d||o._dispatchEvent("icecandidate",s),l&&(o._dispatchEvent("icecandidate",new Event("icecandidate")),o.iceGatheringState="complete",o._emitGatheringStateChange())}},e.setTimeout((function(){s.forEach((function(e){n.onlocalcandidate(e)}))}),0)}},u.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(r);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:i}},u.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},u.prototype._transceive=function(e,r,o){var s=n(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(s.encodings=e.sendEncodingParameters,s.rtcp={cname:i.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(s.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(s)),o&&e.rtpReceiver&&s.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?s.encodings=e.recvEncodingParameters:s.encodings=[{}],s.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(s.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(s.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(s))},u.prototype.setLocalDescription=function(e){var t,r,o=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(d("TypeError",'Unsupported type "'+e.type+'"'));if(!s("setLocalDescription",e.type,o.signalingState)||o._isClosed)return Promise.reject(d("InvalidStateError","Can not set local "+e.type+" in state "+o.signalingState));if("offer"===e.type)t=i.splitSections(e.sdp),r=t.shift(),t.forEach((function(e,t){var r=i.parseRtpParameters(e);o.transceivers[t].localCapabilities=r})),o.transceivers.forEach((function(e,t){o._gather(e.mid,t)}));else if("answer"===e.type){t=i.splitSections(o._remoteDescription.sdp),r=t.shift();var a=i.matchPrefix(r,"a=ice-lite").length>0;t.forEach((function(e,t){var s=o.transceivers[t],d=s.iceGatherer,c=s.iceTransport,u=s.dtlsTransport,l=s.localCapabilities,h=s.remoteCapabilities;if(!(i.isRejected(e)&&0===i.matchPrefix(e,"a=bundle-only").length||s.rejected)){var p=i.getIceParameters(e,r),g=i.getDtlsParameters(e,r);a&&(g.role="server"),o.usingBundle&&0!==t||(o._gather(s.mid,t),"new"===c.state&&c.start(d,p,a?"controlling":"controlled"),"new"===u.state&&u.start(g));var f=n(l,h);o._transceive(s,f.codecs.length>0,!1)}}))}return o._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?o._updateSignalingState("have-local-offer"):o._updateSignalingState("stable"),Promise.resolve()},u.prototype.setRemoteDescription=function(o){var u=this;if(-1===["offer","answer"].indexOf(o.type))return Promise.reject(d("TypeError",'Unsupported type "'+o.type+'"'));if(!s("setRemoteDescription",o.type,u.signalingState)||u._isClosed)return Promise.reject(d("InvalidStateError","Can not set remote "+o.type+" in state "+u.signalingState));var l={};u.remoteStreams.forEach((function(e){l[e.id]=e}));var h=[],p=i.splitSections(o.sdp),g=p.shift(),f=i.matchPrefix(g,"a=ice-lite").length>0,_=i.matchPrefix(g,"a=group:BUNDLE ").length>0;u.usingBundle=_;var m=i.matchPrefix(g,"a=ice-options:")[0];return u.canTrickleIceCandidates=!!m&&m.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(s,d){var c=i.splitLines(s),p=i.getKind(s),m=i.isRejected(s)&&0===i.matchPrefix(s,"a=bundle-only").length,v=c[0].substr(2).split(" ")[2],E=i.getDirection(s,g),S=i.parseMsid(s),T=i.getMid(s)||i.generateIdentifier();if(m||"application"===p&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))u.transceivers[d]={mid:T,kind:p,protocol:v,rejected:!0};else{var C,y,R,b,I,O,P,k,L;!m&&u.transceivers[d]&&u.transceivers[d].rejected&&(u.transceivers[d]=u._createTransceiver(p,!0));var A,N,M=i.parseRtpParameters(s);m||(A=i.getIceParameters(s,g),(N=i.getDtlsParameters(s,g)).role="client"),P=i.parseRtpEncodingParameters(s);var w=i.parseRtcpParameters(s),D=i.matchPrefix(s,"a=end-of-candidates",g).length>0,U=i.matchPrefix(s,"a=candidate:").map((function(e){return i.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===o.type||"answer"===o.type)&&!m&&_&&d>0&&u.transceivers[d]&&(u._disposeIceAndDtlsTransports(d),u.transceivers[d].iceGatherer=u.transceivers[0].iceGatherer,u.transceivers[d].iceTransport=u.transceivers[0].iceTransport,u.transceivers[d].dtlsTransport=u.transceivers[0].dtlsTransport,u.transceivers[d].rtpSender&&u.transceivers[d].rtpSender.setTransport(u.transceivers[0].dtlsTransport),u.transceivers[d].rtpReceiver&&u.transceivers[d].rtpReceiver.setTransport(u.transceivers[0].dtlsTransport)),"offer"!==o.type||m)"answer"!==o.type||m||(y=(C=u.transceivers[d]).iceGatherer,R=C.iceTransport,b=C.dtlsTransport,I=C.rtpReceiver,O=C.sendEncodingParameters,k=C.localCapabilities,u.transceivers[d].recvEncodingParameters=P,u.transceivers[d].remoteCapabilities=M,u.transceivers[d].rtcpParameters=w,U.length&&"new"===R.state&&(!f&&!D||_&&0!==d?U.forEach((function(e){a(C.iceTransport,e)})):R.setRemoteCandidates(U)),_&&0!==d||("new"===R.state&&R.start(y,A,"controlling"),"new"===b.state&&b.start(N)),!n(C.localCapabilities,C.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&C.sendEncodingParameters[0].rtx&&delete C.sendEncodingParameters[0].rtx,u._transceive(C,"sendrecv"===E||"recvonly"===E,"sendrecv"===E||"sendonly"===E),!I||"sendrecv"!==E&&"sendonly"!==E?delete C.rtpReceiver:(L=I.track,S?(l[S.stream]||(l[S.stream]=new e.MediaStream),r(L,l[S.stream]),h.push([L,I,l[S.stream]])):(l.default||(l.default=new e.MediaStream),r(L,l.default),h.push([L,I,l.default]))));else{(C=u.transceivers[d]||u._createTransceiver(p)).mid=T,C.iceGatherer||(C.iceGatherer=u._createIceGatherer(d,_)),U.length&&"new"===C.iceTransport.state&&(!D||_&&0!==d?U.forEach((function(e){a(C.iceTransport,e)})):C.iceTransport.setRemoteCandidates(U)),k=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(k.codecs=k.codecs.filter((function(e){return"rtx"!==e.name}))),O=C.sendEncodingParameters||[{ssrc:1001*(2*d+2)}];var B,x=!1;"sendrecv"===E||"sendonly"===E?(x=!C.rtpReceiver,I=C.rtpReceiver||new e.RTCRtpReceiver(C.dtlsTransport,p),x&&(L=I.track,S&&"-"===S.stream||(S?(l[S.stream]||(l[S.stream]=new e.MediaStream,Object.defineProperty(l[S.stream],"id",{get:function(){return S.stream}})),Object.defineProperty(L,"id",{get:function(){return S.track}}),B=l[S.stream]):(l.default||(l.default=new e.MediaStream),B=l.default)),B&&(r(L,B),C.associatedRemoteMediaStreams.push(B)),h.push([L,I,B]))):C.rtpReceiver&&C.rtpReceiver.track&&(C.associatedRemoteMediaStreams.forEach((function(t){var r=t.getTracks().find((function(e){return e.id===C.rtpReceiver.track.id}));r&&function(t,r){r.removeTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(r,t)})),C.associatedRemoteMediaStreams=[]),C.localCapabilities=k,C.remoteCapabilities=M,C.rtpReceiver=I,C.rtcpParameters=w,C.sendEncodingParameters=O,C.recvEncodingParameters=P,u._transceive(u.transceivers[d],!1,x)}}})),void 0===u._dtlsRole&&(u._dtlsRole="offer"===o.type?"active":"passive"),u._remoteDescription={type:o.type,sdp:o.sdp},"offer"===o.type?u._updateSignalingState("have-remote-offer"):u._updateSignalingState("stable"),Object.keys(l).forEach((function(t){var r=l[t];if(r.getTracks().length){if(-1===u.remoteStreams.indexOf(r)){u.remoteStreams.push(r);var i=new Event("addstream");i.stream=r,e.setTimeout((function(){u._dispatchEvent("addstream",i)}))}h.forEach((function(e){var t=e[0],i=e[1];r.id===e[2].id&&c(u,t,i,[r])}))}})),h.forEach((function(e){e[2]||c(u,e[0],e[1],[])})),e.setTimeout((function(){u&&u.transceivers&&u.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},u.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},u.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},u.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},u.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},u.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},u.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(d("InvalidStateError","Can not call createOffer after close"));var n=r.transceivers.filter((function(e){return"audio"===e.kind})).length,s=r.transceivers.filter((function(e){return"video"===e.kind})).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(n=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(s=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(r.transceivers.forEach((function(e){"audio"===e.kind?--n<0&&(e.wantReceive=!1):"video"===e.kind&&--s<0&&(e.wantReceive=!1)}));n>0||s>0;)n>0&&(r._createTransceiver("audio"),n--),s>0&&(r._createTransceiver("video"),s--);var c=i.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach((function(o,n){var s=o.track,a=o.kind,d=o.mid||i.generateIdentifier();o.mid=d,o.iceGatherer||(o.iceGatherer=r._createIceGatherer(n,r.usingBundle));var c=e.RTCRtpSender.getCapabilities(a);t<15019&&(c.codecs=c.codecs.filter((function(e){return"rtx"!==e.name}))),c.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),o.remoteCapabilities&&o.remoteCapabilities.codecs&&o.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),c.headerExtensions.forEach((function(e){(o.remoteCapabilities&&o.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var u=o.sendEncodingParameters||[{ssrc:1001*(2*n+1)}];s&&t>=15019&&"video"===a&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),o.wantReceive&&(o.rtpReceiver=new e.RTCRtpReceiver(o.dtlsTransport,a)),o.localCapabilities=c,o.sendEncodingParameters=u})),"max-compat"!==r._config.bundlePolicy&&(c+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),c+="a=ice-options:trickle\r\n",r.transceivers.forEach((function(e,t){c+=o(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),c+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,c+="a="+i.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(c+="a=end-of-candidates\r\n"))}));var u=new e.RTCSessionDescription({type:"offer",sdp:c});return Promise.resolve(u)},u.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(d("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(d("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var s=i.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(s+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var a=i.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach((function(e,i){if(!(i+1>a)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var d;e.stream&&("audio"===e.kind?d=e.stream.getAudioTracks()[0]:"video"===e.kind&&(d=e.stream.getVideoTracks()[0]),d&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var c=n(e.localCapabilities,e.remoteCapabilities);!c.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=o(e,c,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var c=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(c)},u.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(o,n){if(!r._remoteDescription)return n(d("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var s=e.sdpMLineIndex;if(e.sdpMid)for(var c=0;c<r.transceivers.length;c++)if(r.transceivers[c].mid===e.sdpMid){s=c;break}var u=r.transceivers[s];if(!u)return n(d("OperationError","Can not add ICE candidate"));if(u.rejected)return o();var l=Object.keys(e.candidate).length>0?i.parseCandidate(e.candidate):{};if("tcp"===l.protocol&&(0===l.port||9===l.port))return o();if(l.component&&1!==l.component)return o();if((0===s||s>0&&u.iceTransport!==r.transceivers[0].iceTransport)&&!a(u.iceTransport,l))return n(d("OperationError","Can not add ICE candidate"));var h=e.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(t=i.getMediaSections(r._remoteDescription.sdp))[s]+="a="+(l.type?h:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=i.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var p=0;p<r.transceivers.length&&(r.transceivers[p].rejected||(r.transceivers[p].iceTransport.addRemoteCandidate({}),(t=i.getMediaSections(r._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=i.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));p++);o()}))},u.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)})),!r)throw d("InvalidAccessError","Invalid selector.");return r.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),Promise.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var i=r.prototype.getStats;r.prototype.getStats=function(){return i.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(r){var i;e[r].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(i=e[r]).type]||i.type,t.set(r,e[r])})),t}))}}}));var l=["createOffer","createAnswer"];return l.forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(l=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),u}},{sdp:17}],17:[function(e,t,r){"use strict";var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},i.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},i.getDescription=function(e){var t=i.splitSections(e);return t&&t[0]},i.getMediaSections=function(e){var t=i.splitSections(e);return t.shift(),t},i.matchPrefix=function(e,t){return i.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},i.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":r.relatedAddress=t[i+1];break;case"rport":r.relatedPort=parseInt(t[i+1],10);break;case"tcptype":r.tcpType=t[i+1];break;case"ufrag":r.ufrag=t[i+1],r.usernameFragment=t[i+1];break;default:r[t[i]]=t[i+1]}return r},i.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},i.parseIceOptions=function(e){return e.substr(14).split(" ")},i.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},i.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},i.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},i.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},i.parseFmtp=function(e){for(var t,r={},i=e.substr(e.indexOf(" ")+1).split(";"),o=0;o<i.length;o++)r[(t=i[o].trim().split("="))[0].trim()]=t[1];return r},i.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+r+" "+i.join(";")+"\r\n"}return t},i.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},i.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},i.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(r.attribute=e.substr(t+1,i-t-1),r.value=e.substr(i+1)):r.attribute=e.substr(t+1),r},i.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},i.getMid=function(e){var t=i.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},i.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},i.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:i.matchPrefix(e+t,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},i.getIceParameters=function(e,t){var r=i.splitLines(e);return{usernameFragment:(r=r.concat(i.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:r.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},i.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},i.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=i.splitLines(e)[0].split(" "),o=3;o<r.length;o++){var n=r[o],s=i.matchPrefix(e,"a=rtpmap:"+n+" ")[0];if(s){var a=i.parseRtpMap(s),d=i.matchPrefix(e,"a=fmtp:"+n+" ");switch(a.parameters=d.length?i.parseFmtp(d[0]):{},a.rtcpFeedback=i.matchPrefix(e,"a=rtcp-fb:"+n+" ").map(i.parseRtcpFb),t.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(a.name.toUpperCase())}}}return i.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(i.parseExtmap(e))})),t},i.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){r+=i.writeRtpMap(e),r+=i.writeFmtp(e),r+=i.writeRtcpFb(e)}));var o=0;return t.codecs.forEach((function(e){e.maxptime>o&&(o=e.maxptime)})),o>0&&(r+="a=maxptime:"+o+"\r\n"),r+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){r+=i.writeExtmap(e)})),r},i.parseRtpEncodingParameters=function(e){var t,r=[],o=i.parseRtpParameters(e),n=-1!==o.fecMechanisms.indexOf("RED"),s=-1!==o.fecMechanisms.indexOf("ULPFEC"),a=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),d=a.length>0&&a[0].ssrc,c=i.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));c.length>0&&c[0].length>1&&c[0][0]===d&&(t=c[0][1]),o.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var i={ssrc:d,codecPayloadType:parseInt(e.parameters.apt,10)};d&&t&&(i.rtx={ssrc:t}),r.push(i),n&&((i=JSON.parse(JSON.stringify(i))).fec={ssrc:d,mechanism:s?"red+ulpfec":"red"},r.push(i))}})),0===r.length&&d&&r.push({ssrc:d});var u=i.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=u}))),r},i.parseRtcpParameters=function(e){var t={},r=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var o=i.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=o.length>0,t.compound=0===o.length;var n=i.matchPrefix(e,"a=rtcp-mux");return t.mux=n.length>0,t},i.parseMsid=function(e){var t,r=i.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substr(7).split(" "))[0],track:t[1]};var o=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return o.length>0?{stream:(t=o[0].value.split(" "))[0],track:t[1]}:void 0},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(e,t,r){var o=void 0!==t?t:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||i.generateSessionId())+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.writeMediaSection=function(e,t,r,o){var n=i.writeRtpDescription(e.kind,t);if(n+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),n+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),n+="a=mid:"+e.mid+"\r\n",e.direction?n+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?n+="a=sendrecv\r\n":e.rtpSender?n+="a=sendonly\r\n":e.rtpReceiver?n+="a=recvonly\r\n":n+="a=inactive\r\n",e.rtpSender){var s="msid:"+o.id+" "+e.rtpSender.track.id+"\r\n";n+="a="+s,n+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(n+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,n+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return n+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(n+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),n},i.getDirection=function(e,t){for(var r=i.splitLines(e),o=0;o<r.length;o++)switch(r[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[o].substr(2)}return t?i.getDirection(t):"sendrecv"},i.getKind=function(e){return i.splitLines(e)[0].split(" ")[0].substr(2)},i.isRejected=function(e){return"0"===e.split(" ",2)[1]},i.parseMLine=function(e){var t=i.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},i.parseOLine=function(e){var t=i.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},i.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=i.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=i)},{}]},{},[1])(1)},3827:function(e){"undefined"!=typeof self&&self,e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(i,o,function(t){return e[t]}.bind(null,o));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=79)}({30:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_RTM_ACTION=void 0,function(e){e.LIVE_SEND_SIGNAL="zm.lv.ssg",e.LIVE_RESPOND_JOIN_LIVE="zm.lv.rjl",e.LIVE_PUSH_SIGNAL="zm.lv.pss",e.SERVICE_PUSH="zm.sv.ps",e.SERVICE_SEND="zm.sv.sd"}(t.ZEGO_RTM_ACTION||(t.ZEGO_RTM_ACTION={}))},31:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={ROOM_NOT_EXIST:{code:1002014,msg:"room not exist"},ROOM_INNER_ERROR:{code:1002099,msg:"room inner error"}}},79:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(80);t.default={type:"live",install:function(e,t,r,o){for(var n in i.rtmPros)Object.defineProperty(e.prototype,n,{value:i.rtmPros[n],writable:!1});for(var n in i.servicePros)Object.defineProperty(r.prototype,n,{value:i.servicePros[n],writable:!1}),Object.defineProperty(o.prototype,n,{value:i.servicePros[n],writable:!1});for(var n in i.modulePros)Object.defineProperty(t.prototype,n,{value:i.modulePros[n],writable:!1})}}},80:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.modulePros=t.servicePros=t.rtmPros=void 0;var i=r(30),o=r(31),n=r(81);t.rtmPros={requestJoinLive:function(e,t,r,i,n){var s=this.getRoomModules(n)||this.stateCenter.roomModulesList[0];return s?s.liveHandler.requestJoinLive(e,t,r,i):(r&&r(o.errorCodeList.ROOM_NOT_EXIST,0),!1)},inviteJoinLive:function(e,t,r,i,n){var s=this.getRoomModules(n)||this.stateCenter.roomModulesList[0];return s?s.liveHandler.inviteJoinLive(e,t,r,i):(r&&r(o.errorCodeList.ROOM_NOT_EXIST,0),!1)},endJoinLive:function(e,t,r,i){var n=this.getRoomModules(i)||this.stateCenter.roomModulesList[0];return n?n.liveHandler.endJoinLive(e,t,r):(r&&r(o.errorCodeList.ROOM_NOT_EXIST,0),!1)},respondJoinLive:function(e,t,r,i,n){var s=this.getRoomModules(n)||this.stateCenter.roomModulesList[0];return s?s.liveHandler.respondJoinLive(e,t,r,i):(i&&i(o.errorCodeList.ROOM_NOT_EXIST,0),!1)}},t.servicePros={handlePushSignalMsg:function(e){var t,r=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,o=this.stateCenter.roomModulesList.find((function(e){return e.roomID==r}));o?o.liveHandler.handlePushSignalMsg(e):this.logger.error(i.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}},t.modulePros={initLiveHandler:function(){this.liveHandler=new n.LiveHandler(this.logger,this.stateCenter,this.service,this.liveRoomHandler,this.rtm,this)}}},81:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveHandler=void 0;var i=r(82),o=r(30),n=r(31),s=function(){function e(e,t,r,i,o,n){this.logger=e,this.stateCenter=t,this.service=r,this.liveRoomHandler=i,this.rtm=o,this.room=n,this.joinLiveCallbackMap={},this.joinLiveRequestMap={}}return e.prototype.resetLiveHandler=function(){this.joinLiveCallbackMap={},this.joinLiveRequestMap={}},e.prototype.getSignalCmdContent=function(e,t,r){var i={request_id:e,room_id:this.room.roomID,from_userid:this.stateCenter.idName,from_username:this.stateCenter.nickName,to_userid:t};return null!=r&&(i.result=r),JSON.stringify(i)},e.prototype.requestJoinLive=function(e,t,r,o){var n=this.stateCenter.getRequestId(),s=this.getSignalCmdContent(n,e);return null!=o&&(this.joinLiveCallbackMap[n]=o,this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveRequest,s,e,t,r),!0)},e.prototype.sendSignalCmd=function(e,t,r,i,s){var a=this;if(this.room.isLogin()){var d={sub_cmd:e,signal_msg:t,dest_id_name:[r]};(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendSignalCmd(d,(function(e){i&&i(e.header.seq)}),(function(e){var t=n.errorCodeList.ROOM_INNER_ERROR;if(!e.header||!e.body)return e.code&&e.msg&&(t=e),void(s&&s(t,0));s&&s(a.rtm.getServerError(e.body.err_code),e.header.seq)}),this.room),this.logger.info(o.ZEGO_RTM_ACTION.LIVE_SEND_SIGNAL+" call success"+e)}else this.logger.error(o.ZEGO_RTM_ACTION.LIVE_SEND_SIGNAL+" state error")},e.prototype.inviteJoinLive=function(e,t,r,o){var n=this.stateCenter.getRequestId(),s=this.getSignalCmdContent(n,e);return null!=o&&(this.joinLiveCallbackMap[n]=o,this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveInvite,s,e,t,r),!0)},e.prototype.endJoinLive=function(e,t,r){var o=this.stateCenter.getRequestId(),n=this.getSignalCmdContent(o,e);return this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveStop,n,e,t,r),!0},e.prototype.respondJoinLive=function(e,t,r,n){var s=this.joinLiveRequestMap[e];if(!s)return this.logger.info(o.ZEGO_RTM_ACTION.LIVE_RESPOND_JOIN_LIVE+" no dest id name"),!1;var a=0;!0===t&&(a=1);var d=this.getSignalCmdContent(e,s,a);return this.sendSignalCmd(i.ENUM_SIGNAL_SUB_CMD.joinLiveResult,d,s,r,n),delete this.joinLiveRequestMap[e],!0},e.prototype.handlePushSignalMsg=function(e){var t=JSON.parse(e.body.signal_msg);switch(this.logger.info(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" hpsm= ",t),e.body.sub_cmd){case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveRequest:this.handlePushJoinLiveRequestMsg(t);break;case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveResult:this.handlePushJoinLiveResultMsg(t);break;case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveInvite:this.handlePushJoinLiveInviteMsg(t);break;case i.ENUM_PUSH_SIGNAL_SUB_CMD.pushJoinLiveStop:this.handlePushJoinLiveStopMsg(t)}},e.prototype.handlePushJoinLiveRequestMsg=function(e){var t=e.request_id;if("string"==typeof t){var r=e.from_userid;"string"==typeof r?(this.joinLiveRequestMap[t]=r,this.onRecvJoinLiveRequest(t,e.from_userid,e.from_username,e.room_id),this.logger.info(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" onRecvJoinLiveRequest "+r)):this.logger.error(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no from user")}else this.logger.error(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no requestId")},e.prototype.onRecvJoinLiveRequest=function(e,t,r,i){this.stateCenter.actionListener("recvJoinLiveRequest",e,t,r,i)},e.prototype.handlePushJoinLiveInviteMsg=function(e){var t=e.request_id;if("string"==typeof t){var r=e.from_userid;"string"==typeof r?(this.joinLiveRequestMap[t]=r,this.onRecvInviteJoinLiveRequest(t,e.from_userid,e.from_username,e.room_id),this.logger.info(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" onRecvInviteJoinLiveRequest "+r)):this.logger.error(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no from user")}else this.logger.error(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+"no requestId")},e.prototype.onRecvInviteJoinLiveRequest=function(e,t,r,i){this.stateCenter.actionListener("recvInviteJoinLiveRequest",e,t,r,i)},e.prototype.handlePushJoinLiveResultMsg=function(e){var t=e.request_id;if("string"==typeof t){var r=e.result;if(null!=r){var i=1==r;if(this.joinLiveCallbackMap[t]){var n=this.joinLiveCallbackMap[t];if(!n)return void this.logger.info(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no callback");this.logger.info(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" joinLiveRequest/invite result "+i),delete this.joinLiveCallbackMap[t],n(i,e.from_userid,e.from_username)}}else this.logger.info(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no result")}else this.logger.error(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no requestId")},e.prototype.handlePushJoinLiveStopMsg=function(e){var t=e.request_id;"string"==typeof t?(this.logger.info(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" onRecvEndJoinLiveCommand "+e.from_userid),this.onRecvEndJoinLiveCommand(t,e.from_userid,e.from_username,e.room_id)):this.logger.error(o.ZEGO_RTM_ACTION.LIVE_PUSH_SIGNAL+" no requestId")},e.prototype.onRecvEndJoinLiveCommand=function(e,t,r,i){this.stateCenter.actionListener("recvEndJoinLiveCommand",e,t,r,i)},e}();t.LiveHandler=s},82:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ENUM_PUSH_SIGNAL_SUB_CMD=t.ENUM_SIGNAL_SUB_CMD=void 0,t.ENUM_SIGNAL_SUB_CMD={none:0,joinLiveRequest:1001,joinLiveResult:1002,joinLiveInvite:1003,joinLiveStop:1004},t.ENUM_PUSH_SIGNAL_SUB_CMD={none:0,pushJoinLiveRequest:11001,pushJoinLiveResult:11002,pushJoinLiveInvite:11003,pushJoinLiveStop:11004}}})},1700:function(e){"undefined"!=typeof self&&self,e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(i,o,function(t){return e[t]}.bind(null,o));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=76)}({13:function(e,t,r){var i,o=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function i(e){return!0===(e&&e.__isLong__)}function o(e){var t=Math.clz32(e&-e);return e?31-t:t}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=i;var n={},s={};function a(e,t){var r,i,o;return t?(o=0<=(e>>>=0)&&e<256)&&(i=s[e])?i:(r=c(e,0,!0),o&&(s[e]=r),r):(o=-128<=(e|=0)&&e<128)&&(i=n[e])?i:(r=c(e,e<0?-1:0,!1),o&&(n[e]=r),r)}function d(e,t){if(isNaN(e))return t?v:m;if(t){if(e<0)return v;if(e>=g)return y}else{if(e<=-f)return R;if(e+1>=f)return C}return e<0?d(-e,t).neg():c(e%p|0,e/p|0,t)}function c(e,t,i){return new r(e,t,i)}r.fromInt=a,r.fromNumber=d,r.fromBits=c;var u=Math.pow;function l(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?v:m;if((r=r||10)<2||36<r)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return l(e.substring(1),t,r).neg();for(var o=d(u(r,8)),n=m,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),c=parseInt(e.substring(s,s+a),r);if(a<8){var h=d(u(r,a));n=n.mul(h).add(d(c))}else n=(n=n.mul(o)).add(d(c))}return n.unsigned=t,n}function h(e,t){return"number"==typeof e?d(e,t):"string"==typeof e?l(e,t):c(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=l,r.fromValue=h;var p=4294967296,g=p*p,f=g/2,_=a(1<<24),m=a(0);r.ZERO=m;var v=a(0,!0);r.UZERO=v;var E=a(1);r.ONE=E;var S=a(1,!0);r.UONE=S;var T=a(-1);r.NEG_ONE=T;var C=c(-1,2147483647,!1);r.MAX_VALUE=C;var y=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=y;var R=c(0,-2147483648,!1);r.MIN_VALUE=R;var b=r.prototype;b.toInt=function(){return this.unsigned?this.low>>>0:this.low},b.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},b.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(R)){var t=d(e),r=this.div(t),i=r.mul(t).sub(this);return r.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=d(u(e,6),this.unsigned),n=this,s="";;){var a=n.div(o),c=(n.sub(a.mul(o)).toInt()>>>0).toString(e);if((n=a).isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},b.getHighBits=function(){return this.high},b.getHighBitsUnsigned=function(){return this.high>>>0},b.getLowBits=function(){return this.low},b.getLowBitsUnsigned=function(){return this.low>>>0},b.getNumBitsAbs=function(){if(this.isNegative())return this.eq(R)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},b.isZero=function(){return 0===this.high&&0===this.low},b.eqz=b.isZero,b.isNegative=function(){return!this.unsigned&&this.high<0},b.isPositive=function(){return this.unsigned||this.high>=0},b.isOdd=function(){return 1==(1&this.low)},b.isEven=function(){return 0==(1&this.low)},b.equals=function(e){return i(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},b.eq=b.equals,b.notEquals=function(e){return!this.eq(e)},b.neq=b.notEquals,b.ne=b.notEquals,b.lessThan=function(e){return this.comp(e)<0},b.lt=b.lessThan,b.lessThanOrEqual=function(e){return this.comp(e)<=0},b.lte=b.lessThanOrEqual,b.le=b.lessThanOrEqual,b.greaterThan=function(e){return this.comp(e)>0},b.gt=b.greaterThan,b.greaterThanOrEqual=function(e){return this.comp(e)>=0},b.gte=b.greaterThanOrEqual,b.ge=b.greaterThanOrEqual,b.compare=function(e){if(i(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},b.comp=b.compare,b.negate=function(){return!this.unsigned&&this.eq(R)?R:this.not().add(E)},b.neg=b.negate,b.add=function(e){i(e)||(e=h(e));var t=this.high>>>16,r=65535&this.high,o=this.low>>>16,n=65535&this.low,s=e.high>>>16,a=65535&e.high,d=e.low>>>16,u=0,l=0,p=0,g=0;return p+=(g+=n+(65535&e.low))>>>16,l+=(p+=o+d)>>>16,u+=(l+=r+a)>>>16,u+=t+s,c((p&=65535)<<16|(g&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},b.subtract=function(e){return i(e)||(e=h(e)),this.add(e.neg())},b.sub=b.subtract,b.multiply=function(e){if(this.isZero())return this;if(i(e)||(e=h(e)),t)return c(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?v:m;if(this.eq(R))return e.isOdd()?R:m;if(e.eq(R))return this.isOdd()?R:m;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(_)&&e.lt(_))return d(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,o=65535&this.high,n=this.low>>>16,s=65535&this.low,a=e.high>>>16,u=65535&e.high,l=e.low>>>16,p=65535&e.low,g=0,f=0,E=0,S=0;return E+=(S+=s*p)>>>16,f+=(E+=n*p)>>>16,E&=65535,f+=(E+=s*l)>>>16,g+=(f+=o*p)>>>16,f&=65535,g+=(f+=n*l)>>>16,f&=65535,g+=(f+=s*u)>>>16,g+=r*p+o*l+n*u+s*a,c((E&=65535)<<16|(S&=65535),(g&=65535)<<16|(f&=65535),this.unsigned)},b.mul=b.multiply,b.divide=function(e){if(i(e)||(e=h(e)),e.isZero())throw Error("division by zero");var r,o,n;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?v:m;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return S;n=v}else{if(this.eq(R))return e.eq(E)||e.eq(T)?R:e.eq(R)?E:(r=this.shr(1).div(e).shl(1)).eq(m)?e.isNegative()?E:T:(o=this.sub(e.mul(r)),n=r.add(o.div(e)));if(e.eq(R))return this.unsigned?v:m;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=m}for(o=this;o.gte(e);){r=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(r)/Math.LN2),a=s<=48?1:u(2,s-48),l=d(r),p=l.mul(e);p.isNegative()||p.gt(o);)p=(l=d(r-=a,this.unsigned)).mul(e);l.isZero()&&(l=E),n=n.add(l),o=o.sub(p)}return n},b.div=b.divide,b.modulo=function(e){return i(e)||(e=h(e)),t?c((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},b.mod=b.modulo,b.rem=b.modulo,b.not=function(){return c(~this.low,~this.high,this.unsigned)},b.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},b.clz=b.countLeadingZeros,b.countTrailingZeros=function(){return this.low?o(this.low):o(this.high)+32},b.ctz=b.countTrailingZeros,b.and=function(e){return i(e)||(e=h(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},b.or=function(e){return i(e)||(e=h(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},b.xor=function(e){return i(e)||(e=h(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},b.shiftLeft=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},b.shl=b.shiftLeft,b.shiftRight=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},b.shr=b.shiftRight,b.shiftRightUnsigned=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):c(32===e?this.high:this.high>>>e-32,0,this.unsigned)},b.shru=b.shiftRightUnsigned,b.shr_u=b.shiftRightUnsigned,b.rotateLeft=function(e){var t;return i(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?c(this.high,this.low,this.unsigned):e<32?(t=32-e,c(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),c(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},b.rotl=b.rotateLeft,b.rotateRight=function(e){var t;return i(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?c(this.high,this.low,this.unsigned):e<32?(t=32-e,c(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),c(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},b.rotr=b.rotateRight,b.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},b.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},b.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},b.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},b.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,i){return i?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var I=r;return e.default=I,"default"in e?e.default:e}({});void 0===(i=function(){return o}.apply(t,[]))||(e.exports=i)},14:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={INPUT_PARAM:{code:1100001,msg:"input parm error."},TIMEOUT:{code:1100002,msg:"network timeout."},IM_CONTENT_NULL:{code:1009001,msg:"message content is empty"},IM_CONTENT_TOO_LONG:{code:1009002,msg:"message content is too long"},IM_SEND_FAILED:{code:1009010,msg:"failed to send message"},ROOM_NOT_EXIST:{code:1002014,msg:"room not exist"},ROOM_INNER_ERROR:{code:1002099,msg:"room inner error"},TRANS_FREQUENTLY:{code:1102022,msg:"trans send frequently"},FREQ_LIMITED:{code:1109001,msg:"frequency limited."}}},27:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_RTM_ACTION=void 0,function(e){e.ZEGOEXPRESSWEBRTM_SEND_CUSTOM="zm.scc",e.ZEGOEXPRESSWEBRTM_SEND_BCM="zm.sbcm",e.ZEGOEXPRESSWEBRTM_SEND_RLM="zm.srlm",e.ZEGOEXPRESSWEBRTM_SEND_BRM="zm.sbrm",e.ZEGOEXPRESSWEBRTM_SEND_RAM="zm.sram",e.MESSAGE_SEND_RELIABLE="zm.msg.sdr",e.MESSAGE_FETCH_RELIABLE="zm.msg.frm",e.MESSAGE_RELIABLE_RSP="zm.msg.rlr",e.MESSAGE_RELIABLE_PUSH="zm.msg.rps",e.MESSAGE_SEND_ROOM_MSG="zm.msg.srm",e.MESSAGE_SEND_CUSTOM_MSG="zm.msg.scm",e.MESSAGE_SEND_BIG_MSG="zm.msg.sbm",e.MESSAGE_BIG_MSG_PUSH="zm.msg.bps",e.MESSAGE_SEND_RELAY_MSG="zm.msg.slm",e.SERVICE_PUSH="zm.sv.ps"}(t.ZEGO_RTM_ACTION||(t.ZEGO_RTM_ACTION={}))},28:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTMLogEvent=void 0;var i=r(14),o=function(e){return e};t.ZegoRTMLogEvent={kZegoTaskLiveSendRoomBigIM:{event:"/liveroom/send_big_room_message",room_sid:o,error:{INPUT_PARAM:i.errorCodeList.INPUT_PARAM,IM_CONTENT_NULL:i.errorCodeList.IM_CONTENT_NULL,IM_CONTENT_TOO_LONG:i.errorCodeList.IM_CONTENT_TOO_LONG,ROOM_NOT_EXIST:i.errorCodeList.ROOM_NOT_EXIST}},kZegoTaskLiveRoomSendCustomCommand:{event:"/liveroom/send_custom_command",room_sid:o,error:{INPUT_PARAM:i.errorCodeList.INPUT_PARAM,IM_CONTENT_NULL:i.errorCodeList.IM_CONTENT_NULL,IM_CONTENT_TOO_LONG:i.errorCodeList.IM_CONTENT_TOO_LONG,ROOM_NOT_EXIST:i.errorCodeList.ROOM_NOT_EXIST}},kZegoTaskLiveRoomSendRoomMessage:{event:"/liveroom/send_room_message",room_sid:o,error:{INPUT_PARAM:i.errorCodeList.INPUT_PARAM,IM_CONTENT_NULL:i.errorCodeList.IM_CONTENT_NULL,IM_CONTENT_TOO_LONG:i.errorCodeList.IM_CONTENT_TOO_LONG,ROOM_NOT_EXIST:i.errorCodeList.ROOM_NOT_EXIST}},kZegoTaskLiveRoomSendReliableMessage:{event:"/liveroom/send_reliable_message",room_sid:o,error:{INPUT_PARAM:i.errorCodeList.INPUT_PARAM,TRANS_FREQUENTLY:i.errorCodeList.TRANS_FREQUENTLY,ROOM_NOT_EXIST:i.errorCodeList.ROOM_NOT_EXIST}},kZegoTaskLiveGetRoomBigIM:{event:"/liveroom/get_big_room_message"},kZegoTaskLiveRoomGetRoomMessage:{event:"/liveroom/get_room_message",room_sid:o},kZegoTaskLiveRoomGetCustomCommand:{event:"/liveroom/get_custom_command"}}},29:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_MESSAGE_LENGTH=t.MAX_TRANS_DATA_LENGTH=t.MAX_TRANS_TYPE_LENGTH=t.ERROR_CODES=void 0,t.ERROR_CODES={FETCH_TRANS_UNKNOWN_CHANNEL:1000001108,FETCH_TRANS_UNKNOWN_TYPE:1000001109,FETCH_TRANS_WRONG_SEQ:1000001110},t.MAX_TRANS_TYPE_LENGTH=128,t.MAX_TRANS_DATA_LENGTH=4096,t.MAX_MESSAGE_LENGTH=1024},76:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(77);t.default={type:"message",install:function(e,t,r,o,n,s){for(var a in i.rtmPros)Object.defineProperty(e.prototype,a,{value:i.rtmPros[a],writable:!1});for(var a in i.servicePros)Object.defineProperty(r.prototype,a,{value:i.servicePros[a],writable:!1}),Object.defineProperty(s.prototype,a,{value:i.servicePros[a],writable:!1}),Object.defineProperty(o.prototype,a,{value:i.servicePros[a],writable:!1});for(var a in i.modulePros)Object.defineProperty(t.prototype,a,{value:i.modulePros[a],writable:!1}),Object.defineProperty(n.prototype,a,{value:i.modulePros[a],writable:!1})}}},77:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.modulePros=t.initMessageHandler=t.servicePros=t.handlePushMsg=t.handleBigImMsgRsp=t.handlePushTransMsg=t.handlePushMergeMsg=t.handlePushCustomMsg=t.handlePushRoomMsg=t.rtmPros=void 0;var i=r(27),o=r(28),n=r(29),s=r(78),a=r(14);function d(e,t,r,s){var a=this;return void 0===r&&(r=1),void 0===s&&(s=1),new Promise((function(d,c){var u=a.getReportSeq();a.dataReport.newReport(u,o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.event);var l=a.proxyRes(a.dataReport,u,d,c),h=l.interResolve,p=l.interReject;if("string"!=typeof e||""==e)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BCM+" roomid must be string and not empty"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.INPUT_PARAM," param roomID error");if(void 0===t||""==t)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BCM+" message is empty"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.IM_CONTENT_NULL);if("string"!=typeof t)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BCM+" message must be string"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.INPUT_PARAM," param message error");if(t.length>n.MAX_MESSAGE_LENGTH)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BCM+" message too long"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.IM_CONTENT_TOO_LONG);var g="PUBLIC"==a.stateCenter.type?a.getRoomModules(e):a.stateCenter.priModules;g?(a.dataReport.addMsgInfo(u,{room_sid:o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.room_sid(g.sessionID)}),g.messageHandler.sendRoomMsg(r,s,e,t,h,p)):p(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.ROOM_NOT_EXIST)}))}function c(e,t,r){var s=this;return new Promise((function(d,c){var u=s.getReportSeq();s.dataReport.newReport(u,o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.event);var l=s.proxyRes(s.dataReport,u,d,c),h=l.interResolve,p=l.interReject;if("string"!=typeof e||""==e)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_CUSTOM+" roomid must be string and not empty"),void p(a.errorCodeList.INPUT_PARAM," param roomID error");if(!(r instanceof Array)||r.find((function(e){return"string"!=typeof e})))return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_CUSTOM+" dstMembers must be string array"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.error.INPUT_PARAM," param toUserList error");if("PUBLIC"===s.stateCenter.type&&"string"!=typeof t&&"object"!=typeof t)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_CUSTOM+" custom content must be a non empty string or object"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.error.INPUT_PARAM," param command error");if("PRIVATE"===s.stateCenter.type&&"string"!=typeof t)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_CUSTOM+" custom content must be a not empty string"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.error.INPUT_PARAM," param command error");if("string"==typeof t&&t.length>n.MAX_MESSAGE_LENGTH)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_CUSTOM+" command too long"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.error.IM_CONTENT_TOO_LONG);var g="PUBLIC"==s.stateCenter.type?s.getRoomModules(e):s.stateCenter.priModules;g?(s.dataReport.addMsgInfo(u,{room_sid:o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.room_sid(g.sessionID)}),g.messageHandler.sendCustomCommand(r,t,h,p)):p(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendCustomCommand.error.ROOM_NOT_EXIST)}))}function u(e,t,r,s){var a=this;return void 0===r&&(r=1),void 0===s&&(s=1),new Promise((function(d,c){var u=a.getReportSeq();a.dataReport.newReport(u,o.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.event);var l=a.proxyRes(a.dataReport,u,d,c),h=l.interResolve,p=l.interReject;if("string"!=typeof e||""==e)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BRM+"roomid must be string and not empty"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.error.INPUT_PARAM," param roomID error");if(void 0===t||""==t)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BRM+" message is empty"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.error.IM_CONTENT_NULL);if("string"!=typeof t)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BRM+" message must be string"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.error.INPUT_PARAM," param message error");if(t.length>n.MAX_MESSAGE_LENGTH)return a.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BRM+" message too long"),void p(o.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.error.IM_CONTENT_TOO_LONG);var g="PUBLIC"==a.stateCenter.type?a.getRoomModules(e):a.stateCenter.priModules;g?(a.dataReport.addMsgInfo(u,{room_sid:o.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.room_sid(g.sessionID)}),g.messageHandler.sendBigRoomMessage(r,s,e,t,h,p)):p(o.ZegoRTMLogEvent.kZegoTaskLiveSendRoomBigIM.error.ROOM_NOT_EXIST)}))}function l(e,t,r){var s=this;return new Promise((function(a,d){var c=s.getReportSeq();s.dataReport.newReport(c,o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.event);var u=s.proxyRes(s.dataReport,c,a,d),l=u.interResolve,h=u.interReject;if("string"!=typeof e||""==e)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_BCM+" roomid must be string and not empty"),void h(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendRoomMessage.error.INPUT_PARAM," param roomID error");if(!t||"string"!=typeof t)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_RLM+" type must be string"),void h({errorCode:o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code});if(t.length>n.MAX_TRANS_TYPE_LENGTH)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_RLM+" type is too long"),void h({errorCode:o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code});if(!r||"string"!=typeof r)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_RLM+" data must be string"),void h({errorCode:o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code});if(r.length>n.MAX_TRANS_DATA_LENGTH)return s.logger.error(i.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_RLM+" type is too long"),void h({errorCode:o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.INPUT_PARAM.code});var p="PUBLIC"==s.stateCenter.type?s.getRoomModules(e):s.stateCenter.priModules;p?(s.dataReport.addMsgInfo(c,{room_sid:o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.room_sid(p.sessionID)}),p.messageHandler.sendReliableMessage(t,r,l,h)):h(o.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.ROOM_NOT_EXIST)}))}function h(e){var t=this.handlePushMsg(e),r=t[0];e=t[1],r.messageHandler.handlePushRoomMsg(e)}function p(e){var t=this.handlePushMsg(e),r=t[0];e=t[1],r.messageHandler.handlePushCustomMsg(e)}function g(e){var t,r=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,o="PUBLIC"==this.stateCenter.type?this.rtm.getRoomModules(r):this.stateCenter.priModules;o?o.messageHandler.handlePushMergeMsg(e):this.logger.error(i.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}function f(e){var t=this.handlePushMsg(e),r=t[0];e=t[1],r.messageHandler.handlePushTransMsg(e)}function _(e){var t,r=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,o="PUBLIC"==this.stateCenter.type?this.rtm.getRoomModules(r):this.stateCenter.priModules;o?o.messageHandler.handleBigImMsgRsp(e):this.logger.error(i.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}function m(e){var t,r=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,o=this.rtm.getRoomModules(r);if(o)return[o,e];this.logger.error(i.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))}function v(){this.messageHandler=new s.MessageHandler(this.logger,this.stateCenter,this.dataReport,this.service,this.liveRoomHandler,this.rtm,this)}t.rtmPros={_sendBroadcastMessage:d,sendBroadcastMessage:function(e,t){var r=this;return new Promise((function(i,o){d.call(r,e,t).then((function(e){i({errorCode:e.errorCode,messageID:e.messageID,extendedData:e.extendedData})})).catch((function(e){o(e)}))}))},_sendCustomCommand:c,sendCustomCommand:function(e,t,r){var i=this;return new Promise((function(o,n){c.call(i,e,t,r).then((function(e){o({errorCode:e.errorCode,extendedData:e.extendedData})})).catch((function(e){n(e)}))}))},_sendBarrageMessage:u,sendBarrageMessage:function(e,t){var r=this;return new Promise((function(i,o){u.call(r,e,t).then((function(e){i({errorCode:e.errorCode,messageID:e.messageID,extendedData:e.extendedData})})).catch((function(e){o(e)}))}))},_setRoomExtraInfo:l,setRoomExtraInfo:function(e,t,r){return l.call(this,e,t,r)},sendRelayMessage:function(e,t,r,i,o){var n=this.getRoomModules(o)||this.stateCenter.roomModulesList[0];n?n.messageHandler.sendRelayMessage(e,t,r,i):i&&i(a.errorCodeList.ROOM_NOT_EXIST,0)}},t.handlePushRoomMsg=h,t.handlePushCustomMsg=p,t.handlePushMergeMsg=g,t.handlePushTransMsg=f,t.handleBigImMsgRsp=_,t.handlePushMsg=m,t.servicePros={handlePushRoomMsg:h,handlePushCustomMsg:p,handlePushMergeMsg:g,handlePushTransMsg:f,handleBigImMsgRsp:_,handlePushMsg:m},t.initMessageHandler=v,t.modulePros={initMessageHandler:v}},78:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var o=r(14),n=r(27),s=r(28),a=r(29),d=i(r(13)),c=function(){function e(e,t,r,i,o,n,s){var a=this;this.logger=e,this.stateCenter=t,this.dataReport=r,this.service=i,this.liveRoomHandler=o,this.rtm=n,this.room=s,this.sendRoomMsgTime=0,this.sendRoomMsgInterval=500,this.bigImCallbackMap={},this.bigImLastTimeIndex=0,this.bigIMmessageList=[],this.bigImTimer=null,this.relayTimer=null,this.serverTimeOffset=0,this.datiTimeWindow=0,this.bigimTimeWindow=0,this.isReliable=!1,this.transSeqMap={},this.onRecvReliableMessage=function(e){var t=(e=e.filter((function(e){return e.trans_idname!==a.stateCenter.idName}))).map((function(e){return{key:e.trans_type,value:e.trans_data,updateUser:{userID:e.trans_idname,userName:e.trans_nickname},updateTime:d.default.isLong(e.trans_send_time)?e.trans_send_time.toNumber():e.trans_send_time}}));a.stateCenter.actionListener("roomExtraInfoUpdate",a.room.roomID,t),e.forEach((function(e){a.stateCenter.actionListener("recvReliableMessage",e.trans_type,e.trans_seq,e.trans_data)}))},this.realyMessageList=[]}return e.prototype.loginRsp=function(e){var t=this;if(null!=e.body.ret_timestamp&&"string"==typeof e.body.ret_timestamp){var r=parseFloat(e.body.ret_timestamp);this.serverTimeOffset=0==r?0:e.body.ret_timestamp-(new Date).getTime()}if(e.body.bigim_time_window&&"number"==typeof e.body.bigim_time_window&&(this.bigimTimeWindow=e.body.bigim_time_window),e.body.dati_time_window&&"number"==typeof e.body.dati_time_window&&(this.datiTimeWindow=e.body.dati_time_window),e.body.trans_seqs)for(var i=0;i<e.body.trans_seqs.length;i++){var o=e.body.trans_seqs[i].trans_channel,n=e.body.trans_seqs[i].trans_seq_array;(n=(n=n.filter((function(e){var r=e.trans_type,i=e.trans_seq;return!t.transSeqMap[r]||t.transSeqMap[r].seq<i}))).map((function(e){return{trans_type:e.trans_type,trans_local_seq:e.trans_seq}}))).length>0&&this.fetchReliableMessage(o,n)}},e.prototype.sendReliableMessage=function(e,t,r,i){var a=this;if(this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELIABLE+" call"),this.isReliable)return this.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELIABLE+" send too often"),void i(s.ZegoRTMLogEvent.kZegoTaskLiveRoomSendReliableMessage.error.TRANS_FREQUENTLY);this.transSeqMap[e]||(this.transSeqMap[e]={seq:0});var d={trans_type:e,trans_data:t,trans_local_seq:this.transSeqMap[e].seq,trans_channel:"clt"};this.isReliable=!0,(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendReliableMessage(d,(function(t){a.transSeqMap[e].seq=t.body.trans_seq,a.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELIABLE+" trans "+e+" seq "+t.body.trans_seq),a.isReliable=!1,r({seq:t.header.seq,errorCode:0})}),(function(e){var t=o.errorCodeList.ROOM_INNER_ERROR;e.body&&e.body.err_code?(t=a.rtm.getServerError(e.body.err_code),a.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_ROOM_MSG+"  "+t.msg)):t=e==o.errorCodeList.TIMEOUT?o.errorCodeList.IM_SEND_FAILED:e,a.isReliable=!1,i(t)}),this.room)},e.prototype.fetchReliableMessage=function(e,t){var r=this,i={trans_channel:e,fetch_array:t},o=function(e){r.handleFetchTransRsp(e)};(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).fetchReliableMessage(i,o,o,this.room),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_FETCH_RELIABLE+" call success")},e.prototype.handleFetchTransRsp=function(e){if(e.body&&0!=e.body.err_code)this.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_RSP+" trans send error "+e.body.err_code);else if(e.header&&e.body){var t=e.body.trans_fetch_results,r=[];if(Array.isArray(t)&&t.length>0)for(var i=0;i<t.length;i++){var o=t[i];if(o.err_code!==a.ERROR_CODES.FETCH_TRANS_UNKNOWN_TYPE){var s=o.trans_type,d=o.trans_seq;o.err_code!==a.ERROR_CODES.FETCH_TRANS_WRONG_SEQ?(!this.transSeqMap[s]||this.transSeqMap[s].seq<d?(this.transSeqMap[s]={seq:d},r.push(o)):this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_RSP+" fetch trans seq wrong"),r.length>0&&this.onRecvReliableMessage(r)):(this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_RSP+" fetch trans seq is wrong "+o.err_code),this.transSeqMap[s]={seq:d})}else this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_RSP+" fetch trans unknown type "+o.err_code)}}else this.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_RSP+" trans send error "+e)},e.prototype.handlePushTransMsg=function(e){var t=e.body.trans_type,r=e.body.trans_seq;!this.transSeqMap[t]||this.transSeqMap[t].seq<r?(this.transSeqMap[t]={seq:r},this.onRecvReliableMessage([e.body])):this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_PUSH+" trans seq wrong"),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_RELIABLE_PUSH+" trans "+t+" seq "+r)},e.prototype.sendRoomMsg=function(e,t,r,i,s,a){var d=this;if(!this.room.isLogin())return this.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_ROOM_MSG+" state error"),!1;var c=Date.parse(new Date+"");if(this.sendRoomMsgTime>0&&this.sendRoomMsgTime+this.sendRoomMsgInterval>c)return this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_ROOM_MSG+" freq error"),a&&a(o.errorCodeList.FREQ_LIMITED,0,e,i),!1;this.sendRoomMsgTime=c;var u={msg_category:e,msg_type:1,msg_priority:1,msg_content:i};return(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendRoomMsg(u,(function(e){s({seq:e.header.seq,errorCode:0,messageID:e.body.msg_id})}),(function(e){var t,r,i=o.errorCodeList.ROOM_INNER_ERROR;if(!e.header||!e.body)return e.code&&e.msg&&(i=e),void a({seq:0,errorCode:i.code,messageID:0});i=(t=[d.rtm.getServerError("PRIVATE"==d.stateCenter.type?e.body.code:e.body.err_code),e.body.msg_id])[0],r=t[1],d.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_ROOM_MSG+"  "+i.msg),i==o.errorCodeList.TIMEOUT&&(i=o.errorCodeList.IM_SEND_FAILED),a({seq:e.header.seq,errorCode:i.code,messageID:r})}),this.room),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_ROOM_MSG+"  call success"),!0},e.prototype.handlePushRoomMsg=function(e){var t,r=this;t=this.stateCenter.useNetAgent?this.room.roomSessionID:e.header.session_id;var i=this.rtm.getReportSeq();this.dataReport.newReport(i),this.dataReport.addMsgInfo(i,{room_sid:s.ZegoRTMLogEvent.kZegoTaskLiveRoomGetRoomMessage.room_sid(t)});var o=[];this.stateCenter.useNetAgent?(e.body.msg_data.forEach((function(e){var t={fromUser:{userID:e.id_name,userName:e.nick_name},message:e.msg_content,sendTime:e.send_time.toNumber(),messageID:e.msg_id.toNumber()};o.push(t)})),e.body.server_msg_id=e.body.server_msg_id.toNumber(),e.body.ret_msg_id=e.body.ret_msg_id.toNumber()):e.body.chat_data.forEach((function(e){var t={fromUser:{userID:e.id_name,userName:e.nick_name},message:e.msg_content,sendTime:e.send_time,messageID:e.msg_id};o.push(t),r.dataReport.addMsgInfo(i,{from_msg_id:e.id_name})})),this.dataReport.uploadReport(i,s.ZegoRTMLogEvent.kZegoTaskLiveRoomGetRoomMessage.event),this.stateCenter.actionListener("IMRecvBroadcastMessage",this.room.roomID,o),this.stateCenter.actionListener("_recvRoomMsg",e.body.chat_data,e.body.server_msg_id,e.body.ret_msg_id)},e.prototype.sendCustomCommand=function(e,t,r,i){var s=this;if(!this.room.isLogin())return this.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_CUSTOM_MSG+" state error"),!1;var a={from_userid:this.stateCenter.idName,from_username:this.stateCenter.nickName,request_id:this.stateCenter.getRequestId(),custom_content:t||"",room_id:this.room.roomID},d={dest_id_name:e,custom_msg:JSON.stringify(a)};return(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendCustomCommand(d,(function(e){r({seq:e.header.seq,errorCode:0})}),(function(e){var t,r=s.rtm.getServerError("PRIVATE"==s.stateCenter.type?e.body.code:e.body.err_code);s.logger.error(n.ZEGO_RTM_ACTION.MESSAGE_SEND_CUSTOM_MSG+" "+r.msg),t=r==o.errorCodeList.TIMEOUT?o.errorCodeList.IM_SEND_FAILED:r,i({seq:e.header.seq,errorCode:t.code})}),this.room),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_CUSTOM_MSG+" call success"),!0},e.prototype.handlePushCustomMsg=function(e){var t,r,i,o,n,a=JSON.parse(e.body.custommsg);r=(t=[a.from_userid,a.from_username,a.room_id,a.custom_content])[0],i=t[1],o=t[2],n=t[3];var d=this.rtm.getReportSeq();this.dataReport.newReport(d),this.dataReport.uploadReport(d,s.ZegoRTMLogEvent.kZegoTaskLiveRoomGetCustomCommand.event),this.stateCenter.actionListener("IMRecvCustomCommand",o,{userID:r,userName:i},n)},e.prototype.sendBigRoomMessage=function(e,t,r,i,o,n){var s=this,a=this.bigimTimeWindow,d=this.serverTimeOffset,c=(new Date).getTime()+d,u=this.rtm.getSeq().toString();if(this.bigImCallbackMap[u]={success:o,error:n},0==a){var l={msg_category:e,msg_type:1,msg_content:i,bigmsg_client_id:u};this.sendBigRoomMessageInternal([l],(function(e){s.handleBigImMsgRsp(e)}),(function(e){n&&n(e)}))}else{var h=Math.floor(c/a);if(this.bigImLastTimeIndex<h&&0==this.bigIMmessageList.length){this.bigImLastTimeIndex=h;var p={msg_category:e,msg_type:1,msg_content:i,bigmsg_client_id:u};this.sendBigRoomMessageInternal([p],(function(e){s.handleBigImMsgRsp(e)}),(function(e){n&&n(e)}))}else this.bigIMmessageList.push({msg_category:e,msg_type:1,msg_content:i,bigmsg_client_id:u}),1==this.bigIMmessageList.length&&this.setBigImTimer(d,a)}},e.prototype.sendBigRoomMessageInternal=function(e,t,r){var i={msgs:e};(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendBigRoomMessage(i,(function(e){t(e)}),(function(e){var t=o.errorCodeList.ROOM_INNER_ERROR;e.header&&e.body||(e.code&&e.msg&&(t=e),r(t)),r(t)}),this.room),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_BIG_MSG+" sendBigRoomMessage called")},e.prototype.handleBigImMsgRsp=function(e){this.bigimTimeWindow=e.body.bigim_time_window;for(var t=0;t<e.body.msgs.length;t++){var r=e.body.msgs[t].bigmsg_client_id,i=e.body.msgs[t].bigmsg_id;if(this.bigImCallbackMap[r]){var o=this.bigImCallbackMap[r].success;null!=o&&o({seq:e.header.seq,errorCode:0,messageID:i}),delete this.bigImCallbackMap[r]}}},e.prototype.setBigImTimer=function(e,t){var r=this,i=t-((new Date).getTime()+e)%t,o=this.rtm.generateRandumNumber(t)+i;this.bigImTimer=setTimeout((function(){r.onBigImTimer()}),o)},e.prototype.onBigImTimer=function(){var e=this,t=(new Date).getTime()+this.serverTimeOffset;this.bigImLastTimeIndex=Math.floor(t/this.bigimTimeWindow);for(var r=[],i=[],o=0;o<this.bigIMmessageList.length&&!(o>=20);o++){var n=this.bigIMmessageList[o];r.push({msg_category:n.msg_category,msg_type:n.msg_type,msg_content:n.msg_content,bigmsg_client_id:n.bigmsg_client_id}),i.push(n.bigmsg_client_id)}this.bigIMmessageList.length>20?this.bigIMmessageList.splice(0,20):this.bigIMmessageList=[],this.sendBigRoomMessageInternal(r,(function(t){e.handleBigImMsgRsp(t)}),(function(t,r){for(var o=0;o<i.length;o++){var n=i[o],s=e.bigImCallbackMap[n];s&&(null!=s.error&&s.error(t,r),delete e.bigImCallbackMap[n])}})),this.bigImTimer&&clearTimeout(this.bigImTimer),this.bigImTimer=null,this.bigIMmessageList.length>0&&this.setBigImTimer(this.serverTimeOffset,this.bigimTimeWindow)},e.prototype.handlePushMergeMsg=function(e){for(var t=0;t<e.body.messages.length;t++)14001!==e.body.messages[t].sub_cmd&&"/lr/push/bigim_chat"!==e.body.messages[t].sub_cmd||this.handlePushBigRooMsg(e.body.messages[t].msg_body)},e.prototype.handlePushBigRooMsg=function(e){var t;if("string"==typeof e)try{t=JSON.parse(e)}catch(e){return void this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_BIG_MSG_PUSH+"parse json error")}else t=e;if(t){for(var r=t.room_id,i=[],o=0;o<t.msg_data.length;o++){var s=t.msg_data[o];s.id_name!=this.stateCenter.idName?i.push({idName:s.id_name,nickName:s.nick_name,messageId:s.bigmsg_id,category:s.msg_category,type:s.msg_type,content:s.msg_content,time:s.send_time||d.default.isLong(s.msg_timestamp)&&s.msg_timestamp.toNumber()}):this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_BIG_MSG_PUSH+" self message")}0==i.length?this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_BIG_MSG_PUSH+" no other pushData except self"):this.onRecvBigRoomMessage(i,r),this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_BIG_MSG_PUSH+"call success")}else this.logger.warn(n.ZEGO_RTM_ACTION.MESSAGE_BIG_MSG_PUSH+" cann't find message body")},e.prototype.onRecvBigRoomMessage=function(e,t){var r=this.rtm.getReportSeq();this.dataReport.newReport(r);var i=[];e.forEach((function(e){var t={fromUser:{userID:e.idName,userName:e.nickName},message:e.content,sendTime:e.time,messageID:e.messageId};i.push(t)})),this.dataReport.uploadReport(r,s.ZegoRTMLogEvent.kZegoTaskLiveGetRoomBigIM.event),this.stateCenter.actionListener("IMRecvBarrageMessage",t,i),this.stateCenter.actionListener("_recvBigRoomMessage",e,t)},e.prototype.resetMessageInfo=function(){this.transSeqMap={},this.realyMessageList=[],this.relayTimer&&(clearTimeout(this.relayTimer),this.relayTimer=null),this.bigImLastTimeIndex=0,this.bigIMmessageList=[],this.bigImCallbackMap={},this.bigImTimer&&(clearTimeout(this.bigImTimer),this.bigImTimer=null),this.serverTimeOffset=0,this.datiTimeWindow=0,this.bigimTimeWindow=0},e.prototype.sendRelayMessage=function(e,t,r,i){var o=this.datiTimeWindow,n=this.serverTimeOffset;o>0?(this.realyMessageList.push({type:e,data:t,success:r,error:i}),1==this.realyMessageList.length&&this.setRelayTimer(n,o)):this.sendRelayMessageInternal(e,t,r,i)},e.prototype.sendRelayMessageInternal=function(e,t,r,i){var s=this;this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELAY_MSG+" call");var a={relay_type:e,relay_data:t},d=this.room;(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendRelayMessage(a,(function(e){r&&r(e.header.seq,e.body.relay_result)}),(function(e){var t=o.errorCodeList.ROOM_INNER_ERROR;if(!e.header||!e.body)return e.code&&e.msg&&(t=e),void(i&&i(t,0));i&&i(s.rtm.getServerError(e.body.err_code),e.header.seq)}),d)},e.prototype.setRelayTimer=function(e,t){var r=this,i=2*t-((new Date).getTime()+e)%t,o=this.rtm.generateRandumNumber(i);this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELAY_MSG+" setTimer "+o),this.relayTimer=setTimeout((function(){r.onRelayTimer()}),o)},e.prototype.onRelayTimer=function(){if(0!=this.realyMessageList.length){var e=this.realyMessageList[0];this.sendRelayMessageInternal(e.type,e.data,e.success,e.error),this.relayTimer&&clearTimeout(this.relayTimer),this.relayTimer=null,this.realyMessageList.splice(0,1),this.realyMessageList.length>0&&this.setRelayTimer(this.serverTimeOffset,this.datiTimeWindow)}else this.logger.info(n.ZEGO_RTM_ACTION.MESSAGE_SEND_RELAY_MSG+"  no relay data")},e.prototype.getRoomChatInfo=function(e,t,r,i){if(this.logger.debug("zb.mh.grc call"),this.room.isLogin()){var o={room_header:{room_id:this.room.roomID,room_sid:this.room.roomSid||"0",room_user_session_id:this.room.roomSessionID||"0"},msg_id:e,msg_count:t},n=function(e,t){if(0!==e.body.code)i({errorCode:e.body.code,extendData:e.body.message||""});else{var o=e.body.msg_data.map((function(e){return{fromUser:{userID:e.user_id,userName:e.user_name},message:e.msg_content,sendTime:e.send_time,messageID:e.msg_id}}));r({chatData:o})}};this.service.sendMessage("zegochat_js.room_im_chat_fetch",o,n,n),this.logger.info("zb.mh.grc call success")}else this.logger.error("zb.mh.srm no enter room")},e}();t.MessageHandler=c}})},4119:function(e){"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__4119__}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var __webpack_exports__=__webpack_require__(4780);return __webpack_exports__}()}));

/***/ }),

/***/ "../zego-express-WebRTM/dist/ZegoExpressWebRTM.js":
/*!********************************************************!*\
  !*** ../zego-express-WebRTM/dist/ZegoExpressWebRTM.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(Buffer) {!function(e,t){if(true)module.exports=t();else { var r, n; }}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=33)}([function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DisconnectedType=t.ConnectedType=t.BusinessService=t.ZegoConnectionAgent=t.NET_ACCESS_CONFIG=t.Mode=t.BrokenType=t.NetAgentHttpRequest=t.NetAgentPCRequest=t.createZegoWebSocket=t.LoggerStateCenter=t.ZegoDataReport=t.ZegoLogger=t.MODULE_TIPS=t.LinkedList=t.ListNode=t.getReportSeq=t.getSeq=t.REPORT_ACTION=t.E_CLIENT_TYPE=t.SERVER_ERROR_CODE=t.ENUM_STREAM_UPDATE_CMD=t.MINIUM_HEARTBEAT_INTERVAL=t.NetType=t.ENUM_NETWORK_STATE=t.ENUM_RUN_STATE=t.MAX_MIX_TASK_ID_LENGTH=t.MAX_ROOM_ID_LENGTH=t.MAX_USER_NAME_LENGTH=t.MAX_USER_ID_LENGTH=t.MAX_STREAM_ID_LENGTH=t.MAX_TRY_HEARTBEAT_COUNT=t.SEND_MSG_TIMEOUT=t.SEND_MSG_RESET=t.MAX_TRY_CONNECT_COUNT=t.ENUM_CONNECT_STATE=t.ENUM_SCREEM_RESOLUTION_TYPE=t.ENUM_RESOLUTION_TYPE=t.ENUM_SIGNAL_STATE=t.TermType=t.ERROR_CODES=t.ENUM_REMOTE_TYPE=t.LOG_LEVEL=t.ENUM_LOG_LEVEL=t.ROOMVERSION=t.PROTO_VERSION=void 0,t.PROTO_VERSION="1.15.1",t.ROOMVERSION="V1",function(e){e[e.debug=0]="debug",e[e.info=1]="info",e[e.warn=2]="warn",e[e.error=3]="error",e[e.report=99]="report",e[e.disable=100]="disable"}(t.ENUM_LOG_LEVEL||(t.ENUM_LOG_LEVEL={})),t.LOG_LEVEL={debug:0,info:1,warn:2,error:3,report:99,disable:100},function(e){e[e.disable=0]="disable",e[e.websocket=1]="websocket",e[e.https=2]="https"}(t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={})),t.ERROR_CODES={ROOM_SESSION_ID_ERR:1000000152},function(e){e[e.TT_NONE=0]="TT_NONE",e[e.TT_PC=1]="TT_PC",e[e.TT_IOS=2]="TT_IOS",e[e.TT_ANDROID=3]="TT_ANDROID",e[e.TT_MAC=4]="TT_MAC",e[e.TT_LINUX=5]="TT_LINUX",e[e.TT_WEB=6]="TT_WEB",e[e.TT_MINIPROGRAM=7]="TT_MINIPROGRAM",e[e.TT_UNKNOWN=32]="TT_UNKNOWN"}(t.TermType||(t.TermType={})),function(e){e[e.disconnected=0]="disconnected",e[e.connecting=1]="connecting",e[e.connected=2]="connected"}(t.ENUM_SIGNAL_STATE||(t.ENUM_SIGNAL_STATE={})),t.ENUM_RESOLUTION_TYPE={LOW:{width:320,height:240,frameRate:15,bitRate:300},MEDIUM:{width:640,height:480,frameRate:15,bitRate:800},HIGH:{width:1280,height:720,frameRate:20,bitRate:1500}},t.ENUM_SCREEM_RESOLUTION_TYPE={LOW:{frameRate:20,bitRate:800},MEDIUM:{frameRate:15,bitRate:1200},HIGH:{frameRate:5,bitRate:2e3}},t.ENUM_CONNECT_STATE={disconnect:0,connecting:1,connected:2},t.MAX_TRY_CONNECT_COUNT=1,t.SEND_MSG_RESET=2,t.SEND_MSG_TIMEOUT=1,t.MAX_TRY_HEARTBEAT_COUNT=5,t.MAX_STREAM_ID_LENGTH=256,t.MAX_USER_ID_LENGTH=64,t.MAX_USER_NAME_LENGTH=256,t.MAX_ROOM_ID_LENGTH=128,t.MAX_MIX_TASK_ID_LENGTH=256,function(e){e[e.logout=0]="logout",e[e.trylogin=1]="trylogin",e[e.login=2]="login"}(t.ENUM_RUN_STATE||(t.ENUM_RUN_STATE={})),function(e){e[e.offline=0]="offline",e[e.online=1]="online"}(t.ENUM_NETWORK_STATE||(t.ENUM_NETWORK_STATE={})),function(e){e[e.NT_NONE=0]="NT_NONE",e[e.NT_LINE=1]="NT_LINE",e[e.NT_WIFI=2]="NT_WIFI",e[e.NT_2G=3]="NT_2G",e[e.NT_3G=4]="NT_3G",e[e.NT_4G=5]="NT_4G",e[e.NT_UNKNOWN=32]="NT_UNKNOWN"}(t.NetType||(t.NetType={})),t.MINIUM_HEARTBEAT_INTERVAL=3e3,t.ENUM_STREAM_UPDATE_CMD={added:12001,deleted:12002,updated:12003},t.SERVER_ERROR_CODE=1e4,function(e){e[e.ClientType_None=0]="ClientType_None",e[e.ClientType_H5=1]="ClientType_H5",e[e.ClientType_SmallProgram=2]="ClientType_SmallProgram",e[e.ClientType_Webrtc=3]="ClientType_Webrtc"}(t.E_CLIENT_TYPE||(t.E_CLIENT_TYPE={})),t.REPORT_ACTION={eventStart:"eventStart",eventEndWithMsgInfo:"eventEndWithMsgInfo",addEventMsg:"addEventMsg",addEvent:"addEvent",eventEnd:"eventEnd",addMsgInfo:"addMsgInfo"},t.getSeq=(r=1,function(){return r++}),t.getReportSeq=function(){var e=1;return function(){return e++}}();var o=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.next=null,this.prev=null,this._id=e,this._data=t}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id?this._id:null},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!1,configurable:!0}),e.prototype.hasNext=function(){return this.next&&this.next.id},e.prototype.hasPrev=function(){return this.prev&&this.prev.id},e}();t.ListNode=o;var i=function(){function e(){this.start=new o,this.end=new o,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}return e.prototype.insertBefore=function(e,t){var n=new o(this._idCounter,t);return n.next=e,n.prev=e.prev,e.prev&&(e.prev.next=n),e.prev=n,++this._idCounter,++this._numNodes,n},e.prototype.addLast=function(e){return this.insertBefore(this.end,e)},e.prototype.add=function(e){return this.addLast(e)},e.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},e.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},e.prototype.size=function(){return this._numNodes},e.prototype.getFromFirst=function(e){var t=0,n=this.start.next;if(e>=0)for(;t<e&&null!==n;)n=n.next,++t;else n=null;if(null===n)throw"Index out of bounds.";return n},e.prototype.get=function(e){return 0===e?this.getFirst():e===this._numNodes-1?this.getLast():this.getFromFirst(e)},e.prototype.remove=function(e){return e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),--this._numNodes,e},e.prototype.removeFirst=function(){var e=null;return this._numNodes>0&&this.start.next&&(e=this.remove(this.start.next)),e},e.prototype.removeLast=function(){var e=null;return this._numNodes>0&&this.end.prev&&(e=this.remove(this.end.prev)),e},e.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},e.prototype.each=function(e){for(var t=this.start;t.hasNext();)e(t=t.next)},e.prototype.find=function(e){for(var t=this.start,n=!1,r=null;t.hasNext()&&!n;)e(t=t.next)&&(r=t,n=!0);return r},e.prototype.map=function(e){for(var t=this.start,n=[];t.hasNext();)e(t=t.next)&&n.push(t);return n},e.prototype.push=function(e){return this.addLast(e)},e.prototype.unshift=function(e){this._numNodes>0?this.insertBefore(this.start.next,e):this.insertBefore(this.end,e)},e.prototype.pop=function(){return this.removeLast()},e.prototype.shift=function(){return this.removeFirst()},e}();t.LinkedList=i,t.MODULE_TIPS={MESSAGE:""};var s=n(35);Object.defineProperty(t,"ZegoLogger",{enumerable:!0,get:function(){return s.ZegoLogger}}),Object.defineProperty(t,"ZegoDataReport",{enumerable:!0,get:function(){return s.ZegoDataReport}}),Object.defineProperty(t,"LoggerStateCenter",{enumerable:!0,get:function(){return s.LoggerStateCenter}}),Object.defineProperty(t,"createZegoWebSocket",{enumerable:!0,get:function(){return s.createZegoWebSocket}});var a=n(36);Object.defineProperty(t,"NetAgentPCRequest",{enumerable:!0,get:function(){return a.NetAgentPCRequest}}),Object.defineProperty(t,"NetAgentHttpRequest",{enumerable:!0,get:function(){return a.NetAgentHttpRequest}}),Object.defineProperty(t,"BrokenType",{enumerable:!0,get:function(){return a.BrokenType}}),Object.defineProperty(t,"Mode",{enumerable:!0,get:function(){return a.Mode}}),Object.defineProperty(t,"NET_ACCESS_CONFIG",{enumerable:!0,get:function(){return a.NET_ACCESS_CONFIG}}),Object.defineProperty(t,"ZegoConnectionAgent",{enumerable:!0,get:function(){return a.ZegoConnectionAgent}}),Object.defineProperty(t,"BusinessService",{enumerable:!0,get:function(){return a.BusinessService}}),Object.defineProperty(t,"ConnectedType",{enumerable:!0,get:function(){return a.ConnectedType}}),Object.defineProperty(t,"DisconnectedType",{enumerable:!0,get:function(){return a.DisconnectedType}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={SERVER:{code:0,msg:"liverooom cmd error"},SUCCESS:{code:0,msg:"success."},INIT:{code:2000000001,msg:"init sdk wrong"},NOT_LOGIN:{code:1000002,msg:"not login"},APPID_INVALID:{code:1001004,msg:"appid invalid"},NETWORK_BROKEN:{code:1000017,msg:"network is broken"},INPUT_PARAM:{code:1100001,msg:"input parm error."},TIMEOUT:{code:1100002,msg:"network timeout."},SOCKET_CLOSE:{code:1100003,msg:"socket close"},NET_SOCKET_TIMEOUT:{code:1100004,msg:"net agent timeout"},NET_HB_TIMEOUT:{code:1100005,msg:"net hb timeout"},INIT_SDK_WRONG:{code:1101e3,msg:"init sdk wrong"},ROOM_COUNT_EXCEED:{code:1002001,msg:"login rooms exceeds the upper limit"},USER_ID_NULL:{code:1002005,msg:"user ID is empty"},USER_ID_INVALID_CHARACTER:{code:1002006,msg:"user ID contains illegal characters"},USER_ID_TOO_LONG:{code:1002007,msg:"user ID is too long"},USER_NAME_NULL:{code:1002008,msg:"username is empty"},USER_NAME_TOO_LONG:{code:1002010,msg:"username is too long"},ROOM_ID_NULL:{code:1002011,msg:"room ID is empty"},ROOM_ID_INVALID_CHARACTER:{code:1002012,msg:"room ID contains illegal characters"},ROOM_ID_TOO_LONG:{code:1002013,msg:"room ID is too long"},ROOM_NOT_EXIST:{code:1002014,msg:"room not exist"},LOGIN_TIMEOUT:{code:1002031,msg:"login timeout"},ROOM_MAX_USER_COUNT:{code:1002034,msg:"users logging into the room exceeds the maximum number"},MULTI_ROOM_UNABLE:{code:1002036,msg:"multi room unable"},MULTIPLE_LOGIN_KICKOUT:{code:1002050,msg:"kickout may be the same user ID login other"},NETWORK_RECOVERY:{code:1002051,msg:"network recovery"},ROOM_RETRY_TIMEOUT:{code:1002053,msg:"network is broken and login fail."},MANUAL_KICKOUT:{code:1002055,msg:"server has sent a signal to kick out"},REPEATEDLY_LOGIN:{code:1002056,msg:"user repeatedly login"},REPEATEDLY_ENTER_ROOM:{code:1002057,msg:"user repeatedly enter room"},ALREADY_LOGIN:{code:1002058,msg:"user already logged in"},ROOM_INNER_ERROR:{code:1002099,msg:"room inner error"},HEARTBEAT_TIMEOUT:{code:1102001,msg:"heartbeat timeout."},PARSE_JSON_ERROR:{code:1102011,msg:"parse json error."},LOGIN_PROCESSING:{code:1102012,msg:"login is processing."},LIVEROMM_REQUEST_ERROR:{code:1102013,msg:"liveroom request error."},ZPUSH_REQUEST_FAIL:{code:1102014,msg:"zpush request fail."},LOGIN_STATE_WRONG:{code:1102015,msg:"user login state is wrong."},TOKEN_ERROR:{code:1102016,msg:"token error"},DIAPATCH_ERROR:{code:1102017,msg:"dispatch error"},TOKEN_EXPIRED:{code:1102018,msg:"token expired"},SUBCMD_ERROR:{code:1102019,msg:"subcmd error."},ZEGO_AUTH_ERROR:{code:1102020,msg:"zego auth error."},BIZ_CHANNEL_ERROR:{code:1102021,msg:"biz channel error."}}},function(e,t,n){(function(t){var r;e.exports=(r=r||function(e,r){var o;if("undefined"!=typeof window&&window.crypto&&(o=window.crypto),"undefined"!=typeof self&&self.crypto&&(o=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(o=globalThis.crypto),!o&&"undefined"!=typeof window&&window.msCrypto&&(o=window.msCrypto),!o&&void 0!==t&&t.crypto&&(o=t.crypto),!o)try{o=n(38)}catch(e){}var i=function(){if(o){if("function"==typeof o.getRandomValues)try{return o.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof o.randomBytes)try{return o.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),a={},c=a.lib={},u=c.Base={extend:function(e){var t=s(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=c.WordArray=u.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||p).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var s=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=s<<24-(r+i)%4*8}else for(var a=0;a<o;a+=4)t[r+a>>>2]=n[a>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=u.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(i());return new l.init(t,e)}}),h=a.enc={},p=h.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new l.init(n,t/2)}},f=h.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new l.init(n,t)}},d=h.Utf8={stringify:function(e){try{return decodeURIComponent(escape(f.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return f.parse(unescape(encodeURIComponent(e)))}},_=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,o=r.words,i=r.sigBytes,s=this.blockSize,a=i/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,u=e.min(4*c,i);if(c){for(var h=0;h<c;h+=s)this._doProcessBlock(o,h);n=o.splice(0,c),r.sigBytes-=u}return new l.init(n,u)},clone:function(){var e=u.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),g=(c.Hasher=_.extend({cfg:u.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){_.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new g.HMAC.init(e,n).finalize(t)}}}),a.algo={});return a}(Math),r)}).call(this,n(11))},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ClientUtil=void 0;var i=n(37),s=n(0),a=o(n(15)),c=o(n(18)),u=n(1),l=function(){function e(){}return e.checkConfigParam=function(e,t,n){return e&&"number"==typeof e&&this.checkInteger(e)?!(!t||"string"!=typeof t&&!Array.isArray(t)||""==t)||(n.error("ccp.0 server must be string or string array and not empty"),!1):(n.error("ccp.0 appid must be positive integer number and not empty"),!1)},e.checkPriConfigParam=function(e,t,n,r,o){return e&&"number"==typeof e&&this.checkInteger(e)?t&&"string"==typeof t?"object"!=typeof n||"string"!=typeof n.deviceID?(o.error("ccp.0 deviceID must be string and not empty"),!1):1===r||0===r||(o.error("ccp.0 anType must be 0 or 1"),!1):(o.error("ccp.0 dispatchServer must be string and not empty"),!1):(o.error("ccp.0 appid must be positive integer number and not empty"),!1)},e.checkIllegalCharacters=function(e){return/^([0-9a-zA-Z#!$%&()`'+-;<=.>@^_~,\\*])+$/.test(e)&&/^[^:/]*$/g.test(e)},e.isUrl=function(e){return!!(e.startsWith("rtmp://")||e.startsWith("https://")&&e.endsWith(".flv")||e.startsWith("https://")&&e.endsWith(".m3u8"))},e.registerCallback=function(e,t,n){var r,o;t.success&&(r=t.success,n[e+"SuccessCallback"]=r),t.error&&(o=t.error,n[e+"ErrorCallback"]=o)},e.actionErrorCallback=function(e,t){return t[e+"ErrorCallback"]},e.actionSuccessCallback=function(e,t){return t[e+"SuccessCallback"]},e.logReportCallback=function(t,n,r,o){e.registerCallback(t,{success:function(t,o){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];e.dataReportEvent(n,r,t,o,i)}},o)},e.proxyRes=function(t,n,r,o){return{interResolve:function(e){t.uploadReport(n),r(e)},interReject:function(r,i){var s;void 0===i&&(i=""),(s=r.code<2e9&&r.code>1e9?e.decodeServerError(r.code,r.msg):{code:r.code,message:r.msg})&&t.addMsgInfo(n,{error:s.code,message:s.message+i}),t.uploadReport(n),o({errorCode:r.code||r.errorCode})}}},e.getServerError=function(e){var t={1:"parse json error.",1001:"login is processing.",1002:"liveroom request error.",1003:"zpush connect fail.",1004:"zpush handshake fail.",1005:"zpush login fail.",1006:"user login state is wrong.",1007:"got no zpush addr",1008:"token error",1009:"dispatch error",1010:"token expired",1011:"token format error",2002:"biz channel error",1e9:"liveroom cmd error, code:",1000002001:"need relogin",1000002002:"third token auth error",1000002003:"token nonce type should be int64",1000002004:"token appid type  should be uint32",1000002005:"token timeout type should be int64",1000002006:"token user_id type should be string",1000002007:"token room_id type should be string",1000002008:"token format error",1000002009:"token privilege type should be map",1000002010:"token expire_time type should be int64",1000002011:"token user_id type should be string",1000002012:"token not exist",1000002013:"token update error",1000002014:"token not need to check"};if(0===e)return u.errorCodeList.SUCCESS;var n=r({},u.errorCodeList.ROOM_INNER_ERROR);if(n.code=e,e>1e9){var o=t[e];n.msg=o?"liveroom cmd error, code: "+e+", message: "+o:t[1e9]+e}else n.msg=t[e]?t[e]+" code:"+e:"unknown error code:"+e;return n},e.unregisterCallback=function(e,t){delete t[e+"SuccessCallback"],delete t[e+"ErrorCallback"]},e.decodeServerError=function(e,t){var n={code:-1,message:"server error"};return n.code=e>1e9?e-1e9+52e6:e+2002e6,t&&(n.message=t),n},e.getLiveRoomError=function(e,t){var n={1016:"MULTI_ROOM_UNABLE",1105:"ROOM_MAX_USER_COUNT",1012:"PUBLISHER_ERROR_REPETITIVE_PUBLISH_STREAM",2002:"TOKEN_ERROR",2003:"ROOM_ERROR_LOGIN_TIMEOUT",2010:"TOKEN_ERROR",5022:"ROOM_COUNT_EXCEED"};if(t)return e>2e5&&e<3e5?n[e-2e5]:e<2e5?{50116:"TOKEN_ERROR",50117:"TOKEN_EXPIRED",50118:"TOKEN_ERROR",50119:"TOKEN_ERROR",50120:"TOKEN_ERROR",50121:"TOKEN_ERROR",50122:"TOKEN_ERROR",50123:"TOKEN_EXPIRED",50124:"TOKEN_ERROR",50125:"TOKEN_ERROR",50126:"TOKEN_ERROR",50127:"TOKEN_ERROR",50128:"TOKEN_ERROR"}[e]||n[e]||"ROOM_INNER_ERROR":n[e]||"ROOM_INNER_ERROR";return e>1e9?n[e-1e9]||"":{1:"PARSE_JSON_ERROR",1001:"LOGIN_PROCESSING",1002:"LIVEROMM_REQUEST_ERROR",1003:"ZPUSH_REQUEST_FAIL",1004:"ZPUSH_REQUEST_FAIL",1005:"ZPUSH_REQUEST_FAIL",1006:"LOGIN_STATE_WRONG",1007:"ZPUSH_REQUEST_FAIL",1008:"TOKEN_ERROR",1009:"DIAPATCH_ERROR",1010:"TOKEN_EXPIRED",1011:"TOKEN_ERROR",1012:"SUBCMD_ERROR",1101:"ZEGO_AUTH_ERROR",2001:"BIZ_CHANNEL_ERROR",2002:"BIZ_CHANNEL_ERROR"}[e]||"ROOM_INNER_ERROR"},e.getKickoutError=function(e,t){var n={code:e,message:"kickout reason = "+e};if(t)switch(e){case 1:n.code=63000001,n.message="zpush multiple login kickout",n.name="MULTIPLE_LOGIN_KICKOUT";break;case 2:n.code=63000002,n.message="zpush manual kickout",n.name="MANUAL_KICKOUT";break;case 4:n.code=63000005,n.message="zpush token expired",n.name="TOKEN_EXPIRED";break;default:n.code=e,n.message="kickout reason = "+e}else switch(e){case 1:n.code=63000001,n.message="zpush multiple login kickout",n.name="MULTIPLE_LOGIN_KICKOUT";break;case 2:n.code=63000002,n.message="zpush manual kickout",n.name="MANUAL_KICKOUT";break;case 3:n.code=63000003,n.message="kickout reason = "+e;break;case 4:n.code=63000004,n.message="zpush multiple login kickout",n.name="MULTIPLE_LOGIN_KICKOUT";break;case 5:n.code=63000005,n.message="zpush token expired",n.name="TOKEN_EXPIRED";break;default:n.code=e,n.message="kickout reason = "+e}return n},e.dataReportEvent=function(e,t,n,r,o){switch(n){case"eventStart":e.eventStart(t,r);break;case"eventEndWithMsgInfo":e.eventEndWithMsgInfo(t,r,o[0]);break;case"addEventMsg":e.addEventMsg(t,r,o[0],o[1]);break;case"addEvent":e.addEvent(t,r);break;case"eventEnd":e.eventEnd(t,r);break;case"addMsgInfo":e.addMsgInfo(t,o[0])}},e.isKeepTryLogin=function(e){switch(e){case 1002:case 1003:return!0;default:return!1}},e.mergeUserList=function(e,t,n,r){e.debug("msl.0 call");var o,i=[],s=[];n||(n=[]);for(var a=0;a<n.length;a++){o=!1;for(var c=0;c<t.length;c++)if(n[a].userID===t[c].userID){o=!0;break}o||i.push(n[a])}for(var u=0;u<t.length;u++){o=!1;for(var l=0;l<n.length;l++)if(t[u].userID===n[l].userID){o=!0;break}o||s.push(t[u])}t.splice(0);for(a=0;a<n.length;a++)t.push(t[a]);r(i,s),e.debug("msl.0 call success")},e.checkInteger=function(e,t){return 0==t?"number"==typeof e&&e%1==0&&e>=0:"number"==typeof e&&e%1==0&&e>0},e.checkValidNumber=function(e,t,n){return t=t||1,n=n||1e4,"number"==typeof e&&e%1==0&&e>=t&&e<=n},e.generateRandumNumber=function(e){return parseInt(Math.random()*(e+1)+"",10)},e.uuid=function(e,t){var n,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(t=t||r.length,e)for(n=0;n<e;n++)o[n]=r[0|Math.random()*t];else{var i=void 0;for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",n=0;n<36;n++)o[n]||(i=0|16*Math.random(),o[n]=r[19==n?3&i|8:i])}return o.join("")},e.compareVersion=function(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length);e.length<n;)e.push("0");for(;t.length<n;)t.push("0");for(var r=0;r<n;r++){var o=parseInt(e[r]),i=parseInt(t[r]);if(o>i)return 1;if(o<i)return-1}return 0},e.getBrowser=function(){var e=window.navigator.userAgent,t=null!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),n=-1!=e.indexOf("Firefox"),r=null!=window.opr,o=e.indexOf("Chrome")&&window.chrome,i=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version");return t?"IE":n?"Firefox":r?"Opera":o?"Chrome":i?"Safari":"Unkown"},e.isTestEnv=function(e){return-1!=e.indexOf("wss://wssliveroom-test.zego.im/ws")||-1!=e.indexOf("wss://test2-wsliveroom-api.zego.im/ws")||-1!=e.indexOf("wss://wsliveroom-test.zegocloud.com/ws")||-1!=e.indexOf("wss://wsliveroom-test.zego.im/ws")||-1!=e.indexOf("wss://webliveroom-test.zego.im/ws")||-1!=e.indexOf("wss://webliveroom-test-bak.zego.im/ws")||-1!=e.indexOf("wss://webliveroom-hk-test.zegocloud.com/ws")||-1!=e.indexOf("wss://webliveroom-hk-test-bak.zegocloud.com/ws")},e.getLogLevel=function(e){return s.LOG_LEVEL[e]},e.getUint64=function(e,t,n){var r=n.getUint32(e,t),o=n.getUint32(e+4,t),i=t?r+Math.pow(2,32)*o:Math.pow(2,32)*r+o;return Number.isSafeInteger(i)||console.warn(i,"exceeds MAX_SAFE_INTEGER. Precision may be lost"),i},e.decodeTokenExpire=function(t){try{var n=Uint8Array.from(i.Base64.base64decode(t),(function(e){return e.charCodeAt(0)})),r=new DataView(n.buffer),o=void 0;return o="function"==typeof r.getBigInt64?r.getBigUint64(0):e.getUint64(0,!1,r),Number(o>0?o:r.getBigUint64(0,!0))}catch(e){console.error("token error")}return-1},e.bin2hex=function(e){var t,n,r,o="";for(t=0,n=(e+="").length;t<n;t++)o+=(r=e.charCodeAt(t).toString(16)).length<2?"0"+r:r;return o},e.getCanvasFingerprint=function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=e;n.textBaseline="top",n.font="14px 'Arial'",n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.fillText(r,2,15),n.fillStyle="rgba(102, 204, 0, 0.7)",n.fillText(r,4,17);var o=t.toDataURL().replace("data:image/png;base64,",""),i=atob(o);return this.bin2hex(i.slice(-16,-12))},e.generateUUID=function(e){var t;if(void 0===e&&(e=0),0===e?t=localStorage.getItem("z_deviceID"):wx.getStorageSync("z_deviceID"),t)return t;var n=(new Date).getTime(),r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(36)}));if(0===e){var o=this.getCanvasFingerprint("hello, zego")+r.slice(8);localStorage.setItem("z_deviceID",o)}else wx.setStorageSync("z_deviceID",r);return r},e.getNetType=function(){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return((null==e?void 0:e.effectiveType)||(null==e?void 0:e.type)||"unknwon").toUpperCase()},e.getNetTypeNum=function(){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t=((null==e?void 0:e.effectiveType)||(null==e?void 0:e.type)||"unknwon").toUpperCase();return t.indexOf("4G")>-1?s.NetType.NT_4G:t.indexOf("2G")>-1?s.NetType.NT_2G:t.indexOf("3G")>-1?s.NetType.NT_3G:t.indexOf("WIFI")>-1?s.NetType.NT_WIFI:t.indexOf("LINE")>-1?s.NetType.NT_LINE:t.indexOf("NONE")>-1?s.NetType.NT_NONE:s.NetType.NT_UNKNOWN},e.encryptStores=function(e,t){return a.default.encrypt(e,t).toString()},e.decryptStores=function(e,t){try{return a.default.decrypt(e,t).toString(c.default)}catch(e){return""}},e}();t.ClientUtil=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_RTM_ACTION=void 0,function(e){e.ZEGOEXPRESSWEBRTM_CONSTRUCTOR="zm.0",e.ZEGOEXPRESSWEBRTM_BIND_WINDOW_LISTENER="zm.wl",e.ZEGOEXPRESSWEBRTM_SET_LOG_CONFIG="zm.slf",e.ZEGOEXPRESSWEBRTM_SET_DEBUG_VERBOSE="zm.sdv",e.ZEGOEXPRESSWEBRTM_LOGIN_ROOM="zm.lg",e.ZEGOEXPRESSWEBRTM_LOGOUT_ROOM="zm.lo",e.ZEGOEXPRESSWEBRTM_FETCH_APP_CONFIG="zm.fac",e.ZEGOEXPRESSWEBRTM_CREATENETAGENT="zm.cna",e.ZEGOEXPRESSWEBRTM_GETSTOREAPPCONFIG="zm.gsac",e.ZEGOEXPRESSWEBRTM_SET_CLOUD_SETTING_URLS="zm.scsu",e.ZEGOEXPRESSWEBRTM_ON="zm.on",e.ZEGOEXPRESSWEBRTM_OFF="zm.off",e.ZEGOEXPRESSWEBRTM_RENEWTOKEN="zm.rntk",e.ZEGOEXPRESSWEBRTM_RESETTOKENTIMER="zm.rstt",e.ZEGOEXPRESSWEBRTM_ENABLE_MULTI_ROOM="zm.emr",e.ZEGOEXPRESSWEBRTM_SEND_PB="zm.spb",e.ZEGOEXPRESSWEBRTM_GET_HEADER="zm.gh",e.ROOM_LOGIN_ROOM="zm.rm.lg",e.ROOM_TRY_LOGIN="zm.rm.tl",e.ROOM_OPEN_HANDLER="zm.rm.op",e.ROOM_HANDLE_LOGINRSP="zm.rm.lgr",e.ROOM_CLOSEHANDLER="zm.rm.clh",e.ROOM_LOGOUT="zm.rm.lo",e.ROOM_RESET_ROOM="zm.rm.rr",e.ROOM_DISCONNECT="zm.rm.dcn",e.ROOM_KICK_OUT="zm.rm.kco",e.ROOM_STATUS_CALLBACK="zm.rm.scb",e.ROOM_RESETTOKEN_TIMER="zm.rm.rst",e.HEARTBEAT_START="zm.hb.st",e.HEARTBEAT_HEARTBEAT_RSP="zm.hb.rsp",e.HEARTBEAT_RESET="zm.hb.rst",e.SERVICE_PUSH="zm.sv.ps",e.SERVICE_SEND="zm.sv.sd",e.USER_LOGIN_RSP="zm.us.lgr",e.USER_FETCH_USER="zm.us.ftu",e.USER_FETCH_USER_RSP="zm.us.urp",e.USER_USER_PUSH="zm.us.uph",e.USER_MERGE_SEQ="zm.us.mg",e.USER_MERGE_TIMEOUT="zm.us.mto",e.USER_MERGE="zm.us.mg",e.USER_HB_PATCH="zm.us.pt",e.STATE_ACTION="zm.st.at",e.ON_LISTENER="ON_LISTENER",e.LIVEROOMHANDLER_SENDMESSAGE="zm.lrh.sm",e.LIVEROOMHANDLER_HANDLEPUSH="zm.lrh.hp",e.LIVEROOMHANDLER_HANDLESWITCHPUSH="zm.lrh.hsp",e.LIVEROOMHANDLER_PUSHUSERUPDATE="zm.lrh.puu",e.LIVEROOMHANDLER_PUSHKICKOUT="zm.lrh.pk",e.LIVEROOMHANDLER_GETSTREAMLIST="zm.lrh.gs",e.LIVEROOMHANDLER_LOGIN="zm.lrh.lgi",e.LIVEROOMHANDLER_FETCH_USER_LIST="zm.lrh.ful",e.LIVEROOMHANDLER_LOGOUT="zm.lrh.lgo",e.LIVEROOMHANDLER_SENDSTREAMUPDATE="zm.lrh.sru",e.LIVEROOMHANDLER_RENEW_TOKEN="zm.lrh.rt",e.LIVEROOMHANDLER_SENDSIGNALCMD="zm.lrh.ssc",e.LIVEROOMHANDLER_SENDBIGROOMMESSAGE="zm.lrh.sbrm",e.LIVEROOMHANDLER_SENDCUSTOMCOMMAND="zm.lrh.scc",e.LIVEROOMHANDLER_FETCHRELIABLEMESSAGE="zm.lrh.frm",e.LIVEROOMHANDLER_SENDRELIABLEMESSAGE="zm.lrh.srm.0",e.LIVEROOMHANDLER_SENDROOMMSG="zm.lrh.srm.1",e.LIVEROOMHANDLER_HANDLEDISCONNECTED="zm.lrh.hd",e.LIVEROOMHANDLER_HANDLEBROKEN="zm.lrh.hb",e.LIVEROOMHANDLER_HANDLECONNECTED="zm.lrh.hc",e.LIVEROOMHANDLER_RESET="zm.lrh.r.0"}(t.ZEGO_RTM_ACTION||(t.ZEGO_RTM_ACTION={}))},function(e,t,n){"use strict";(function(e){var r=t;function o(e,t,n){for(var r=Object.keys(t),o=0;o<r.length;++o)void 0!==e[r[o]]&&n||(e[r[o]]=t[r[o]]);return e}function i(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&o(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=n(54),r.base64=n(55),r.EventEmitter=n(56),r.float=n(57),r.inquire=n(58),r.utf8=n(59),r.pool=n(60),r.LongBits=n(61),r.isNode=Boolean(void 0!==e&&e&&e.process&&e.process.versions&&e.process.versions.node),r.global=r.isNode&&e||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=o,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=i,r.ProtocolError=i("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}}).call(this,n(11))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRTMLogEvent=void 0;var r=n(1),o=function(e){return e},i=function(e){return e};t.ZegoRTMLogEvent={kZegoTaskInitSetting:{event:"/sdk/init",error:{kInvalidParamError:r.errorCodeList.INPUT_PARAM},system_info:navigator?navigator.appVersion:""},kZegoTaskSetDebug:{event:"/sdk/set_debug",debug:o},kZegoTaskSetLog:{event:"/sdk/set_log_config",error:{kInvalidParamError:r.errorCodeList.INPUT_PARAM},log_level:function(e){return e},remote_log_level:o,log_url:o},kZegoTaskLoginRoom:{event:"/sdk/login",user_update:o,max_member_count:o,message:o,token:o,use_na:o,error:{ROOM_ID_NULL:r.errorCodeList.ROOM_ID_NULL,INPUT_PARAM:r.errorCodeList.INPUT_PARAM,ROOM_ID_TOO_LONG:r.errorCodeList.ROOM_ID_TOO_LONG,ROOM_ID_INVALID_CHARACTER:r.errorCodeList.ROOM_ID_INVALID_CHARACTER,USER_ID_NULL:r.errorCodeList.USER_ID_NULL,USER_ID_TOO_LONG:r.errorCodeList.USER_ID_TOO_LONG,USER_ID_INVALID_CHARACTER:r.errorCodeList.USER_ID_INVALID_CHARACTER,USER_NAME_NULL:r.errorCodeList.USER_NAME_NULL,USER_NAME_TOO_LONG:r.errorCodeList.USER_NAME_TOO_LONG,REPEATEDLY_LOGIN:r.errorCodeList.REPEATEDLY_LOGIN,LOGIN_TIMEOUT:r.errorCodeList.LOGIN_TIMEOUT,INNER_ERROR:r.errorCodeList.ROOM_INNER_ERROR,NETWORK_BROKEN:r.errorCodeList.NETWORK_BROKEN},subEvent:{create_socket:{event:"create_socket",server:o,try_cnt:o},liveroom_login:{event:"liveroom_login",server:o,respond_info:o}}},kZegoTaskReNewToken:{event:"/sdk/reNewToken",error:{INPUT_PARAM:r.errorCodeList.INPUT_PARAM,NOT_LOGIN:r.errorCodeList.NOT_LOGIN}},kZegoTaskLogoutRoom:{event:"/sdk/logout",error:{INPUT_PARAM:r.errorCodeList.INPUT_PARAM,ROOM_NOT_EXIST:r.errorCodeList.ROOM_NOT_EXIST}},kZegoTaskReLoginRoom:{event:"/sdk/relogin",error:{ROOM_ID_NULL:r.errorCodeList.ROOM_ID_NULL,ROOM_DISCONNECT:r.errorCodeList.NETWORK_BROKEN},subEvent:{create_socket:{event:"create_socket",server:o,try_cnt:o},liveroom_login:{event:"liveroom_login",server:o,respond_info:o}}},kZegoTaskKickout:{event:"/sdk/kickout",user_id:o,error:{}},kZegoTaskRoomKickout:{event:"/sdk/room_kickout",user_id:o,room_id:o,message:o},kZegoTaskLiveRoomHB:{event:"/liveroom/hb",room_sid:o,error:{NOT_LOGIN:r.errorCodeList.NOT_LOGIN,HB_TIMEOUT:r.errorCodeList.TIMEOUT}},kZegoTaskLiveRoomGetUserUpdateInfo:{event:"/liveroom/get_user_update_info",user_update_type:o},kZegoListener:{event:"/sdk/listener"},kZegoEnableMultiRoom:{event:"sdk/enable_multi_room",error:{kInvalidParamError:r.errorCodeList.INPUT_PARAM,kAlreadyLoginError:r.errorCodeList.ALREADY_LOGIN}},kZegoTaskCloudSettingCache:{event:"/cloud_setting/cache"},kZegoTaskCloudSettingRefresh:{event:"/cloud_setting/refresh"},kZegoTaskCloudSettingRequest:{event:"/cloud_setting/request"},kZegoConnConnect:{event:"/zegoconn/connect",request_count:i,svr_env:o,server_list:o},kZegoConnDisConnect:{event:"/zegoconn/disconnect",server:o},kZegoConnDispatch:{event:"/zegoconn/auto_dispatch",trigger_reason:o,domain_list:function(e){return e}},kZegoRequest:{event:"/zegoconn/request",na_req_location:o},kZegoSDKConfigInit:{event:"/sdk_config/init",trigger_reason:o},kZegoSDKProxyConnect:{event:"/zegoconn/proxy_connect",proxy_link_sources:i,recv_time:i}}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoRoomStateChangedReason=void 0,function(e){e.Logining="LOGINING",e.Logined="LOGINED",e.LoginFailed="LOGIN_FAILED",e.Reconnecting="RECONNECTING",e.Reconnected="RECONNECTED",e.ReconnectFailed="RECONNECT_FAILED",e.Kickout="KICKOUT",e.Logout="LOGOUT",e.LogoutFailed="LOGOUT_FAILED"}(t.ZegoRoomStateChangedReason||(t.ZegoRoomStateChangedReason={}))},,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var r,o,i,s,a=n(24),c=a.Reader,u=a.Writer,l=a.util,h=a.roots.default||(a.roots.default={});h.proto_switch=((i={}).CommonRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.proto_switch.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.CommonRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.proto_switch.RspHead.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),i.RspHead=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).uint32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.RspHead;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.code=e.uint32();break;case 2:r.message=e.string();break;default:e.skipType(7&o)}}return r},e}(),i.LoginRoomReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.app_id=0,e.prototype.id_name=l.newBuffer([]),e.prototype.device_id="",e.prototype.term_type=0,e.prototype.net_type=0,e.prototype.sdk_ver=0,e.prototype.proto_ver=0,e.prototype.nick_name=l.newBuffer([]),e.prototype.client_stamp=l.newBuffer([]),e.prototype.crypt_version=0,e.prototype.k1_sign=l.newBuffer([]),e.prototype.login_token=l.newBuffer([]),e.prototype.relogin_token=l.newBuffer([]),e.prototype.role=0,e.prototype.liveroom_session_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.room_id=l.newBuffer([]),e.prototype.room_name=l.newBuffer([]),e.prototype.biz_type=0,e.prototype.room_create_flag=0,e.prototype.user_state_flag=0,e.prototype.lv_key="",e.prototype.third_token=l.newBuffer([]),e.prototype.cluster_req=0,e.prototype.user_count_limit=0,e.prototype.relate_service="",e.prototype.biz_version="",e.prototype.login_logic=0,e.prototype.sdk_conn_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(8).uint32(e.app_id),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(18).bytes(e.id_name),null!=e.device_id&&Object.hasOwnProperty.call(e,"device_id")&&t.uint32(26).string(e.device_id),null!=e.term_type&&Object.hasOwnProperty.call(e,"term_type")&&t.uint32(32).int32(e.term_type),null!=e.net_type&&Object.hasOwnProperty.call(e,"net_type")&&t.uint32(40).int32(e.net_type),null!=e.sdk_ver&&Object.hasOwnProperty.call(e,"sdk_ver")&&t.uint32(48).uint32(e.sdk_ver),null!=e.proto_ver&&Object.hasOwnProperty.call(e,"proto_ver")&&t.uint32(56).int32(e.proto_ver),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(66).bytes(e.nick_name),null!=e.client_stamp&&Object.hasOwnProperty.call(e,"client_stamp")&&t.uint32(74).bytes(e.client_stamp),null!=e.crypt_version&&Object.hasOwnProperty.call(e,"crypt_version")&&t.uint32(80).uint32(e.crypt_version),null!=e.k1_sign&&Object.hasOwnProperty.call(e,"k1_sign")&&t.uint32(90).bytes(e.k1_sign),null!=e.login_token&&Object.hasOwnProperty.call(e,"login_token")&&t.uint32(98).bytes(e.login_token),null!=e.relogin_token&&Object.hasOwnProperty.call(e,"relogin_token")&&t.uint32(106).bytes(e.relogin_token),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(112).uint32(e.role),null!=e.liveroom_session_id&&Object.hasOwnProperty.call(e,"liveroom_session_id")&&t.uint32(120).uint64(e.liveroom_session_id),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(130).bytes(e.room_id),null!=e.room_name&&Object.hasOwnProperty.call(e,"room_name")&&t.uint32(138).bytes(e.room_name),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(144).uint32(e.biz_type),null!=e.room_create_flag&&Object.hasOwnProperty.call(e,"room_create_flag")&&t.uint32(152).uint32(e.room_create_flag),null!=e.user_state_flag&&Object.hasOwnProperty.call(e,"user_state_flag")&&t.uint32(160).uint32(e.user_state_flag),null!=e.lv_key&&Object.hasOwnProperty.call(e,"lv_key")&&t.uint32(170).string(e.lv_key),null!=e.third_token&&Object.hasOwnProperty.call(e,"third_token")&&t.uint32(178).bytes(e.third_token),null!=e.cluster_req&&Object.hasOwnProperty.call(e,"cluster_req")&&t.uint32(184).uint32(e.cluster_req),null!=e.user_count_limit&&Object.hasOwnProperty.call(e,"user_count_limit")&&t.uint32(192).uint32(e.user_count_limit),null!=e.relate_service&&Object.hasOwnProperty.call(e,"relate_service")&&t.uint32(202).string(e.relate_service),null!=e.biz_version&&Object.hasOwnProperty.call(e,"biz_version")&&t.uint32(210).string(e.biz_version),null!=e.login_logic&&Object.hasOwnProperty.call(e,"login_logic")&&t.uint32(216).uint32(e.login_logic),null!=e.sdk_conn_type&&Object.hasOwnProperty.call(e,"sdk_conn_type")&&t.uint32(224).int32(e.sdk_conn_type),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.LoginRoomReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.app_id=e.uint32();break;case 2:r.id_name=e.bytes();break;case 3:r.device_id=e.string();break;case 4:r.term_type=e.int32();break;case 5:r.net_type=e.int32();break;case 6:r.sdk_ver=e.uint32();break;case 7:r.proto_ver=e.int32();break;case 8:r.nick_name=e.bytes();break;case 9:r.client_stamp=e.bytes();break;case 10:r.crypt_version=e.uint32();break;case 11:r.k1_sign=e.bytes();break;case 12:r.login_token=e.bytes();break;case 13:r.relogin_token=e.bytes();break;case 14:r.role=e.uint32();break;case 15:r.liveroom_session_id=e.uint64();break;case 16:r.room_id=e.bytes();break;case 17:r.room_name=e.bytes();break;case 18:r.biz_type=e.uint32();break;case 19:r.room_create_flag=e.uint32();break;case 20:r.user_state_flag=e.uint32();break;case 21:r.lv_key=e.string();break;case 22:r.third_token=e.bytes();break;case 23:r.cluster_req=e.uint32();break;case 24:r.user_count_limit=e.uint32();break;case 25:r.relate_service=e.string();break;case 26:r.biz_version=e.string();break;case 27:r.login_logic=e.uint32();break;case 28:r.sdk_conn_type=e.int32();break;default:e.skipType(7&o)}}return r},e}(),i.LoginRoomRsp=function(){function e(e){if(this.stream_info=[],this.stream_mix_info=[],this.trans_seqs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.room_id=l.newBuffer([]),e.prototype.heartbeat_interval=0,e.prototype.heartbeat_timeout=0,e.prototype.ret_timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.crypt_option=0,e.prototype.k2_sign=l.newBuffer([]),e.prototype.liveroom_session_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.liveroom_hb_interval=0,e.prototype.liveroom_hb_timeout=0,e.prototype.anchor_info=null,e.prototype.stream_seq=0,e.prototype.stream_info=l.emptyArray,e.prototype.stream_fetch_flag=0,e.prototype.lv_key="",e.prototype.zp_key="",e.prototype.online_count=0,e.prototype.bigim_time_window=0,e.prototype.dati_time_window=0,e.prototype.cluster_name="",e.prototype.relogin_token=l.newBuffer([]),e.prototype.stream_mix_info=l.emptyArray,e.prototype.userlist_merge_timeout=0,e.prototype.userlist_interval=0,e.prototype.room_session_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.trans_seqs=l.emptyArray,e.prototype.stream_list_push_merge_timeout=0,e.prototype.stream_list_hb_wait_merge_time=0,e.prototype.trans_list_seq=0,e.prototype.token_remain_time=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.proto_switch.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.heartbeat_interval&&Object.hasOwnProperty.call(e,"heartbeat_interval")&&t.uint32(24).uint32(e.heartbeat_interval),null!=e.heartbeat_timeout&&Object.hasOwnProperty.call(e,"heartbeat_timeout")&&t.uint32(32).uint32(e.heartbeat_timeout),null!=e.ret_timestamp&&Object.hasOwnProperty.call(e,"ret_timestamp")&&t.uint32(40).int64(e.ret_timestamp),null!=e.crypt_option&&Object.hasOwnProperty.call(e,"crypt_option")&&t.uint32(48).uint32(e.crypt_option),null!=e.k2_sign&&Object.hasOwnProperty.call(e,"k2_sign")&&t.uint32(58).bytes(e.k2_sign),null!=e.liveroom_session_id&&Object.hasOwnProperty.call(e,"liveroom_session_id")&&t.uint32(64).uint64(e.liveroom_session_id),null!=e.liveroom_hb_interval&&Object.hasOwnProperty.call(e,"liveroom_hb_interval")&&t.uint32(72).uint32(e.liveroom_hb_interval),null!=e.liveroom_hb_timeout&&Object.hasOwnProperty.call(e,"liveroom_hb_timeout")&&t.uint32(80).uint32(e.liveroom_hb_timeout),null!=e.anchor_info&&Object.hasOwnProperty.call(e,"anchor_info")&&h.proto_switch.StAnchorInfo.encode(e.anchor_info,t.uint32(90).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(96).uint32(e.stream_seq),null!=e.stream_info&&e.stream_info.length)for(var n=0;n<e.stream_info.length;++n)h.proto_switch.StStreamInfo.encode(e.stream_info[n],t.uint32(106).fork()).ldelim();if(null!=e.stream_fetch_flag&&Object.hasOwnProperty.call(e,"stream_fetch_flag")&&t.uint32(112).uint32(e.stream_fetch_flag),null!=e.lv_key&&Object.hasOwnProperty.call(e,"lv_key")&&t.uint32(122).string(e.lv_key),null!=e.zp_key&&Object.hasOwnProperty.call(e,"zp_key")&&t.uint32(130).string(e.zp_key),null!=e.online_count&&Object.hasOwnProperty.call(e,"online_count")&&t.uint32(136).uint32(e.online_count),null!=e.bigim_time_window&&Object.hasOwnProperty.call(e,"bigim_time_window")&&t.uint32(144).uint32(e.bigim_time_window),null!=e.dati_time_window&&Object.hasOwnProperty.call(e,"dati_time_window")&&t.uint32(152).uint32(e.dati_time_window),null!=e.cluster_name&&Object.hasOwnProperty.call(e,"cluster_name")&&t.uint32(162).string(e.cluster_name),null!=e.relogin_token&&Object.hasOwnProperty.call(e,"relogin_token")&&t.uint32(170).bytes(e.relogin_token),null!=e.stream_mix_info&&e.stream_mix_info.length)for(n=0;n<e.stream_mix_info.length;++n)h.proto_switch.StStreamInfo.encode(e.stream_mix_info[n],t.uint32(178).fork()).ldelim();if(null!=e.userlist_merge_timeout&&Object.hasOwnProperty.call(e,"userlist_merge_timeout")&&t.uint32(184).uint32(e.userlist_merge_timeout),null!=e.userlist_interval&&Object.hasOwnProperty.call(e,"userlist_interval")&&t.uint32(192).uint32(e.userlist_interval),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(200).uint64(e.room_session_id),null!=e.trans_seqs&&e.trans_seqs.length)for(n=0;n<e.trans_seqs.length;++n)h.proto_switch.StTransInfo.encode(e.trans_seqs[n],t.uint32(210).fork()).ldelim();return null!=e.stream_list_push_merge_timeout&&Object.hasOwnProperty.call(e,"stream_list_push_merge_timeout")&&t.uint32(216).uint32(e.stream_list_push_merge_timeout),null!=e.stream_list_hb_wait_merge_time&&Object.hasOwnProperty.call(e,"stream_list_hb_wait_merge_time")&&t.uint32(224).uint32(e.stream_list_hb_wait_merge_time),null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(232).uint32(e.trans_list_seq),null!=e.token_remain_time&&Object.hasOwnProperty.call(e,"token_remain_time")&&t.uint32(240).uint32(e.token_remain_time),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.LoginRoomRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.proto_switch.RspHead.decode(e,e.uint32());break;case 2:r.room_id=e.bytes();break;case 3:r.heartbeat_interval=e.uint32();break;case 4:r.heartbeat_timeout=e.uint32();break;case 5:r.ret_timestamp=e.int64();break;case 6:r.crypt_option=e.uint32();break;case 7:r.k2_sign=e.bytes();break;case 8:r.liveroom_session_id=e.uint64();break;case 9:r.liveroom_hb_interval=e.uint32();break;case 10:r.liveroom_hb_timeout=e.uint32();break;case 11:r.anchor_info=h.proto_switch.StAnchorInfo.decode(e,e.uint32());break;case 12:r.stream_seq=e.uint32();break;case 13:r.stream_info&&r.stream_info.length||(r.stream_info=[]),r.stream_info.push(h.proto_switch.StStreamInfo.decode(e,e.uint32()));break;case 14:r.stream_fetch_flag=e.uint32();break;case 15:r.lv_key=e.string();break;case 16:r.zp_key=e.string();break;case 17:r.online_count=e.uint32();break;case 18:r.bigim_time_window=e.uint32();break;case 19:r.dati_time_window=e.uint32();break;case 20:r.cluster_name=e.string();break;case 21:r.relogin_token=e.bytes();break;case 22:r.stream_mix_info&&r.stream_mix_info.length||(r.stream_mix_info=[]),r.stream_mix_info.push(h.proto_switch.StStreamInfo.decode(e,e.uint32()));break;case 23:r.userlist_merge_timeout=e.uint32();break;case 24:r.userlist_interval=e.uint32();break;case 25:r.room_session_id=e.uint64();break;case 26:r.trans_seqs&&r.trans_seqs.length||(r.trans_seqs=[]),r.trans_seqs.push(h.proto_switch.StTransInfo.decode(e,e.uint32()));break;case 27:r.stream_list_push_merge_timeout=e.uint32();break;case 28:r.stream_list_hb_wait_merge_time=e.uint32();break;case 29:r.trans_list_seq=e.uint32();break;case 30:r.token_remain_time=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),i.StAnchorInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.anchor_id_name=l.newBuffer([]),e.prototype.anchor_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.anchor_nick_name=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.anchor_id_name&&Object.hasOwnProperty.call(e,"anchor_id_name")&&t.uint32(10).bytes(e.anchor_id_name),null!=e.anchor_id&&Object.hasOwnProperty.call(e,"anchor_id")&&t.uint32(16).uint64(e.anchor_id),null!=e.anchor_nick_name&&Object.hasOwnProperty.call(e,"anchor_nick_name")&&t.uint32(26).bytes(e.anchor_nick_name),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.StAnchorInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.anchor_id_name=e.bytes();break;case 2:r.anchor_id=e.uint64();break;case 3:r.anchor_nick_name=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),i.StStreamInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.stream_id=l.newBuffer([]),e.prototype.stream_sid="",e.prototype.id_name=l.newBuffer([]),e.prototype.nick_name=l.newBuffer([]),e.prototype.create_time=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.extra_info=l.newBuffer([]),e.prototype.title=l.newBuffer([]),e.prototype.stream_ver=0,e.prototype.stream_attr=l.newBuffer([]),e.prototype.stream_src=0,e.prototype.stream_state=0,e.prototype.stream_type=0,e.prototype.stream_nid=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(10).bytes(e.stream_id),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(18).string(e.stream_sid),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(26).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(34).bytes(e.nick_name),null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(41).fixed64(e.create_time),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(50).bytes(e.extra_info),null!=e.title&&Object.hasOwnProperty.call(e,"title")&&t.uint32(58).bytes(e.title),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(64).uint32(e.stream_ver),null!=e.stream_attr&&Object.hasOwnProperty.call(e,"stream_attr")&&t.uint32(74).bytes(e.stream_attr),null!=e.stream_src&&Object.hasOwnProperty.call(e,"stream_src")&&t.uint32(80).uint32(e.stream_src),null!=e.stream_state&&Object.hasOwnProperty.call(e,"stream_state")&&t.uint32(88).uint32(e.stream_state),null!=e.stream_type&&Object.hasOwnProperty.call(e,"stream_type")&&t.uint32(96).uint32(e.stream_type),null!=e.stream_nid&&Object.hasOwnProperty.call(e,"stream_nid")&&t.uint32(104).uint32(e.stream_nid),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.StStreamInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.stream_id=e.bytes();break;case 2:r.stream_sid=e.string();break;case 3:r.id_name=e.bytes();break;case 4:r.nick_name=e.bytes();break;case 5:r.create_time=e.fixed64();break;case 6:r.extra_info=e.bytes();break;case 7:r.title=e.bytes();break;case 8:r.stream_ver=e.uint32();break;case 9:r.stream_attr=e.bytes();break;case 10:r.stream_src=e.uint32();break;case 11:r.stream_state=e.uint32();break;case 12:r.stream_type=e.uint32();break;case 13:r.stream_nid=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),i.StTransSeqInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trans_type=l.newBuffer([]),e.prototype.trans_seq=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(16).uint32(e.trans_seq),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.StTransSeqInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.trans_type=e.bytes();break;case 2:r.trans_seq=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),i.StTransInfo=function(){function e(e){if(this.trans_seq_array=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trans_channel=l.newBuffer([]),e.prototype.trans_seq_array=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(10).bytes(e.trans_channel),null!=e.trans_seq_array&&e.trans_seq_array.length)for(var n=0;n<e.trans_seq_array.length;++n)h.proto_switch.StTransSeqInfo.encode(e.trans_seq_array[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.StTransInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.trans_channel=e.bytes();break;case 2:r.trans_seq_array&&r.trans_seq_array.length||(r.trans_seq_array=[]),r.trans_seq_array.push(h.proto_switch.StTransSeqInfo.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),i.LogoutRoomReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.logout_code=0,e.prototype.logout_check=l.newBuffer([]),e.prototype.liveroom_session_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.room_id=l.newBuffer([]),e.prototype.role=0,e.prototype.nickname=l.newBuffer([]),e.prototype.logout_logic=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.logout_code&&Object.hasOwnProperty.call(e,"logout_code")&&t.uint32(8).uint32(e.logout_code),null!=e.logout_check&&Object.hasOwnProperty.call(e,"logout_check")&&t.uint32(18).bytes(e.logout_check),null!=e.liveroom_session_id&&Object.hasOwnProperty.call(e,"liveroom_session_id")&&t.uint32(24).uint64(e.liveroom_session_id),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(34).bytes(e.room_id),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(40).uint32(e.role),null!=e.nickname&&Object.hasOwnProperty.call(e,"nickname")&&t.uint32(50).bytes(e.nickname),null!=e.logout_logic&&Object.hasOwnProperty.call(e,"logout_logic")&&t.uint32(56).uint32(e.logout_logic),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.LogoutRoomReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.logout_code=e.uint32();break;case 2:r.logout_check=e.bytes();break;case 3:r.liveroom_session_id=e.uint64();break;case 4:r.room_id=e.bytes();break;case 5:r.role=e.uint32();break;case 6:r.nickname=e.bytes();break;case 7:r.logout_logic=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),i.LogoutRoomRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.proto_switch.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.LogoutRoomRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.proto_switch.RspHead.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),i.TcpHbReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.id_name=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.TcpHbReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.id_name=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),i.TcpHbRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.heartbeat_interval=0,e.prototype.heartbeat_timeout=0,e.prototype.server_timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.proto_switch.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.heartbeat_interval&&Object.hasOwnProperty.call(e,"heartbeat_interval")&&t.uint32(16).uint32(e.heartbeat_interval),null!=e.heartbeat_timeout&&Object.hasOwnProperty.call(e,"heartbeat_timeout")&&t.uint32(24).uint32(e.heartbeat_timeout),null!=e.server_timestamp&&Object.hasOwnProperty.call(e,"server_timestamp")&&t.uint32(32).int64(e.server_timestamp),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.TcpHbRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.proto_switch.RspHead.decode(e,e.uint32());break;case 2:r.heartbeat_interval=e.uint32();break;case 3:r.heartbeat_timeout=e.uint32();break;case 4:r.server_timestamp=e.int64();break;default:e.skipType(7&o)}}return r},e}(),i.TermType=(r={},(o=Object.create(r))[r[0]="TT_NONE"]=0,o[r[1]="TT_PC"]=1,o[r[2]="TT_IOS"]=2,o[r[3]="TT_ANDROID"]=3,o[r[4]="TT_MAC"]=4,o[r[5]="TT_LINUX"]=5,o[r[6]="TT_WEB"]=6,o[r[7]="TT_MINIPROGRAM"]=7,o[r[32]="TT_UNKNOWN"]=32,o),i.NetType=function(){var e={},t=Object.create(e);return t[e[0]="NT_NONE"]=0,t[e[1]="NT_LINE"]=1,t[e[2]="NT_WIFI"]=2,t[e[3]="NT_2G"]=3,t[e[4]="NT_3G"]=4,t[e[5]="NT_4G"]=5,t[e[32]="NT_UNKNOWN"]=32,t}(),i.ProductType=function(){var e={},t=Object.create(e);return t[e[0]="PRODUCT_TYPE_NONE"]=0,t[e[1]="PRODUCT_TYPE_LIVEROOM"]=1,t[e[2]="PRODUCT_TYPE_IM"]=2,t}(),i.LiveroomProtoVersion=function(){var e={},t=Object.create(e);return t[e[0]="PROTO_VERSION_NONE"]=0,t[e[131072]="RPOTO_V020000"]=131072,t}(),i.SdkConnType=function(){var e={},t=Object.create(e);return t[e[0]="SdkConnType_None"]=0,t[e[1]="SdkConnType_Tcp"]=1,t[e[2]="SdkConnType_Websocket"]=2,t}(),i.Header=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.cmd="",e.prototype.seq=0,e.prototype.timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.app_id=0,e.prototype.user_id="",e.prototype.session_id=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.user_nid=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.controls=l.newBuffer([]),e.prototype.product=0,e.prototype.flags=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.cmd&&Object.hasOwnProperty.call(e,"cmd")&&t.uint32(10).string(e.cmd),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(16).uint32(e.seq),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(24).int64(e.timestamp),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(32).uint32(e.app_id),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(42).string(e.user_id),null!=e.session_id&&Object.hasOwnProperty.call(e,"session_id")&&t.uint32(48).int64(e.session_id),null!=e.user_nid&&Object.hasOwnProperty.call(e,"user_nid")&&t.uint32(56).int64(e.user_nid),null!=e.controls&&Object.hasOwnProperty.call(e,"controls")&&t.uint32(66).bytes(e.controls),null!=e.product&&Object.hasOwnProperty.call(e,"product")&&t.uint32(72).int32(e.product),null!=e.flags&&Object.hasOwnProperty.call(e,"flags")&&t.uint32(82).bytes(e.flags),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.Header;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.cmd=e.string();break;case 2:r.seq=e.uint32();break;case 3:r.timestamp=e.int64();break;case 4:r.app_id=e.uint32();break;case 5:r.user_id=e.string();break;case 6:r.session_id=e.int64();break;case 7:r.user_nid=e.int64();break;case 8:r.controls=e.bytes();break;case 9:r.product=e.int32();break;case 10:r.flags=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),i.PushKickout=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.reason=0,e.prototype.message="",e.prototype.need_relogin=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(8).uint32(e.reason),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.need_relogin&&Object.hasOwnProperty.call(e,"need_relogin")&&t.uint32(24).uint32(e.need_relogin),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.PushKickout;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.reason=e.uint32();break;case 2:r.message=e.string();break;case 3:r.need_relogin=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),i.PushRedirect2Sdk=function(){function e(e){if(this.redirect_server=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.redirect_server=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.redirect_server&&e.redirect_server.length)for(var n=0;n<e.redirect_server.length;++n)t.uint32(10).string(e.redirect_server[n]);return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.PushRedirect2Sdk;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.redirect_server&&r.redirect_server.length||(r.redirect_server=[]),r.redirect_server.push(e.string());break;default:e.skipType(7&o)}}return r},e}(),i.PushReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.head=null,e.prototype.msg_body=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.head&&Object.hasOwnProperty.call(e,"head")&&h.proto_switch.PushReqHead.encode(e.head,t.uint32(10).fork()).ldelim(),null!=e.msg_body&&Object.hasOwnProperty.call(e,"msg_body")&&t.uint32(18).bytes(e.msg_body),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.PushReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.head=h.proto_switch.PushReqHead.decode(e,e.uint32());break;case 2:r.msg_body=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),i.PushReqHead=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sub_cmd="",e.prototype.sender_user_id="",e.prototype.qos_flag=0,e.prototype.msg_id="",e.prototype.send_time=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.room_id=l.newBuffer([]),e.prototype.sender_user_nid=l.Long?l.Long.fromBits(0,0,!0):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.sub_cmd&&Object.hasOwnProperty.call(e,"sub_cmd")&&t.uint32(10).string(e.sub_cmd),null!=e.sender_user_id&&Object.hasOwnProperty.call(e,"sender_user_id")&&t.uint32(18).string(e.sender_user_id),null!=e.qos_flag&&Object.hasOwnProperty.call(e,"qos_flag")&&t.uint32(24).uint32(e.qos_flag),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(34).string(e.msg_id),null!=e.send_time&&Object.hasOwnProperty.call(e,"send_time")&&t.uint32(40).int64(e.send_time),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(50).bytes(e.room_id),null!=e.sender_user_nid&&Object.hasOwnProperty.call(e,"sender_user_nid")&&t.uint32(56).uint64(e.sender_user_nid),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.PushReqHead;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.sub_cmd=e.string();break;case 2:r.sender_user_id=e.string();break;case 3:r.qos_flag=e.uint32();break;case 4:r.msg_id=e.string();break;case 5:r.send_time=e.int64();break;case 6:r.room_id=e.bytes();break;case 7:r.sender_user_nid=e.uint64();break;default:e.skipType(7&o)}}return r},e}(),i.PushRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.message="",e.prototype.sub_cmd="",e.prototype.msg_id="",e.prototype.server_send_time=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).uint32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.sub_cmd&&Object.hasOwnProperty.call(e,"sub_cmd")&&t.uint32(26).string(e.sub_cmd),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(34).string(e.msg_id),null!=e.server_send_time&&Object.hasOwnProperty.call(e,"server_send_time")&&t.uint32(40).int64(e.server_send_time),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.PushRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.code=e.uint32();break;case 2:r.message=e.string();break;case 3:r.sub_cmd=e.string();break;case 4:r.msg_id=e.string();break;case 5:r.server_send_time=e.int64();break;default:e.skipType(7&o)}}return r},e}(),i.MergePushHead=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.qos_flag=0,e.prototype.send_time=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.room_id=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.qos_flag&&Object.hasOwnProperty.call(e,"qos_flag")&&t.uint32(8).uint32(e.qos_flag),null!=e.send_time&&Object.hasOwnProperty.call(e,"send_time")&&t.uint32(16).int64(e.send_time),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(26).bytes(e.room_id),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.MergePushHead;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.qos_flag=e.uint32();break;case 2:r.send_time=e.int64();break;case 3:r.room_id=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),i.MergePushInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sub_cmd="",e.prototype.sub_seq=0,e.prototype.sender_nid=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.msg_id=l.newBuffer([]),e.prototype.msg_body=l.newBuffer([]),e.prototype.msg_timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.sub_cmd&&Object.hasOwnProperty.call(e,"sub_cmd")&&t.uint32(10).string(e.sub_cmd),null!=e.sub_seq&&Object.hasOwnProperty.call(e,"sub_seq")&&t.uint32(16).uint32(e.sub_seq),null!=e.sender_nid&&Object.hasOwnProperty.call(e,"sender_nid")&&t.uint32(24).uint64(e.sender_nid),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(34).bytes(e.msg_id),null!=e.msg_body&&Object.hasOwnProperty.call(e,"msg_body")&&t.uint32(42).bytes(e.msg_body),null!=e.msg_timestamp&&Object.hasOwnProperty.call(e,"msg_timestamp")&&t.uint32(48).int64(e.msg_timestamp),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.MergePushInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.sub_cmd=e.string();break;case 2:r.sub_seq=e.uint32();break;case 3:r.sender_nid=e.uint64();break;case 4:r.msg_id=e.bytes();break;case 5:r.msg_body=e.bytes();break;case 6:r.msg_timestamp=e.int64();break;default:e.skipType(7&o)}}return r},e}(),i.CmdMergePushReq=function(){function e(e){if(this.messages=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.head=null,e.prototype.messages=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.head&&Object.hasOwnProperty.call(e,"head")&&h.proto_switch.MergePushHead.encode(e.head,t.uint32(10).fork()).ldelim(),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)h.proto_switch.MergePushInfo.encode(e.messages[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.CmdMergePushReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.head=h.proto_switch.MergePushHead.decode(e,e.uint32());break;case 2:r.messages&&r.messages.length||(r.messages=[]),r.messages.push(h.proto_switch.MergePushInfo.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),i.CmdMergePushRspInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sub_cmd="",e.prototype.sub_seq=0,e.prototype.msg_id=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.sub_cmd&&Object.hasOwnProperty.call(e,"sub_cmd")&&t.uint32(10).string(e.sub_cmd),null!=e.sub_seq&&Object.hasOwnProperty.call(e,"sub_seq")&&t.uint32(16).uint32(e.sub_seq),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(26).bytes(e.msg_id),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.CmdMergePushRspInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.sub_cmd=e.string();break;case 2:r.sub_seq=e.uint32();break;case 3:r.msg_id=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),i.CmdMergePushRsp=function(){function e(e){if(this.messages=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.messages=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)h.proto_switch.CmdMergePushRspInfo.encode(e.messages[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.proto_switch.CmdMergePushRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.messages&&r.messages.length||(r.messages=[]),r.messages.push(h.proto_switch.CmdMergePushRspInfo.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),i),h.liveroom_cs=((s={}).ReqHead=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.room_id="",e.prototype.user_session_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.room_session_id=l.Long?l.Long.fromBits(0,0,!0):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).string(e.room_id),null!=e.user_session_id&&Object.hasOwnProperty.call(e,"user_session_id")&&t.uint32(16).uint64(e.user_session_id),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(24).uint64(e.room_session_id),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.ReqHead;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.room_id=e.string();break;case 2:r.user_session_id=e.uint64();break;case 3:r.room_session_id=e.uint64();break;default:e.skipType(7&o)}}return r},e}(),s.RspHead=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).uint32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.RspHead;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.code=e.uint32();break;case 2:r.message=e.string();break;default:e.skipType(7&o)}}return r},e}(),s.CommonRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.CommonRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),s.HbReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.role=0,e.prototype.lv_key="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(16).uint32(e.role),null!=e.lv_key&&Object.hasOwnProperty.call(e,"lv_key")&&t.uint32(26).string(e.lv_key),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.HbReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.role=e.uint32();break;case 3:r.lv_key=e.string();break;default:e.skipType(7&o)}}return r},e}(),s.HbRsp=function(){function e(e){if(this.trans_seqs=[],this.user_trans_seqs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.ret_timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.hb_interval=0,e.prototype.hb_timeout=0,e.prototype.stream_seq=0,e.prototype.user_seq=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.online_count=0,e.prototype.bigim_time_window=0,e.prototype.dati_time_window=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.trans_seqs=l.emptyArray,e.prototype.user_trans_seqs=l.emptyArray,e.prototype.StreamRefresh=0,e.prototype.trans_list_seq=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.ret_timestamp&&Object.hasOwnProperty.call(e,"ret_timestamp")&&t.uint32(16).int64(e.ret_timestamp),null!=e.hb_interval&&Object.hasOwnProperty.call(e,"hb_interval")&&t.uint32(24).uint32(e.hb_interval),null!=e.hb_timeout&&Object.hasOwnProperty.call(e,"hb_timeout")&&t.uint32(32).uint32(e.hb_timeout),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(40).uint32(e.stream_seq),null!=e.user_seq&&Object.hasOwnProperty.call(e,"user_seq")&&t.uint32(48).int64(e.user_seq),null!=e.online_count&&Object.hasOwnProperty.call(e,"online_count")&&t.uint32(56).uint32(e.online_count),null!=e.bigim_time_window&&Object.hasOwnProperty.call(e,"bigim_time_window")&&t.uint32(64).uint32(e.bigim_time_window),null!=e.dati_time_window&&Object.hasOwnProperty.call(e,"dati_time_window")&&t.uint32(72).int64(e.dati_time_window),null!=e.trans_seqs&&e.trans_seqs.length)for(var n=0;n<e.trans_seqs.length;++n)h.liveroom_cs.StTransChannelSeq.encode(e.trans_seqs[n],t.uint32(82).fork()).ldelim();if(null!=e.user_trans_seqs&&e.user_trans_seqs.length)for(n=0;n<e.user_trans_seqs.length;++n)h.liveroom_cs.StTransChannelSeq.encode(e.user_trans_seqs[n],t.uint32(90).fork()).ldelim();return null!=e.StreamRefresh&&Object.hasOwnProperty.call(e,"StreamRefresh")&&t.uint32(96).uint32(e.StreamRefresh),null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(104).uint32(e.trans_list_seq),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.HbRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.ret_timestamp=e.int64();break;case 3:r.hb_interval=e.uint32();break;case 4:r.hb_timeout=e.uint32();break;case 5:r.stream_seq=e.uint32();break;case 6:r.user_seq=e.int64();break;case 7:r.online_count=e.uint32();break;case 8:r.bigim_time_window=e.uint32();break;case 9:r.dati_time_window=e.int64();break;case 10:r.trans_seqs&&r.trans_seqs.length||(r.trans_seqs=[]),r.trans_seqs.push(h.liveroom_cs.StTransChannelSeq.decode(e,e.uint32()));break;case 11:r.user_trans_seqs&&r.user_trans_seqs.length||(r.user_trans_seqs=[]),r.user_trans_seqs.push(h.liveroom_cs.StTransChannelSeq.decode(e,e.uint32()));break;case 12:r.StreamRefresh=e.uint32();break;case 13:r.trans_list_seq=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.StTransSeq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trans_type=l.newBuffer([]),e.prototype.trans_seq=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(16).uint32(e.trans_seq),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StTransSeq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.trans_type=e.bytes();break;case 2:r.trans_seq=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.StTransChannelSeq=function(){function e(e){if(this.trans_seq_array=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trans_channel=l.newBuffer([]),e.prototype.trans_seq_array=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(10).bytes(e.trans_channel),null!=e.trans_seq_array&&e.trans_seq_array.length)for(var n=0;n<e.trans_seq_array.length;++n)h.liveroom_cs.StTransSeq.encode(e.trans_seq_array[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StTransChannelSeq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.trans_channel=e.bytes();break;case 2:r.trans_seq_array&&r.trans_seq_array.length||(r.trans_seq_array=[]),r.trans_seq_array.push(h.liveroom_cs.StTransSeq.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.UserlistReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.sort_type=0,e.prototype.user_index=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.sort_type&&Object.hasOwnProperty.call(e,"sort_type")&&t.uint32(16).uint32(e.sort_type),null!=e.user_index&&Object.hasOwnProperty.call(e,"user_index")&&t.uint32(24).uint32(e.user_index),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.UserlistReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.sort_type=e.uint32();break;case 3:r.user_index=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.UserlistRsp=function(){function e(e){if(this.user_basic_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.server_user_seq=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.server_user_index=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.ret_user_index=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.user_basic_list=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.server_user_seq&&Object.hasOwnProperty.call(e,"server_user_seq")&&t.uint32(16).uint64(e.server_user_seq),null!=e.server_user_index&&Object.hasOwnProperty.call(e,"server_user_index")&&t.uint32(24).int64(e.server_user_index),null!=e.ret_user_index&&Object.hasOwnProperty.call(e,"ret_user_index")&&t.uint32(32).int64(e.ret_user_index),null!=e.user_basic_list&&e.user_basic_list.length)for(var n=0;n<e.user_basic_list.length;++n)h.liveroom_cs.StUserBasicDef.encode(e.user_basic_list[n],t.uint32(42).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.UserlistRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.server_user_seq=e.uint64();break;case 3:r.server_user_index=e.int64();break;case 4:r.ret_user_index=e.int64();break;case 5:r.user_basic_list&&r.user_basic_list.length||(r.user_basic_list=[]),r.user_basic_list.push(h.liveroom_cs.StUserBasicDef.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StUserBasicDef=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.id_name=l.newBuffer([]),e.prototype.nick_name=l.newBuffer([]),e.prototype.role=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StUserBasicDef;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.id_name=e.bytes();break;case 2:r.nick_name=e.bytes();break;case 3:r.role=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.StreamAddReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.stream_id=l.newBuffer([]),e.prototype.title=l.newBuffer([]),e.prototype.stream_attr=l.newBuffer([]),e.prototype.extra_info=l.newBuffer([]),e.prototype.client_req_seq=0,e.prototype.nickname=l.newBuffer([]),e.prototype.login_mode=0,e.prototype.stream_type=0,e.prototype.third_token=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(18).bytes(e.stream_id),null!=e.title&&Object.hasOwnProperty.call(e,"title")&&t.uint32(26).bytes(e.title),null!=e.stream_attr&&Object.hasOwnProperty.call(e,"stream_attr")&&t.uint32(34).bytes(e.stream_attr),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).bytes(e.extra_info),null!=e.client_req_seq&&Object.hasOwnProperty.call(e,"client_req_seq")&&t.uint32(48).uint32(e.client_req_seq),null!=e.nickname&&Object.hasOwnProperty.call(e,"nickname")&&t.uint32(58).bytes(e.nickname),null!=e.login_mode&&Object.hasOwnProperty.call(e,"login_mode")&&t.uint32(64).uint32(e.login_mode),null!=e.stream_type&&Object.hasOwnProperty.call(e,"stream_type")&&t.uint32(72).uint32(e.stream_type),null!=e.third_token&&Object.hasOwnProperty.call(e,"third_token")&&t.uint32(82).bytes(e.third_token),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StreamAddReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.stream_id=e.bytes();break;case 3:r.title=e.bytes();break;case 4:r.stream_attr=e.bytes();break;case 5:r.extra_info=e.bytes();break;case 6:r.client_req_seq=e.uint32();break;case 7:r.nickname=e.bytes();break;case 8:r.login_mode=e.uint32();break;case 9:r.stream_type=e.uint32();break;case 10:r.third_token=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.StreamAddRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.stream_seq=0,e.prototype.stream_sid="",e.prototype.stream_ver=0,e.prototype.stream_nid=0,e.prototype.token_remain_time=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(16).uint32(e.stream_seq),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(26).string(e.stream_sid),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(32).uint32(e.stream_ver),null!=e.stream_nid&&Object.hasOwnProperty.call(e,"stream_nid")&&t.uint32(40).uint32(e.stream_nid),null!=e.token_remain_time&&Object.hasOwnProperty.call(e,"token_remain_time")&&t.uint32(48).uint32(e.token_remain_time),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StreamAddRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.stream_seq=e.uint32();break;case 3:r.stream_sid=e.string();break;case 4:r.stream_ver=e.uint32();break;case 5:r.stream_nid=e.uint32();break;case 6:r.token_remain_time=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.StreamDeleteReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.stream_sid="",e.prototype.stream_id=l.newBuffer([]),e.prototype.client_req_seq=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(18).string(e.stream_sid),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(26).bytes(e.stream_id),null!=e.client_req_seq&&Object.hasOwnProperty.call(e,"client_req_seq")&&t.uint32(32).uint32(e.client_req_seq),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StreamDeleteReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.stream_sid=e.string();break;case 3:r.stream_id=e.bytes();break;case 4:r.client_req_seq=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.StreamDeleteRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.stream_seq=0,e.prototype.stream_ver=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(16).uint32(e.stream_seq),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(24).uint32(e.stream_ver),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StreamDeleteRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.stream_seq=e.uint32();break;case 3:r.stream_ver=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.StreamUpdateReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.stream_sid="",e.prototype.stream_id=l.newBuffer([]),e.prototype.title=l.newBuffer([]),e.prototype.stream_attr=l.newBuffer([]),e.prototype.extra_info=l.newBuffer([]),e.prototype.client_req_seq=0,e.prototype.nickname=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(18).string(e.stream_sid),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(26).bytes(e.stream_id),null!=e.title&&Object.hasOwnProperty.call(e,"title")&&t.uint32(34).bytes(e.title),null!=e.stream_attr&&Object.hasOwnProperty.call(e,"stream_attr")&&t.uint32(42).bytes(e.stream_attr),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(50).bytes(e.extra_info),null!=e.client_req_seq&&Object.hasOwnProperty.call(e,"client_req_seq")&&t.uint32(56).uint32(e.client_req_seq),null!=e.nickname&&Object.hasOwnProperty.call(e,"nickname")&&t.uint32(66).bytes(e.nickname),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StreamUpdateReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.stream_sid=e.string();break;case 3:r.stream_id=e.bytes();break;case 4:r.title=e.bytes();break;case 5:r.stream_attr=e.bytes();break;case 6:r.extra_info=e.bytes();break;case 7:r.client_req_seq=e.uint32();break;case 8:r.nickname=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.StreamUpdateRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.stream_seq=0,e.prototype.stream_ver=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(16).uint32(e.stream_seq),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(24).uint32(e.stream_ver),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StreamUpdateRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.stream_seq=e.uint32();break;case 3:r.stream_ver=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.StreamListReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StreamListReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),s.StreamListRsp=function(){function e(e){if(this.stream_info=[],this.stream_mix_info=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.stream_seq=0,e.prototype.stream_info=l.emptyArray,e.prototype.stream_refresh=0,e.prototype.stream_mix_info=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(16).uint32(e.stream_seq),null!=e.stream_info&&e.stream_info.length)for(var n=0;n<e.stream_info.length;++n)h.liveroom_cs.StStreamInfo.encode(e.stream_info[n],t.uint32(26).fork()).ldelim();if(null!=e.stream_refresh&&Object.hasOwnProperty.call(e,"stream_refresh")&&t.uint32(32).uint32(e.stream_refresh),null!=e.stream_mix_info&&e.stream_mix_info.length)for(n=0;n<e.stream_mix_info.length;++n)h.liveroom_cs.StStreamInfo.encode(e.stream_mix_info[n],t.uint32(42).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StreamListRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.stream_seq=e.uint32();break;case 3:r.stream_info&&r.stream_info.length||(r.stream_info=[]),r.stream_info.push(h.liveroom_cs.StStreamInfo.decode(e,e.uint32()));break;case 4:r.stream_refresh=e.uint32();break;case 5:r.stream_mix_info&&r.stream_mix_info.length||(r.stream_mix_info=[]),r.stream_mix_info.push(h.liveroom_cs.StStreamInfo.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StStreamInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.stream_sid="",e.prototype.stream_id=l.newBuffer([]),e.prototype.id_name=l.newBuffer([]),e.prototype.nick_name=l.newBuffer([]),e.prototype.extra_info=l.newBuffer([]),e.prototype.title=l.newBuffer([]),e.prototype.stream_ver=0,e.prototype.stream_attr=l.newBuffer([]),e.prototype.create_time=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.stream_src=0,e.prototype.state=0,e.prototype.stream_type=0,e.prototype.stream_nid=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(10).string(e.stream_sid),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(18).bytes(e.stream_id),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(26).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(34).bytes(e.nick_name),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).bytes(e.extra_info),null!=e.title&&Object.hasOwnProperty.call(e,"title")&&t.uint32(50).bytes(e.title),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(56).uint32(e.stream_ver),null!=e.stream_attr&&Object.hasOwnProperty.call(e,"stream_attr")&&t.uint32(66).bytes(e.stream_attr),null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(72).int64(e.create_time),null!=e.stream_src&&Object.hasOwnProperty.call(e,"stream_src")&&t.uint32(80).uint32(e.stream_src),null!=e.state&&Object.hasOwnProperty.call(e,"state")&&t.uint32(88).uint32(e.state),null!=e.stream_type&&Object.hasOwnProperty.call(e,"stream_type")&&t.uint32(96).uint32(e.stream_type),null!=e.stream_nid&&Object.hasOwnProperty.call(e,"stream_nid")&&t.uint32(104).uint32(e.stream_nid),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StStreamInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.stream_sid=e.string();break;case 2:r.stream_id=e.bytes();break;case 3:r.id_name=e.bytes();break;case 4:r.nick_name=e.bytes();break;case 5:r.extra_info=e.bytes();break;case 6:r.title=e.bytes();break;case 7:r.stream_ver=e.uint32();break;case 8:r.stream_attr=e.bytes();break;case 9:r.create_time=e.int64();break;case 10:r.stream_src=e.uint32();break;case 11:r.state=e.uint32();break;case 12:r.stream_type=e.uint32();break;case 13:r.stream_nid=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.StDstUser=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.id_name=l.newBuffer([]),e.prototype.id=l.Long?l.Long.fromBits(0,0,!0):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(16).uint64(e.id),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StDstUser;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.id_name=e.bytes();break;case 2:r.id=e.uint64();break;default:e.skipType(7&o)}}return r},e}(),s.SignalLiveReq=function(){function e(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.push_message=l.newBuffer([]),e.prototype.dst_userlist=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.push_message&&Object.hasOwnProperty.call(e,"push_message")&&t.uint32(18).bytes(e.push_message),null!=e.dst_userlist&&e.dst_userlist.length)for(var n=0;n<e.dst_userlist.length;++n)h.liveroom_cs.StDstUser.encode(e.dst_userlist[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.SignalLiveReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.push_message=e.bytes();break;case 3:r.dst_userlist&&r.dst_userlist.length||(r.dst_userlist=[]),r.dst_userlist.push(h.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.SignalLiveRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.SignalLiveRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),s.SignalLiveResultReq=function(){function e(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.push_message=l.newBuffer([]),e.prototype.dst_userlist=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.push_message&&Object.hasOwnProperty.call(e,"push_message")&&t.uint32(18).bytes(e.push_message),null!=e.dst_userlist&&e.dst_userlist.length)for(var n=0;n<e.dst_userlist.length;++n)h.liveroom_cs.StDstUser.encode(e.dst_userlist[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.SignalLiveResultReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.push_message=e.bytes();break;case 3:r.dst_userlist&&r.dst_userlist.length||(r.dst_userlist=[]),r.dst_userlist.push(h.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.SignalLiveResulRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.SignalLiveResulRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),s.SignalLiveInviteReq=function(){function e(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.push_message=l.newBuffer([]),e.prototype.dst_userlist=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.push_message&&Object.hasOwnProperty.call(e,"push_message")&&t.uint32(18).bytes(e.push_message),null!=e.dst_userlist&&e.dst_userlist.length)for(var n=0;n<e.dst_userlist.length;++n)h.liveroom_cs.StDstUser.encode(e.dst_userlist[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.SignalLiveInviteReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.push_message=e.bytes();break;case 3:r.dst_userlist&&r.dst_userlist.length||(r.dst_userlist=[]),r.dst_userlist.push(h.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.SignalLiveInviteRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.SignalLiveInviteRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),s.SignalLiveStopReq=function(){function e(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.push_message=l.newBuffer([]),e.prototype.dst_userlist=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.push_message&&Object.hasOwnProperty.call(e,"push_message")&&t.uint32(18).bytes(e.push_message),null!=e.dst_userlist&&e.dst_userlist.length)for(var n=0;n<e.dst_userlist.length;++n)h.liveroom_cs.StDstUser.encode(e.dst_userlist[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.SignalLiveStopReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.push_message=e.bytes();break;case 3:r.dst_userlist&&r.dst_userlist.length||(r.dst_userlist=[]),r.dst_userlist.push(h.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.SignalLiveStopRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.SignalLiveStopRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),s.SignalLiveCustomReq=function(){function e(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.push_message=l.newBuffer([]),e.prototype.dst_userlist=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.push_message&&Object.hasOwnProperty.call(e,"push_message")&&t.uint32(18).bytes(e.push_message),null!=e.dst_userlist&&e.dst_userlist.length)for(var n=0;n<e.dst_userlist.length;++n)h.liveroom_cs.StDstUser.encode(e.dst_userlist[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.SignalLiveCustomReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.push_message=e.bytes();break;case 3:r.dst_userlist&&r.dst_userlist.length||(r.dst_userlist=[]),r.dst_userlist.push(h.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.SignalLiveCustomRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.SignalLiveCustomRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),s.ImChatReq=function(){function e(e){if(this.dst_userlist=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.msg_category=0,e.prototype.msg_type=0,e.prototype.msg_priority=0,e.prototype.msg_content=l.newBuffer([]),e.prototype.dst_userlist=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.msg_category&&Object.hasOwnProperty.call(e,"msg_category")&&t.uint32(16).uint32(e.msg_category),null!=e.msg_type&&Object.hasOwnProperty.call(e,"msg_type")&&t.uint32(24).uint32(e.msg_type),null!=e.msg_priority&&Object.hasOwnProperty.call(e,"msg_priority")&&t.uint32(32).uint32(e.msg_priority),null!=e.msg_content&&Object.hasOwnProperty.call(e,"msg_content")&&t.uint32(42).bytes(e.msg_content),null!=e.dst_userlist&&e.dst_userlist.length)for(var n=0;n<e.dst_userlist.length;++n)h.liveroom_cs.StDstUser.encode(e.dst_userlist[n],t.uint32(50).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.ImChatReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.msg_category=e.uint32();break;case 3:r.msg_type=e.uint32();break;case 4:r.msg_priority=e.uint32();break;case 5:r.msg_content=e.bytes();break;case 6:r.dst_userlist&&r.dst_userlist.length||(r.dst_userlist=[]),r.dst_userlist.push(h.liveroom_cs.StDstUser.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.ImChatRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.msg_id=l.Long?l.Long.fromBits(0,0,!0):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(16).uint64(e.msg_id),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.ImChatRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.msg_id=e.uint64();break;default:e.skipType(7&o)}}return r},e}(),s.ImGethatReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.msg_priority=0,e.prototype.msg_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.sort_type=0,e.prototype.msg_count=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.msg_priority&&Object.hasOwnProperty.call(e,"msg_priority")&&t.uint32(16).uint32(e.msg_priority),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(24).uint64(e.msg_id),null!=e.sort_type&&Object.hasOwnProperty.call(e,"sort_type")&&t.uint32(32).uint32(e.sort_type),null!=e.msg_count&&Object.hasOwnProperty.call(e,"msg_count")&&t.uint32(40).uint32(e.msg_count),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.ImGethatReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.msg_priority=e.uint32();break;case 3:r.msg_id=e.uint64();break;case 4:r.sort_type=e.uint32();break;case 5:r.msg_count=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.ImGetChatRsp=function(){function e(e){if(this.msg_data=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.server_msg_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.ret_msg_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.msg_data=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.server_msg_id&&Object.hasOwnProperty.call(e,"server_msg_id")&&t.uint32(16).uint64(e.server_msg_id),null!=e.ret_msg_id&&Object.hasOwnProperty.call(e,"ret_msg_id")&&t.uint32(24).uint64(e.ret_msg_id),null!=e.msg_data&&e.msg_data.length)for(var n=0;n<e.msg_data.length;++n)h.liveroom_cs.StMsgData.encode(e.msg_data[n],t.uint32(34).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.ImGetChatRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.server_msg_id=e.uint64();break;case 3:r.ret_msg_id=e.uint64();break;case 4:r.msg_data&&r.msg_data.length||(r.msg_data=[]),r.msg_data.push(h.liveroom_cs.StMsgData.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StMsgData=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.id_name=l.newBuffer([]),e.prototype.nick_name=l.newBuffer([]),e.prototype.role=0,e.prototype.msg_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.msg_category=0,e.prototype.msg_type=0,e.prototype.msg_priority=0,e.prototype.msg_content=l.newBuffer([]),e.prototype.send_time=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(32).uint64(e.msg_id),null!=e.msg_category&&Object.hasOwnProperty.call(e,"msg_category")&&t.uint32(40).uint32(e.msg_category),null!=e.msg_type&&Object.hasOwnProperty.call(e,"msg_type")&&t.uint32(48).uint32(e.msg_type),null!=e.msg_priority&&Object.hasOwnProperty.call(e,"msg_priority")&&t.uint32(56).uint32(e.msg_priority),null!=e.msg_content&&Object.hasOwnProperty.call(e,"msg_content")&&t.uint32(66).bytes(e.msg_content),null!=e.send_time&&Object.hasOwnProperty.call(e,"send_time")&&t.uint32(72).int64(e.send_time),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StMsgData;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.id_name=e.bytes();break;case 2:r.nick_name=e.bytes();break;case 3:r.role=e.uint32();break;case 4:r.msg_id=e.uint64();break;case 5:r.msg_category=e.uint32();break;case 6:r.msg_type=e.uint32();break;case 7:r.msg_priority=e.uint32();break;case 8:r.msg_content=e.bytes();break;case 9:r.send_time=e.int64();break;default:e.skipType(7&o)}}return r},e}(),s.EnterReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.switch_session_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.nick_name=l.newBuffer([]),e.prototype.role=0,e.prototype.net_type=0,e.prototype.config=null,e.prototype.lv_key="",e.prototype.third_token=l.newBuffer([]),e.prototype.cluster_req=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.user_count_limit=0,e.prototype.relate_service="",e.prototype.conn_type=0,e.prototype.room_name=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.switch_session_id&&Object.hasOwnProperty.call(e,"switch_session_id")&&t.uint32(16).uint64(e.switch_session_id),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(26).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(32).uint32(e.role),null!=e.net_type&&Object.hasOwnProperty.call(e,"net_type")&&t.uint32(40).uint32(e.net_type),null!=e.config&&Object.hasOwnProperty.call(e,"config")&&h.liveroom_cs.StConfigList.encode(e.config,t.uint32(50).fork()).ldelim(),null!=e.lv_key&&Object.hasOwnProperty.call(e,"lv_key")&&t.uint32(58).string(e.lv_key),null!=e.third_token&&Object.hasOwnProperty.call(e,"third_token")&&t.uint32(66).bytes(e.third_token),null!=e.cluster_req&&Object.hasOwnProperty.call(e,"cluster_req")&&t.uint32(72).uint64(e.cluster_req),null!=e.user_count_limit&&Object.hasOwnProperty.call(e,"user_count_limit")&&t.uint32(80).uint32(e.user_count_limit),null!=e.relate_service&&Object.hasOwnProperty.call(e,"relate_service")&&t.uint32(90).string(e.relate_service),null!=e.conn_type&&Object.hasOwnProperty.call(e,"conn_type")&&t.uint32(96).uint32(e.conn_type),null!=e.room_name&&Object.hasOwnProperty.call(e,"room_name")&&t.uint32(106).bytes(e.room_name),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.EnterReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.switch_session_id=e.uint64();break;case 3:r.nick_name=e.bytes();break;case 4:r.role=e.uint32();break;case 5:r.net_type=e.uint32();break;case 6:r.config=h.liveroom_cs.StConfigList.decode(e,e.uint32());break;case 7:r.lv_key=e.string();break;case 8:r.third_token=e.bytes();break;case 9:r.cluster_req=e.uint64();break;case 10:r.user_count_limit=e.uint32();break;case 11:r.relate_service=e.string();break;case 12:r.conn_type=e.uint32();break;case 13:r.room_name=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.EnterRsp=function(){function e(e){if(this.stream_info=[],this.stream_mix_info=[],this.trans_seqs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.room_id=l.newBuffer([]),e.prototype.user_session_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.room_session_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.user_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.ret_timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.bigim_time_window=0,e.prototype.dati_time_window=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.room_id32=0,e.prototype.hb_interval=0,e.prototype.hb_timeout=0,e.prototype.lv_key="",e.prototype.zp_key="",e.prototype.online_count=0,e.prototype.anchor_info=null,e.prototype.stream_seq=0,e.prototype.stream_info=l.emptyArray,e.prototype.stream_mix_info=l.emptyArray,e.prototype.userlist_merge_timeout=0,e.prototype.userlist_interval=0,e.prototype.stream_list_push_merge_timeout=0,e.prototype.stream_list_hb_wait_merge_time=0,e.prototype.trans_list_seq=0,e.prototype.trans_seqs=l.emptyArray,e.prototype.cluster_name="",e.prototype.token_remain_time=0,e.prototype.stream_fetch_flag=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.user_session_id&&Object.hasOwnProperty.call(e,"user_session_id")&&t.uint32(24).uint64(e.user_session_id),null!=e.room_session_id&&Object.hasOwnProperty.call(e,"room_session_id")&&t.uint32(32).uint64(e.room_session_id),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(40).uint64(e.user_id),null!=e.ret_timestamp&&Object.hasOwnProperty.call(e,"ret_timestamp")&&t.uint32(49).fixed64(e.ret_timestamp),null!=e.bigim_time_window&&Object.hasOwnProperty.call(e,"bigim_time_window")&&t.uint32(56).uint32(e.bigim_time_window),null!=e.dati_time_window&&Object.hasOwnProperty.call(e,"dati_time_window")&&t.uint32(64).int64(e.dati_time_window),null!=e.room_id32&&Object.hasOwnProperty.call(e,"room_id32")&&t.uint32(72).uint32(e.room_id32),null!=e.hb_interval&&Object.hasOwnProperty.call(e,"hb_interval")&&t.uint32(80).uint32(e.hb_interval),null!=e.hb_timeout&&Object.hasOwnProperty.call(e,"hb_timeout")&&t.uint32(88).uint32(e.hb_timeout),null!=e.lv_key&&Object.hasOwnProperty.call(e,"lv_key")&&t.uint32(98).string(e.lv_key),null!=e.zp_key&&Object.hasOwnProperty.call(e,"zp_key")&&t.uint32(106).string(e.zp_key),null!=e.online_count&&Object.hasOwnProperty.call(e,"online_count")&&t.uint32(112).uint32(e.online_count),null!=e.anchor_info&&Object.hasOwnProperty.call(e,"anchor_info")&&h.liveroom_cs.StAnchorInfo.encode(e.anchor_info,t.uint32(122).fork()).ldelim(),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(128).uint32(e.stream_seq),null!=e.stream_info&&e.stream_info.length)for(var n=0;n<e.stream_info.length;++n)h.liveroom_cs.StStreamInfo.encode(e.stream_info[n],t.uint32(138).fork()).ldelim();if(null!=e.stream_mix_info&&e.stream_mix_info.length)for(n=0;n<e.stream_mix_info.length;++n)h.liveroom_cs.StStreamInfo.encode(e.stream_mix_info[n],t.uint32(146).fork()).ldelim();if(null!=e.userlist_merge_timeout&&Object.hasOwnProperty.call(e,"userlist_merge_timeout")&&t.uint32(152).uint32(e.userlist_merge_timeout),null!=e.userlist_interval&&Object.hasOwnProperty.call(e,"userlist_interval")&&t.uint32(160).uint32(e.userlist_interval),null!=e.stream_list_push_merge_timeout&&Object.hasOwnProperty.call(e,"stream_list_push_merge_timeout")&&t.uint32(168).uint32(e.stream_list_push_merge_timeout),null!=e.stream_list_hb_wait_merge_time&&Object.hasOwnProperty.call(e,"stream_list_hb_wait_merge_time")&&t.uint32(176).uint32(e.stream_list_hb_wait_merge_time),null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(184).uint32(e.trans_list_seq),null!=e.trans_seqs&&e.trans_seqs.length)for(n=0;n<e.trans_seqs.length;++n)h.liveroom_cs.StTransInfo.encode(e.trans_seqs[n],t.uint32(194).fork()).ldelim();return null!=e.cluster_name&&Object.hasOwnProperty.call(e,"cluster_name")&&t.uint32(202).string(e.cluster_name),null!=e.token_remain_time&&Object.hasOwnProperty.call(e,"token_remain_time")&&t.uint32(208).uint32(e.token_remain_time),null!=e.stream_fetch_flag&&Object.hasOwnProperty.call(e,"stream_fetch_flag")&&t.uint32(216).uint32(e.stream_fetch_flag),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.EnterRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.room_id=e.bytes();break;case 3:r.user_session_id=e.uint64();break;case 4:r.room_session_id=e.uint64();break;case 5:r.user_id=e.uint64();break;case 6:r.ret_timestamp=e.fixed64();break;case 7:r.bigim_time_window=e.uint32();break;case 8:r.dati_time_window=e.int64();break;case 9:r.room_id32=e.uint32();break;case 10:r.hb_interval=e.uint32();break;case 11:r.hb_timeout=e.uint32();break;case 12:r.lv_key=e.string();break;case 13:r.zp_key=e.string();break;case 14:r.online_count=e.uint32();break;case 15:r.anchor_info=h.liveroom_cs.StAnchorInfo.decode(e,e.uint32());break;case 16:r.stream_seq=e.uint32();break;case 17:r.stream_info&&r.stream_info.length||(r.stream_info=[]),r.stream_info.push(h.liveroom_cs.StStreamInfo.decode(e,e.uint32()));break;case 18:r.stream_mix_info&&r.stream_mix_info.length||(r.stream_mix_info=[]),r.stream_mix_info.push(h.liveroom_cs.StStreamInfo.decode(e,e.uint32()));break;case 19:r.userlist_merge_timeout=e.uint32();break;case 20:r.userlist_interval=e.uint32();break;case 21:r.stream_list_push_merge_timeout=e.uint32();break;case 22:r.stream_list_hb_wait_merge_time=e.uint32();break;case 23:r.trans_list_seq=e.uint32();break;case 24:r.trans_seqs&&r.trans_seqs.length||(r.trans_seqs=[]),r.trans_seqs.push(h.liveroom_cs.StTransInfo.decode(e,e.uint32()));break;case 25:r.cluster_name=e.string();break;case 26:r.token_remain_time=e.uint32();break;case 27:r.stream_fetch_flag=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.StAnchorInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.anchor_id_name=l.newBuffer([]),e.prototype.anchor_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.anchor_nick_name=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.anchor_id_name&&Object.hasOwnProperty.call(e,"anchor_id_name")&&t.uint32(10).bytes(e.anchor_id_name),null!=e.anchor_id&&Object.hasOwnProperty.call(e,"anchor_id")&&t.uint32(16).uint64(e.anchor_id),null!=e.anchor_nick_name&&Object.hasOwnProperty.call(e,"anchor_nick_name")&&t.uint32(26).bytes(e.anchor_nick_name),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StAnchorInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.anchor_id_name=e.bytes();break;case 2:r.anchor_id=e.uint64();break;case 3:r.anchor_nick_name=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.QuitReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.switch_session_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.room_id32=0,e.prototype.nick_name=l.newBuffer([]),e.prototype.role=0,e.prototype.net_type=0,e.prototype.config_list=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.switch_session_id&&Object.hasOwnProperty.call(e,"switch_session_id")&&t.uint32(16).uint64(e.switch_session_id),null!=e.room_id32&&Object.hasOwnProperty.call(e,"room_id32")&&t.uint32(24).uint32(e.room_id32),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(34).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(40).uint32(e.role),null!=e.net_type&&Object.hasOwnProperty.call(e,"net_type")&&t.uint32(48).uint32(e.net_type),null!=e.config_list&&Object.hasOwnProperty.call(e,"config_list")&&h.liveroom_cs.StConfigList.encode(e.config_list,t.uint32(58).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.QuitReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.switch_session_id=e.uint64();break;case 3:r.room_id32=e.uint32();break;case 4:r.nick_name=e.bytes();break;case 5:r.role=e.uint32();break;case 6:r.net_type=e.uint32();break;case 7:r.config_list=h.liveroom_cs.StConfigList.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),s.StConfigList=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.room_create_flag=0,e.prototype.user_state_flag=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.room_create_flag&&Object.hasOwnProperty.call(e,"room_create_flag")&&t.uint32(8).uint32(e.room_create_flag),null!=e.user_state_flag&&Object.hasOwnProperty.call(e,"user_state_flag")&&t.uint32(16).uint32(e.user_state_flag),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StConfigList;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.room_create_flag=e.uint32();break;case 2:r.user_state_flag=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.QuitRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.room_id=l.newBuffer([]),e.prototype.room_id32=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.room_id32&&Object.hasOwnProperty.call(e,"room_id32")&&t.uint32(24).uint32(e.room_id32),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.QuitRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.room_id=e.bytes();break;case 3:r.room_id32=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.RoomListReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.RoomListReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),s.RoomListRsp=function(){function e(e){if(this.room_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.room_list=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.room_list&&e.room_list.length)for(var n=0;n<e.room_list.length;++n)h.liveroom_cs.StRoomListRoom.encode(e.room_list[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.RoomListRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.room_list&&r.room_list.length||(r.room_list=[]),r.room_list.push(h.liveroom_cs.StRoomListRoom.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StRoomListStream=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.stream_id=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(10).bytes(e.stream_id),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StRoomListStream;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.stream_id=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.StRoomListRoom=function(){function e(e){if(this.stream_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.room_id=l.newBuffer([]),e.prototype.room_name=l.newBuffer([]),e.prototype.anchor_id_name=l.newBuffer([]),e.prototype.anchor_nick_name=l.newBuffer([]),e.prototype.stream_list=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).bytes(e.room_id),null!=e.room_name&&Object.hasOwnProperty.call(e,"room_name")&&t.uint32(18).bytes(e.room_name),null!=e.anchor_id_name&&Object.hasOwnProperty.call(e,"anchor_id_name")&&t.uint32(26).bytes(e.anchor_id_name),null!=e.anchor_nick_name&&Object.hasOwnProperty.call(e,"anchor_nick_name")&&t.uint32(34).bytes(e.anchor_nick_name),null!=e.stream_list&&e.stream_list.length)for(var n=0;n<e.stream_list.length;++n)h.liveroom_cs.StRoomListStream.encode(e.stream_list[n],t.uint32(42).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StRoomListRoom;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.room_id=e.bytes();break;case 2:r.room_name=e.bytes();break;case 3:r.anchor_id_name=e.bytes();break;case 4:r.anchor_nick_name=e.bytes();break;case 5:r.stream_list&&r.stream_list.length||(r.stream_list=[]),r.stream_list.push(h.liveroom_cs.StRoomListStream.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StTransSeqInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trans_type=l.newBuffer([]),e.prototype.trans_seq=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(16).uint32(e.trans_seq),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StTransSeqInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.trans_type=e.bytes();break;case 2:r.trans_seq=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.StTransInfo=function(){function e(e){if(this.trans_seq_array=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trans_channel=l.newBuffer([]),e.prototype.trans_seq_array=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(10).bytes(e.trans_channel),null!=e.trans_seq_array&&e.trans_seq_array.length)for(var n=0;n<e.trans_seq_array.length;++n)h.liveroom_cs.StTransSeqInfo.encode(e.trans_seq_array[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StTransInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.trans_channel=e.bytes();break;case 2:r.trans_seq_array&&r.trans_seq_array.length||(r.trans_seq_array=[]),r.trans_seq_array.push(h.liveroom_cs.StTransSeqInfo.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.TransReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.nick_name=l.newBuffer([]),e.prototype.role=0,e.prototype.trans_type=l.newBuffer([]),e.prototype.trans_data=l.newBuffer([]),e.prototype.trans_local_seq=0,e.prototype.trans_channel=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(34).bytes(e.trans_type),null!=e.trans_data&&Object.hasOwnProperty.call(e,"trans_data")&&t.uint32(42).bytes(e.trans_data),null!=e.trans_local_seq&&Object.hasOwnProperty.call(e,"trans_local_seq")&&t.uint32(48).uint32(e.trans_local_seq),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(58).bytes(e.trans_channel),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.TransReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.nick_name=e.bytes();break;case 3:r.role=e.uint32();break;case 4:r.trans_type=e.bytes();break;case 5:r.trans_data=e.bytes();break;case 6:r.trans_local_seq=e.uint32();break;case 7:r.trans_channel=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.TransRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.trans_type=l.newBuffer([]),e.prototype.trans_seq=0,e.prototype.trans_list_seq=0,e.prototype.trans_channel=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(18).bytes(e.trans_type),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(24).uint32(e.trans_seq),null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(32).uint32(e.trans_list_seq),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(42).bytes(e.trans_channel),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.TransRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.trans_type=e.bytes();break;case 3:r.trans_seq=e.uint32();break;case 4:r.trans_list_seq=e.uint32();break;case 5:r.trans_channel=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.TransFetchReq=function(){function e(e){if(this.fetch_array=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.trans_channel=l.newBuffer([]),e.prototype.fetch_array=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(18).bytes(e.trans_channel),null!=e.fetch_array&&e.fetch_array.length)for(var n=0;n<e.fetch_array.length;++n)h.liveroom_cs.StTransFetch.encode(e.fetch_array[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.TransFetchReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.trans_channel=e.bytes();break;case 3:r.fetch_array&&r.fetch_array.length||(r.fetch_array=[]),r.fetch_array.push(h.liveroom_cs.StTransFetch.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StTransFetch=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trans_type=l.newBuffer([]),e.prototype.trans_local_seq=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_local_seq&&Object.hasOwnProperty.call(e,"trans_local_seq")&&t.uint32(16).uint32(e.trans_local_seq),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StTransFetch;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.trans_type=e.bytes();break;case 2:r.trans_local_seq=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.TransFetchRsp=function(){function e(e){if(this.trans_fetch_results=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.trans_channel=l.newBuffer([]),e.prototype.trans_fetch_results=l.emptyArray,e.prototype.trans_list_seq=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(18).bytes(e.trans_channel),null!=e.trans_fetch_results&&e.trans_fetch_results.length)for(var n=0;n<e.trans_fetch_results.length;++n)h.liveroom_cs.TransFetchResult.encode(e.trans_fetch_results[n],t.uint32(26).fork()).ldelim();return null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(32).uint32(e.trans_list_seq),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.TransFetchRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.trans_channel=e.bytes();break;case 3:r.trans_fetch_results&&r.trans_fetch_results.length||(r.trans_fetch_results=[]),r.trans_fetch_results.push(h.liveroom_cs.TransFetchResult.decode(e,e.uint32()));break;case 4:r.trans_list_seq=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.TransFetchResult=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trans_type=l.newBuffer([]),e.prototype.trans_data=l.newBuffer([]),e.prototype.trans_idname=l.newBuffer([]),e.prototype.trans_nickname=l.newBuffer([]),e.prototype.trans_role=0,e.prototype.trans_send_time=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.trans_seq=0,e.prototype.err_code=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_data&&Object.hasOwnProperty.call(e,"trans_data")&&t.uint32(18).bytes(e.trans_data),null!=e.trans_idname&&Object.hasOwnProperty.call(e,"trans_idname")&&t.uint32(26).bytes(e.trans_idname),null!=e.trans_nickname&&Object.hasOwnProperty.call(e,"trans_nickname")&&t.uint32(34).bytes(e.trans_nickname),null!=e.trans_role&&Object.hasOwnProperty.call(e,"trans_role")&&t.uint32(40).uint32(e.trans_role),null!=e.trans_send_time&&Object.hasOwnProperty.call(e,"trans_send_time")&&t.uint32(48).int64(e.trans_send_time),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(56).uint32(e.trans_seq),null!=e.err_code&&Object.hasOwnProperty.call(e,"err_code")&&t.uint32(64).int32(e.err_code),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.TransFetchResult;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.trans_type=e.bytes();break;case 2:r.trans_data=e.bytes();break;case 3:r.trans_idname=e.bytes();break;case 4:r.trans_nickname=e.bytes();break;case 5:r.trans_role=e.uint32();break;case 6:r.trans_send_time=e.int64();break;case 7:r.trans_seq=e.uint32();break;case 8:r.err_code=e.int32();break;default:e.skipType(7&o)}}return r},e}(),s.UserTransFetchReq=function(){function e(e){if(this.fetch_array=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.nick_name=l.newBuffer([]),e.prototype.role=0,e.prototype.trans_channel=l.newBuffer([]),e.prototype.fetch_array=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(34).bytes(e.trans_channel),null!=e.fetch_array&&e.fetch_array.length)for(var n=0;n<e.fetch_array.length;++n)h.liveroom_cs.StUserTransFetch.encode(e.fetch_array[n],t.uint32(42).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.UserTransFetchReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.nick_name=e.bytes();break;case 3:r.role=e.uint32();break;case 4:r.trans_channel=e.bytes();break;case 5:r.fetch_array&&r.fetch_array.length||(r.fetch_array=[]),r.fetch_array.push(h.liveroom_cs.StUserTransFetch.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StUserTransFetch=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trans_type=l.newBuffer([]),e.prototype.trans_local_seq=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_local_seq&&Object.hasOwnProperty.call(e,"trans_local_seq")&&t.uint32(16).uint32(e.trans_local_seq),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StUserTransFetch;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.trans_type=e.bytes();break;case 2:r.trans_local_seq=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.UserTransFetchRsp=function(){function e(e){if(this.trans_fetch_results=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.trans_channel=l.newBuffer([]),e.prototype.trans_fetch_results=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(18).bytes(e.trans_channel),null!=e.trans_fetch_results&&e.trans_fetch_results.length)for(var n=0;n<e.trans_fetch_results.length;++n)h.liveroom_cs.StUserTransFetchResult.encode(e.trans_fetch_results[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.UserTransFetchRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.trans_channel=e.bytes();break;case 3:r.trans_fetch_results&&r.trans_fetch_results.length||(r.trans_fetch_results=[]),r.trans_fetch_results.push(h.liveroom_cs.StUserTransFetchResult.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StUserTransFetchResult=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trans_type=l.newBuffer([]),e.prototype.trans_data=l.newBuffer([]),e.prototype.trans_idname=l.newBuffer([]),e.prototype.trans_nickname=l.newBuffer([]),e.prototype.trans_role=0,e.prototype.trans_send_time=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.trans_seq=0,e.prototype.err_code=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_data&&Object.hasOwnProperty.call(e,"trans_data")&&t.uint32(18).bytes(e.trans_data),null!=e.trans_idname&&Object.hasOwnProperty.call(e,"trans_idname")&&t.uint32(26).bytes(e.trans_idname),null!=e.trans_nickname&&Object.hasOwnProperty.call(e,"trans_nickname")&&t.uint32(34).bytes(e.trans_nickname),null!=e.trans_role&&Object.hasOwnProperty.call(e,"trans_role")&&t.uint32(40).uint32(e.trans_role),null!=e.trans_send_time&&Object.hasOwnProperty.call(e,"trans_send_time")&&t.uint32(48).int64(e.trans_send_time),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(56).uint32(e.trans_seq),null!=e.err_code&&Object.hasOwnProperty.call(e,"err_code")&&t.uint32(64).int32(e.err_code),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StUserTransFetchResult;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.trans_type=e.bytes();break;case 2:r.trans_data=e.bytes();break;case 3:r.trans_idname=e.bytes();break;case 4:r.trans_nickname=e.bytes();break;case 5:r.trans_role=e.uint32();break;case 6:r.trans_send_time=e.int64();break;case 7:r.trans_seq=e.uint32();break;case 8:r.err_code=e.int32();break;default:e.skipType(7&o)}}return r},e}(),s.BigimChatReq=function(){function e(e){if(this.msgs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.nick_name=l.newBuffer([]),e.prototype.role=0,e.prototype.msgs=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.msgs&&e.msgs.length)for(var n=0;n<e.msgs.length;++n)h.liveroom_cs.StBigimChatData.encode(e.msgs[n],t.uint32(34).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.BigimChatReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.nick_name=e.bytes();break;case 3:r.role=e.uint32();break;case 4:r.msgs&&r.msgs.length||(r.msgs=[]),r.msgs.push(h.liveroom_cs.StBigimChatData.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StBigimChatData=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.msg_category=0,e.prototype.msg_type=0,e.prototype.msg_content=l.newBuffer([]),e.prototype.msg_timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.bigmsg_client_id=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.msg_category&&Object.hasOwnProperty.call(e,"msg_category")&&t.uint32(8).uint32(e.msg_category),null!=e.msg_type&&Object.hasOwnProperty.call(e,"msg_type")&&t.uint32(16).uint32(e.msg_type),null!=e.msg_content&&Object.hasOwnProperty.call(e,"msg_content")&&t.uint32(26).bytes(e.msg_content),null!=e.msg_timestamp&&Object.hasOwnProperty.call(e,"msg_timestamp")&&t.uint32(32).int64(e.msg_timestamp),null!=e.bigmsg_client_id&&Object.hasOwnProperty.call(e,"bigmsg_client_id")&&t.uint32(42).bytes(e.bigmsg_client_id),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StBigimChatData;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.msg_category=e.uint32();break;case 2:r.msg_type=e.uint32();break;case 3:r.msg_content=e.bytes();break;case 4:r.msg_timestamp=e.int64();break;case 5:r.bigmsg_client_id=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.BigimChatRsp=function(){function e(e){if(this.msgs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.bigim_time_window=0,e.prototype.msgs=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.bigim_time_window&&Object.hasOwnProperty.call(e,"bigim_time_window")&&t.uint32(16).uint32(e.bigim_time_window),null!=e.msgs&&e.msgs.length)for(var n=0;n<e.msgs.length;++n)h.liveroom_cs.StBigimChatRspData.encode(e.msgs[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.BigimChatRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.bigim_time_window=e.uint32();break;case 3:r.msgs&&r.msgs.length||(r.msgs=[]),r.msgs.push(h.liveroom_cs.StBigimChatRspData.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StBigimChatRspData=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.bigmsg_id=l.newBuffer([]),e.prototype.bigmsg_client_id=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.bigmsg_id&&Object.hasOwnProperty.call(e,"bigmsg_id")&&t.uint32(10).bytes(e.bigmsg_id),null!=e.bigmsg_client_id&&Object.hasOwnProperty.call(e,"bigmsg_client_id")&&t.uint32(18).bytes(e.bigmsg_client_id),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StBigimChatRspData;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.bigmsg_id=e.bytes();break;case 2:r.bigmsg_client_id=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.RelayReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.nick_name=l.newBuffer([]),e.prototype.role=0,e.prototype.relay_type=l.newBuffer([]),e.prototype.relay_data=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.relay_type&&Object.hasOwnProperty.call(e,"relay_type")&&t.uint32(34).bytes(e.relay_type),null!=e.relay_data&&Object.hasOwnProperty.call(e,"relay_data")&&t.uint32(42).bytes(e.relay_data),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.RelayReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.nick_name=e.bytes();break;case 3:r.role=e.uint32();break;case 4:r.relay_type=e.bytes();break;case 5:r.relay_data=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.RelayRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.reley_type=l.newBuffer([]),e.prototype.relay_result=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.reley_type&&Object.hasOwnProperty.call(e,"reley_type")&&t.uint32(18).bytes(e.reley_type),null!=e.relay_result&&Object.hasOwnProperty.call(e,"relay_result")&&t.uint32(26).bytes(e.relay_result),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.RelayRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.reley_type=e.bytes();break;case 3:r.relay_result=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.RenewTokenReq=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.req_head=null,e.prototype.token="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.req_head&&Object.hasOwnProperty.call(e,"req_head")&&h.liveroom_cs.ReqHead.encode(e.req_head,t.uint32(10).fork()).ldelim(),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(18).string(e.token),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.RenewTokenReq;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.req_head=h.liveroom_cs.ReqHead.decode(e,e.uint32());break;case 2:r.token=e.string();break;default:e.skipType(7&o)}}return r},e}(),s.RenewTokenRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rsp_head=null,e.prototype.token_remain_time=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.rsp_head&&Object.hasOwnProperty.call(e,"rsp_head")&&h.liveroom_cs.RspHead.encode(e.rsp_head,t.uint32(10).fork()).ldelim(),null!=e.token_remain_time&&Object.hasOwnProperty.call(e,"token_remain_time")&&t.uint32(16).uint32(e.token_remain_time),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.RenewTokenRsp;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.rsp_head=h.liveroom_cs.RspHead.decode(e,e.uint32());break;case 2:r.token_remain_time=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.UserAction=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.action=0,e.prototype.id_name=l.newBuffer([]),e.prototype.nick_name=l.newBuffer([]),e.prototype.role=0,e.prototype.login_time=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.action&&Object.hasOwnProperty.call(e,"action")&&t.uint32(8).uint32(e.action),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(18).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(26).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(32).uint32(e.role),null!=e.login_time&&Object.hasOwnProperty.call(e,"login_time")&&t.uint32(40).int64(e.login_time),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.UserAction;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.action=e.uint32();break;case 2:r.id_name=e.bytes();break;case 3:r.nick_name=e.bytes();break;case 4:r.role=e.uint32();break;case 5:r.login_time=e.int64();break;default:e.skipType(7&o)}}return r},e}(),s.PushUserInfoUpdated=function(){function e(e){if(this.user_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.room_id=l.newBuffer([]),e.prototype.server_user_seq=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.user_list=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).bytes(e.room_id),null!=e.server_user_seq&&Object.hasOwnProperty.call(e,"server_user_seq")&&t.uint32(16).int64(e.server_user_seq),null!=e.user_list&&e.user_list.length)for(var n=0;n<e.user_list.length;++n)h.liveroom_cs.UserAction.encode(e.user_list[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.PushUserInfoUpdated;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.room_id=e.bytes();break;case 2:r.server_user_seq=e.int64();break;case 3:r.user_list&&r.user_list.length||(r.user_list=[]),r.user_list.push(h.liveroom_cs.UserAction.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.PushUserKickout=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.id_name=l.newBuffer([]),e.prototype.room_id=l.newBuffer([]),e.prototype.session_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.kickout_reason=0,e.prototype.custom_reason=l.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.session_id&&Object.hasOwnProperty.call(e,"session_id")&&t.uint32(24).uint64(e.session_id),null!=e.kickout_reason&&Object.hasOwnProperty.call(e,"kickout_reason")&&t.uint32(32).int32(e.kickout_reason),null!=e.custom_reason&&Object.hasOwnProperty.call(e,"custom_reason")&&t.uint32(42).bytes(e.custom_reason),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.PushUserKickout;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.id_name=e.bytes();break;case 2:r.room_id=e.bytes();break;case 3:r.session_id=e.uint64();break;case 4:r.kickout_reason=e.int32();break;case 5:r.custom_reason=e.bytes();break;default:e.skipType(7&o)}}return r},e}(),s.PushUserLogReport=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.PushUserLogReport;e.pos<n;){var o=e.uint32();e.skipType(7&o)}return r},e}(),s.PushUserTokenExpire=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.room_id=l.newBuffer([]),e.prototype.token="",e.prototype.stop_stream=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).bytes(e.room_id),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(18).string(e.token),null!=e.stop_stream&&Object.hasOwnProperty.call(e,"stop_stream")&&h.liveroom_cs.StopStream.encode(e.stop_stream,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.PushUserTokenExpire;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.room_id=e.bytes();break;case 2:r.token=e.string();break;case 3:r.stop_stream=h.liveroom_cs.StopStream.decode(e,e.uint32());break;default:e.skipType(7&o)}}return r},e}(),s.StopStream=function(){function e(e){if(this.stream_id_list=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.stream_id_list=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.stream_id_list&&e.stream_id_list.length)for(var n=0;n<e.stream_id_list.length;++n)t.uint32(10).bytes(e.stream_id_list[n]);return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StopStream;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.stream_id_list&&r.stream_id_list.length||(r.stream_id_list=[]),r.stream_id_list.push(e.bytes());break;default:e.skipType(7&o)}}return r},e}(),s.PushStream=function(){function e(e){if(this.stream_info=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.room_id=l.newBuffer([]),e.prototype.stream_seq=0,e.prototype.stream_info=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).bytes(e.room_id),null!=e.stream_seq&&Object.hasOwnProperty.call(e,"stream_seq")&&t.uint32(16).uint32(e.stream_seq),null!=e.stream_info&&e.stream_info.length)for(var n=0;n<e.stream_info.length;++n)h.liveroom_cs.StPushStreamInfo.encode(e.stream_info[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.PushStream;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.room_id=e.bytes();break;case 2:r.stream_seq=e.uint32();break;case 3:r.stream_info&&r.stream_info.length||(r.stream_info=[]),r.stream_info.push(h.liveroom_cs.StPushStreamInfo.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StPushStreamInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.stream_id=l.newBuffer([]),e.prototype.stream_sid="",e.prototype.id_name=l.newBuffer([]),e.prototype.nick_name=l.newBuffer([]),e.prototype.extra_info=l.newBuffer([]),e.prototype.title=l.newBuffer([]),e.prototype.third_define_data=l.newBuffer([]),e.prototype.create_time=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.req_seq=0,e.prototype.stream_ver=0,e.prototype.stream_attr=l.newBuffer([]),e.prototype.stream_src=0,e.prototype.stream_state=0,e.prototype.stream_type=0,e.prototype.stream_nid=0,e.prototype.close_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(10).bytes(e.stream_id),null!=e.stream_sid&&Object.hasOwnProperty.call(e,"stream_sid")&&t.uint32(18).string(e.stream_sid),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(26).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(34).bytes(e.nick_name),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).bytes(e.extra_info),null!=e.title&&Object.hasOwnProperty.call(e,"title")&&t.uint32(50).bytes(e.title),null!=e.third_define_data&&Object.hasOwnProperty.call(e,"third_define_data")&&t.uint32(58).bytes(e.third_define_data),null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(64).int64(e.create_time),null!=e.req_seq&&Object.hasOwnProperty.call(e,"req_seq")&&t.uint32(72).uint32(e.req_seq),null!=e.stream_ver&&Object.hasOwnProperty.call(e,"stream_ver")&&t.uint32(80).uint32(e.stream_ver),null!=e.stream_attr&&Object.hasOwnProperty.call(e,"stream_attr")&&t.uint32(90).bytes(e.stream_attr),null!=e.stream_src&&Object.hasOwnProperty.call(e,"stream_src")&&t.uint32(96).uint32(e.stream_src),null!=e.stream_state&&Object.hasOwnProperty.call(e,"stream_state")&&t.uint32(104).uint32(e.stream_state),null!=e.stream_type&&Object.hasOwnProperty.call(e,"stream_type")&&t.uint32(112).uint32(e.stream_type),null!=e.stream_nid&&Object.hasOwnProperty.call(e,"stream_nid")&&t.uint32(120).uint32(e.stream_nid),null!=e.close_type&&Object.hasOwnProperty.call(e,"close_type")&&t.uint32(128).uint32(e.close_type),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StPushStreamInfo;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.stream_id=e.bytes();break;case 2:r.stream_sid=e.string();break;case 3:r.id_name=e.bytes();break;case 4:r.nick_name=e.bytes();break;case 5:r.extra_info=e.bytes();break;case 6:r.title=e.bytes();break;case 7:r.third_define_data=e.bytes();break;case 8:r.create_time=e.int64();break;case 9:r.req_seq=e.uint32();break;case 10:r.stream_ver=e.uint32();break;case 11:r.stream_attr=e.bytes();break;case 12:r.stream_src=e.uint32();break;case 13:r.stream_state=e.uint32();break;case 14:r.stream_type=e.uint32();break;case 15:r.stream_nid=e.uint32();break;case 16:r.close_type=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.PushImChat=function(){function e(e){if(this.msg_data=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.room_id=l.newBuffer([]),e.prototype.server_msg_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.ret_msg_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.msg_data=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(10).bytes(e.room_id),null!=e.server_msg_id&&Object.hasOwnProperty.call(e,"server_msg_id")&&t.uint32(16).uint64(e.server_msg_id),null!=e.ret_msg_id&&Object.hasOwnProperty.call(e,"ret_msg_id")&&t.uint32(24).uint64(e.ret_msg_id),null!=e.msg_data&&e.msg_data.length)for(var n=0;n<e.msg_data.length;++n)h.liveroom_cs.StImChatData.encode(e.msg_data[n],t.uint32(34).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.PushImChat;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.room_id=e.bytes();break;case 2:r.server_msg_id=e.uint64();break;case 3:r.ret_msg_id=e.uint64();break;case 4:r.msg_data&&r.msg_data.length||(r.msg_data=[]),r.msg_data.push(h.liveroom_cs.StImChatData.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StImChatData=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.id_name=l.newBuffer([]),e.prototype.nick_name=l.newBuffer([]),e.prototype.role=0,e.prototype.msg_id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.msg_category=0,e.prototype.msg_type=0,e.prototype.msg_priority=0,e.prototype.msg_content=l.newBuffer([]),e.prototype.send_time=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.msg_id&&Object.hasOwnProperty.call(e,"msg_id")&&t.uint32(32).uint64(e.msg_id),null!=e.msg_category&&Object.hasOwnProperty.call(e,"msg_category")&&t.uint32(40).uint32(e.msg_category),null!=e.msg_type&&Object.hasOwnProperty.call(e,"msg_type")&&t.uint32(48).uint32(e.msg_type),null!=e.msg_priority&&Object.hasOwnProperty.call(e,"msg_priority")&&t.uint32(56).uint32(e.msg_priority),null!=e.msg_content&&Object.hasOwnProperty.call(e,"msg_content")&&t.uint32(66).bytes(e.msg_content),null!=e.send_time&&Object.hasOwnProperty.call(e,"send_time")&&t.uint32(72).int64(e.send_time),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StImChatData;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.id_name=e.bytes();break;case 2:r.nick_name=e.bytes();break;case 3:r.role=e.uint32();break;case 4:r.msg_id=e.uint64();break;case 5:r.msg_category=e.uint32();break;case 6:r.msg_type=e.uint32();break;case 7:r.msg_priority=e.uint32();break;case 8:r.msg_content=e.bytes();break;case 9:r.send_time=e.int64();break;default:e.skipType(7&o)}}return r},e}(),s.PushBigImChat=function(){function e(e){if(this.msg_data=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.app_id=0,e.prototype.room_id=l.newBuffer([]),e.prototype.timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.msg_data=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(8).uint32(e.app_id),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(24).int64(e.timestamp),null!=e.msg_data&&e.msg_data.length)for(var n=0;n<e.msg_data.length;++n)h.liveroom_cs.StBigImChatData.encode(e.msg_data[n],t.uint32(34).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.PushBigImChat;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.app_id=e.uint32();break;case 2:r.room_id=e.bytes();break;case 3:r.timestamp=e.int64();break;case 4:r.msg_data&&r.msg_data.length||(r.msg_data=[]),r.msg_data.push(h.liveroom_cs.StBigImChatData.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StBigImChatData=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.id_name=l.newBuffer([]),e.prototype.nick_name=l.newBuffer([]),e.prototype.role=0,e.prototype.bigmsg_id=l.newBuffer([]),e.prototype.msg_category=0,e.prototype.msg_type=0,e.prototype.msg_content=l.newBuffer([]),e.prototype.msg_timestamp=l.Long?l.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(10).bytes(e.id_name),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(18).bytes(e.nick_name),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).uint32(e.role),null!=e.bigmsg_id&&Object.hasOwnProperty.call(e,"bigmsg_id")&&t.uint32(34).bytes(e.bigmsg_id),null!=e.msg_category&&Object.hasOwnProperty.call(e,"msg_category")&&t.uint32(40).uint32(e.msg_category),null!=e.msg_type&&Object.hasOwnProperty.call(e,"msg_type")&&t.uint32(48).uint32(e.msg_type),null!=e.msg_content&&Object.hasOwnProperty.call(e,"msg_content")&&t.uint32(58).bytes(e.msg_content),null!=e.msg_timestamp&&Object.hasOwnProperty.call(e,"msg_timestamp")&&t.uint32(64).int64(e.msg_timestamp),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StBigImChatData;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.id_name=e.bytes();break;case 2:r.nick_name=e.bytes();break;case 3:r.role=e.uint32();break;case 4:r.bigmsg_id=e.bytes();break;case 5:r.msg_category=e.uint32();break;case 6:r.msg_type=e.uint32();break;case 7:r.msg_content=e.bytes();break;case 8:r.msg_timestamp=e.int64();break;default:e.skipType(7&o)}}return r},e}(),s.PushTrans=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.app_id=0,e.prototype.room_id=l.newBuffer([]),e.prototype.trans_idname=l.newBuffer([]),e.prototype.trans_nickname=l.newBuffer([]),e.prototype.trans_role=0,e.prototype.trans_type=l.newBuffer([]),e.prototype.trans_data=l.newBuffer([]),e.prototype.trans_seq=0,e.prototype.trans_send_time=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.trans_channel=l.newBuffer([]),e.prototype.trans_list_seq=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(8).uint32(e.app_id),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.trans_idname&&Object.hasOwnProperty.call(e,"trans_idname")&&t.uint32(26).bytes(e.trans_idname),null!=e.trans_nickname&&Object.hasOwnProperty.call(e,"trans_nickname")&&t.uint32(34).bytes(e.trans_nickname),null!=e.trans_role&&Object.hasOwnProperty.call(e,"trans_role")&&t.uint32(40).uint32(e.trans_role),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(50).bytes(e.trans_type),null!=e.trans_data&&Object.hasOwnProperty.call(e,"trans_data")&&t.uint32(58).bytes(e.trans_data),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(64).uint32(e.trans_seq),null!=e.trans_send_time&&Object.hasOwnProperty.call(e,"trans_send_time")&&t.uint32(72).int64(e.trans_send_time),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(82).bytes(e.trans_channel),null!=e.trans_list_seq&&Object.hasOwnProperty.call(e,"trans_list_seq")&&t.uint32(88).uint32(e.trans_list_seq),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.PushTrans;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.app_id=e.uint32();break;case 2:r.room_id=e.bytes();break;case 3:r.trans_idname=e.bytes();break;case 4:r.trans_nickname=e.bytes();break;case 5:r.trans_role=e.uint32();break;case 6:r.trans_type=e.bytes();break;case 7:r.trans_data=e.bytes();break;case 8:r.trans_seq=e.uint32();break;case 9:r.trans_send_time=e.int64();break;case 10:r.trans_channel=e.bytes();break;case 11:r.trans_list_seq=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s.PushUserTrans=function(){function e(e){if(this.trans_array=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.app_id=0,e.prototype.room_id=l.newBuffer([]),e.prototype.trans_idname=l.newBuffer([]),e.prototype.trans_nickname=l.newBuffer([]),e.prototype.trans_role=0,e.prototype.trans_send_time=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.trans_channel=l.newBuffer([]),e.prototype.trans_array=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(8).uint32(e.app_id),null!=e.room_id&&Object.hasOwnProperty.call(e,"room_id")&&t.uint32(18).bytes(e.room_id),null!=e.trans_idname&&Object.hasOwnProperty.call(e,"trans_idname")&&t.uint32(26).bytes(e.trans_idname),null!=e.trans_nickname&&Object.hasOwnProperty.call(e,"trans_nickname")&&t.uint32(34).bytes(e.trans_nickname),null!=e.trans_role&&Object.hasOwnProperty.call(e,"trans_role")&&t.uint32(40).uint32(e.trans_role),null!=e.trans_send_time&&Object.hasOwnProperty.call(e,"trans_send_time")&&t.uint32(72).int64(e.trans_send_time),null!=e.trans_channel&&Object.hasOwnProperty.call(e,"trans_channel")&&t.uint32(82).bytes(e.trans_channel),null!=e.trans_array&&e.trans_array.length)for(var n=0;n<e.trans_array.length;++n)h.liveroom_cs.StTransSimple.encode(e.trans_array[n],t.uint32(90).fork()).ldelim();return t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.PushUserTrans;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.app_id=e.uint32();break;case 2:r.room_id=e.bytes();break;case 3:r.trans_idname=e.bytes();break;case 4:r.trans_nickname=e.bytes();break;case 5:r.trans_role=e.uint32();break;case 9:r.trans_send_time=e.int64();break;case 10:r.trans_channel=e.bytes();break;case 11:r.trans_array&&r.trans_array.length||(r.trans_array=[]),r.trans_array.push(h.liveroom_cs.StTransSimple.decode(e,e.uint32()));break;default:e.skipType(7&o)}}return r},e}(),s.StTransSimple=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trans_type=l.newBuffer([]),e.prototype.trans_data=l.newBuffer([]),e.prototype.trans_seq=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.trans_type&&Object.hasOwnProperty.call(e,"trans_type")&&t.uint32(10).bytes(e.trans_type),null!=e.trans_data&&Object.hasOwnProperty.call(e,"trans_data")&&t.uint32(18).bytes(e.trans_data),null!=e.trans_seq&&Object.hasOwnProperty.call(e,"trans_seq")&&t.uint32(24).uint32(e.trans_seq),t},e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new h.liveroom_cs.StTransSimple;e.pos<n;){var o=e.uint32();switch(o>>>3){case 1:r.trans_type=e.bytes();break;case 2:r.trans_data=e.bytes();break;case 3:r.trans_seq=e.uint32();break;default:e.skipType(7&o)}}return r},e}(),s),e.exports=h},function(e,t,n){var r,o=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;
/**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   */
var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}function o(e){var t=Math.clz32(e&-e);return e?31-t:t}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var i={},s={};function a(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=s[e])?r:(n=u(e,0,!0),o&&(s[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=i[e])?r:(n=u(e,e<0?-1:0,!1),o&&(i[e]=n),n)}function c(e,t){if(isNaN(e))return t?y:m;if(t){if(e<0)return y;if(e>=d)return T}else{if(e<=-_)return S;if(e+1>=_)return O}return e<0?c(-e,t).neg():u(e%f|0,e/f|0,t)}function u(e,t,r){return new n(e,t,r)}n.fromInt=a,n.fromNumber=c,n.fromBits=u;var l=Math.pow;function h(e,t,n){if(0===e.length)throw Error("empty string");if("number"==typeof t?(n=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?y:m;if((n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return h(e.substring(1),t,n).neg();for(var o=c(l(n,8)),i=m,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+a),n);if(a<8){var p=c(l(n,a));i=i.mul(p).add(c(u))}else i=(i=i.mul(o)).add(c(u))}return i.unsigned=t,i}function p(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?h(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}n.fromString=h,n.fromValue=p;var f=4294967296,d=f*f,_=d/2,g=a(1<<24),m=a(0);n.ZERO=m;var y=a(0,!0);n.UZERO=y;var v=a(1);n.ONE=v;var b=a(1,!0);n.UONE=b;var E=a(-1);n.NEG_ONE=E;var O=u(-1,2147483647,!1);n.MAX_VALUE=O;var T=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=T;var S=u(0,-2147483648,!1);n.MIN_VALUE=S;var R=n.prototype;R.toInt=function(){return this.unsigned?this.low>>>0:this.low},R.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},R.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=c(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=c(l(e,6),this.unsigned),i=this,s="";;){var a=i.div(o),u=(i.sub(a.mul(o)).toInt()>>>0).toString(e);if((i=a).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},R.getHighBits=function(){return this.high},R.getHighBitsUnsigned=function(){return this.high>>>0},R.getLowBits=function(){return this.low},R.getLowBitsUnsigned=function(){return this.low>>>0},R.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},R.isZero=function(){return 0===this.high&&0===this.low},R.eqz=R.isZero,R.isNegative=function(){return!this.unsigned&&this.high<0},R.isPositive=function(){return this.unsigned||this.high>=0},R.isOdd=function(){return 1==(1&this.low)},R.isEven=function(){return 0==(1&this.low)},R.equals=function(e){return r(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},R.eq=R.equals,R.notEquals=function(e){return!this.eq(e)},R.neq=R.notEquals,R.ne=R.notEquals,R.lessThan=function(e){return this.comp(e)<0},R.lt=R.lessThan,R.lessThanOrEqual=function(e){return this.comp(e)<=0},R.lte=R.lessThanOrEqual,R.le=R.lessThanOrEqual,R.greaterThan=function(e){return this.comp(e)>0},R.gt=R.greaterThan,R.greaterThanOrEqual=function(e){return this.comp(e)>=0},R.gte=R.greaterThanOrEqual,R.ge=R.greaterThanOrEqual,R.compare=function(e){if(r(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},R.comp=R.compare,R.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(v)},R.neg=R.negate,R.add=function(e){r(e)||(e=p(e));var t=this.high>>>16,n=65535&this.high,o=this.low>>>16,i=65535&this.low,s=e.high>>>16,a=65535&e.high,c=e.low>>>16,l=0,h=0,f=0,d=0;return f+=(d+=i+(65535&e.low))>>>16,h+=(f+=o+c)>>>16,l+=(h+=n+a)>>>16,l+=t+s,u((f&=65535)<<16|(d&=65535),(l&=65535)<<16|(h&=65535),this.unsigned)},R.subtract=function(e){return r(e)||(e=p(e)),this.add(e.neg())},R.sub=R.subtract,R.multiply=function(e){if(this.isZero())return this;if(r(e)||(e=p(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?y:m;if(this.eq(S))return e.isOdd()?S:m;if(e.eq(S))return this.isOdd()?S:m;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return c(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=65535&this.high,i=this.low>>>16,s=65535&this.low,a=e.high>>>16,l=65535&e.high,h=e.low>>>16,f=65535&e.low,d=0,_=0,v=0,b=0;return v+=(b+=s*f)>>>16,_+=(v+=i*f)>>>16,v&=65535,_+=(v+=s*h)>>>16,d+=(_+=o*f)>>>16,_&=65535,d+=(_+=i*h)>>>16,_&=65535,d+=(_+=s*l)>>>16,d+=n*f+o*h+i*l+s*a,u((v&=65535)<<16|(b&=65535),(d&=65535)<<16|(_&=65535),this.unsigned)},R.mul=R.multiply,R.divide=function(e){if(r(e)||(e=p(e)),e.isZero())throw Error("division by zero");var n,o,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:m;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return b;i=y}else{if(this.eq(S))return e.eq(v)||e.eq(E)?S:e.eq(S)?v:(n=this.shr(1).div(e).shl(1)).eq(m)?e.isNegative()?v:E:(o=this.sub(e.mul(n)),i=n.add(o.div(e)));if(e.eq(S))return this.unsigned?y:m;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=m}for(o=this;o.gte(e);){n=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),a=s<=48?1:l(2,s-48),h=c(n),f=h.mul(e);f.isNegative()||f.gt(o);)f=(h=c(n-=a,this.unsigned)).mul(e);h.isZero()&&(h=v),i=i.add(h),o=o.sub(f)}return i},R.div=R.divide,R.modulo=function(e){return r(e)||(e=p(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},R.mod=R.modulo,R.rem=R.modulo,R.not=function(){return u(~this.low,~this.high,this.unsigned)},R.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},R.clz=R.countLeadingZeros,R.countTrailingZeros=function(){return this.low?o(this.low):o(this.high)+32},R.ctz=R.countTrailingZeros,R.and=function(e){return r(e)||(e=p(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},R.or=function(e){return r(e)||(e=p(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},R.xor=function(e){return r(e)||(e=p(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},R.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},R.shl=R.shiftLeft,R.shiftRight=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},R.shr=R.shiftRight,R.shiftRightUnsigned=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):u(32===e?this.high:this.high>>>e-32,0,this.unsigned)},R.shru=R.shiftRightUnsigned,R.shr_u=R.shiftRightUnsigned,R.rotateLeft=function(e){var t;return r(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?u(this.high,this.low,this.unsigned):e<32?(t=32-e,u(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),u(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},R.rotl=R.rotateLeft,R.rotateRight=function(e){var t;return r(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?u(this.high,this.low,this.unsigned):e<32?(t=32-e,u(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),u(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},R.rotr=R.rotateRight,R.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},R.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},R.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},R.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},R.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var k=n;return e.default=k,"default"in e?e.default:e}({});void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)},,function(e,t,n){var r;e.exports=(r=n(2),n(39),n(16),n(17),n(42),function(){var e=r,t=e.lib.BlockCipher,n=e.algo,o=[],i=[],s=[],a=[],c=[],u=[],l=[],h=[],p=[],f=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,r=0;for(t=0;t<256;t++){var d=r^r<<1^r<<2^r<<3^r<<4;d=d>>>8^255&d^99,o[n]=d,i[d]=n;var _=e[n],g=e[_],m=e[g],y=257*e[d]^16843008*d;s[n]=y<<24|y>>>8,a[n]=y<<16|y>>>16,c[n]=y<<8|y>>>24,u[n]=y,y=16843009*m^65537*g^257*_^16843008*n,l[d]=y<<24|y>>>8,h[d]=y<<16|y>>>16,p[d]=y<<8|y>>>24,f[d]=y,n?(n=_^e[e[e[m^_]]],r^=e[e[r]]):n=r=1}}();var d=[0,1,2,4,8,16,32,64,128,27,54],_=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],s=0;s<r;s++)s<n?i[s]=t[s]:(u=i[s-1],s%n?n>6&&s%n==4&&(u=o[u>>>24]<<24|o[u>>>16&255]<<16|o[u>>>8&255]<<8|o[255&u]):(u=o[(u=u<<8|u>>>24)>>>24]<<24|o[u>>>16&255]<<16|o[u>>>8&255]<<8|o[255&u],u^=d[s/n|0]<<24),i[s]=i[s-n]^u);for(var a=this._invKeySchedule=[],c=0;c<r;c++){if(s=r-c,c%4)var u=i[s];else u=i[s-4];a[c]=c<4||s<=4?u:l[o[u>>>24]]^h[o[u>>>16&255]]^p[o[u>>>8&255]]^f[o[255&u]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,a,c,u,o)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,h,p,f,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,s,a){for(var c=this._nRounds,u=e[t]^n[0],l=e[t+1]^n[1],h=e[t+2]^n[2],p=e[t+3]^n[3],f=4,d=1;d<c;d++){var _=r[u>>>24]^o[l>>>16&255]^i[h>>>8&255]^s[255&p]^n[f++],g=r[l>>>24]^o[h>>>16&255]^i[p>>>8&255]^s[255&u]^n[f++],m=r[h>>>24]^o[p>>>16&255]^i[u>>>8&255]^s[255&l]^n[f++],y=r[p>>>24]^o[u>>>16&255]^i[l>>>8&255]^s[255&h]^n[f++];u=_,l=g,h=m,p=y}_=(a[u>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&p])^n[f++],g=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[p>>>8&255]<<8|a[255&u])^n[f++],m=(a[h>>>24]<<24|a[p>>>16&255]<<16|a[u>>>8&255]<<8|a[255&l])^n[f++],y=(a[p>>>24]<<24|a[u>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^n[f++],e[t]=_,e[t+1]=g,e[t+2]=m,e[t+3]=y},keySize:8});e.AES=t._createHelper(_)}(),r.AES)},function(e,t,n){var r;e.exports=(r=n(2),function(e){var t=r,n=t.lib,o=n.WordArray,i=n.Hasher,s=t.algo,a=[];!function(){for(var t=0;t<64;t++)a[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=s.MD5=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,s=e[t+0],c=e[t+1],f=e[t+2],d=e[t+3],_=e[t+4],g=e[t+5],m=e[t+6],y=e[t+7],v=e[t+8],b=e[t+9],E=e[t+10],O=e[t+11],T=e[t+12],S=e[t+13],R=e[t+14],k=e[t+15],C=i[0],w=i[1],N=i[2],M=i[3];C=u(C,w,N,M,s,7,a[0]),M=u(M,C,w,N,c,12,a[1]),N=u(N,M,C,w,f,17,a[2]),w=u(w,N,M,C,d,22,a[3]),C=u(C,w,N,M,_,7,a[4]),M=u(M,C,w,N,g,12,a[5]),N=u(N,M,C,w,m,17,a[6]),w=u(w,N,M,C,y,22,a[7]),C=u(C,w,N,M,v,7,a[8]),M=u(M,C,w,N,b,12,a[9]),N=u(N,M,C,w,E,17,a[10]),w=u(w,N,M,C,O,22,a[11]),C=u(C,w,N,M,T,7,a[12]),M=u(M,C,w,N,S,12,a[13]),N=u(N,M,C,w,R,17,a[14]),C=l(C,w=u(w,N,M,C,k,22,a[15]),N,M,c,5,a[16]),M=l(M,C,w,N,m,9,a[17]),N=l(N,M,C,w,O,14,a[18]),w=l(w,N,M,C,s,20,a[19]),C=l(C,w,N,M,g,5,a[20]),M=l(M,C,w,N,E,9,a[21]),N=l(N,M,C,w,k,14,a[22]),w=l(w,N,M,C,_,20,a[23]),C=l(C,w,N,M,b,5,a[24]),M=l(M,C,w,N,R,9,a[25]),N=l(N,M,C,w,d,14,a[26]),w=l(w,N,M,C,v,20,a[27]),C=l(C,w,N,M,S,5,a[28]),M=l(M,C,w,N,f,9,a[29]),N=l(N,M,C,w,y,14,a[30]),C=h(C,w=l(w,N,M,C,T,20,a[31]),N,M,g,4,a[32]),M=h(M,C,w,N,v,11,a[33]),N=h(N,M,C,w,O,16,a[34]),w=h(w,N,M,C,R,23,a[35]),C=h(C,w,N,M,c,4,a[36]),M=h(M,C,w,N,_,11,a[37]),N=h(N,M,C,w,y,16,a[38]),w=h(w,N,M,C,E,23,a[39]),C=h(C,w,N,M,S,4,a[40]),M=h(M,C,w,N,s,11,a[41]),N=h(N,M,C,w,d,16,a[42]),w=h(w,N,M,C,m,23,a[43]),C=h(C,w,N,M,b,4,a[44]),M=h(M,C,w,N,T,11,a[45]),N=h(N,M,C,w,k,16,a[46]),C=p(C,w=h(w,N,M,C,f,23,a[47]),N,M,s,6,a[48]),M=p(M,C,w,N,y,10,a[49]),N=p(N,M,C,w,R,15,a[50]),w=p(w,N,M,C,g,21,a[51]),C=p(C,w,N,M,T,6,a[52]),M=p(M,C,w,N,d,10,a[53]),N=p(N,M,C,w,E,15,a[54]),w=p(w,N,M,C,c,21,a[55]),C=p(C,w,N,M,v,6,a[56]),M=p(M,C,w,N,k,10,a[57]),N=p(N,M,C,w,m,15,a[58]),w=p(w,N,M,C,S,21,a[59]),C=p(C,w,N,M,_,6,a[60]),M=p(M,C,w,N,O,10,a[61]),N=p(N,M,C,w,f,15,a[62]),w=p(w,N,M,C,b,21,a[63]),i[0]=i[0]+C|0,i[1]=i[1]+w|0,i[2]=i[2]+N|0,i[3]=i[3]+M|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296),s=r;n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(n.length+1),this._process();for(var a=this._hash,c=a.words,u=0;u<4;u++){var l=c[u];c[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return a},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,n,r,o,i,s){var a=e+(t&n|~t&r)+o+s;return(a<<i|a>>>32-i)+t}function l(e,t,n,r,o,i,s){var a=e+(t&r|n&~r)+o+s;return(a<<i|a>>>32-i)+t}function h(e,t,n,r,o,i,s){var a=e+(t^n^r)+o+s;return(a<<i|a>>>32-i)+t}function p(e,t,n,r,o,i,s){var a=e+(n^(t|~r))+o+s;return(a<<i|a>>>32-i)+t}t.MD5=i._createHelper(c),t.HmacMD5=i._createHmacHelper(c)}(Math),r.MD5)},function(e,t,n){var r,o,i,s,a,c,u,l;e.exports=(l=n(2),n(40),n(41),o=(r=l).lib,i=o.Base,s=o.WordArray,a=r.algo,c=a.MD5,u=a.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,r=this.cfg,o=r.hasher.create(),i=s.create(),a=i.words,c=r.keySize,u=r.iterations;a.length<c;){n&&o.update(n),n=o.update(e).finalize(t),o.reset();for(var l=1;l<u;l++)n=o.finalize(n),o.reset();i.concat(n)}return i.sigBytes=4*c,i}}),r.EvpKDF=function(e,t,n){return u.create(n).compute(e,t)},l.EvpKDF)},function(e,t,n){var r;e.exports=(r=n(2),r.enc.Utf8)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STORE_SECRET=t.BIZ_TYPE=t.PROTO_VER=t.CRYPT_VERSION=t.SDK_CONN_TYPE=t.APP_CONFIG_KEY=t.NET_ACCESS_SERVERS=t.ROOM_BASIC=t.INIT=t.CLOUD_SETTING=void 0,t.CLOUD_SETTING={product:"Web_SDK",URL:["https://cloud-setting-api.zego.im/cloud-setting/get","https://cloud-setting-api.zegocloud.com/cloud-setting/get"],ONLINE:!1},t.INIT="init",t.ROOM_BASIC="room";t.SDK_CONN_TYPE=2;t.CRYPT_VERSION=1;t.PROTO_VER=131072;t.BIZ_TYPE=0;t.STORE_SECRET="0c9e6e0f8c0a8f4e",t.NET_ACCESS_SERVERS="z_net_access_servers",t.APP_CONFIG_KEY="z_appconfig"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeartBeatHandler=void 0;var r=n(0),o=n(3),i=n(1),s=n(4),a=n(6),c=function(){function e(e,t,n,r,o,i){this.logger=e,this.stateCenter=t,this.dataReport=n,this.service=r,this.liveRoomHandler=o,this.room=i,this.tryHeartbeatCount=0,this.heartbeatTimer=null,this.loginHeartbeatTimer=null,this.initCount=0}return e.prototype.init=function(e){var t,n=this;t=e.body.hearbeat_interval<r.MINIUM_HEARTBEAT_INTERVAL?r.MINIUM_HEARTBEAT_INTERVAL:e.body.hearbeat_interval,this.tryHeartbeatCount=0,this.heartbeatTimer&&clearTimeout(this.heartbeatTimer),this.loginHeartbeatTimer=setTimeout((function(){n.start(t)}),t),this.initCount++},e.prototype.start=function(e){var t=this;this.logger.info(s.ZEGO_RTM_ACTION.HEARTBEAT_START+" call");var n=r.getReportSeq();if(this.dataReport.newReport(n,a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.event),this.dataReport.addMsgInfo(n,{room_sid:a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.room_sid(this.room.sessionID)}),!this.room.isLogin())return this.logger.error(s.ZEGO_RTM_ACTION.HEARTBEAT_START+" state error"),this.dataReport.addMsgInfo(n,{error:a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.error.NOT_LOGIN.code,message:a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.error.NOT_LOGIN.msg}),void this.dataReport.uploadReport(n);if(++this.tryHeartbeatCount>3)return this.logger.error(s.ZEGO_RTM_ACTION.HEARTBEAT_START+" come to try limit"),this.dataReport.addMsgInfo(n,{error:a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.error.HB_TIMEOUT.code,message:a.ZegoRTMLogEvent.kZegoTaskLiveRoomHB.error.HB_TIMEOUT.msg}),this.dataReport.uploadReport(n),void this.hbLogout(i.errorCodeList.HEARTBEAT_TIMEOUT);var c=function(e){var r="PRIVATE"==t.stateCenter.type?e.body&&e.body.code:e.body&&e.body.err_code;if(e.header&&e.body){if(0!==r){var s=o.ClientUtil.decodeServerError(e.body.err_code||e.body.code,e.body.err_message||e.body.message);t.dataReport.addMsgInfo(n,{error:s.code,message:s.message+e.body.err_code})}}else t.dataReport.addMsgInfo(n,{error:e.code>0?e.code:i.errorCodeList.ROOM_INNER_ERROR.code,message:e.msg?e.msg:i.errorCodeList.ROOM_INNER_ERROR});t.dataReport.uploadReport(n),t.handleHeartbeatRsp(e)};(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).heartBeat(c,c,this.room),this.heartbeatInterval=e;var u=this.heartbeatInterval;this.initCount>=2?(u=Math.round(Math.random()*(this.heartbeatInterval+1)),this.initCount=1):u=this.heartbeatInterval,this.heartbeatTimer=setTimeout((function(){t.start(t.heartbeatInterval)}),u),this.logger.info(s.ZEGO_RTM_ACTION.HEARTBEAT_START+" call success")},e.prototype.handleHeartbeatRsp=function(e){return e.body&&e.body.err_code&&0!==e.body.err_code?(this.logger.error(s.ZEGO_RTM_ACTION.HEARTBEAT_HEARTBEAT_RSP+" disconnect, server error=",e.body.err_code),e.body.err_code==r.ERROR_CODES.ROOM_SESSION_ID_ERR?void this.hbLogout(i.errorCodeList.HEARTBEAT_TIMEOUT):void this.hbLogout(o.ClientUtil.getServerError(e.body.err_code))):e.header&&e.body?(this.tryHeartbeatCount=0,0!==e.body.hearbeat_interval&&(this.heartbeatInterval=e.body.hearbeat_interval,this.heartbeatInterval<r.MINIUM_HEARTBEAT_INTERVAL&&(this.heartbeatInterval=r.MINIUM_HEARTBEAT_INTERVAL)),this.heartbeatRspNotiFy(e),void this.logger.info(s.ZEGO_RTM_ACTION.HEARTBEAT_HEARTBEAT_RSP+" call success")):(this.logger.error(s.ZEGO_RTM_ACTION.HEARTBEAT_HEARTBEAT_RSP+" disconnect, error=",JSON.stringify(e)),void this.hbLogout(e))},e.prototype.heartbeatRspNotiFy=function(e){},e.prototype.hbLogout=function(e){},e.prototype.resetHeartbeat=function(){clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null,clearTimeout(this.loginHeartbeatTimer),this.loginHeartbeatTimer=null,this.tryHeartbeatCount=0,this.initCount=0,this.logger.info(s.ZEGO_RTM_ACTION.HEARTBEAT_RESET+" call success")},e}();t.HeartBeatHandler=c},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.UserHandler=void 0;var o=n(0),i=n(3),s=n(4),a=n(6),c=function(){function e(e,t,n,r,o,i){this.logger=e,this.stateCenter=t,this.dataReport=n,this.service=r,this.liveRoomHandler=o,this.room=i,this.userQuerying=!1,this.userTempList=[],this.userSeq=0,this.minUserSeq=0,this.userList=[],this.userSeqMergeMap=null,this.userListInterval=3e4,this.userListMergeInterval=5e3,this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""}}return e.prototype.loginRsp=function(e,t){this.anchor_info=e.body.anchor_info||this.anchor_info,this.userListInterval=e.body.userlist_interval||this.userListInterval,this.userListMergeInterval=e.body.userlist_merge_timeout||this.userListMergeInterval,e.body.anchor_info&&(this.stateCenter.actionListener("getAnchorInfo",e.body.anchor_info.anchor_id_name,e.body.anchor_info.anchor_nick_name),this.stateCenter.actionListener("_getAnchorInfo",e.body.anchor_info.anchor_id_name,e.body.anchor_info.anchor_nick_name)),e.body.online_count&&this.stateCenter.actionListener("roomOnlineUserCountUpdate",this.room.roomID,e.body.online_count),this.logger.info(s.ZEGO_RTM_ACTION.USER_LOGIN_RSP+"  userStateUpdate "+this.stateCenter.userStateUpdate),this.stateCenter.userStateUpdate&&this.fetchUserList(t)},e.prototype.patchUserList=function(e){var t=this;e.body.server_user_seq!==this.userSeq&&this.stateCenter.userStateUpdate&&!this.userSeqMergeMap&&(this.logger.info(s.ZEGO_RTM_ACTION.USER_HB_PATCH+" call update user "+this.userSeq+" server "+e.body.server_user_seq),this.userSeqMergeMap||(this.userSeqMergeMap={}),this.userSeqMergeTimer&&clearTimeout(this.userSeqMergeTimer),this.userSeqMergeTimer=setTimeout((function(){t.handleMergeTimeout()}),this.userListMergeInterval)),this.minUserSeq=e.body.server_user_seq,null!=e.body.online_count&&0!=e.body.online_count&&this.stateCenter.actionListener("roomOnlineUserCountUpdate",this.room.roomID,e.body.online_count)},e.prototype.resetUserHandler=function(){this.userQuerying=!1,this.lastUserQueryTime=0,this.userTempList=[],this.userSeq=0,this.minUserSeq=0,this.userList=void 0,this.userSeqMergeMap={},this.userSeqMergeTimer=void 0,this.userQueryTimer=void 0,this.userListInterval=3e4,this.userListMergeInterval=5e3,this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""}},e.prototype.fetchUserList=function(e){this.userQuerying?this.logger.warn(s.ZEGO_RTM_ACTION.USER_FETCH_USER+" is already querying"):(this.userQuerying=!0,this.userTempList=[],this.fetchUserListWithPage(0,e||0),this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER+" the first time call"))},e.prototype.fetchUserListWithPage=function(e,t){var n=this,r=function(e){n.handleFetchUserListRsp(e,t)},o={user_index:e,sort_type:0};(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).fetchUserList(o,r,r,this.room)},e.prototype.handleFetchUserListRsp=function(e,t){var n=this;if(e.body&&0!=e.body.err_code)return this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,void this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER_RSP+" fetch error "+e.body.err_code);if(!e.header||!e.body)return this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,void this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER_RSP+" fetch error "+e);if(this.stateCenter.userStateUpdate){this.userTempList=r(this.userTempList,e.body.user_baseinfos);var a=e.body.ret_user_index;if(a!=e.body.server_user_index)return this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER_RSP+" fetch another page"),void this.fetchUserListWithPage(a+1,t);this.userSeq=e.body.server_user_seq;for(var c=[],u=[],l=0;l<this.userTempList.length;l++){var h={userID:this.userTempList[l].id_name,userName:this.userTempList[l].nick_name,role:this.userTempList[l].role};c.push(h),u.push({idName:this.userTempList[l].id_name,nickName:this.userTempList[l].nick_name,role:this.userTempList[l].role})}this.stateCenter.actionListener("_getTotalUserList",this.room.roomID,u),t==o.ENUM_RUN_STATE.login?(this.userList&&i.ClientUtil.mergeUserList(this.logger,this.userList,c,(function(e,t){0!==e.length&&n.onUserStateUpdate(n.room.roomID,"ADD",e),0!==t.length&&n.onUserStateUpdate(n.room.roomID,"DELETE",t)})),this.userList=c):(this.userList=c,0!==c.length&&this.onUserStateUpdate(this.room.roomID,"ADD",c)),this.userQuerying=!1,this.lastUserQueryTime=Date.now()+this.userListInterval,this.userTempList=[],this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER_RSP+" call success user_list "+c+" count "+c.length)}},e.prototype.handlePushUserStateUpdateMsg=function(e){if(this.logger.info(s.ZEGO_RTM_ACTION.USER_USER_PUSH+" call"),this.stateCenter.userStateUpdate)if(this.userSeq!==e.body.user_list_seq)if(this.userSeq+e.body.user_actions.length===e.body.user_list_seq){this.userSeq=e.body.user_list_seq;var t,n,r=[];if("PRIVATE"==this.stateCenter.type){t=0,n=1;for(var o=0;o<e.body.user_actions.length;o++){var i={action:e.body.user_actions[o].action,idName:e.body.user_actions[o].user_id,nickName:e.body.user_actions[o].user_name,role:e.body.user_actions[o].role,loginTime:e.body.user_actions[o].login_time};r.push(i)}}else{t=1,n=2;for(o=0;o<e.body.user_actions.length;o++){i={action:e.body.user_actions[o].Action,idName:e.body.user_actions[o].IdName,nickName:e.body.user_actions[o].NickName,role:e.body.user_actions[o].Role,loginTime:e.body.user_actions[o].LoginTime};r.push(i)}this.stateCenter.actionListener("_userStateUpdate",e.body.room_id,r)}var a=[],c=[];r.forEach((function(e){e.action==t?a.push({userID:e.idName,userName:e.nickName,role:e.role}):e.action==n&&c.push({userID:e.idName,userName:e.nickName,role:e.role})})),this.userList&&(this.userList=this.userList.concat(a).filter((function(e){return!c.some((function(t){return t.userID==e.userID}))}))),0!==a.length&&this.onUserStateUpdate(e.body.room_id||e.body.room_pushheader.room_id,"ADD",a),0!==c.length&&this.onUserStateUpdate(e.body.room_id||e.body.room_pushheader.room_id,"DELETE",c),this.logger.info(s.ZEGO_RTM_ACTION.USER_USER_PUSH+" call success")}else this.mergeUserByUserSeq(e.body.user_list_seq,e.body.user_actions);else this.logger.warn(s.ZEGO_RTM_ACTION.USER_USER_PUSH+" user_list_seq is the same with local seq");else this.logger.info(s.ZEGO_RTM_ACTION.USER_USER_PUSH+" userStateUpdate is false")},e.prototype.onUserStateUpdate=function(e,t,n){var r=this,i=o.getReportSeq();this.dataReport.newReport(i,a.ZegoRTMLogEvent.kZegoTaskLiveRoomGetUserUpdateInfo.event);var s=n.filter((function(e){return e.userID!==r.stateCenter.idName}));0!=s.length&&("PRIVATE"!==this.stateCenter.type&&(s=s.map((function(e){return{userID:e.userID,userName:e.userName}}))),this.stateCenter.actionListener("roomUserUpdate",e,t,s),this.dataReport.addMsgInfo(i,{user_update_type:"ADD"==t?a.ZegoRTMLogEvent.kZegoTaskLiveRoomGetUserUpdateInfo.user_update_type("added"):a.ZegoRTMLogEvent.kZegoTaskLiveRoomGetUserUpdateInfo.user_update_type("deleted")}),this.dataReport.uploadReport(i))},e.prototype.mergeUserByUserSeq=function(e,t){var n=this;this.userSeqMergeMap||(this.logger.warn(s.ZEGO_RTM_ACTION.USER_MERGE_SEQ+" new merge userlist "+this.userSeq+" server "+e),this.userSeqMergeMap={},this.userSeqMergeTimer&&clearTimeout(this.userSeqMergeTimer),this.userSeqMergeTimer=setTimeout((function(){n.handleMergeTimeout()}),this.userListMergeInterval)),this.userSeqMergeMap[e]=t,this.logger.warn(s.ZEGO_RTM_ACTION.USER_MERGE_SEQ+"  merge userlist "+this.userSeq+" server "+e+" userlist "+t.length)},e.prototype.mergeUser=function(e){var t=this;this.logger.info(s.ZEGO_RTM_ACTION.USER_MERGE+" merge userlist "+this.userSeq+" userSeqList "+e.join(",")),this.userSeq=e[e.length-1],this.lastUserQueryTime=Date.now()+this.userListInterval;var n={};e.forEach((function(e){t.userSeqMergeMap&&t.userSeqMergeMap[e].forEach((function(e){n[e.IdName]=e}))})),this.userSeqMergeMap=null;var r=Object.values(n).map((function(e){return{action:e.Action,idName:e.IdName,nickName:e.NickName,role:e.Role,loginTime:e.LoginTime?String(e.LoginTime):""}}));r.sort((function(e,t){return e.loginTime.localeCompare(t.loginTime)}));var o=[],i=[];r.forEach((function(e){1==e.action?o.push({userID:e.idName,userName:e.nickName,role:e.role}):2==e.action&&i.push({userID:e.idName,userName:e.nickName,role:e.role})})),this.userList=this.userList&&this.userList.concat(o).filter((function(e){return!i.some((function(t){return t.userID==e.userID}))})),0!==o.length&&this.onUserStateUpdate(this.room.roomID,"ADD",o),0!==i.length&&this.onUserStateUpdate(this.room.roomID,"DELETE",i),this.stateCenter.actionListener("_userStateUpdate",this.room.roomID,r)},e.prototype.handleMergeTimeout=function(){var e=this,t=Object.keys(this.userSeqMergeMap).map((function(e){return+e})).sort((function(e,t){return e-t}));if(t[t.length-1]-t[0]+1===t.length||t[t.length-1]>=this.minUserSeq)this.mergeUser(t);else{this.userSeqMergeMap=null;var n=this.lastUserQueryTime-Date.now();this.logger.info(s.ZEGO_RTM_ACTION.USER_MERGE_TIMEOUT+"  fetch merge userlist "+this.userSeq+" userSeqList "+t.join(",")+" wait "+n),n>0?(this.userQueryTimer&&clearTimeout(this.userQueryTimer),this.userQueryTimer=setTimeout((function(){e.fetchUserList()}),n)):this.fetchUserList()}},e.prototype.loginPrivateRsp=function(e){this.logger.info(s.ZEGO_RTM_ACTION.USER_FETCH_USER," userStateUpdate "+this.stateCenter.userStateUpdate),this.stateCenter.userStateUpdate&&this.fetchUserList()},e}();t.UserHandler=c},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.LiveRoomService=void 0;var i=n(0),s=n(23),a=n(4),c=n(1),u=function(){function e(e,t,n){this.stateCenter=e,this.logger=t,this.rtm=n,this.service=new s.ZegoSocketService(this.stateCenter.ENV),this.cmdSeq=0,this.responseRouters={}}return e.prototype.checkResponse=function(e){return 0!=this.stateCenter.roomModulesList.filter((function(e){return e.runState!==i.ENUM_RUN_STATE.logout})).length&&(e.header.appid!==this.stateCenter.appid||e.header.user_id!==this.stateCenter.userid)},e.prototype.handleSendCommandMsgRsp=function(e){var t=this,n=this.service.sendCommandMap[e.header.seq];if(null!=n){var r=n._data;delete this.service.sendCommandMap[e.header.seq],this.service.sendCommandList.remove(n),0===e.body.err_code?setTimeout((function(){r&&null!=r.success&&r.success(e,t.cmdSeq)}),0):setTimeout((function(){r&&null!=r.error&&r.error(e,t.cmdSeq)}),0)}},e.prototype.onPush=function(){var e=this;this.service.onMessage=function(t){t instanceof ArrayBuffer?e.stateCenter.actionListener("_protobufResponse",t):t.header?(0!==t.body.err_code?t.body.err_message&&e.logger.error(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" cmd="+t.header.cmd+", err_code="+t.body.err_code+", err_message="+t.body.err_message+" "):e.logger.info(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" cmd="+t.header.cmd+", msg="+JSON.stringify(t)+" "),["login","logout"].indexOf(t.header.cmd)>-1?e.handleSendCommandMsgRsp(t):e.checkResponse(t)?e.logger.error(a.ZEGO_RTM_ACTION.SERVICE_PUSH+"  check session fail."):(e.logger.info(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" cmd="+t.header.cmd+",function="+!!e.responseRouters[t.header.cmd]),e.handleSendCommandMsgRsp(t),e.responseRouters[t.header.cmd]&&e.responseRouters[t.header.cmd](t,e.cmdSeq))):e.logger.error(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" msg type error ")}},e.prototype.handlePushKickout=function(e){var t,n,r,i;if(void 0===(null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.protocol)||1===(null===(n=null==e?void 0:e.body)||void 0===n?void 0:n.protocol))o(this.stateCenter.roomModulesList).forEach((function(t){return t.roomHandler.handlePushKickout(e,!0)}));else{var s=null===(r=null==e?void 0:e.header)||void 0===r?void 0:r.room_id,c=this.stateCenter.roomModulesList.find((function(e){return e.roomID==s}));if(!c)return void this.logger.error(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(null===(i=e.header)||void 0===i?void 0:i.room_id));c.roomHandler.handlePushKickout(e)}},e.prototype.handlePushCustomMsg=function(e){},e.prototype.handlePushRoomMsg=function(e){},e.prototype.handlePushUserStateUpdateMsg=function(e){var t,n=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,r=this.stateCenter.roomModulesList.find((function(e){return e.roomID==n}));r?r.userHandler.handlePushUserStateUpdateMsg(e):this.logger.error(a.ZEGO_RTM_ACTION.SERVICE_PUSH+" room no found ignore "+JSON.stringify(e))},e.prototype.handlePushMergeMsg=function(e){},e.prototype.handlePushTransMsg=function(e){},e.prototype.handleBigImMsgRsp=function(e){},e.prototype.handlePushSignalMsg=function(e){},e.prototype.handlePushTokenExpire=function(e){this.stateCenter.actionListener("_tokenExpired",e)},e.prototype.closeHandler=function(e){this.service.closeHandler(e)},e.prototype.openHandler=function(e){this.service.openHandler(e)},e.prototype.errorHandler=function(e){this.service.errorHandler(e)},e.prototype.getHeader=function(e,t,n,r){return{Protocol:"V1"===i.ROOMVERSION?"req":"req_v2",cmd:e,appid:this.stateCenter.appid,seq:++this.cmdSeq,user_id:this.stateCenter.userid,session_id:t||"",room_id:n||"",room_session_id:r||"",biz_version:this.stateCenter.bizVersion||""}},e.prototype.startCheck=function(){this.service.startCheck()},e.prototype.stopCheck=function(){this.service.stopCheck()},e.prototype.isDisConnect=function(){return!this.service||this.service.isDisConnect()},e.prototype.createSocket=function(e){var t=this;this.service.createSocket(e),this.responseRouters=r(r({},this.responseRouters),{push_kickout:function(e){t.handlePushKickout(e)},push_custommsg:function(e){t.handlePushCustomMsg(e)},push_im_chat:function(e){t.handlePushRoomMsg(e)},push_userlist_update:function(e){t.handlePushUserStateUpdateMsg(e)},push_merge_message:function(e){t.handlePushMergeMsg(e)},push_trans:function(e){t.handlePushTransMsg(e)},push_signal:function(e){t.handlePushSignalMsg(e)},push_token_expire:function(e){t.handlePushTokenExpire(e)}})},e.prototype.closeSocket=function(){this.service.closeSocket()},e.prototype.sendMessage=function(e,t,n,r,o,i){var s,u,l;if(this.service.isDisConnect())return this.logger.error(a.ZEGO_RTM_ACTION.SERVICE_SEND+" socket is disconnect"),r(c.errorCodeList.SOCKET_CLOSE),0;var h=(null==i?void 0:i.roomID)?i.roomID:null===(s=this.stateCenter.roomModulesList[0])||void 0===s?void 0:s.roomID,p=(null==i?void 0:i.roomSessionID)?i.roomSessionID:null===(u=this.stateCenter.roomModulesList[0])||void 0===u?void 0:u.roomSessionID,f=(null==i?void 0:i.sessionID)?i.sessionID:null===(l=this.stateCenter.roomModulesList[0])||void 0===l?void 0:l.sessionID,d=o||this.getHeader(e,f,h,p);return this.logger.info(a.ZEGO_RTM_ACTION.SERVICE_SEND+" sendMsg:"+JSON.stringify({header:d,body:t})),this.service.sendMessage(d,t,n,r)},e.prototype.on=function(e,t){this.responseRouters[e]=t},e.prototype.login=function(e,t,n){var r=this.getHeader(e.isMulti?"enter":"login",e.sessionID,e.roomID,e.roomSessionID),o={id_name:this.stateCenter.idName,nick_name:this.stateCenter.nickName,role:this.stateCenter.role,token:e.token,version:this.stateCenter.sdKVersion,room_name:e.roomID,user_state_flag:this.stateCenter.userStateUpdate?1:0,room_create_flag:this.stateCenter.roomCreateFlag,client_type:0===this.stateCenter.ENV?i.E_CLIENT_TYPE.ClientType_Webrtc:i.E_CLIENT_TYPE.ClientType_SmallProgram,third_token:e.thirdToken,user_count_limit:e.maxMemberCount,relate_service:this.stateCenter.relateService.join()||"",login_logic:this.stateCenter.isMultiRoom?3:1,proto_format:this.stateCenter.protoFormat};return this.sendMessage("",o,t,n,r)},e.prototype.logout=function(e,t,n){var r=e.isMulti?"quit":"logout",o={reserve:0};return"logout"==r&&(o.login_logic=this.stateCenter.isMultiRoom?3:1),this.sendMessage(r,o,t,n,void 0,{sessionID:e.sessionID,roomID:e.roomID,roomSessionID:e.roomSessionID})},e.prototype.heartBeat=function(e,t,n){return this.sendMessage("hb",{reserve:0},e,t,void 0,n)},e.prototype.fetchUserList=function(e,t,n,r){return this.sendMessage("user_list",e,t,n,void 0,r)},e.prototype.fetchUserListV2=function(e,t,n,r){return this.sendMessage("user_list_v2",e,t,n,void 0,r)},e.prototype.fetchReliableMessage=function(e,t,n,r){return this.sendMessage("trans_fetch",e,t,n,void 0,r)},e.prototype.sendReliableMessage=function(e,t,n,r){return this.sendMessage("trans",e,t,n,void 0,r)},e.prototype.sendRoomMsg=function(e,t,n,r){return this.sendMessage("im_chat",e,t,n,void 0,r)},e.prototype.sendCustomCommand=function(e,t,n,r){return this.sendMessage("custommsg",e,t,n,void 0,r)},e.prototype.sendBigRoomMessage=function(e,t,n,r){return this.sendMessage("bigim_chat",e,t,n,void 0,r)},e.prototype.sendRelayMessage=function(e,t,n,r){return this.sendMessage("relay",e,t,n,void 0,r)},e.prototype.sendSignalCmd=function(e,t,n,r){return this.sendMessage("signal",e,t,n,void 0,r)},e.prototype.sendPB=function(e){return this.service.isDisConnect()||this.stateCenter.networkState==i.ENUM_NETWORK_STATE.offline?(this.logger.error(a.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_PB+" socket is disconnected"),!1):this.service.sendPB(e)},e}();t.LiveRoomService=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSocketService=void 0;var r=n(0),o=n(1),i=function(){function e(e){this.socket=null,this.sendCommandList=new r.LinkedList,this.sendCommandMap={},this.sendDataCheckOnceCount=100,this.sendDataDropTimeout=1e4,this.sendDataCheckInterval=2e3,this.ENV=e}return e.prototype.createSocket=function(e){this.socket=r.createZegoWebSocket(e,this.ENV%2)},e.prototype.closeSocket=function(){this.socket&&(this.socket.onclose=null,this.socket.onerror=null,this.socket.close(),this.socket=null)},e.prototype.isDisConnect=function(){return!this.socket||1!==this.socket.readyState},e.prototype.sendMessage=function(e,t,n,r,o){void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o={timeOut:6e3});var i={header:e,body:t},s={data:i,seq:e.seq,deleted:!1,sendTime:Date.parse(new Date+""),timeOut:o.timeOut,success:n,error:r},a=this.sendCommandList.push(s);return this.sendCommandMap[s.seq]=a,this.socket&&this.socket.send(JSON.stringify(i)),e.seq},e.prototype.sendPB=function(e){return this.socket&&this.socket.send(e),!0},e.prototype.checkSendMessageList=function(e){for(var t=e.getFirst();null!=t;)e.remove(t),t._data&&t._data.error&&setTimeout((function(){t&&t._data&&t._data.error&&t._data.error(o.errorCodeList.TIMEOUT,t._data.data.header.seq,t._data.data.body.custom_msg)}),0),t=e.getFirst()},e.prototype.checkMessageListTimeout=function(e,t){for(var n=e.getFirst(),r=Date.parse(new Date+""),i=0,s=function(){if(n._data&&n._data.sendTime+n._data.timeOut>r)return"break";if(n._data&&delete t[n._data.data.header.seq],e.remove(n),n._data&&null==n._data.error||n._data&&n._data.sendTime+a.sendDataDropTimeout<r)0;else{var s=n&&n._data&&n._data.error,c=n&&n._data&&n._data.seq,u=n&&n._data&&n._data.data.body.custom_msg;setTimeout((function(){s&&s(o.errorCodeList.TIMEOUT,c,u)}),0)}if(++i>=a.sendDataCheckOnceCount)return"break";n=e.getFirst()},a=this;null!=n;){if("break"===s())break}},e.prototype.startCheck=function(){var e=this;this.checkMessageListTimeout(this.sendCommandList,this.sendCommandMap),this.sendDataCheckTimer=setTimeout((function(){e.startCheck()}),this.sendDataCheckInterval)},e.prototype.stopCheck=function(){this.checkSendMessageList(this.sendCommandList),clearTimeout(this.sendDataCheckTimer)},e.prototype.openHandler=function(e){var t=this;this.socket&&(this.socket.onopen=function(n){t.socket.binaryType="arraybuffer",t.responseHandler(),e(n)})},e.prototype.responseHandler=function(){var e=this;this.socket&&(this.socket.onmessage=function(t){var n="string"==typeof t.data?JSON.parse(t.data):t.data;e.onMessage(n)})},e.prototype.closeHandler=function(e){this.socket&&(this.socket.onclose=function(t){e(t)})},e.prototype.errorHandler=function(e){this.socket&&(this.socket.onerror=e)},e.prototype.onMessage=function(e){},e}();t.ZegoSocketService=i},function(e,t,n){"use strict";e.exports=n(53)},function(e,t,n){"use strict";e.exports=h;var r,o=n(5),i=o.LongBits,s=o.base64,a=o.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var p=function(){return o.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function f(e,t,n){t[n]=255&e}function d(e,t){this.len=e,this.next=void 0,this.val=t}function _(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function g(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}h.create=p(),h.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(h.alloc=o.pool(h.alloc,o.Array.prototype.subarray)),h.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},d.prototype=Object.create(c.prototype),d.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new d((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(_,10,i.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=i.from(e);return this._push(_,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(_,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=i.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var m=o.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(o.isString(e)){var n=h.alloc(t=s.length(e));s.decode(e,n,0),e=n}return this.uint32(t)._push(m,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=p(),r._configure()}},function(e,t,n){"use strict";e.exports=c;var r,o=n(5),i=o.LongBits,s=o.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},h=function(){return o.Buffer?function(e){return(c.create=function(e){return o.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function p(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw a(this,8);return new i(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}c.create=h(),c.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=h(),r._configure();var t=o.Long?"toLong":"toNumber";o.merge(c.prototype,{int64:function(){return p.call(this)[t](!1)},uint64:function(){return p.call(this)[t](!0)},sint64:function(){return p.call(this).zzDecode()[t](!1)},fixed64:function(){return d.call(this)[t](!0)},sfixed64:function(){return d.call(this)[t](!1)}})}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BusinessService=t.NetAgentHttpRequest=t.NetAgentPCRequest=t.ZegoConnectionAgent=t.ZegoExpressWebRTM=t.ZegoDataReport=t.ZegoLogger=t.getSeq=t.getReportSeq=t.ZegoExpressWebRTMEngine=void 0;var r=n(34);Object.defineProperty(t,"ZegoExpressWebRTM",{enumerable:!0,get:function(){return r.ZegoExpressWebRTM}});var o=n(74),i=n(0);Object.defineProperty(t,"ZegoConnectionAgent",{enumerable:!0,get:function(){return i.ZegoConnectionAgent}}),Object.defineProperty(t,"BusinessService",{enumerable:!0,get:function(){return i.BusinessService}}),Object.defineProperty(t,"NetAgentPCRequest",{enumerable:!0,get:function(){return i.NetAgentPCRequest}}),Object.defineProperty(t,"NetAgentHttpRequest",{enumerable:!0,get:function(){return i.NetAgentHttpRequest}});var s=function(){function e(t,n,s,a){void 0===s&&(s=0),this.logger=new i.ZegoLogger(s),this.dataReport=new i.ZegoDataReport(this.logger),this.cloudSetting=new o.ZegoSetting,this.zegoWebRTM=new r.ZegoExpressWebRTM(t,n,this.logger,this.dataReport,this.cloudSetting,e.version,s,a)}return e.prototype.enableMultiRoom=function(e){return this.zegoWebRTM.enableMultiRoom(e)},e.prototype.loginRoom=function(e,t,n,r){return this.zegoWebRTM.loginRoom(e,t,n,r)},e.prototype.logoutRoom=function(e){return this.zegoWebRTM.logoutRoom(e)},e.prototype.renewToken=function(e,t){return this.zegoWebRTM.renewToken(e,t)},e.prototype.sendBarrageMessage=function(e,t){return this.zegoWebRTM.sendBarrageMessage(e,t)},e.prototype.sendBroadcastMessage=function(e,t){return this.zegoWebRTM.sendBroadcastMessage(e,t)},e.prototype.sendCustomCommand=function(e,t,n){return this.zegoWebRTM.sendCustomCommand(e,t,n)},e.prototype.setRoomExtraInfo=function(e,t,n){return this.zegoWebRTM.setRoomExtraInfo(e,t,n)},e.prototype.setLogConfig=function(e){return this.zegoWebRTM.setLogConfig(e)},e.prototype.setDebugVerbose=function(e){return this.zegoWebRTM.setDebugVerbose(e)},e.prototype.on=function(e,t){return this.zegoWebRTM.on(e,t)},e.prototype.getVersion=function(){return this.zegoWebRTM.getVersion()},e.prototype.off=function(e,t){return this.zegoWebRTM.off(e,t)},e.prototype.loginHall=function(e,t,n){return this.zegoWebRTM.loginHall(e,t,n)},e.prototype.logoutHall=function(){return this.zegoWebRTM.logoutHall()},e.prototype.enterRoom=function(e,t){return this.zegoWebRTM.enterRoom(e,t)},e.prototype.leaveRoom=function(){return this.zegoWebRTM.leaveRoom()},e.use=function(e){r.ZegoExpressWebRTM.use(e)},e.version=i.PROTO_VERSION,e}();t.ZegoExpressWebRTMEngine=s;var a=n(0);Object.defineProperty(t,"getReportSeq",{enumerable:!0,get:function(){return a.getReportSeq}}),Object.defineProperty(t,"getSeq",{enumerable:!0,get:function(){return a.getSeq}}),Object.defineProperty(t,"ZegoLogger",{enumerable:!0,get:function(){return a.ZegoLogger}}),Object.defineProperty(t,"ZegoDataReport",{enumerable:!0,get:function(){return a.ZegoDataReport}})},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoExpressWebRTM=void 0;var s=n(0),a=n(8),c=n(1),u=n(3),l=n(0),h=n(19),p=n(43),f=n(45),d=n(46),_=n(47),g=n(49),m=n(4),y=n(6),v=n(22),b=n(50),E=n(51),O=n(52),T=function(){function e(e,t,n,r,o,i,a,c){var p=this;this.logger=n,this.dataReport=r,this.cloudSetting=o,this.version=i,this.options=c,this.stateCenter=new d.StateCenter(this.logger,this.dataReport),this.stateCenter.ENV=a,this.getReportSeq=l.getReportSeq,this.getSeq=s.getSeq,this.initCallback();var f=l.getReportSeq();if(this.dataReport.newReport(f),(0==a||1==a)&&this.setDebug(t),u.ClientUtil.checkConfigParam(e,t,this.logger)){this.stateCenter.appid=e,this.stateCenter.configOK=!0,this.stateCenter.sdKVersion=this.version,this.stateCenter.testEnvironment&&(this.stateCenter.mode=s.Mode.MODE_TEST),this.netAgent=new s.ZegoConnectionAgent,this.netAgent.init(),this.netAgent.setLogger(this.logger),this.netAgent.setAppInfo({appID:this.stateCenter.appid,env:this.stateCenter.ENV,mode:this.stateCenter.mode}),this.liveRoomHandler=new O.LiveRoomHandler(this.logger,this.stateCenter,this.netAgent,this),this.service=new v.LiveRoomService(this.stateCenter,this.logger,this),this.stateCenter.deviceID=u.ClientUtil.generateUUID(),this.stateCenter.settingConfig=new E.ZegoSettingConfig,this.cloudSetting.setLog(this.logger),this.cloudSetting.init({product:h.CLOUD_SETTING.product,appID:e,urls:h.CLOUD_SETTING.URL,env:a,pollingNotify:function(e,t){p.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR," setting file changed "+e+" "+JSON.stringify(t)),p.stateCenter.actionListener("_cloudSettingNotify",e,t)},reportNotify:this.cloudReportNotify.bind(this),online:!this.stateCenter.testEnvironment});var _=this.stateCenter.settingConfig.getSetting("remote_log_level");_&&(this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+"  setting remote_log_level default "+_),this.logger.setRemoteLogLevel(_));var g="";0===a?g="rtc":1===a&&(g="xcx"),this.cloudSetting.setEnvVariable("environment",g);var b=this.cloudSetting.getSettingCache(h.INIT),T=this.cloudSetting.getSettingCache(h.ROOM_BASIC);if(Promise.all([b,T]).then((function(e){var t=null==e?void 0:e[0];p.stateCenter.settingConfig.setSetting(null==t?void 0:t.setting);var n=p.stateCenter.settingConfig.getSetting("unify");if(n){var r=n.enable,o=n.sdk_conn_ver;r&&s.NET_ACCESS_CONFIG.connectVer>=o?p.stateCenter.useNetAgent=!0:p.stateCenter.useNetAgent=!1}p.stateCenter.useNetAgent&&(p.createNetAgent(),p.getStoreAppConfig());var i=p.stateCenter.settingConfig.getSetting("remote_log_level",!0);i&&(p.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+"  setting remote_log_level "+i),p.logger.setRemoteLogLevel(i));var a=null==e?void 0:e[1];p.stateCenter.settingConfig.setSetting(null==a?void 0:a.setting);var c=l.getReportSeq();p.dataReport.newReport(c,y.ZegoRTMLogEvent.kZegoTaskCloudSettingCache.event),p.dataReport.addMsgInfo(c,{files:[{name:h.INIT,content:null==t?void 0:t.setting,versions:null==t?void 0:t.versions},{name:h.ROOM_BASIC,content:null==a?void 0:a.setting,versions:null==a?void 0:a.versions}]}),p.dataReport.uploadReport(c)})).catch((function(e){p.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+"  initConfig "+JSON.stringify(e))})),"string"==typeof t?(this.stateCenter.server=t,this.stateCenter.serverBak=t):Array.isArray(t)&&t.length>0&&(this.stateCenter.server=t[0],this.stateCenter.serverBak=t[1]||t[0]),0==a||2==a)this.bindWindowListener(),this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+"  "+navigator.appVersion),this.stateCenter.networkState=navigator?navigator.onLine?s.ENUM_NETWORK_STATE.online:s.ENUM_NETWORK_STATE.offline:s.ENUM_NETWORK_STATE.online,this.dataReport.addMsgInfo(f,{system_info:y.ZegoRTMLogEvent.kZegoTaskInitSetting.system_info});else if(1==a||3==a){this.bindWxListener();try{var S=wx.getSystemInfoSync(),R={brand:S.brand,model:S.model,system:S.system,platform:S.platform,version:S.version,SDKVersion:S.SDKVersion};this.dataReport.addMsgInfo(f,{system_info:R})}catch(e){this.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+" get system info error")}}this.logger.setSessionInfo(this.stateCenter.appid,"","","","",this.version)}else this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+" init sdk error"),this.dataReport.addMsgInfo(f,y.ZegoRTMLogEvent.kZegoTaskInitSetting.error.kInvalidParamError);this.dataReport.uploadReport(f,y.ZegoRTMLogEvent.kZegoTaskInitSetting.event)}return Object.defineProperty(e.prototype,"modules",{get:function(){return{service:this.service}},enumerable:!1,configurable:!0}),e.prototype.initCallback=function(){this.proxyRes=u.ClientUtil.proxyRes,this.actionSuccessCallback=u.ClientUtil.actionSuccessCallback,this.actionErrorCallback=u.ClientUtil.actionErrorCallback,this.getServerError=u.ClientUtil.getServerError,this.generateRandumNumber=u.ClientUtil.generateRandumNumber,this.unregisterCallback=u.ClientUtil.unregisterCallback,this.logReportCallback=u.ClientUtil.logReportCallback,this.registerCallback=u.ClientUtil.registerCallback},e.prototype.getStoreAppConfig=function(){this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_GETSTOREAPPCONFIG+" call");var e=localStorage.getItem(h.APP_CONFIG_KEY+"_"+this.getAppID()+"_"+(this.stateCenter.mode||s.NET_ACCESS_CONFIG.modeNo));if(e)try{var t=u.ClientUtil.decryptStores(e,h.STORE_SECRET);t?(this.stateCenter.appConfig=JSON.parse(t),this.stateCenter.actionListener("_appConfigRsp"),this.handleLogUpload()):localStorage.removeItem(h.APP_CONFIG_KEY+"_"+this.getAppID()+"_"+(this.stateCenter.mode||s.NET_ACCESS_CONFIG.modeNo))}catch(e){this.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_GETSTOREAPPCONFIG+" "+JSON.stringify(e))}else this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_GETSTOREAPPCONFIG+" no store config")},e.prototype.createNetAgent=function(){var e,t,n,r,o=this;this.netAgent.on("disconnected",(function(e){o.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CREATENETAGENT+" netAgent disconnect")})),this.netAgent.on("connected",(function(){o.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CREATENETAGENT+" netAgent connect"),o.fetchAppConfig(),o.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&o.netAgent.isConnect()&&e.roomTryHandler.active(!0)}))})),this.netAgent.on("broken",(function(e){o.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CREATENETAGENT+" netAgent broken"),e===s.BrokenType.CLOSE&&o.stateCenter.roomModulesList.forEach((function(e){e.resetSessionInfo()}))})),this.netAgent.on("dispatchEvent",(function(e,t,n){if(o.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CREATENETAGENT+" dispatch"),"start"===t){var r=l.getReportSeq();o.dataReport.newReport(r,y.ZegoRTMLogEvent.kZegoConnDispatch.event),o.stateCenter.requestList[e]=r}else if("end"===t){var i=o.stateCenter.requestList[e];if(i){var s="";s=(null==n?void 0:n.reason)?n.reason:o.dispatchServers?"UpdateDispatchResult":"NoDispatchResult",o.dataReport.addMsgInfo(i,{domain_list:y.ZegoRTMLogEvent.kZegoConnDispatch.domain_list(n.domains),trigger_reason:y.ZegoRTMLogEvent.kZegoConnDispatch.trigger_reason(s)}),o.dataReport.uploadReport(i)}}})),this.netAgent.on("connectedEvent",(function(e,t,n){if(o.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CREATENETAGENT+" connect"),"start"===t){var r=l.getReportSeq();o.dataReport.newReport(r,y.ZegoRTMLogEvent.kZegoConnConnect.event),o.stateCenter.requestList[e]=r}else if("end"===t){var i=o.stateCenter.requestList[e];i&&(o.dataReport.addMsgInfo(i,{server_list:y.ZegoRTMLogEvent.kZegoConnConnect.server_list(n.servers),request_count:n.count,connect_id:n.connectid}),o.dataReport.uploadReport(i))}})),this.netAgent.on("requestEvent",(function(e,t,n){if(o.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CREATENETAGENT+" request"),"start"===t){var r=l.getReportSeq();o.dataReport.newReport(r,y.ZegoRTMLogEvent.kZegoRequest.event),o.stateCenter.requestList[e]=r}else if("end"===t){var i=o.stateCenter.requestList[e];i&&(o.dataReport.addMsgInfo(i,{na_req_location:y.ZegoRTMLogEvent.kZegoRequest.na_req_location(n.na_req_location),http_code:n.status_code}),o.dataReport.uploadReport(i))}})),this.netAgent.on("disConnectedEvent",(function(e){var t=e.duration,n=e.server,r=e.connectid;o.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CREATENETAGENT+" disconnect");var i=l.getReportSeq();o.dataReport.newReport(i,y.ZegoRTMLogEvent.kZegoConnDisConnect.event),o.dataReport.addMsgInfo(i,{server:y.ZegoRTMLogEvent.kZegoConnDisConnect.server(n),connect_duration:t,connect_id:r}),o.dataReport.uploadReport(i)})),null===(e=this.liveRoomHandler.liveroomRequest)||void 0===e||e.on("pcConnectedEvent",(function(e){var t=l.getReportSeq();o.dataReport.newReport(t,y.ZegoRTMLogEvent.kZegoSDKProxyConnect.event),o.dataReport.addMsgInfo(t,{recv_time:(new Date).getTime(),proxy_link_sources:e.proxy_link_sources}),o.dataReport.uploadReport(t)}));var i=((null===(t=this.options)||void 0===t?void 0:t.accessDomains)&&(null===(n=this.options)||void 0===n?void 0:n.accessDomains.length)>0?null===(r=this.options)||void 0===r?void 0:r.accessDomains:s.NET_ACCESS_CONFIG.domains).map((function(e){return"wss://"+e+"/accesshub"}));this.netAgent.setNetAgentDefaultServers(i),this.dispatchServers=this.getDispatchUrl(),this.netAgent.setDispatchConnectServers(this.dispatchServers)},e.prototype.getDispatchUrl=function(){var e=localStorage.getItem(h.NET_ACCESS_SERVERS+"_"+this.stateCenter.appid+"_"+(this.stateCenter.mode||s.NET_ACCESS_CONFIG.modeNo));if(!e)return[];var t=u.ClientUtil.decryptStores(e,h.STORE_SECRET);if(t)try{return JSON.parse(t)}catch(e){return[]}return[]},e.prototype.bindWindowListener=function(){var e=this,t=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i),n=u.ClientUtil.getBrowser(),r=t?"pagehide":"Firefox"===n?"beforeunload":"unload";window.addEventListener(r,(function(){e.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_BIND_WINDOW_LISTENER+" "+r),"PUBLIC"===e.stateCenter.type?e.logoutRoom():e.leaveRoom(),e.logoutRoom()})),window.addEventListener("offline",(function(){e.netOffLineHandle()})),window.addEventListener("online",(function(){e.netOnLineHandle()}))},e.prototype.bindWxListener=function(){var e=this;wx.onNetworkStatusChange((function(t){t.isConnected?e.netOnLineHandle():e.netOffLineHandle()}))},e.prototype.retryRoom=function(){var e=this;this.stateCenter.roomModulesList.forEach((function(t){t.roomTryHandler&&e.netAgent.isConnect()&&(t.resetSessionInfo(),t.roomTryHandler.active(!0))}))},e.prototype.netOnLineHandle=function(){var e=this;this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_BIND_WINDOW_LISTENER+" network is online"),this.stateCenter.networkState=s.ENUM_NETWORK_STATE.online,this.stateCenter.useNetAgent||this.stateCenter.roomModulesList.forEach((function(t){t.roomTryHandler&&e.service.isDisConnect()?t.roomTryHandler.active():t.roomTryHandler&&(t.roomTryHandler.stopMaxTime(),t.roomHandler.roomStateHandle("CONNECTED",a.ZegoRoomStateChangedReason.Reconnected,{code:0,msg:""}))}))},e.prototype.netOffLineHandle=function(){this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_BIND_WINDOW_LISTENER+" network is broken"),this.stateCenter.networkState=s.ENUM_NETWORK_STATE.offline,this.stateCenter.useNetAgent||this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&(e.roomTryHandler.invalid(),e.roomTryHandler.onactive=function(t,n){e.roomHandler.disconnectedHandle(n)},e.roomTryHandler.startMaxTime(),e.roomHandler.roomStateHandle("CONNECTING",a.ZegoRoomStateChangedReason.Reconnecting,c.errorCodeList.NETWORK_BROKEN))}))},e.prototype.setLogConfig=function(e){this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_LOG_CONFIG+" call");var t=l.getReportSeq();if(this.dataReport.newReport(t),e.logLevel&&["debug","info","warn","error","report","disable"].includes(e.logLevel)&&(this.logger.setLogLevel(e.logLevel),this.dataReport.addMsgInfo(t,{log_level:y.ZegoRTMLogEvent.kZegoTaskSetLog.log_level(e.logLevel)})),e.remoteLogLevel&&["debug","info","warn","error","report","disable"].includes(e.remoteLogLevel)&&this.dataReport.addMsgInfo(t,{remote_log_level:y.ZegoRTMLogEvent.kZegoTaskSetLog.remote_log_level(e.remoteLogLevel)}),"string"==typeof e.logURL&&(e.logURL.startsWith("wss://")||e.logURL.startsWith("https://")))this.logger.setLogServer(e.logURL),this.dataReport.addMsgInfo(t,{log_url:y.ZegoRTMLogEvent.kZegoTaskSetLog.log_url(e.logURL)}),this.dataReport.uploadReport(t,y.ZegoRTMLogEvent.kZegoTaskSetLog.event);else if(e.logURL)return this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_LOG_CONFIG+"log url must be a wss or https url"),this.dataReport.addMsgInfo(t,y.ZegoRTMLogEvent.kZegoTaskSetLog.error.kInvalidParamError),this.dataReport.uploadReport(t,y.ZegoRTMLogEvent.kZegoTaskSetLog.event),!1;return this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_LOG_CONFIG+" call success"),!0},e.prototype.setDebugVerbose=function(e){var t=l.getReportSeq();this.dataReport.newReport(t),"boolean"==typeof e&&(this.stateCenter.debug=e,this.stateCenter.debugCustom=!0,this.dataReport.addMsgInfo(t,{debug:y.ZegoRTMLogEvent.kZegoTaskSetDebug.debug(e?"true":"false")})),this.dataReport.uploadReport(t,y.ZegoRTMLogEvent.kZegoTaskSetDebug.event),this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_DEBUG_VERBOSE+" call success")},e.prototype.setDebug=function(e){"string"==typeof e&&e.indexOf("wss")>-1?this.stateCenter.debug=u.ClientUtil.isTestEnv(e):Array.isArray(e)&&e.length>0&&e.every((function(e){return"string"==typeof e&&e.indexOf("wss")>-1}))?this.stateCenter.debug=u.ClientUtil.isTestEnv(e[0]):this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+" server wrong"),this.stateCenter.testEnvironment=this.stateCenter.debug},e.prototype.renewToken=function(e,t){var n,r,o=this,i=l.getReportSeq();if(this.dataReport.newReport(i),void 0!==t&&("string"!=typeof t||""==t))return this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" roomID must be string and no empty"),!1;var s=this.getRoomModules(t)||this.stateCenter.roomModulesList[0];if(!s)return this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" calling must after loginRoom"),this.dataReport.addMsgInfo(i,{error:y.ZegoRTMLogEvent.kZegoTaskReNewToken.error.NOT_LOGIN.code,message:y.ZegoRTMLogEvent.kZegoTaskReNewToken.error.NOT_LOGIN.msg}),this.dataReport.uploadReport(i,y.ZegoRTMLogEvent.kZegoTaskReNewToken.event),!1;if("string"==typeof e&&s.roomTryHandler){if(e===s.roomTryHandler.token)this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" token has not changed");else if(this.stateCenter.configRoomAuth){var a=function(t){var n,r;null===(n=s.roomTryHandler)||void 0===n||n.renewLocalToken(e,null===(r=null==t?void 0:t.body)||void 0===r?void 0:r.token_remain_time),o.cloudSetting.setToken(e),o.stateCenter.configCheckToken=!0,o.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" "+JSON.stringify(t))},c=function(t){var n,r,i=null===(n=null==t?void 0:t.body)||void 0===n?void 0:n.err_code;!i||1000002014!==i&&2014!==i?o.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" "+JSON.stringify(t)):(o.stateCenter.configCheckToken=!1,null===(r=s.roomTryHandler)||void 0===r||r.renewLocalToken(e),o.cloudSetting.setToken(e),o.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" "+JSON.stringify(t)))};this.stateCenter.useNetAgent?null===(n=this.liveRoomHandler)||void 0===n||n.renewToken({token:e},a,c,s):this.service.sendMessage("renew_token",{token:e},a,c,void 0,{sessionID:s.sessionID,roomID:t,roomSessionID:s.roomSessionID})}else null===(r=s.roomTryHandler)||void 0===r||r.renewLocalToken(e),this.cloudSetting.setToken(e);return this.dataReport.uploadReport(i,y.ZegoRTMLogEvent.kZegoTaskReNewToken.event),!0}return"string"!=typeof e||s.roomTryHandler?(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" token must be string and not empty"),this.dataReport.addMsgInfo(i,{error:y.ZegoRTMLogEvent.kZegoTaskReNewToken.error.INPUT_PARAM.code,message:y.ZegoRTMLogEvent.kZegoTaskReNewToken.error.INPUT_PARAM.msg+" param token error"}),this.dataReport.uploadReport(i,y.ZegoRTMLogEvent.kZegoTaskReNewToken.event),!1):(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_RENEWTOKEN+" calling must after loginRoom"),this.dataReport.addMsgInfo(i,{error:y.ZegoRTMLogEvent.kZegoTaskReNewToken.error.NOT_LOGIN.code,message:y.ZegoRTMLogEvent.kZegoTaskReNewToken.error.NOT_LOGIN.msg}),this.dataReport.uploadReport(i,y.ZegoRTMLogEvent.kZegoTaskReNewToken.event),!1)},e.prototype.setCloudSettingURLs=function(e){var t=this;this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_CLOUD_SETTING_URLS+" call "),Array.isArray(e)&&e.length>0&&e.every((function(e){return"string"==typeof e&&e.indexOf("http")>-1}))&&this.cloudSetting.init({product:h.CLOUD_SETTING.product,appID:this.stateCenter.appid,urls:e,env:this.stateCenter.ENV,pollingNotify:function(e,n){t.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SET_CLOUD_SETTING_URLS," setting file changed "+e+" "+JSON.stringify(n)),t.stateCenter.actionListener("_cloudSettingNotify",e,n)},reportNotify:this.cloudReportNotify.bind(this),online:!this.stateCenter.testEnvironment})},e.prototype.loginRoom=function(e,t,n,c){var u=this;return this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM+" call by user "+(null==n?void 0:n.userID)+" "+e),new Promise((function(l,h){return r(u,void 0,void 0,(function(){var r,u,d,g,v,b,E=this;return o(this,(function(o){switch(o.label){case 0:return 1!==this.stateCenter.ENV?[3,2]:[4,new Promise((function(e){wx.getNetworkType({success:function(t){E.stateCenter.networkState="none"===t.networkType?s.ENUM_NETWORK_STATE.offline:s.ENUM_NETWORK_STATE.online,e()},fail:function(t){E.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_CONSTRUCTOR+" network "+JSON.stringify(t)),E.stateCenter.networkState=s.ENUM_NETWORK_STATE.online,e()}})}))];case 1:o.sent(),o.label=2;case 2:return r=this.loginReport(l,h,t,c),u=r.interResolve,d=r.interReject,!(c=c||{}).maxMemberCount&&(c.maxMemberCount=0),this.netAgent&&(this.stateCenter.idName=n.userID,this.netAgent.setUserInfo(n.userID),this.stateCenter.actionListener("_roomLogin",e,t),this.netAgent.isConnect()&&this.fetchAppConfig(t)),this.cloudSetting.setUserID(n.userID),this.cloudSetting.setToken(t),this.cloudSetting.activePolling(),this.stateCenter.onListener("roomLoginResponse",(function(e){E.stateCenter.settingFetched||(E.getCloudSetting(),E.stateCenter.actionListener("_settingCanFetch"),E.stateCenter.settingFetched=!0)})),(g=this.getRoomModules(e))?(this.logger.setSessionInfo(this.stateCenter.appid,e,"",n.userID,"",this.stateCenter.sdKVersion),d(y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.REPEATEDLY_LOGIN),[2]):((g=new _.LiveRoomModules(e,this.stateCenter,this.logger,this.dataReport,this.service,this,this.liveRoomHandler)).roomTryHandler||(g.roomTryHandler=new p.RetryRoomHandler(this.logger,this.stateCenter,g)),g.roomTryHandler.init(this.stateCenter.roomRetryTime),g.roomTryHandler.initRoom(g.roomHandler,e,t,n,this.stateCenter.server,this.stateCenter.serverBak,c),g.roomTryHandler.setLoginRoomCallback(u,d),g.roomHandler.roomStateHandle("CONNECTING",a.ZegoRoomStateChangedReason.Logining,{code:0,msg:""}),(v=f.checkParams({roomID:{order:0,value:e,rules:[{name:f.RULE_PARAM_NAME.NOT_EMPTY,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.ROOM_ID_NULL},{name:f.RULE_PARAM_NAME.TYPE_STRING,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:"roomID must be string"},{name:f.RULE_PARAM_NAME.MAX_LENGTH_128,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.ROOM_ID_TOO_LONG},{name:f.RULE_PARAM_NAME.ILLEGAL_CHARACTERS,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.ROOM_ID_INVALID_CHARACTER}]},token:{order:1,value:t,rules:[{name:f.RULE_PARAM_NAME.NOT_EMPTY,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM},{name:f.RULE_PARAM_NAME.TYPE_STRING,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM}]},user:{order:2,value:n,rules:[{name:f.RULE_PARAM_NAME.NOT_EMPTY,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:" param user error."},{name:f.RULE_PARAM_NAME.TYPE_OBJECT,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:" param user error."}]},"user.userID":{order:3,value:n.userID,rules:[{name:f.RULE_PARAM_NAME.NOT_EMPTY,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.USER_ID_NULL,extMsg:" param user error."},{name:f.RULE_PARAM_NAME.TYPE_STRING,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:" param userID error."},{name:f.RULE_PARAM_NAME.MAX_LENGTH_64,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.USER_ID_TOO_LONG},{name:f.RULE_PARAM_NAME.ILLEGAL_CHARACTERS,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.USER_ID_INVALID_CHARACTER}]},"user.userName":{order:4,value:n.userName,rules:[{name:f.RULE_PARAM_NAME.TYPE_STRING,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:" userName must be string."},{name:f.RULE_PARAM_NAME.MAX_LENGTH_256,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.USER_NAME_TOO_LONG}]},config:{order:5,value:c,rules:[]},"config.maxMemberCount":{order:6,value:c.maxMemberCount,rules:[{name:f.RULE_PARAM_NAME.TYPE_INTEGER,error:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INPUT_PARAM,extMsg:" maxMemberCount must be integer number."}]}},{action:m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM,logger:this.logger}))!==f.RULE_SUCCESS?(g.roomHandler.roomStateHandle("DISCONNECTED",a.ZegoRoomStateChangedReason.LoginFailed,v.error,v.extMsg),d(v.error,v.extMsg),[2]):(this.stateCenter.roomModulesList.length>0&&1==this.stateCenter.isMultiRoom?g.isMulti=!0:i(this.stateCenter.roomModulesList).forEach((function(e){return e.roomHandler.logout()})),this.stateCenter.roomModulesList.push(g),b=this.stateCenter.settingConfig.getSetting("room_server",!0),Array.isArray(b)&&b.length>0&&(this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM," setting room_server "+b),this.stateCenter.server=b[0],this.stateCenter.serverBak=b[1]||b[0]),this.stateCenter.setMultiRoom=!0,g.roomTryHandler.startMaxTime(),this.stateCenter.useNetAgent&&!this.netAgent.isConnect()?(this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM," us is not connected"),g.roomHandler.setRunState(s.ENUM_RUN_STATE.trylogin),this.netAgent.connectUa(),[2]):(g.roomTryHandler.active(!0),[2])))}}))}))}))},e.prototype.handleLogUpload=function(){var e=this.stateCenter.appConfig.app_config.domain;if(e){this.stateCenter.logDomain="weblogger"+this.stateCenter.appid+"-api."+e;var t="";t=0===this.stateCenter.ENV?"wss://"+this.stateCenter.logDomain+"/log":"https://"+this.stateCenter.logDomain+"/httplog",this.logger.setLogServer(t)}},e.prototype.fetchAppConfig=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,a,p,f,d,_,g,v,b;return o(this,(function(o){switch(o.label){case 0:if(this.stateCenter.appConfigFetched)return this.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_FETCH_APP_CONFIG+" config fetched"),[2];if(!this.getUserID())return this.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_FETCH_APP_CONFIG+" user not exist"),[2];if(t="",e)t=e;else{if(!(this.stateCenter.roomModulesList.length>0))return this.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_FETCH_APP_CONFIG+" token not exist"),[2];t=this.getToken()}n=l.getReportSeq(),this.dataReport.newReport(n,y.ZegoRTMLogEvent.kZegoSDKConfigInit.event),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.netAgent.getAppConfigByAgent("init",t,5e3)];case 2:return r=o.sent(),i=r.code,a=r.data,this.dataReport.addMsgInfo(n,{trigger_reason:"refresh"}),this.dataReport.uploadReport(n),this.stateCenter.appConfigFetched=!0,this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM+" initConfig code:"+i+" data: "+JSON.stringify(a)),p=a.app_config,f=a.media_config,d=f.publish_config,_=f.play_config,this.stateCenter.appConfig={app_config:p,media_config:{publish_config:d,play_config:_}},g=JSON.stringify(this.stateCenter.appConfig),v=u.ClientUtil.encryptStores(g,h.STORE_SECRET),localStorage.setItem(h.APP_CONFIG_KEY+"_"+this.getAppID()+"_"+(this.stateCenter.mode||s.NET_ACCESS_CONFIG.modeNo),v),this.handleLogUpload(),this.stateCenter.appConfig||this.stateCenter.actionListener("_appConfigRsp"),[3,4];case 3:return b=o.sent(),this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM+" fail "+JSON.stringify(b)),this.dataReport.addMsgInfo(n,{trigger_reason:"refresh"}),this.dataReport.uploadReport(n),[20012,20008].includes(null==b?void 0:b.code)&&this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&e.roomTryHandler.loginFail(c.errorCodeList.APPID_INVALID)})),[3,4];case 4:return[2]}}))}))},e.prototype.getCloudSetting=function(){var e=this;this.cloudSetting.fetchMultiSetting([h.INIT,h.ROOM_BASIC]).then((function(t){var n;e.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM," settingConfig "+JSON.stringify(t)),e.stateCenter.settingConfig.setSetting(null===(n=null==t?void 0:t[h.INIT])||void 0===n?void 0:n.setting,["remote_log_level"]);var r=e.stateCenter.settingConfig.getSetting("remote_log_level",!0);r&&(e.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM+"  setting remote_log_level "+r),e.logger.setRemoteLogLevel(r))})).catch((function(t){e.logger.warn(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM," settingConfig "+JSON.stringify(t))})),this.stateCenter.onListener("_cloudSettingNotify",(function(t,n){var r=l.getReportSeq();e.dataReport.newReport(r,y.ZegoRTMLogEvent.kZegoTaskCloudSettingRefresh.event);var o=e.cloudSetting.getEnvVariables();if(e.dataReport.addMsgInfo(r,{params:o,files:[{name:t,content:n.setting,versions:n.versions}]}),e.dataReport.uploadReport(r),t===h.INIT){e.stateCenter.settingConfig.setSetting(null==n?void 0:n.setting,["remote_log_level"]);var i=e.stateCenter.settingConfig.getSetting("remote_log_level");i&&(e.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGIN_ROOM," setting remote_log_level "+i),e.logger.setRemoteLogLevel(i))}}))},e.prototype.cloudReportNotify=function(e,t,n){if("request_start"===t){var r=l.getReportSeq();this.dataReport.newReport(r,y.ZegoRTMLogEvent.kZegoTaskCloudSettingRequest.event),this.stateCenter.settingConfig.requestList[e]=r}else if("request_end"===t){var o=this.stateCenter.settingConfig.requestList[e];o&&(this.dataReport.addMsgInfo(o,{request_detail:null==n?void 0:n.reportData,files:null==n?void 0:n.files,error:null==n?void 0:n.code,request_params:null==n?void 0:n.params}),this.dataReport.uploadReport(o))}},e.prototype.loginReport=function(e,t,n,r){var o=this,i=l.getReportSeq();this.stateCenter.reportSeqList.login=i,this.dataReport.newReport(i,y.ZegoRTMLogEvent.kZegoTaskLoginRoom.event);var s=this.cloudSetting.getEnvVariable("deviceid");this.dataReport.addMsgInfo(i,{deviceid:s,use_na:this.stateCenter.useNetAgent?1:0}),"string"==typeof n&&this.dataReport.addMsgInfo(i,{token:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.token(n),isMulti:this.stateCenter.isMultiRoom}),r&&(r.userUpdate&&"boolean"==typeof r.userUpdate&&this.dataReport.addMsgInfo(i,{user_update:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.user_update(r.userUpdate+"")}),r.maxMemberCount&&"number"==typeof r.maxMemberCount&&this.dataReport.addMsgInfo(i,{max_member_count:y.ZegoRTMLogEvent.kZegoTaskLoginRoom.max_member_count(r.maxMemberCount+"")})),u.ClientUtil.logReportCallback(y.ZegoRTMLogEvent.kZegoTaskLoginRoom.event,this.dataReport,i,this.stateCenter.reportList);return{interResolve:function(t){o.dataReport.uploadReport(i),o.stateCenter.reportSeqList.login=0,u.ClientUtil.unregisterCallback(y.ZegoRTMLogEvent.kZegoTaskLoginRoom.event,o.stateCenter.reportList),e(t)},interReject:function(e,n){var r,s;void 0===n&&(n=""),e.code<2e9&&e.code>1e9||e.code<1e6?(r=u.ClientUtil.decodeServerError(e.code,e.msg),s=u.ClientUtil.getLiveRoomError(e.code,o.stateCenter.useNetAgent)):r={code:e.code,message:e.msg},r&&o.dataReport.addMsgInfo(i,{error:r.code,message:r.message+n}),o.dataReport.uploadReport(i),o.stateCenter.reportSeqList.login=0,u.ClientUtil.unregisterCallback(y.ZegoRTMLogEvent.kZegoTaskLoginRoom.event,o.stateCenter.reportList),s&&c.errorCodeList[s]&&(e.code=c.errorCodeList[s].code),e.code&&e.msg&&""!==n?t({code:e.code,msg:e.msg+n}):t(e)}}},e.prototype.logoutRoom=function(e){this.logger.info(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGOUT_ROOM+" call by user "+e);var t=l.getReportSeq();if(this.dataReport.newReport(t),this.dataReport.addMsgInfo(t,{roomid:e,isMulti:this.stateCenter.isMultiRoom}),void 0===e)i(this.stateCenter.roomModulesList).forEach((function(e){return e.roomHandler.logout(!0)})),this.cloudSetting.uninit();else{if("string"!=typeof e||""==e)return this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGOUT_ROOM+" roomID must be string and not empty"),this.dataReport.addMsgInfo(t,{error:y.ZegoRTMLogEvent.kZegoTaskLogoutRoom.error.INPUT_PARAM.code,message:y.ZegoRTMLogEvent.kZegoTaskLogoutRoom.error.INPUT_PARAM.msg+" param roomID error"}),void this.dataReport.uploadReport(t,y.ZegoRTMLogEvent.kZegoTaskLogoutRoom.event);var n=this.getRoomModules(e);n?(n.roomHandler.logout(),0===this.stateCenter.roomModulesList.length&&this.cloudSetting.uninit(),this.dataReport.uploadReport(t,y.ZegoRTMLogEvent.kZegoTaskLogoutRoom.event)):(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_LOGOUT_ROOM+" room not exist"),this.dataReport.addMsgInfo(t,{error:y.ZegoRTMLogEvent.kZegoTaskLogoutRoom.error.ROOM_NOT_EXIST.code,message:y.ZegoRTMLogEvent.kZegoTaskLogoutRoom.error.ROOM_NOT_EXIST.msg}),this.dataReport.uploadReport(t,y.ZegoRTMLogEvent.kZegoTaskLogoutRoom.event))}},e.prototype.loginHall=function(e,t,n){var i=this;return new Promise((function(e,t){return r(i,void 0,void 0,(function(){return o(this,(function(e){return[2]}))}))}))},e.prototype.loginHallReport=function(e,t,n,r){},e.prototype.logoutHall=function(){},e.prototype.enterRoom=function(e,t){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.leaveRoom=function(){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.sendCustomCommand=function(e,t,n){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype._sendCustomCommand=function(e,t,n){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.sendBroadcastMessage=function(e,t){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype._sendBroadcastMessage=function(e,t,n,r){return void 0===n&&(n=1),void 0===r&&(r=1),new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.setRoomExtraInfo=function(e,t,n){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype._setRoomExtraInfo=function(e,t,n){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.sendBarrageMessage=function(e,t){return new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype._sendBarrageMessage=function(e,t,n,r){return void 0===n&&(n=1),void 0===r&&(r=1),new Promise((function(e,t){console.error(s.MODULE_TIPS.MESSAGE),t()}))},e.prototype.sendRelayMessage=function(e,t,n,r,o){console.error(s.MODULE_TIPS.MESSAGE)},e.prototype.requestJoinLive=function(e,t,n,r,o){return console.error(s.MODULE_TIPS.MESSAGE),!1},e.prototype.inviteJoinLive=function(e,t,n,r,o){return console.error(s.MODULE_TIPS.MESSAGE),!1},e.prototype.endJoinLive=function(e,t,n,r){return console.error(s.MODULE_TIPS.MESSAGE),!1},e.prototype.respondJoinLive=function(e,t,n,r,o){return console.error(s.MODULE_TIPS.MESSAGE),!1},e.prototype.getVersion=function(){return this.version},e.prototype.setSdkBizVersion=function(e){"string"==typeof e&&""!==e&&(this.stateCenter.bizVersion=e)},e.prototype.on=function(e,t){return this.stateCenter.listenerList[e]?"function"!=typeof t?(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ON+" listener callBack must be funciton"),!1):(-1==this.stateCenter.listenerList[e].indexOf(t)&&this.stateCenter.listenerList[e].push(t),!0):(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ON+" event "+e+" no found"),!1)},e.prototype.off=function(e,t){if(!this.stateCenter.listenerList[e])return this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_OFF+" listener no found"),!1;var n=this.stateCenter.listenerList[e];return t?n.splice(n.indexOf(t),1):this.stateCenter.listenerList[e]=[],!0},e.prototype._on=function(e,t){return this.stateCenter.listenerList[e]?"function"!=typeof t?(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ON+" listener callBack must be funciton"),!1):(-1==this.stateCenter.listenerList[e].indexOf(t)&&this.stateCenter.listenerList[e].push(t),!0):(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ON+" event "+e+" no found"),!1)},e.prototype._off=function(e,t){if(!this.stateCenter.listenerList[e])return this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_OFF+" listener no found"),!1;var n=this.stateCenter.listenerList[e];return t?n.splice(n.indexOf(t),1):this.stateCenter.listenerList[e]=[],!0},e.prototype.isTestEnvironment=function(){return this.stateCenter.testEnvironment},e.prototype.isLogin=function(e){var t=this.getRoomModules(e)||this.stateCenter.roomModulesList[0];return!!t&&t.isLogin()},e.prototype.getMultiRoom=function(){return this.stateCenter.isMultiRoom},e.prototype.getAppID=function(){return this.stateCenter.appid},e.prototype.getUserID=function(){return this.stateCenter.idName},e.prototype.getUseNetAgent=function(){return this.stateCenter.useNetAgent},e.prototype.getToken=function(e){return(this.getRoomModules(e)||this.stateCenter.roomModulesList[0]).token},e.prototype.setRoomCreateFlag=function(e){this.stateCenter.roomCreateFlag=e},e.prototype.setRole=function(e){this.stateCenter.role=e},e.prototype.getSessionId=function(e){var t=this.getRoomModules(e)||this.stateCenter.roomModulesList[0];return t?t.sessionID:"0"},e.prototype.getRoomSessionID=function(e){var t=this.getRoomModules(e)||this.stateCenter.roomModulesList[0];return t?t.roomSessionID:"0"},e.prototype.getAppConfig=function(){return this.stateCenter.appConfig},e.prototype.setAccess=function(e){this.stateCenter.useNetAgent=e,this.netAgent.setAccess(e)},e.prototype.enableMultiRoom=function(e){var t=l.getReportSeq();return this.dataReport.newReport(t,y.ZegoRTMLogEvent.kZegoEnableMultiRoom.event),this.dataReport.addMsgInfo(t,{isMulti:e}),"boolean"!=typeof e?(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ENABLE_MULTI_ROOM+" param must be boolean"),this.dataReport.uploadReport(t,void 0,y.ZegoRTMLogEvent.kZegoEnableMultiRoom.error.kAlreadyLoginError),!1):this.stateCenter.roomModulesList.length>0||this.stateCenter.setMultiRoom?(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_ENABLE_MULTI_ROOM+" multi room can only be set once before first login"),this.dataReport.uploadReport(t,void 0,y.ZegoRTMLogEvent.kZegoEnableMultiRoom.error.kAlreadyLoginError),!1):(this.dataReport.uploadReport(t),this.stateCenter.isMultiRoom=e,this.stateCenter.setMultiRoom=!0,!0)},e.prototype.getRoomModules=function(e){return this.stateCenter.roomModulesList.find((function(t){return t.roomID==e}))},e.use=function(t){switch(t.type){case"message":t.install(e,_.LiveRoomModules,v.LiveRoomService,O.LiveRoomHandler,g.LiveRoomModules,b.LiveRoomPrivateService);break;case"live":t.install(e,_.LiveRoomModules,v.LiveRoomService,O.LiveRoomHandler);break;case"privates":t.install(e,g.LiveRoomModules,b.LiveRoomPrivateService)}},e.prototype.resetRoomTokenTimer=function(e,t){var n=this.getRoomModules(e)||this.stateCenter.roomModulesList[0];n&&t&&t>0&&n.roomHandler.resetTokenTimer(1e3*t-this.stateCenter.local_time_deviation)},e.prototype.isDisConnect=function(){return this.stateCenter.useNetAgent?this.liveRoomHandler.isDisConnect():this.service.isDisConnect()},e.prototype.sendMessage=function(e,t,n,r){(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).sendMessage(e,t,n,r)},e.prototype.setProtoFormat=function(e){if(void 0===e&&(e="json"),!["json","pb"].includes(e))throw new Error("Failed to execute 'setProtoFormat': Arguments 'format' must be 'json' or 'pb'.");this.stateCenter.protoFormat=e},e.prototype.setSdkLoginRelateService=function(e){Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))&&(this.stateCenter.relateService=e)},e.prototype.sendMessageByService=function(e,t,n,r,o,i){return this.service.sendMessage(e,t,n,r,o,i)},e.prototype.getHeader=function(e){var t=this.stateCenter.roomModulesList[0];if(t&&t.isLogin()){var n=t.roomID,r=t.sessionID,o=t.roomSessionID;return this.service.getHeader(e,r,n,o)}this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_GET_HEADER+" room no found or no login")},e.prototype.sendPB=function(e){return e instanceof Uint8Array?this.service.sendPB(e):(this.logger.error(m.ZEGO_RTM_ACTION.ZEGOEXPRESSWEBRTM_SEND_PB+" type error"),!1)},e.prototype.onPushBizChannel=function(e){e&&this.service.on("push_biz_channel",e)},e.prototype.getRoomID=function(){return this.stateCenter.roomid},e.prototype.getServerTimeOffset=function(){return this.stateCenter.serverTimeOffset},e.prototype.isUseNetAgent=function(){return this.stateCenter.useNetAgent},e.prototype.getReqHead=function(e){var t;return t="string"==typeof e&&""!==e&&this.getRoomModules(e)||this.stateCenter.roomModulesList[0],this.liveRoomHandler.getReqHead(t)},e.prototype.sendSwitchMessage=function(e,t){return"string"==typeof e&&t?this.liveRoomHandler.sendMessage(e,t,void 0,void 0,void 0,!1):-1},e.prototype.onSwitchMessage=function(e){e&&this.liveRoomHandler&&(this.liveRoomHandler.onSwitchMessage=e)},e}();t.ZegoExpressWebRTM=T},function(e,t,n){"undefined"!=typeof self&&self,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.E_CLIENT_TYPE=t.ENUM_LOG_LEVEL=t.ENUM_REMOTE_TYPE=t.ZEGO_ENV=t.ZEGO_BROWSER_TYPE=void 0,function(e){e[e.IE=0]="IE",e[e.FIREFOX=1]="FIREFOX",e[e.CHROME=2]="CHROME",e[e.SAFARI=3]="SAFARI",e[e.OPERA=4]="OPERA",e[e.WEIXIN=5]="WEIXIN",e[e.WEIXINMINI=6]="WEIXINMINI",e[e.UNKOWN=7]="UNKOWN"}(t.ZEGO_BROWSER_TYPE||(t.ZEGO_BROWSER_TYPE={})),function(e){e[e.BROWSER=0]="BROWSER",e[e.WEIXINMINI=1]="WEIXINMINI"}(t.ZEGO_ENV||(t.ZEGO_ENV={})),function(e){e[e.DISABLE=0]="DISABLE",e[e.WEBSOCKET=1]="WEBSOCKET",e[e.HTTPS=2]="HTTPS"}(t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={})),t.ENUM_LOG_LEVEL={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},function(e){e[e.ClientType_None=0]="ClientType_None",e[e.ClientType_H5=1]="ClientType_H5",e[e.ClientType_SmallPragram=2]="ClientType_SmallPragram",e[e.ClientType_Webrtc=3]="ClientType_Webrtc"}(t.E_CLIENT_TYPE||(t.E_CLIENT_TYPE={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerStateCenter=void 0;var r=function(){function e(){this._testEnvironment=!0,this._ENV=0,this._debug=!0}return e.getInstance=function(){return e.instance||(e.instance=new e,e.instance.init()),e.instance},e.prototype.init=function(){},Object.defineProperty(e.prototype,"testEnvironment",{get:function(){return this._testEnvironment},set:function(e){this._testEnvironment=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ENV",{get:function(){return this._ENV},set:function(e){this._ENV=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debug",{get:function(){return this._debug},set:function(e){this._debug=e},enumerable:!1,configurable:!0}),e.instance=new e,e}();t.LoggerStateCenter=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createZegoWebSocket=t.ZegoWeiXinMiniWebSocket=void 0;var r=n(0),o=function(){function e(e,t){this.url=e,this.readyState=3,this._websocket=wx.connectSocket({url:e}),this.init()}return e.prototype.init=function(){var e=this;this._websocket&&(this.readyState=0,this._websocket.onOpen((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onopen&&(e.onopen(t),e._websocket.onClose((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onclose&&e.onclose(t)})),e._websocket.onMessage((function(t){"function"==typeof e.onmessage&&e.onmessage(t)})))})),this._websocket.onError((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onerror&&e.onerror(t)})))},e.prototype.onopen=function(e){},e.prototype.onerror=function(e){},e.prototype.onclose=function(e){},e.prototype.onmessage=function(e){},e.prototype.send=function(e){this._websocket&&this._websocket.send({data:e})},e.prototype.close=function(){this._websocket&&this._websocket.close()},e}();t.ZegoWeiXinMiniWebSocket=o,t.createZegoWebSocket=function(e,t){return t%2===r.ZEGO_ENV.BROWSER?new WebSocket(e):new o(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerStateCenter=t.createZegoWebSocket=t.ZegoDataReport=t.ZegoLogger=void 0;var r=n(1);Object.defineProperty(t,"LoggerStateCenter",{enumerable:!0,get:function(){return r.LoggerStateCenter}});var o=n(2);Object.defineProperty(t,"createZegoWebSocket",{enumerable:!0,get:function(){return o.createZegoWebSocket}});var i=n(4);Object.defineProperty(t,"ZegoDataReport",{enumerable:!0,get:function(){return i.ZegoDataReport}});var s=n(5);Object.defineProperty(t,"ZegoLogger",{enumerable:!0,get:function(){return s.ZegoLogger}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoDataReport=void 0;var o=function(){function e(e){this.dataStatistics={},this.logger=e}return e.prototype.newReport=function(e,t){this.dataStatistics[e]={event_time:Date.now(),time_consumed:0,seq:e,error:0,message:"success",event:t,events:[]}},e.prototype.addMsgExt=function(e,t){this.dataStatistics[e]?this.dataStatistics[e].msg_ext=t:console.warn(e+" not exist")},e.prototype.addMsgInfo=function(e,t){this.dataStatistics[e]?Object.assign(this.dataStatistics[e],t):console.warn(e+" not exist")},e.prototype.eventStart=function(e,t){this.dataStatistics[e]?null!=this.dataStatistics[e].events?this.dataStatistics[e].events.push({event:t,event_time:Date.now(),time_consumed:0}):this.logger.warn("zd.es.0 no events"):this.logger.warn("zd.es.0 no seq match")},e.prototype.eventEnd=function(e,t,n){if(this.dataStatistics[e]){var r=this.dataStatistics[e].events;if(r&&0!==r.length){for(var o=r.length-1;o>=0;o--)if(r[o].event==t&&0==r[o].time_consumed){r[o].time_consumed=Date.now()-r[o].event_time;break}}else this.logger.info("zd.ee.0 no events")}else this.logger.info("zd.ee.0 no seq match")},e.prototype.eventEndWithMsg=function(e,t,n){if(this.dataStatistics[e]){var o=this.dataStatistics[e].events;if(o){for(var i=o.length-1;i>=0;i--)if(o[i].event==t&&0==o[i].time_consumed){o[i].time_consumed=Date.now()-o[i].event_time,null==o[i].msg_ext&&(o[i].msg_ext={}),o[i].msg_ext=r({},n);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},e.prototype.eventEndWithMsgInfo=function(e,t,n){if(this.dataStatistics[e]){var r=this.dataStatistics[e].events;if(r){for(var o=r.length-1;o>=0;o--)if(r[o].event==t&&0==r[o].time_consumed){r[o].time_consumed=Date.now()-r[o].event_time,Object.assign(r[o],n);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},e.prototype.addEventInfo=function(e,t,n,r){if(this.dataStatistics[e]){var o=this.dataStatistics[e].events;if(null!=o){for(var i=o.length-1;i>=0;i--)if(o[i].event==t&&null!=o[i].time_consumed){null==o[i].msg_ext?o[i].msg_ext={}:o[i].msg_ext&&(o[i].msg_ext[n]=r);break}}else this.logger.warn("zd.aei.0 no events")}else this.logger.warn("zd.aei.0 no seq match")},e.prototype.addEventMsg=function(e,t,n,r){if(this.dataStatistics[e]){var o=this.dataStatistics[e].events;if(null!=o){for(var i=o.length-1;i>=0;i--)if(o[i].event==t){o[i][n]=r;break}}else this.logger.warn("zd.aem.0 no events")}else this.logger.warn("zd.aem.0 no seq match")},e.prototype.addEvent=function(e,t,n){this.dataStatistics[e]?this.dataStatistics[e].events&&(n?this.dataStatistics[e].events.push({event:t,event_time:Date.now(),msg_ext:n}):this.dataStatistics[e].events.push({event:t,event_time:Date.now()})):this.logger.warn("zd.ae.0 no seq match")},e.prototype.uploadReport=function(e,t,n,r){var o=this.dataStatistics[e];null!=o&&(t&&(o.event=t),o.time_consumed=Date.now()-o.event_time,n&&this.addMsgInfo(e,{error:n.code,message:n.message||n.msg+" "+(r||"")}),this.logger.report(o),delete this.dataStatistics[e])},e}();t.ZegoDataReport=o},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLogger=void 0;var o=n(0),i=n(2),s=n(1),a=n(6),c=function(){function e(e){this.logLevel=o.ENUM_LOG_LEVEL.INFO,this.logRemoteLevel=0,this.websocket=null,this.logUploadTimer=null,this.logUploadInterval=1e4,this.logCache=[],this.logCacheSend=[],this.logCacheMax=100,this.existUserID=!1,this.stateCenter=s.LoggerStateCenter.getInstance(),this.env=e}return e.prototype.setLogLevel=function(e){var t=o.ENUM_LOG_LEVEL[e];return void 0!==t&&(this.logLevel=t,!0)},e.prototype.setRemoteLogLevel=function(e){var t=o.ENUM_LOG_LEVEL[e];return void 0!==t&&(this.logRemoteLevel=t,!0)},e.prototype.setSessionInfo=function(e,t,n,r,o,i){this.appid=e,this.roomid=t,this.sessionid=n,this.userid=r,this.userName=o,this.version=i},e.prototype.report=function(e){var t=this.logReportParamList(o.ENUM_LOG_LEVEL.REPORT,e);this.logLevel!==o.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=o.ENUM_LOG_LEVEL.REPORT&&console.debug(t),this.RemoteLog(o.ENUM_LOG_LEVEL.REPORT,t,!0)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.logParamList(o.ENUM_LOG_LEVEL.DEBUG,e.join(""));this.logLevel!==o.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=o.ENUM_LOG_LEVEL.DEBUG&&console.debug(n),this.log(o.ENUM_LOG_LEVEL.DEBUG,n)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.logParamList(o.ENUM_LOG_LEVEL.INFO,e.join(""));this.logLevel!==o.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=o.ENUM_LOG_LEVEL.INFO&&console.info(n),this.log(o.ENUM_LOG_LEVEL.INFO,n)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.logParamList(o.ENUM_LOG_LEVEL.WARN,e.join(""));this.logLevel!==o.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=o.ENUM_LOG_LEVEL.WARN&&console.warn(n),this.log(o.ENUM_LOG_LEVEL.WARN,n)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.logParamList(o.ENUM_LOG_LEVEL.ERROR,e.join(""));this.logLevel!==o.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=o.ENUM_LOG_LEVEL.ERROR&&(console.error(n),window?this.stateCenter.debug&&window.alert(e.join("").substr(e.join("").indexOf(" ")+1,4500)):wx&&this.stateCenter.debug&&wx.showModal({title:"",content:e.join("").substr(e.join("").indexOf(" ")+1,4500)})),this.log(o.ENUM_LOG_LEVEL.ERROR,n)},e.prototype.log=function(e,t){this.logRemoteLevel!==o.ENUM_LOG_LEVEL.DISABLE&&this.logRemoteLevel<=e&&this.RemoteLog(e,t)},e.prototype.setLogServer=function(e){try{return e.startsWith("wss:")?(this.logType=o.ENUM_REMOTE_TYPE.WEBSOCKET,this.openWebSocketLogServer(e)):e.startsWith("https:")?(this.logType=o.ENUM_REMOTE_TYPE.HTTPS,this.openHttpsLogServer(e)):this.logType=o.ENUM_REMOTE_TYPE.DISABLE,!0}catch(e){return this.error(JSON.stringify(e)),!1}},e.prototype.stopLogServer=function(){this.logType==o.ENUM_REMOTE_TYPE.WEBSOCKET?this.stopWebSocketServer():this.logType==o.ENUM_REMOTE_TYPE.HTTPS&&(this.SendHttpsLog(),this.stopHttpsServer()),this.logType=o.ENUM_REMOTE_TYPE.DISABLE},e.prototype.stopWebSocketServer=function(){this.websocket&&(this.websocket.onclose=null,this.websocket.onerror=null,this.websocket.close(),this.websocket=null)},e.prototype.openHttpsLogServer=function(e){var t=this;this.url=e,e&&(this.stopHttpsServer(),this.logUploadTimer||(this.logUploadTimer=setInterval((function(){t.SendHttpsLog()}),this.logUploadInterval)))},e.prototype.stopHttpsServer=function(){this.logUploadTimer&&(clearInterval(this.logUploadTimer),this.logUploadTimer=null)},e.prototype.RemoteLog=function(e,t,n){if(void 0===n&&(n=!1),""!=this.url)if(this.logType==o.ENUM_REMOTE_TYPE.WEBSOCKET)this.RemoteWebSocketLog(e,t);else if(this.logType==o.ENUM_REMOTE_TYPE.HTTPS)this.RemoteHttpsLog(e,t,n);else if(this.logLevel!==o.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=e)for(this.logCacheSend.push(t);this.logCacheSend.length>this.logCacheMax;)this.logCacheSend.shift()},e.prototype.RemoteWebSocketLog=function(e,t){if("string"==typeof t&&t.length>4e3)console.info("log over maximum, ignore");else if(null==this.websocket||2==this.websocket.readyState||3==this.websocket.readyState){var n=this.url;this.url="",this.setLogServer(n),this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t)}else if(0==this.websocket.readyState)this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t);else if(1==this.websocket.readyState)if(this.logCacheSend.length>0){for(var o="",i=0;i<this.logCacheSend.length;i++){(o+this.logCacheSend[i]).length>4e3&&(this.websocket.send(o),o="");var s=JSON.parse(this.logCacheSend[i]);s=r(r({},s),{userid:s.userid||this.userid,roomid:s.roomid||this.roomid,userName:s.roomid||this.userName}),o=o+JSON.stringify(s)+"\n"}t=o+t,this.logCacheSend=[],this.websocket.send(t)}else this.websocket.send(t);else console.warn("wrong socket state:"+this.websocket.readyState),this.logCacheSend.length<this.logCacheMax&&this.logCacheSend.push(t)},e.prototype.RemoteHttpsLog=function(e,t,n){this.logCacheSend.push(t),(this.logCacheSend.length>=this.logCacheMax||!0===n)&&this.SendHttpsLog()},e.prototype.logParamList=function(e,t){var n=a.getCurrentTime(),r=[t.substr(0,t.indexOf(" "))||t,t.substr(t.indexOf(" ")+1,4500)||t],o={time:n,level:e,action:r[0],content:r[1],appid:this.appid,roomid:this.roomid,userid:this.userid,userName:this.userName,sessionid:this.sessionid};return JSON.stringify(o)},e.prototype.logReportParamList=function(e,t){var n=a.getCurrentTime();return t=r(r({},t),{time:n,level:e,console:this.env%2===o.ZEGO_ENV.BROWSER?"rtc":"xcx",appid:this.appid,room_id:this.roomid,roomid:this.roomid,userid:this.userid,id_name:this.userid,userName:this.userName,sessionid:this.sessionid,sdk_version:this.version,test_environment:this.stateCenter.testEnvironment,version:this.version,event_id:this.appid+"_"+this.userid+"_"+t.event_time+"_"+t.seq}),JSON.stringify(t)},e.prototype.openWebSocketLogServer=function(e){if(this.url!=e){if(this.url=e,!e)return;this.stopWebSocketServer(),this.websocket=i.createZegoWebSocket(e,this.env),this.websocket.onopen=function(){},this.websocket.onclose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn("onclose   websocket error:",e)},this.websocket.onmessage=function(){},this.websocket.onerror=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn("open log websocket error:",e)}}},e.prototype.SendHttpsLog=function(){0!=this.logCacheSend.length&&(this.env%2===o.ZEGO_ENV.BROWSER?this.SendHttpsLogWeb():this.SendHttpsLogWeChatMini())},e.prototype.SendHttpsLogWeb=function(){var e=this,t=this.logCacheSend.join("\n"),n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState)if(200==n.status){if(0==n.responseText.length)return;try{var t=JSON.parse(n.responseText).interval;"number"==typeof t&&e.logUploadInterval!==t&&(e.timeInterval=t,e.openHttpsLogServer(e.url))}catch(e){console.log("send result failed "+e)}}else console.log("send failed "+n.status)},n.open("POST",this.url,!0),0==this.env?n.send(t):2==this.env&&(n.setRequestHeader("content-type","application/json"),n.send(JSON.stringify({user_id:this.userid,log:t}))),this.logCacheSend=[]},e.prototype.SendHttpsLogWeChatMini=function(){var e=this;!this.existUserID&&this.userid&&this.logCacheSend.forEach((function(t){Array.isArray(t)&&t.forEach((function(n,r){var o=JSON.parse(n);o&&""==JSON.parse(n).userid?(o.userid=e.userid,o.id_name=e.userid,t[r]=JSON.stringify(o)):e.existUserID=!0}))}));var t=this.logCacheSend.join("\n"),n=1==this.env?t:JSON.stringify({user_id:this.userid,log:t});wx.request({url:this.url,data:n,method:"POST",success:function(t){if(0!=t.data.length){var n=t&&t.data&&t.data.interval;"number"==typeof n&&e.logUploadInterval!==n&&(e.timeInterval=n,e.openHttpsLogServer(e.url))}},fail:function(e){console.log("send failed "+e.statusCode)}}),this.logCacheSend=[]},e}();t.ZegoLogger=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentTime=t.getCurrentEnv=t.getBrowser=void 0;var r=n(0);t.getBrowser=function(){var e=window.navigator.userAgent,t=null!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),n=-1!=e.indexOf("Firefox"),o=null!=window.opr,i=e.indexOf("Chrome")&&window.chrome,s=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version"),a=e.toLowerCase().match(/MicroMessenger/i)&&"micromessenger"===e.toLowerCase().match(/MicroMessenger/i)[0];return t?r.ZEGO_BROWSER_TYPE.IE:n?r.ZEGO_BROWSER_TYPE.FIREFOX:o?r.ZEGO_BROWSER_TYPE.OPERA:i?r.ZEGO_BROWSER_TYPE.CHROME:s?r.ZEGO_BROWSER_TYPE.SAFARI:a?r.ZEGO_BROWSER_TYPE.WEIXIN:r.ZEGO_BROWSER_TYPE.UNKOWN},t.getCurrentEnv=function(){var e=window.navigator.userAgent;return new Promise((function(t){-1==e.indexOf("MicroMessage")?t(r.ZEGO_ENV.BROWSER):wx.miniProgram.getEnv((function(e){e.miniprogram}))}))};var o=["00","01","02","03","04","05","06","07","08","09"];t.getCurrentTime=function(){var e=new Date;return[e.getFullYear()+"/",(o[e.getMonth()+1]||e.getMonth()+1)+"/",(o[e.getDate()]||e.getDate())+" ",(o[e.getHours()]||e.getHours())+":",(o[e.getMinutes()]||e.getMinutes())+":",o[e.getSeconds()]||e.getSeconds(),"."+e.getTime()%1e3].join("")}}])},function(module,exports,__webpack_require__){var t;"undefined"!=typeof self&&self,t=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.typeMap=t.BrokenType=t.ConnectedType=t.DisconnectedType=t.Method=t.ConnectionClosedAction=t.NetWorkState=t.externalErrorList=t.Stick=t.PcConnectState=t.ENUM_CONNECT_STATE=t.StreamType=t.Mode=t.ZegoconnRunEnv=t.BusinessService=t.AccessHub_Error_Code=t.AccessHubMessageType=t.ENUM_NETWORK_STATE=void 0,function(e){e[e.offline=0]="offline",e[e.online=1]="online"}(t.ENUM_NETWORK_STATE||(t.ENUM_NETWORK_STATE={})),function(e){e[e.MSG_TYPE_STREAM_CLOSED=2]="MSG_TYPE_STREAM_CLOSED",e[e.MSG_TYPE_CLOSE_CONNECTION=3]="MSG_TYPE_CLOSE_CONNECTION",e[e.MSG_TYPE_HTTP_REQUEST=4]="MSG_TYPE_HTTP_REQUEST",e[e.MSG_TYPE_HTTP_RESPONSE=5]="MSG_TYPE_HTTP_RESPONSE",e[e.MSG_TYPE_HB_REQUEST=12]="MSG_TYPE_HB_REQUEST",e[e.MSG_TYPE_HB_RESPONSE=13]="MSG_TYPE_HB_RESPONSE",e[e.MSG_TYPE_GET_CONFIG_REQUEST=14]="MSG_TYPE_GET_CONFIG_REQUEST",e[e.MSG_TYPE_GET_CONFIG_RESPONSE=15]="MSG_TYPE_GET_CONFIG_RESPONSE",e[e.MSG_TYPE_HTTP_REQUEST_ACK=16]="MSG_TYPE_HTTP_REQUEST_ACK",e[e.MSG_TYPE_PC_UPWARD_MESSAGE=17]="MSG_TYPE_PC_UPWARD_MESSAGE",e[e.MSG_TYPE_PC_UPWARD_MESSAGE_ACK=18]="MSG_TYPE_PC_UPWARD_MESSAGE_ACK",e[e.MSG_TYPE_PC_ESTABLISHED=19]="MSG_TYPE_PC_ESTABLISHED",e[e.MSG_TYPE_PC_BROKEN=20]="MSG_TYPE_PC_BROKEN",e[e.MSG_TYPE_PC_DOWNWARD_MESSAGE=21]="MSG_TYPE_PC_DOWNWARD_MESSAGE",e[e.MSG_TYPE_REDIRECT=22]="MSG_TYPE_REDIRECT",e[e.MSG_TYPE_GET_APPCONFIG_REQUEST=23]="MSG_TYPE_GET_APPCONFIG_REQUEST",e[e.MSG_TYPE_GET_APPCONFIG_RESPONSE=24]="MSG_TYPE_GET_APPCONFIG_RESPONSE",e[e.MSG_TYPE_PUSH_APPCONFIG=25]="MSG_TYPE_PUSH_APPCONFIG",e[e.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST=26]="MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST",e[e.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE=27]="MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE",e[e.MSG_TYPE_PUSH_EXCEPTION=30]="MSG_TYPE_PUSH_EXCEPTION"}(t.AccessHubMessageType||(t.AccessHubMessageType={})),function(e){e[e.ACCESSHUB_INVALID_FRAME=2e4]="ACCESSHUB_INVALID_FRAME",e[e.ACCESSHUB_NEED_ENCRYPT=20001]="ACCESSHUB_NEED_ENCRYPT",e[e.ACCESSHUB_DECRYPT=20002]="ACCESSHUB_DECRYPT",e[e.ACCESSHUB_MSGTYPE=20003]="ACCESSHUB_MSGTYPE",e[e.ACCESSHUB_UNMARSHAL=20004]="ACCESSHUB_UNMARSHAL",e[e.ACCESSHUB_TIMEOUT=20005]="ACCESSHUB_TIMEOUT",e[e.ACCESSHUB_CONNECT=20006]="ACCESSHUB_CONNECT",e[e.ACCESSHUB_BROKEN=20007]="ACCESSHUB_BROKEN",e[e.ACCESSHUB_INTERNAL_ERROR=20008]="ACCESSHUB_INTERNAL_ERROR",e[e.ACCESSHUB_MARSHAL=20009]="ACCESSHUB_MARSHAL",e[e.ACCESSHUB_UNSUPPORTED_SERVICE=20010]="ACCESSHUB_UNSUPPORTED_SERVICE",e[e.ACCESSHUB_TOO_FREQUENTLY=20011]="ACCESSHUB_TOO_FREQUENTLY",e[e.ACCESSHUB_INVALID_APPID=20012]="ACCESSHUB_INVALID_APPID",e[e.ACCESSHUB_HB_TIMEOUT=20013]="ACCESSHUB_HB_TIMEOUT",e[e.ACCESSHUB_INVALID_SIGNATURE=20014]="ACCESSHUB_INVALID_SIGNATURE"}(r=t.AccessHub_Error_Code||(t.AccessHub_Error_Code={})),function(e){e[e.SERVICE_UNSET=0]="SERVICE_UNSET",e[e.SERVICE_MEDIAGW=1]="SERVICE_MEDIAGW",e[e.SERVICE_LIVEROOM=2]="SERVICE_LIVEROOM",e[e.SERVICE_MIX=3]="SERVICE_MIX",e[e.SERVICE_ZEUS=4]="SERVICE_ZEUS",e[e.SERVICE_ZPUSH=5]="SERVICE_ZPUSH",e[e.SERVICE_L3=6]="SERVICE_L3",e[e.SERVICE_TALKLINE=7]="SERVICE_TALKLINE",e[e.SERVICE_EDUSUITE=8]="SERVICE_EDUSUITE",e[e.SERVICE_ZIM=9]="SERVICE_ZIM",e[e.SERVICE_ClOUD_SETTING=10]="SERVICE_ClOUD_SETTING",e[e.SERVICE_ZEUSHB=11]="SERVICE_ZEUSHB",e[e.SERVICE_USER_LOGIC=12]="SERVICE_USER_LOGIC",e[e.SERVICE_UNIFYDISPATCH=13]="SERVICE_UNIFYDISPATCH",e[e.SERVICE_QUALITY=14]="SERVICE_QUALITY",e[e.SERVICE_SECURITY=15]="SERVICE_SECURITY",e[e.SERVICE_KTVCPR=16]="SERVICE_KTVCPR",e[e.SERVICE_SWITCH4LIVEROOM=17]="SERVICE_SWITCH4LIVEROOM",e[e.SERVICE_WEBRTC_SIGNAL=18]="SERVICE_WEBRTC_SIGNAL",e[e.SERVICE_L3_WEBRTC_SIGNAL=19]="SERVICE_L3_WEBRTC_SIGNAL",e[e.SERVICE_VIDEOCPR=20]="SERVICE_VIDEOCPR",e[e.SERVICE_CDN=21]="SERVICE_CDN",e[e.SERVICE_CLOUDRECORD=22]="SERVICE_CLOUDRECORD",e[e.SERVICE_INNER_ECHO=23]="SERVICE_INNER_ECHO",e[e.SERVICE_OUTER_ECHO=24]="SERVICE_OUTER_ECHO",e[e.SERVICE_LOCALHOST_ECHO=25]="SERVICE_LOCALHOST_ECHO",e[e.SERVICE_ECHO=26]="SERVICE_ECHO",e[e.SERVICE_DOCSERVICE=27]="SERVICE_DOCSERVICE",e[e.SERVICE_AUTHSVR=28]="SERVICE_AUTHSVR"}(t.BusinessService||(t.BusinessService={})),function(e){e[e.ZEGOCONN_RUN_ENV_UNSET=0]="ZEGOCONN_RUN_ENV_UNSET",e[e.ZEGOCONN_RUN_ENV_BROWSER=1]="ZEGOCONN_RUN_ENV_BROWSER",e[e.ZEGOCONN_RUN_ENV_APPLET=2]="ZEGOCONN_RUN_ENV_APPLET"}(t.ZegoconnRunEnv||(t.ZegoconnRunEnv={})),function(e){e[e.Mode_UNSET=0]="Mode_UNSET",e[e.MODE_ONLINE=1]="MODE_ONLINE",e[e.MODE_TEST=2]="MODE_TEST",e[e.MODE_ALPHA=3]="MODE_ALPHA"}(t.Mode||(t.Mode={})),function(e){e[e.HTTP=0]="HTTP",e[e.PC=1]="PC",e[e.OTHER=2]="OTHER"}(t.StreamType||(t.StreamType={})),t.ENUM_CONNECT_STATE={disconnect:0,connecting:1,connected:2},function(e){e[e.CONNECTED=0]="CONNECTED",e[e.DISCONNECT=1]="DISCONNECT",e[e.BROKEN=2]="BROKEN"}(t.PcConnectState||(t.PcConnectState={})),t.Stick={DISPATCH:"zego-action-dispatch",RETRY:"zego-action-retry",ABORT:"zego-action-abort",NEXT_GROUP:"zego-action-next-group",PUSH_APP_CONFIG:"push-app-config:"},t.externalErrorList=[r.ACCESSHUB_INVALID_APPID,r.ACCESSHUB_INVALID_SIGNATURE],function(e){e[e.offline=0]="offline",e[e.online=1]="online"}(t.NetWorkState||(t.NetWorkState={})),function(e){e[e.ACTION_RESERVED=0]="ACTION_RESERVED",e[e.ACTION_DISPATCH=1]="ACTION_DISPATCH",e[e.ACTION_RETRY=2]="ACTION_RETRY",e[e.ACTION_NEXT_NODE=3]="ACTION_NEXT_NODE",e[e.ACTION_ABORT=4]="ACTION_ABORT",e[e.ACTION_NEXT_GROUP=5]="ACTION_NEXT_GROUP"}(t.ConnectionClosedAction||(t.ConnectionClosedAction={})),function(e){e[e.METHOD_UNSET=0]="METHOD_UNSET",e[e.METHOD_GET=1]="METHOD_GET",e[e.METHOD_POST=2]="METHOD_POST"}(t.Method||(t.Method={})),function(e){e[e.CLOSE=0]="CLOSE",e[e.TEMP=1]="TEMP",e[e.TIMEOUT=2]="TIMEOUT"}(t.DisconnectedType||(t.DisconnectedType={})),function(e){e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL"}(t.ConnectedType||(t.ConnectedType={})),function(e){e[e.EMPTY=0]="EMPTY",e[e.CLOSE=1]="CLOSE"}(t.BrokenType||(t.BrokenType={})),t.typeMap={2:"stream_closed",3:"close_connection",4:"http_request",5:"http_response",12:"hb_request",13:"hb_response",14:"get_config_request",15:"get_config_response",16:"http_request_ack",17:"pc_upward_message",18:"pc_upward_message_ack",19:"pc_established",20:"pc_broken",21:"pc_downward_message",22:"redirect",23:"get_appconfig_request",24:"get_appconfig_response",25:"push_appconfig",26:"accesshub_dispatch_request",27:"accesshub_dispatch_response",30:"push_exception"}},function(e,t,n){"use strict";(function(e){var r=t;function o(e,t,n){for(var r=Object.keys(t),o=0;o<r.length;++o)void 0!==e[r[o]]&&n||(e[r[o]]=t[r[o]]);return e}function i(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&o(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=n(17),r.base64=n(18),r.EventEmitter=n(19),r.float=n(20),r.inquire=n(21),r.utf8=n(22),r.pool=n(23),r.LongBits=n(24),r.isNode=Boolean(void 0!==e&&e&&e.process&&e.process.versions&&e.process.versions.node),r.global=r.isNode&&e||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=o,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=i,r.ProtocolError=i("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}}).call(this,n(16))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APP_CONFIG_KEY=t.NET_ACCESS_SERVERS=t.NET_ACCESS_CONFIG=void 0;var r=n(0);t.NET_ACCESS_CONFIG={domains:["accesshub-wss.zego.im"],mode:"online",modeNo:r.Mode.MODE_ONLINE,sdkType:3,connectVer:2,pcEstablishTimeout:15,scheme:"wss",location:"accesshub",wssMessageType:1},t.NET_ACCESS_SERVERS="z_net_access_servers",t.APP_CONFIG_KEY="z_appconfig"},function(e,t,n){"use strict";e.exports=n(15)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorCodeList=void 0,t.errorCodeList={TIMEOUT:{code:1100002,msg:"network timeout."},SOCKET_CLOSE:{code:1100003,msg:"socket close"},NET_SOCKET_TIMEOUT:{code:1100004,msg:"net agent timeout"},NET_HB_TIMEOUT:{code:1100005,msg:"net hb timeout"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuidNum=t.decodeString=t.encodeString=void 0,t.encodeString=function(e){return Uint8Array.from(Array.from(unescape(encodeURIComponent(e))).map((function(e){return e.charCodeAt(0)})))},t.decodeString=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(String,Array.from(e))))},t.uuidNum=function(e,t){var n,r="0123456789".split(""),o=[];if(t=r.length,e)for(n=0;n<e;n++)o[n]=r[0|Math.random()*t];else{var i=void 0;for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",n=0;n<36;n++)o[n]||(i=0|16*Math.random(),o[n]=r[19==n?3&i|8:i])}return o.join("")}},function(e,t,n){"use strict";e.exports=h;var r,o=n(1),i=o.LongBits,s=o.base64,a=o.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var p=function(){return o.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function f(e,t,n){t[n]=255&e}function d(e,t){this.len=e,this.next=void 0,this.val=t}function _(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function g(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}h.create=p(),h.alloc=function(e){return new o.Array(e)},o.Array!==Array&&(h.alloc=o.pool(h.alloc,o.Array.prototype.subarray)),h.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},d.prototype=Object.create(c.prototype),d.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new d((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(_,10,i.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=i.from(e);return this._push(_,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(_,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=i.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(o.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(o.float.writeDoubleLE,8,e)};var m=o.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(o.isString(e)){var n=h.alloc(t=s.length(e));s.decode(e,n,0),e=n}return this.uint32(t)._push(m,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=p(),r._configure()}},function(e,t,n){"use strict";e.exports=c;var r,o=n(1),i=o.LongBits,s=o.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},h=function(){return o.Buffer?function(e){return(c.create=function(e){return o.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function p(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw a(this,8);return new i(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}c.create=h(),c.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=h(),r._configure();var t=o.Long?"toLong":"toNumber";o.merge(c.prototype,{int64:function(){return p.call(this)[t](!1)},uint64:function(){return p.call(this)[t](!0)},sint64:function(){return p.call(this).zzDecode()[t](!1)},fixed64:function(){return d.call(this)[t](!0)},sfixed64:function(){return d.call(this)[t](!1)}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetAgentPCRequest=void 0;var r=n(0),o=n(2),i=n(9),s=n(5),a=[r.BusinessService.SERVICE_WEBRTC_SIGNAL,r.BusinessService.SERVICE_L3_WEBRTC_SIGNAL],c=function(){function e(e,t,n,o,s){this.logger=e,this.service=t,this.streamManager=n,this.pcEstablishTimeout=o,this.option=s,this.connectState=r.PcConnectState.DISCONNECT,this.lastConnectState=r.PcConnectState.DISCONNECT,this.brokenTimer=null,this.listenerList={connected:[],broken:[]},this.netPcStream=this.streamManager.createStream(r.StreamType.PC),this.eventManager=new i.EventManager,this.netPcStream.onPushEvent=this.onPushEvent.bind(this)}return e.prototype.sendRequest=function(e,t,n){var i,c,u,l=this,h=e.payload;(a.includes(this.service)||(null===(i=this.option)||void 0===i?void 0:i.encode))&&(h=(0,s.encodeString)(e.payload));var p={service_no:this.service,ack:e.ack,payload:h,wss_message_type:o.NET_ACCESS_CONFIG.wssMessageType,wss_path:null===(c=this.option)||void 0===c?void 0:c.path,wss_raw_query:null===(u=this.option)||void 0===u?void 0:u.query,zegoconn_version:o.NET_ACCESS_CONFIG.connectVer};this.netPcStream.isConnect()||this.eventManager.emit("connectStart"),this.netPcStream.sendMessage(r.AccessHubMessageType.MSG_TYPE_PC_UPWARD_MESSAGE,p,(function(){l.logger.info("zn.napr.sr suc"),n&&n()}),(function(e){l.logger.error("zn.napr.sr fail"),t&&t(e)}),null,{isInSendMap:!1}),this.netPcStream.isFirst=!1},e.prototype.onPushEvent=function(e,t){var n;switch(this.logger.info("zn.napr.ope"+" msgType: ".concat(e)),e){case r.AccessHubMessageType.MSG_TYPE_PC_ESTABLISHED:this.pcEstablished(t);break;case r.AccessHubMessageType.MSG_TYPE_PC_BROKEN:this.pcBroken();break;case r.AccessHubMessageType.MSG_TYPE_PC_DOWNWARD_MESSAGE:var o=t.payload;(a.includes(this.service)||(null===(n=this.option)||void 0===n?void 0:n.encode))&&(o=(0,s.decodeString)(t.payload)),this.eventManager.emit("downLoadMessage",o)}},e.prototype.on=function(e,t){return this.eventManager.addEventHandler(e,t)},e.prototype.off=function(e,t){this.eventManager.removeEventHandler(e,t)},e.prototype.pcEstablished=function(e){this.logger.info("zn.napr.pe call "+JSON.stringify(e)),this.setConnectState(r.PcConnectState.CONNECTED);var t=r.ConnectedType.MANUAL;this.lastConnectState===r.PcConnectState.BROKEN&&this.connectState===r.PcConnectState.CONNECTED&&(t=r.ConnectedType.AUTO),this.eventManager.emit("connected",t),this.eventManager.emit("pcConnectedEvent",{proxy_link_sources:null==e?void 0:e.from}),this.brokenTimer&&clearTimeout(this.brokenTimer)},e.prototype.pcBroken=function(){var e=this;this.logger.info("zn.napr.pb call"),this.setConnectState(r.PcConnectState.BROKEN),this.eventManager.emit("broken"),this.brokenTimer=setTimeout((function(){e.eventManager.emit("disconnected",r.DisconnectedType.TEMP)}),1e3*this.pcEstablishTimeout)},e.prototype.resetBrokenTimer=function(){this.brokenTimer&&clearTimeout(this.brokenTimer)},e.prototype._close=function(e,t){if(this.logger.info("zn.napr.cr call "+this.service+" "+this.connectState),this.connectState!==r.PcConnectState.DISCONNECT){this.netPcStream.closeStream(0,""),this.resetBrokenTimer();var n=this.streamManager.getStreamID();this.netPcStream.refresh(n),this.eventManager.emit(e,t)}this.setConnectState(r.PcConnectState.DISCONNECT)},e.prototype.closePc=function(){this._close("broken")},e.prototype.closeRequest=function(){this._close("disconnected",r.DisconnectedType.CLOSE)},e.prototype.setConnectState=function(e){this.connectState!==e&&(this.lastConnectState=this.connectState,this.connectState=e)},e}();t.NetAgentPCRequest=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventManager=void 0;var r=function(){function e(){this.handlerListMap={}}return e.prototype.addEventHandler=function(e,t){if(this.handlerListMap[e]||(this.handlerListMap[e]=[]),"function"!=typeof t)throw new Error("Params callBack is not a Function");return this.handlerListMap[e]&&-1==this.handlerListMap[e].indexOf(t)&&this.handlerListMap[e].push(t),!0},e.prototype.removeEventHandler=function(e,t){return!!this.handlerListMap[e]&&(this.handlerListMap[e]=t?this.handlerListMap[e].filter((function(e){return e!==t})):[],!0)},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.handlerListMap[e]&&this.handlerListMap[e].forEach((function(n){try{setTimeout((function(){n.apply(void 0,t)}),0)}catch(t){console.error("dispatch "+e+" "+t)}}))},e}();t.EventManager=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetAgentHttpRequest=void 0;var r=n(0),o=n(5),i=n(2),s=function(){function e(e,t,n){this.logger=e,this.service=t,this.streamManager=n,this.netHttpStream=this.streamManager.createStream(r.StreamType.HTTP)}return e.prototype.sendRequest=function(e,t,n,s,a){var c=this,u={service_no:this.service,ack:e.ack,headers:e.headers,body:(0,o.encodeString)(JSON.stringify(e.body)),id_name:e.idName,method_no:e.method_no,stick:e.stick,location:e.location,zegoconn_version:i.NET_ACCESS_CONFIG.connectVer};this.netHttpStream.sendMessage(r.AccessHubMessageType.MSG_TYPE_HTTP_REQUEST,u,(function(e){if(e.body){var n=(0,o.decodeString)(e.body);e.body=n}c.logger.info("zn.nahr.sr suc "+JSON.stringify(e)),t&&t(e)}),(function(e,t,r){c.logger.error("zn.nahr.sr fail"),n&&n(r||e)}),(function(e){c.logger.error("zn.nahr.sr ack"),s&&s(e)}),a),this.netHttpStream.isFirst=!1},e}();t.NetAgentHttpRequest=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Method=t.Mode=t.DisconnectedType=t.ConnectedType=t.NET_ACCESS_CONFIG=t.BrokenType=t.BusinessService=t.NetAgentHttpRequest=t.NetAgentPCRequest=t.ZegoConnectionAgent=void 0;var r=n(0);Object.defineProperty(t,"BrokenType",{enumerable:!0,get:function(){return r.BrokenType}}),Object.defineProperty(t,"BusinessService",{enumerable:!0,get:function(){return r.BusinessService}}),Object.defineProperty(t,"ConnectedType",{enumerable:!0,get:function(){return r.ConnectedType}}),Object.defineProperty(t,"DisconnectedType",{enumerable:!0,get:function(){return r.DisconnectedType}}),Object.defineProperty(t,"Mode",{enumerable:!0,get:function(){return r.Mode}}),Object.defineProperty(t,"Method",{enumerable:!0,get:function(){return r.Method}});var o=n(12);Object.defineProperty(t,"ZegoConnectionAgent",{enumerable:!0,get:function(){return o.ZegoConnectionAgent}});var i=n(10);Object.defineProperty(t,"NetAgentHttpRequest",{enumerable:!0,get:function(){return i.NetAgentHttpRequest}});var s=n(2);Object.defineProperty(t,"NET_ACCESS_CONFIG",{enumerable:!0,get:function(){return s.NET_ACCESS_CONFIG}});var a=n(8);Object.defineProperty(t,"NetAgentPCRequest",{enumerable:!0,get:function(){return a.NetAgentPCRequest}})},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoConnectionAgent=void 0;var o=n(0),i=n(13),s=n(31),a=n(36),c=n(37),u=n(38),l=n(2),h=n(9),p=n(39),f=n(4),d=n(40),_=n(5),g=n(41),m=n(10),y=n(42),v=function(){function e(){var e=this;this.linkCheckTimer=null,this.connectServers=[],this.getAppConfigFailCount=0,this.getAppConfigTime=0,this.inited=!1,this.linkMsgMaxInterval=90,this.linkMsgCheckInterval=5,this.connectedTime=0,this.connectid="",this.reportSeq=0,this.connectSeq=0,this.onConnectedEvent=function(t){e.getConfig();var n=e.reportSeq++;e.eventManager.emit("dispatchEvent",n,"start"),e.dispatch().then((function(t){var r=t.servers,o=t.domains;e.eventManager.emit("dispatchEvent",n,"end",{domains:o}),r.length>0&&e.eventManager.emit("dispatchResultUpdate",{servers:r})})).catch((function(e){})),e.eventManager.emit("connected"),e.connectedTime=(new Date).getTime(),e.connectid=(0,_.uuidNum)(16),e.eventManager.emit("connectedEvent",e.connectSeq,"end",{servers:t,count:t.length,connectid:e.connectid})},this.onConnectingEvent=function(){e.logger.info("zn.zca.oce call")},this.onDisConnectedEvent=function(t){e.disConnect(),e.netAgentPCRequestMgr.updateConnectState(o.PcConnectState.BROKEN)},this.onPushEvent=function(t,n,r){switch(n){case o.AccessHubMessageType.MSG_TYPE_REDIRECT:e.redirect(r);break;case o.AccessHubMessageType.MSG_TYPE_CLOSE_CONNECTION:e.connectClosed(r);break;case o.AccessHubMessageType.MSG_TYPE_PC_BROKEN:case o.AccessHubMessageType.MSG_TYPE_PC_ESTABLISHED:case o.AccessHubMessageType.MSG_TYPE_PC_DOWNWARD_MESSAGE:e.streamManager.onPushEvent(t,n,r);break;case o.AccessHubMessageType.MSG_TYPE_PUSH_APPCONFIG:e.businessRequestMgr.decodeConfigMessage(r.data)}}}return e.prototype.init=function(){this.logger=new g.ZegoLogger,this.protobuf=new i.AccessHubProtoBuf,this.stateCenter=new d.StateCenter,this.eventManager=new h.EventManager,this.checkLinkMsg(),this.inited=!0},e.prototype.unInit=function(){this.inited=!1},e.prototype.setAppInfo=function(e){this.stateCenter.appInfo=e,this.stateCenter.networkState=navigator?navigator.onLine?o.ENUM_NETWORK_STATE.online:o.ENUM_NETWORK_STATE.offline:o.ENUM_NETWORK_STATE.online,0===e.env?this.bindWindowListener():1===e.env&&this.bindWxListener(),this.zegoLink=new s.ZegoWssLink(e.appID,e.env,this.protobuf,this.logger,this.stateCenter),this.zegoLink.initEvent(this.onConnectedEvent,this.onDisConnectedEvent,this.onConnectingEvent,this.onPushEvent),this.streamManager=new y.StreamManager(this.zegoLink),this.businessRequestMgr=new a.NetAgentBusinessRequestMgr(this.streamManager,this.protobuf,this.logger,this.stateCenter),this.netHeartBeatHandler=new c.NetHeartBeatHandler(this.streamManager,this.logger),this.netAgentPCRequestMgr=new u.NetAgentPCRequestMgr(this.streamManager,this.logger),this.heartBeatHandler()},e.prototype.setUserInfo=function(e){this.stateCenter.userId=e},e.prototype.setNetAgentDefaultServers=function(e){this.connectServers=r([],e,!0)},e.prototype.setDispatchConnectServers=function(e){this.connect(e)},e.prototype.startHttpRequest=function(e,t,n,r,o){var i=this,s=this.reportSeq++;this.eventManager.emit("requestEvent",s,"start"),this.isConnect()||this.connectUa(),new m.NetAgentHttpRequest(this.logger,e.service,this.streamManager).sendRequest(e,(function(e){i.eventManager.emit("requestEvent",s,"end",{na_req_location:location,status_code:e.status_code}),t&&t(e)}),(function(e){i.eventManager.emit("requestEvent",s,"end",{na_req_location:location}),n&&n(e)}),r,o)},e.prototype.getAppConfigByAgent=function(e,t,n){return this.isConnect()||this.connectUa(),this.getAppConfig(e,this.stateCenter.userId,t,n)},e.prototype.getPCRequest=function(e,t){var n=this,r=this.netAgentPCRequestMgr.getRequest(e,t);return r.on("disconnected",(function(t){n.logger.warn("zn.zca.gpr "+e+" disconnect "+t),t===o.DisconnectedType.TEMP&&(n.disConnect(),n.connectStart())})),r.on("connectStart",(function(){n.connectUa()})),r},e.prototype.connectUa=function(){this.logger.info("zn.zca.cua call"),this.retryLinkHandler&&(this.retryLinkHandler.init(),this.connectStart(!1,!0))},e.prototype.destroyConnect=function(){this.logger.info("zn.zca.dc.0 call"),this.resetNetAgent()},e.prototype.isConnect=function(){return this.zegoLink&&this.zegoLink.isConnect()},e.prototype.on=function(e,t){return this.logger.info("zn.zca.o.0 "+e),this.eventManager.addEventHandler(e,t)},e.prototype.off=function(e,t){this.logger.info("zn.zca.o.1 "+e),this.eventManager.removeEventHandler(e,t)},e.prototype.setLogger=function(e){this.logger=e},e.prototype.setAccess=function(e){this.stateCenter.useNetAgent=e},e.prototype.heartBeatHandler=function(){var e=this;this.netHeartBeatHandler.netHbLogout=function(t){e.retryLinkHandler&&([f.errorCodeList.NET_HB_TIMEOUT.code].includes(t.code)?(e.retryLinkHandler.startMaxTime(),e.disConnect(),e.connectStart()):(e.retryLinkHandler.stopMaxTime(),e.retryLinkHandler.invalid(),e.eventManager.emit("disconnected")))}},e.prototype.bindWindowListener=function(){var e=this;window.addEventListener("offline",(function(){e.netOffLineHandle()})),window.addEventListener("online",(function(){e.netOnLineHandle()}))},e.prototype.bindWxListener=function(){var e=this;wx.onNetworkStatusChange((function(t){t.isConnected?e.netOnLineHandle():e.netOffLineHandle()}))},e.prototype.netOnLineHandle=function(){this.logger.info("zn.zca.noh.0 network is online"),this.stateCenter.networkState=o.ENUM_NETWORK_STATE.online,this.stateCenter.useNetAgent&&this.netOnLineHandler()},e.prototype.netOffLineHandle=function(){this.logger.info("zn.zca.noh.1 network is broken"),this.stateCenter.networkState=o.ENUM_NETWORK_STATE.offline,this.stateCenter.useNetAgent&&this.netOffLineHandler()},e.prototype.checkLinkMsg=function(){var e=this;if(this.stateCenter.useNetAgent){if(this.isConnect()){var t=Date.now()-this.zegoLink.updatedMsgTime;if(t>1e3*this.linkMsgMaxInterval)return this.logger.info("zn.zca.clm interval: "+t),void this.resetNetAgent()}this.linkCheckTimer&&clearTimeout(this.linkCheckTimer),this.linkCheckTimer=setTimeout((function(){e.checkLinkMsg()}),1e3*this.linkMsgCheckInterval)}},e.prototype.connect=function(e){var t=this;e.length>0&&(this.connectServers=r([],e,!0)),this.zegoLink.createSocket(this.connectServers),this.retryLinkHandler||(this.retryLinkHandler=new p.NetRetryLinkHandler(this.logger,this.stateCenter)),this.retryLinkHandler.init(),this.retryLinkHandler.initLink(this.zegoLink),this.retryLinkHandler.onactive=function(e,n){n===f.errorCodeList.NET_SOCKET_TIMEOUT&&(t.eventManager.emit("disconnected",n),t.netAgentPCRequestMgr.updateConnectState(o.PcConnectState.DISCONNECT,o.DisconnectedType.TIMEOUT,n))},this.connectStart(!1,!0)},e.prototype.resetNetAgent=function(){this.netHeartBeatHandler.reset(),this.zegoLink.destroySocket()},e.prototype.getConfig=function(){var e=this,t=function(t,n,r){r?e.logger.info("zn.zca.gc fail "+JSON.stringify(r)):0===t.code?(e.logger.info("zn.zca.gc suc "+JSON.stringify(t)),e.getConfigSuccess(t)):e.logger.info("zn.zca.gc fail")};this.businessRequestMgr.getConfig(t,t)},e.prototype.getConfigSuccess=function(e){this.netHeartBeatHandler.init(e),this.netAgentPCRequestMgr.setEstablishTimeout(e.data.pc_establish_timeout)},e.prototype.dispatch=function(){var e=this;return new Promise((function(t,n){e.businessRequestMgr.dispatchURL((function(n){var r=n.data.wss_groups;e.logger.info("zn.nab.du wss_groups: "+JSON.stringify(r));var o=e.handleWssGroups(r);t({servers:o,domains:r})}),(function(e){n(e)}))}))},e.prototype.handleWssGroups=function(e){return Array.isArray(e)&&e.length>0?e.map((function(e){return l.NET_ACCESS_CONFIG.scheme+"://"+e.host+"/"+l.NET_ACCESS_CONFIG.location})):[]},e.prototype.getAppConfig=function(e,t,n,r){var i=this;return new Promise((function(s,a){"string"==typeof t&&"string"==typeof n?i.businessRequestMgr.getAppConfig(e,t,n,r).then((function(e){s(e)})).catch((function(r){if(i.logger.error("zn.zca.gac "+JSON.stringify(r)),o.externalErrorList.indexOf(r.code)>-1)return i.getAppConfigFailCount=0,void a(r);i.getAppConfigFailCount++,20008===r.code&&i.getAppConfigFailCount<3?i.getAppConfig(e,t,n).then((function(e){return s(e)})).catch((function(e){return a(e)})):(i.getAppConfigFailCount=0,a(r))})):i.logger.error("zn.zca.gac userID or token must be string")}))},e.prototype.reportDisConnectEvent=function(){var e=(new Date).getTime()-this.connectedTime;this.eventManager.emit("disConnectedEvent",{duration:e,server:this.zegoLink.connectServer})},e.prototype.redirect=function(e){this.logger.info("zn.zca.rd"+" ".concat(JSON.stringify(e.wss_groups)));var t=this.handleWssGroups(e.wss_groups);t&&Array.isArray(t)&&t.length>0?(this.disConnect(),this.zegoLink.createSocket(t),this.connectStart(!1,!0)):this.logger.warn("zn.zca.rd wss_groups null")},e.prototype.connectClosed=function(e){var t=this;switch(this.logger.info("zn.zca.cc"+" ".concat(e.reason," ").concat(e.msg," ").concat(e.action)),e.action){case o.ConnectionClosedAction.ACTION_DISPATCH:var n=this.reportSeq++;this.eventManager.emit("dispatchEvent",n,"start"),this.dispatch().then((function(e){var r=e.servers,o=e.domains;t.eventManager.emit("dispatchEvent",n,"end",{domains:o,reason:"ConnectClosed"}),Array.isArray(r)&&r.length>0&&(t.disConnect(),t.zegoLink.createSocket(r),t.eventManager.emit("dispatchResultUpdate",{servers:r}),t.connectStart(!1,!0))})).catch((function(e){t.logger.info("zn.zca.cc dispatch fail")}));break;case o.ConnectionClosedAction.ACTION_RETRY:this.disConnect(),this.connectStart(!1);break;case o.ConnectionClosedAction.ACTION_NEXT_GROUP:this.netAgentPCRequestMgr.closePCs(),this.eventManager.emit("broken",o.BrokenType.CLOSE),this.connectStart();break;case o.ConnectionClosedAction.ACTION_ABORT:case o.ConnectionClosedAction.ACTION_RESERVED:}},e.prototype.netOnLineHandler=function(){this.retryLinkHandler&&(this.zegoLink.isConnect()?this.retryLinkHandler.stopMaxTime():this.connectStart())},e.prototype.netOffLineHandler=function(){this.retryLinkHandler&&(this.retryLinkHandler.invalid(),this.retryLinkHandler.startMaxTime(),this.zegoLink.setState(o.ENUM_CONNECT_STATE.disconnect))},e.prototype.connectStart=function(e,t){this.retryLinkHandler.active(e,t)&&this.reportConnectEvent()},e.prototype.reportConnectEvent=function(){var e=this.reportSeq++;this.connectSeq=e,this.eventManager.emit("connectedEvent",e,"start")},e.prototype.disConnect=function(){this.netAgentPCRequestMgr.closePCs(),this.eventManager.emit("broken"),this.reportDisConnectEvent()},e.prototype.testConnect=function(){this.startHttpRequest({service:o.BusinessService.SERVICE_ClOUD_SETTING,headers:[],body:{appid:3349318446,biztype:0,deviceid:"27a315ae-ff78-4ded-8581-8b7b7afe6f2e",files:["init","room"],id_name:"sample1647345322471",mode:"online",param:{},product:"Web_SDK",timestamp:1647345362932,token:"eyJ2ZXIiOjEsImhhc2giOiIwOGQxMDYzMzQ0M2EzNjk1ZmE4YTg2ZDNmZGRlNGNiNyIsIm5vbmNlIjoiYWEyZDFmMDJmOGRiYjBlM2Q1YjY5NzA3NzMzOGYyODIiLCJleHBpcmVkIjoxNjQ5OTM3MzI2fQ=="},idName:"sample1647345322471",ack:!0,method_no:o.Method.METHOD_POST,location:"/cloud-setting/get"},(function(e){console.warn("suc",e)}),(function(e){console.warn("err",e)}),(function(e){console.warn("suc",e)}))},e}();t.ZegoConnectionAgent=v},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessHubProtoBuf=void 0;var c=a(n(14)),u=s(n(3)),l=n(0),h=a(n(30));u.util.Long=c.default,u.configure();var p=function(){function e(){var e;this.protoInstance=h.default,this.protoMap=((e={})[l.AccessHubMessageType.MSG_TYPE_STREAM_CLOSED]=["proto_accesshub","ConnectionClosed"],e[l.AccessHubMessageType.MSG_TYPE_CLOSE_CONNECTION]=["proto_accesshub","CloseConnection"],e[l.AccessHubMessageType.MSG_TYPE_HTTP_REQUEST]=["proto_accesshub","HTTPRequest"],e[l.AccessHubMessageType.MSG_TYPE_HTTP_RESPONSE]=["proto_accesshub","HTTPResponse"],e[l.AccessHubMessageType.MSG_TYPE_HB_REQUEST]=["proto_accesshub","HBRequest"],e[l.AccessHubMessageType.MSG_TYPE_HB_RESPONSE]=["proto_accesshub","HBResponse"],e[l.AccessHubMessageType.MSG_TYPE_GET_CONFIG_REQUEST]=["proto_accesshub","GetConfigRequest"],e[l.AccessHubMessageType.MSG_TYPE_GET_CONFIG_RESPONSE]=["proto_accesshub","GetConfigResponse"],e[l.AccessHubMessageType.MSG_TYPE_HTTP_REQUEST_ACK]=["proto_accesshub","HBResponse"],e[l.AccessHubMessageType.MSG_TYPE_PC_UPWARD_MESSAGE]=["proto_accesshub","PCUpwardMessage"],e[l.AccessHubMessageType.MSG_TYPE_PC_UPWARD_MESSAGE_ACK]=["proto_accesshub","PCUpwardMessageAck"],e[l.AccessHubMessageType.MSG_TYPE_PC_ESTABLISHED]=["proto_accesshub","PCEstablished"],e[l.AccessHubMessageType.MSG_TYPE_PC_BROKEN]=["proto_accesshub","PCBroken"],e[l.AccessHubMessageType.MSG_TYPE_PC_DOWNWARD_MESSAGE]=["proto_accesshub","PCDownwardMessage"],e[l.AccessHubMessageType.MSG_TYPE_REDIRECT]=["proto_accesshub","Redirect"],e[l.AccessHubMessageType.MSG_TYPE_GET_APPCONFIG_REQUEST]=["proto_accesshub","GetAppConfigRequest"],e[l.AccessHubMessageType.MSG_TYPE_GET_APPCONFIG_RESPONSE]=["proto_accesshub","GetAppConfigResponse"],e[l.AccessHubMessageType.MSG_TYPE_PUSH_APPCONFIG]=["proto_accesshub","PushAppConfig"],e[l.AccessHubMessageType.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST]=["proto_accesshub","AccesshubDispatchRequest"],e[l.AccessHubMessageType.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE]=["proto_accesshub","AccesshubDispatchResponse"],e[l.AccessHubMessageType.MSG_TYPE_PUSH_EXCEPTION]=["proto_accesshub","PushException"],e)}return e.prototype.encodeRequest=function(e,t,n){var r=this.protoMap[e],o=r[0],i=r[1],s=this.encode(this.protoInstance[o][i],t),a=s.length,c=new Uint8Array(13+a);return c[0]=175,c[1]=0,c[2]=e>>8,c[3]=e-(c[2]<<8),c.set(new Uint8Array(Int32Array.from([a]).buffer).reverse(),4),c.set(new Uint8Array(Int32Array.from([n]).buffer).reverse(),8),c[12]=0,c.set(s,13),c},e.prototype.decodeResponse=function(e){var t=(e[2]<<8)+e[3],n=new DataView(e.buffer).getUint32(8),r=e.slice(13);try{var o=this.protoMap[t],i=o[0],s=o[1];return[n,t,this.decode(this.protoInstance[i][s],r)]}catch(e){return[n,t,{code:1}]}},e.prototype.decodeConfigMessage=function(e){return this.decode(this.protoInstance.proto_initconfig.InitConfig,e)},e.prototype.encode=function(e,t){return e.encode(new e(t)).finish()},e.prototype.decode=function(e,t){return r({},e.decode(t))},e}();t.AccessHubProtoBuf=p},function(e,t){e.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function o(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=o;var i={},s={};function a(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=s[e])?r:(n=u(e,(0|e)<0?-1:0,!0),o&&(s[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=i[e])?r:(n=u(e,e<0?-1:0,!1),o&&(i[e]=n),n)}function c(e,t){if(isNaN(e))return t?y:m;if(t){if(e<0)return y;if(e>=d)return T}else{if(e<=-_)return S;if(e+1>=_)return O}return e<0?c(-e,t).neg():u(e%f|0,e/f|0,t)}function u(e,t,n){return new r(e,t,n)}r.fromInt=a,r.fromNumber=c,r.fromBits=u;var l=Math.pow;function h(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return m;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return h(e.substring(1),t,n).neg();for(var o=c(l(n,8)),i=m,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+a),n);if(a<8){var p=c(l(n,a));i=i.mul(p).add(c(u))}else i=(i=i.mul(o)).add(c(u))}return i.unsigned=t,i}function p(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?h(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=h,r.fromValue=p;var f=4294967296,d=f*f,_=d/2,g=a(1<<24),m=a(0);r.ZERO=m;var y=a(0,!0);r.UZERO=y;var v=a(1);r.ONE=v;var b=a(1,!0);r.UONE=b;var E=a(-1);r.NEG_ONE=E;var O=u(-1,2147483647,!1);r.MAX_VALUE=O;var T=u(-1,-1,!0);r.MAX_UNSIGNED_VALUE=T;var S=u(0,-2147483648,!1);r.MIN_VALUE=S;var R=r.prototype;R.toInt=function(){return this.unsigned?this.low>>>0:this.low},R.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},R.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=c(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=c(l(e,6),this.unsigned),i=this,s="";;){var a=i.div(o),u=(i.sub(a.mul(o)).toInt()>>>0).toString(e);if((i=a).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},R.getHighBits=function(){return this.high},R.getHighBitsUnsigned=function(){return this.high>>>0},R.getLowBits=function(){return this.low},R.getLowBitsUnsigned=function(){return this.low>>>0},R.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},R.isZero=function(){return 0===this.high&&0===this.low},R.eqz=R.isZero,R.isNegative=function(){return!this.unsigned&&this.high<0},R.isPositive=function(){return this.unsigned||this.high>=0},R.isOdd=function(){return 1==(1&this.low)},R.isEven=function(){return 0==(1&this.low)},R.equals=function(e){return o(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},R.eq=R.equals,R.notEquals=function(e){return!this.eq(e)},R.neq=R.notEquals,R.ne=R.notEquals,R.lessThan=function(e){return this.comp(e)<0},R.lt=R.lessThan,R.lessThanOrEqual=function(e){return this.comp(e)<=0},R.lte=R.lessThanOrEqual,R.le=R.lessThanOrEqual,R.greaterThan=function(e){return this.comp(e)>0},R.gt=R.greaterThan,R.greaterThanOrEqual=function(e){return this.comp(e)>=0},R.gte=R.greaterThanOrEqual,R.ge=R.greaterThanOrEqual,R.compare=function(e){if(o(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},R.comp=R.compare,R.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(v)},R.neg=R.negate,R.add=function(e){o(e)||(e=p(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,s=e.high>>>16,a=65535&e.high,c=e.low>>>16,l=0,h=0,f=0,d=0;return f+=(d+=i+(65535&e.low))>>>16,h+=(f+=r+c)>>>16,l+=(h+=n+a)>>>16,l+=t+s,u((f&=65535)<<16|(d&=65535),(l&=65535)<<16|(h&=65535),this.unsigned)},R.subtract=function(e){return o(e)||(e=p(e)),this.add(e.neg())},R.sub=R.subtract,R.multiply=function(e){if(this.isZero())return m;if(o(e)||(e=p(e)),n)return u(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return m;if(this.eq(S))return e.isOdd()?S:m;if(e.eq(S))return this.isOdd()?S:m;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return c(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,s=65535&this.low,a=e.high>>>16,l=65535&e.high,h=e.low>>>16,f=65535&e.low,d=0,_=0,y=0,v=0;return y+=(v+=s*f)>>>16,_+=(y+=i*f)>>>16,y&=65535,_+=(y+=s*h)>>>16,d+=(_+=r*f)>>>16,_&=65535,d+=(_+=i*h)>>>16,_&=65535,d+=(_+=s*l)>>>16,d+=t*f+r*h+i*l+s*a,u((y&=65535)<<16|(v&=65535),(d&=65535)<<16|(_&=65535),this.unsigned)},R.mul=R.multiply,R.divide=function(e){if(o(e)||(e=p(e)),e.isZero())throw Error("division by zero");var t,r,i;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:m;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return b;i=y}else{if(this.eq(S))return e.eq(v)||e.eq(E)?S:e.eq(S)?v:(t=this.shr(1).div(e).shl(1)).eq(m)?e.isNegative()?v:E:(r=this.sub(e.mul(t)),i=t.add(r.div(e)));if(e.eq(S))return this.unsigned?y:m;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=m}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(t)/Math.LN2),a=s<=48?1:l(2,s-48),h=c(t),f=h.mul(e);f.isNegative()||f.gt(r);)f=(h=c(t-=a,this.unsigned)).mul(e);h.isZero()&&(h=v),i=i.add(h),r=r.sub(f)}return i},R.div=R.divide,R.modulo=function(e){return o(e)||(e=p(e)),n?u((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},R.mod=R.modulo,R.rem=R.modulo,R.not=function(){return u(~this.low,~this.high,this.unsigned)},R.and=function(e){return o(e)||(e=p(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},R.or=function(e){return o(e)||(e=p(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},R.xor=function(e){return o(e)||(e=p(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},R.shiftLeft=function(e){return o(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},R.shl=R.shiftLeft,R.shiftRight=function(e){return o(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},R.shr=R.shiftRight,R.shiftRightUnsigned=function(e){if(o(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},R.shru=R.shiftRightUnsigned,R.shr_u=R.shiftRightUnsigned,R.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},R.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},R.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},R.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},R.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e,t,n){"use strict";var r=t;function o(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(6),r.BufferWriter=n(25),r.Reader=n(7),r.BufferReader=n(26),r.util=n(1),r.rpc=n(27),r.roots=n(29),r.configure=o,o()},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";e.exports=function(e,t){for(var n=new Array(arguments.length-1),r=0,o=2,i=!0;o<arguments.length;)n[r++]=arguments[o++];return new Promise((function(o,s){n[r]=function(e){if(i)if(i=!1,e)s(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];o.apply(null,t)}};try{e.apply(t||null,n)}catch(e){i&&(i=!1,s(e))}}))}},function(e,t,n){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var o=new Array(64),i=new Array(123),s=0;s<64;)i[o[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;r.encode=function(e,t,n){for(var r,i=null,s=[],a=0,c=0;t<n;){var u=e[t++];switch(c){case 0:s[a++]=o[u>>2],r=(3&u)<<4,c=1;break;case 1:s[a++]=o[r|u>>4],r=(15&u)<<2,c=2;break;case 2:s[a++]=o[r|u>>6],s[a++]=o[63&u],c=0}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=o[r],s[a++]=61,1===c&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))},r.decode=function(e,t,n){for(var r,o=n,s=0,a=0;a<e.length;){var c=e.charCodeAt(a++);if(61===c&&s>1)break;if(void 0===(c=i[c]))throw Error("invalid encoding");switch(s){case 0:r=c,s=1;break;case 1:t[n++]=r<<2|(48&c)>>4,r=c,s=2;break;case 2:t[n++]=(15&r)<<4|(60&c)>>2,r=c,s=3;break;case 3:t[n++]=(3&r)<<6|c,s=0}}if(1===s)throw Error("invalid encoding");return n-o},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,n){"use strict";function r(){this._listeners={}}e.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},function(e,t,n){"use strict";function r(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3]}function i(e,r,o){t[0]=e,r[o]=n[3],r[o+1]=n[2],r[o+2]=n[1],r[o+3]=n[0]}function s(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function a(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?o:i,e.writeFloatBE=r?i:o,e.readFloatLE=r?s:a,e.readFloatBE=r?a:s}():function(){function t(e,t,n,r){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var i=Math.floor(Math.log(t)/Math.LN2);e((o<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),o=2*(r>>31)+1,i=r>>>23&255,s=8388607&r;return 255===i?s?NaN:o*(1/0):0===i?1401298464324817e-60*o*s:o*Math.pow(2,i-150)*(s+8388608)}e.writeFloatLE=t.bind(null,o),e.writeFloatBE=t.bind(null,i),e.readFloatLE=n.bind(null,s),e.readFloatBE=n.bind(null,a)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3],r[o+4]=n[4],r[o+5]=n[5],r[o+6]=n[6],r[o+7]=n[7]}function i(e,r,o){t[0]=e,r[o]=n[7],r[o+1]=n[6],r[o+2]=n[5],r[o+3]=n[4],r[o+4]=n[3],r[o+5]=n[2],r[o+6]=n[1],r[o+7]=n[0]}function s(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function a(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?o:i,e.writeDoubleBE=r?i:o,e.readDoubleLE=r?s:a,e.readDoubleBE=r?a:s}():function(){function t(e,t,n,r,o,i){var s=r<0?1:0;if(s&&(r=-r),0===r)e(0,o,i+t),e(1/r>0?0:2147483648,o,i+n);else if(isNaN(r))e(0,o,i+t),e(2146959360,o,i+n);else if(r>17976931348623157e292)e(0,o,i+t),e((s<<31|2146435072)>>>0,o,i+n);else{var a;if(r<22250738585072014e-324)e((a=r/5e-324)>>>0,o,i+t),e((s<<31|a/4294967296)>>>0,o,i+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=r*Math.pow(2,-c))>>>0,o,i+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,o,i+n)}}}function n(e,t,n,r,o){var i=e(r,o+t),s=e(r,o+n),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+i;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,o,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=n.bind(null,s,0,4),e.readDoubleBE=n.bind(null,a,4,0)}(),e}function o(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function i(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=r(r)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,n){"use strict";var r=t;r.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},r.read=function(e,t,n){if(n-t<1)return"";for(var r,o=null,i=[],s=0;t<n;)(r=e[t++])<128?i[s++]=r:r>191&&r<224?i[s++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[s++]=55296+(r>>10),i[s++]=56320+(1023&r)):i[s++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))},r.write=function(e,t,n){for(var r,o,i=n,s=0;s<e.length;++s)(r=e.charCodeAt(s))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(o=e.charCodeAt(s+1)))?(r=65536+((1023&r)<<10)+(1023&o),++s,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-i}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=n||8192,o=r>>>1,i=null,s=r;return function(n){if(n<1||n>o)return e(n);s+n>r&&(i=e(r),s=0);var a=t.call(i,s,s+=n);return 7&s&&(s=1+(7|s)),a}}},function(e,t,n){"use strict";e.exports=o;var r=n(1);function o(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=o.zero=new o(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var s=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new o(n,r)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if(r.isString(e)){if(!r.Long)return o.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):i},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;o.fromHash=function(e){return e===s?i:new o((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},o.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},o.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){"use strict";e.exports=i;var r=n(6);(i.prototype=Object.create(r.prototype)).constructor=i;var o=n(1);function i(){r.call(this)}function s(e,t,n){e.length<40?o.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}i._configure=function(){i.alloc=o._Buffer_allocUnsafe,i.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},i.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=o.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},i._configure()},function(e,t,n){"use strict";e.exports=i;var r=n(7);(i.prototype=Object.create(r.prototype)).constructor=i;var o=n(1);function i(e){r.call(this,e)}i._configure=function(){o.Buffer&&(i.prototype._slice=o.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},function(e,t,n){"use strict";t.Service=n(28)},function(e,t,n){"use strict";e.exports=o;var r=n(1);function o(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(o.prototype=Object.create(r.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(t,n,o,i,s){if(!i)throw TypeError("request must be specified");var a=this;if(!s)return r.asPromise(e,a,t,n,o,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return a.emit("error",e,t),s(e);if(null!==n){if(!(n instanceof o))try{n=o[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",n,t),s(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";n.r(t),n.d(t,"proto_accesshub",(function(){return c})),n.d(t,"proto_initconfig",(function(){return u})),n.d(t,"default",(function(){return a}));var r=n(3);const o=r.Reader,i=r.Writer,s=r.util,a=r.roots.default||(r.roots.default={}),c=a.proto_accesshub=(()=>{const e={};return e.MessageType=function(){const e={},t=Object.create(e);return t[e[0]="MSG_TYPE_EMPTY"]=0,t[e[1]="MSG_TYPE_CONNECTION_CLOSED"]=1,t[e[2]="MSG_TYPE_STREAM_CLOSED"]=2,t[e[3]="MSG_TYPE_CLOSE_CONNECTION"]=3,t[e[4]="MSG_TYPE_HTTP_REQUEST"]=4,t[e[5]="MSG_TYPE_HTTP_RESPONSE"]=5,t[e[6]="MSG_TYPE_HTTP_REQUEST_DROPED"]=6,t[e[7]="MSG_TYPE_PROXY_CONNECT"]=7,t[e[8]="MSG_TYPE_PROXY_CONNECTED"]=8,t[e[9]="MSG_TYPE_PROXY_CONNECTION_CLOSED"]=9,t[e[10]="MSG_TYPE_PROXY_SEND_DATA"]=10,t[e[11]="MSG_TYPE_PROXY_RECV_DATA"]=11,t[e[12]="MSG_TYPE_HB_REQUEST"]=12,t[e[13]="MSG_TYPE_HB_RESPONSE"]=13,t[e[14]="MSG_TYPE_GET_CONFIG_REQUEST"]=14,t[e[15]="MSG_TYPE_GET_CONFIG_RESPONSE"]=15,t[e[16]="MSG_TYPE_HTTP_REQUEST_ACK"]=16,t[e[17]="MSG_TYPE_PC_UPWARD_MESSAGE"]=17,t[e[18]="MSG_TYPE_PC_UPWARD_MESSAGE_ACK"]=18,t[e[19]="MSG_TYPE_PC_ESTABLISHED"]=19,t[e[20]="MSG_TYPE_PC_BROKEN"]=20,t[e[21]="MSG_TYPE_PC_DOWNWARD_MESSAGE"]=21,t[e[22]="MSG_TYPE_REDIRECT"]=22,t[e[23]="MSG_TYPE_GET_APPCONFIG_REQUEST"]=23,t[e[24]="MSG_TYPE_GET_APPCONFIG_RESPONSE"]=24,t[e[25]="MSG_TYPE_PUSH_APPCONFIG"]=25,t[e[26]="MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST"]=26,t[e[27]="MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE"]=27,t[e[28]="MSG_TYPE_GET_IM_CONFIG_REQUEST"]=28,t[e[29]="MSG_TYPE_GET_IM_CONFIG_RESPONSE"]=29,t[e[30]="MSG_TYPE_PUSH_EXCEPTION"]=30,t[e[50]="MSG_TYPE_UA_DISPATCH_REQUEST"]=50,t[e[51]="MSG_TYPE_UA_DISPATCH_RESPONSE"]=51,t[e[52]="MSG_TYPE_UA_ECHO_REQUEST"]=52,t[e[53]="MSG_TYPE_UA_ECHO_RESPONSE"]=53,t[e[100]="MSG_TYPE_NODE_REGISTER_REQUEST"]=100,t[e[101]="MSG_TYPE_NODE_REGISTER_RESPONSE"]=101,t[e[102]="MSG_TYPE_NODE_HB_REQUEST"]=102,t[e[103]="MSG_TYPE_NODE_HB_RESPONSE"]=103,t}(),e.ErrorCode=function(){const e={},t=Object.create(e);return t[e[0]="OK"]=0,t[e[1e4]="DISPATCH_NO_AVAILABLE_NODE"]=1e4,t[e[10001]="DISPATCH_INTERNAL_ERROR"]=10001,t[e[10002]="DISPATCH_INVALID_FRAME"]=10002,t[e[10003]="DISPATCH_UNMARSHAL"]=10003,t[e[10004]="DISPATCH_MSGTYPE"]=10004,t[e[10005]="DISPATCH_MARSHAL"]=10005,t[e[10006]="DISPATCH_TOO_FREQUENTLY"]=10006,t[e[2e4]="ACCESSHUB_INVALID_FRAME"]=2e4,t[e[20001]="ACCESSHUB_NEED_ENCRYPT"]=20001,t[e[20002]="ACCESSHUB_DECRYPT"]=20002,t[e[20003]="ACCESSHUB_MSGTYPE"]=20003,t[e[20004]="ACCESSHUB_UNMARSHAL"]=20004,t[e[20005]="ACCESSHUB_TIMEOUT"]=20005,t[e[20006]="ACCESSHUB_CONNECT"]=20006,t[e[20007]="ACCESSHUB_BROKEN"]=20007,t[e[20008]="ACCESSHUB_INTERNAL_ERROR"]=20008,t[e[20009]="ACCESSHUB_MARSHAL"]=20009,t[e[20010]="ACCESSHUB_UNSUPPORTED_SERVICE"]=20010,t[e[20011]="ACCESSHUB_TOO_FREQUENTLY"]=20011,t[e[20012]="ACCESSHUB_INVALID_APPID"]=20012,t[e[20013]="ACCESSHUB_HB_TIMEOUT"]=20013,t[e[20014]="ACCESSHUB_INVALID_SIGNATURE"]=20014,t[e[20015]="ACCESSHUB_AUTH_FAILED"]=20015,t[e[3e4]="ACCESSHUB_GET_STREAM_FAILED"]=3e4,t[e[30001]="ACCESSHUB_GET_CONN_FAILED"]=30001,t[e[30002]="ACCESSHUB_DO_HTTP_REQUEST_FAILED"]=30002,t[e[30003]="ACCESSHUB_UNMARSHAL_HB_FAILED"]=30003,t[e[30004]="ACCESSHUB_DO_BACKEND_DISPATCH_FAILED"]=30004,t}(),e.Mode=function(){const e={},t=Object.create(e);return t[e[0]="Mode_UNSET"]=0,t[e[1]="MODE_ONLINE"]=1,t[e[2]="MODE_TEST"]=2,t[e[3]="MODE_ALPHA"]=3,t}(),e.Service=function(){const e={},t=Object.create(e);return t[e[0]="SERVICE_UNSET"]=0,t[e[1]="SERVICE_MEDIAGW"]=1,t[e[2]="SERVICE_LIVEROOM"]=2,t[e[3]="SERVICE_MIX"]=3,t[e[4]="SERVICE_ZEUS"]=4,t[e[5]="SERVICE_ZPUSH"]=5,t[e[6]="SERVICE_L3"]=6,t[e[7]="SERVICE_TALKLINE"]=7,t[e[8]="SERVICE_EDUSUITE"]=8,t[e[9]="SERVICE_ZIM"]=9,t[e[10]="SERVICE_ClOUD_SETTING"]=10,t[e[11]="SERVICE_ZEUSHB"]=11,t[e[12]="SERVICE_USER_LOGIC"]=12,t[e[13]="SERVICE_UNIFYDISPATCH"]=13,t[e[14]="SERVICE_QUALITY"]=14,t[e[15]="SERVICE_SECURITY"]=15,t[e[16]="SERVICE_KTVCPR"]=16,t[e[17]="SERVICE_SWITCH4LIVEROOM"]=17,t[e[18]="SERVICE_WEBRTC_SIGNAL"]=18,t[e[19]="SERVICE_L3_WEBRTC_SIGNAL"]=19,t[e[20]="SERVICE_VIDEOCPR"]=20,t[e[21]="SERVICE_CDN"]=21,t[e[22]="SERVICE_CLOUDRECORD"]=22,t[e[23]="SERVICE_INNER_ECHO"]=23,t[e[24]="SERVICE_OUTER_ECHO"]=24,t[e[25]="SERVICE_LOCALHOST_ECHO"]=25,t[e[26]="SERVICE_ECHO"]=26,t[e[27]="SERVICE_DOCSERVICE"]=27,t[e[28]="SERVICE_AUTHSVR"]=28,t}(),e.Method=function(){const e={},t=Object.create(e);return t[e[0]="METHOD_UNSET"]=0,t[e[1]="METHOD_GET"]=1,t[e[2]="METHOD_POST"]=2,t}(),e.SdkType=function(){const e={},t=Object.create(e);return t[e[0]="SDK_TYPE_UNSET"]=0,t[e[1]="SDK_TYPE_QUIC_MTCP_NATIVE"]=1,t[e[2]="SDK_TYPE_WSS_NATIVE"]=2,t[e[3]="SDK_TYPE_WSS_WEB"]=3,t}(),e.ZegoconnRunEnv=function(){const e={},t=Object.create(e);return t[e[0]="ZEGOCONN_RUN_ENV_UNSET"]=0,t[e[1]="ZEGOCONN_RUN_ENV_BROWSER"]=1,t[e[2]="ZEGOCONN_RUN_ENV_APPLET"]=2,t}(),e.ConnectionClosed=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.msg="",e.encode=function(e,t){return t||(t=i.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(18).string(e.msg),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.ConnectionClosed;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.code=e.int32();break;case 2:r.msg=e.string();break;default:e.skipType(7&t)}}return r},e}(),e.StreamClosed=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.msg="",e.encode=function(e,t){return t||(t=i.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(18).string(e.msg),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.StreamClosed;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.code=e.int32();break;case 2:r.msg=e.string();break;default:e.skipType(7&t)}}return r},e}(),e.CloseConnection=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.reason=0,e.prototype.msg="",e.prototype.action=0,e.encode=function(e,t){return t||(t=i.create()),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(8).int32(e.reason),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(18).string(e.msg),null!=e.action&&Object.hasOwnProperty.call(e,"action")&&t.uint32(24).int32(e.action),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.CloseConnection;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.reason=e.int32();break;case 2:r.msg=e.string();break;case 3:r.action=e.int32();break;default:e.skipType(7&t)}}return r},e.Action=function(){const e={},t=Object.create(e);return t[e[0]="ACTION_RESERVED"]=0,t[e[1]="ACTION_DISPATCH"]=1,t[e[2]="ACTION_RETRY"]=2,t[e[3]="ACTION_NEXT_NODE"]=3,t[e[4]="ACTION_ABORT"]=4,t[e[5]="ACTION_NEXT_GROUP"]=5,t}(),e}(),e.HTTPRequest=function(){function e(e){if(this.headers=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.appid=0,e.prototype.biz_type=0,e.prototype.mode="",e.prototype.id_name="",e.prototype.reqid="",e.prototype.stick="",e.prototype.service="",e.prototype.location="",e.prototype.method="",e.prototype.headers=s.emptyArray,e.prototype.body=s.newBuffer([]),e.prototype.ack=!1,e.prototype.mode_no=0,e.prototype.service_no=0,e.prototype.method_no=0,e.prototype.sdk_type=0,e.prototype.zegoconn_run_env=0,e.prototype.zegoconn_version=0,e.encode=function(e,t){if(t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(16).uint32(e.appid),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(24).uint32(e.biz_type),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(34).string(e.mode),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(42).string(e.id_name),null!=e.reqid&&Object.hasOwnProperty.call(e,"reqid")&&t.uint32(50).string(e.reqid),null!=e.stick&&Object.hasOwnProperty.call(e,"stick")&&t.uint32(58).string(e.stick),null!=e.service&&Object.hasOwnProperty.call(e,"service")&&t.uint32(66).string(e.service),null!=e.location&&Object.hasOwnProperty.call(e,"location")&&t.uint32(74).string(e.location),null!=e.method&&Object.hasOwnProperty.call(e,"method")&&t.uint32(82).string(e.method),null!=e.headers&&e.headers.length)for(let n=0;n<e.headers.length;++n)a.proto_accesshub.HTTPRequest.HTTPHeader.encode(e.headers[n],t.uint32(90).fork()).ldelim();return null!=e.body&&Object.hasOwnProperty.call(e,"body")&&t.uint32(98).bytes(e.body),null!=e.ack&&Object.hasOwnProperty.call(e,"ack")&&t.uint32(104).bool(e.ack),null!=e.mode_no&&Object.hasOwnProperty.call(e,"mode_no")&&t.uint32(112).int32(e.mode_no),null!=e.service_no&&Object.hasOwnProperty.call(e,"service_no")&&t.uint32(120).int32(e.service_no),null!=e.method_no&&Object.hasOwnProperty.call(e,"method_no")&&t.uint32(128).int32(e.method_no),null!=e.sdk_type&&Object.hasOwnProperty.call(e,"sdk_type")&&t.uint32(136).int32(e.sdk_type),null!=e.zegoconn_run_env&&Object.hasOwnProperty.call(e,"zegoconn_run_env")&&t.uint32(144).int32(e.zegoconn_run_env),null!=e.zegoconn_version&&Object.hasOwnProperty.call(e,"zegoconn_version")&&t.uint32(152).uint32(e.zegoconn_version),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.HTTPRequest;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.appid=e.uint32();break;case 3:r.biz_type=e.uint32();break;case 4:r.mode=e.string();break;case 5:r.id_name=e.string();break;case 6:r.reqid=e.string();break;case 7:r.stick=e.string();break;case 8:r.service=e.string();break;case 9:r.location=e.string();break;case 10:r.method=e.string();break;case 11:r.headers&&r.headers.length||(r.headers=[]),r.headers.push(a.proto_accesshub.HTTPRequest.HTTPHeader.decode(e,e.uint32()));break;case 12:r.body=e.bytes();break;case 13:r.ack=e.bool();break;case 14:r.mode_no=e.int32();break;case 15:r.service_no=e.int32();break;case 16:r.method_no=e.int32();break;case 17:r.sdk_type=e.int32();break;case 18:r.zegoconn_run_env=e.int32();break;case 19:r.zegoconn_version=e.uint32();break;default:e.skipType(7&t)}}return r},e.HTTPHeader=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.name="",e.prototype.val="",e.encode=function(e,t){return t||(t=i.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.val&&Object.hasOwnProperty.call(e,"val")&&t.uint32(18).string(e.val),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.HTTPRequest.HTTPHeader;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.name=e.string();break;case 2:r.val=e.string();break;default:e.skipType(7&t)}}return r},e}(),e}(),e.HTTPResponse=function(){function e(e){if(this.headers=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.headers=s.emptyArray,e.prototype.status_code=0,e.prototype.body=s.newBuffer([]),e.encode=function(e,t){if(t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.headers&&e.headers.length)for(let n=0;n<e.headers.length;++n)a.proto_accesshub.HTTPRequest.HTTPHeader.encode(e.headers[n],t.uint32(18).fork()).ldelim();return null!=e.status_code&&Object.hasOwnProperty.call(e,"status_code")&&t.uint32(24).int32(e.status_code),null!=e.body&&Object.hasOwnProperty.call(e,"body")&&t.uint32(34).bytes(e.body),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.HTTPResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.headers&&r.headers.length||(r.headers=[]),r.headers.push(a.proto_accesshub.HTTPRequest.HTTPHeader.decode(e,e.uint32()));break;case 3:r.status_code=e.int32();break;case 4:r.body=e.bytes();break;default:e.skipType(7&t)}}return r},e}(),e.HTTPRequestAck=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.HTTPRequestAck;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;default:e.skipType(7&t)}}return r},e}(),e.HTTPRequestDroped=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.reason=0,e.prototype.msg="",e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(16).int32(e.reason),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(26).string(e.msg),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.HTTPRequestDroped;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.reason=e.int32();break;case 3:r.msg=e.string();break;default:e.skipType(7&t)}}return r},e}(),e.HBRequest=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.ts=s.Long?s.Long.fromBits(0,0,!1):0,e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(16).int64(e.ts),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.HBRequest;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.ts=e.int64();break;default:e.skipType(7&t)}}return r},e}(),e.HBResponse=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.ts=s.Long?s.Long.fromBits(0,0,!1):0,e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(16).int64(e.ts),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.HBResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.ts=e.int64();break;default:e.skipType(7&t)}}return r},e}(),e.GetConfigRequest=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.appid=0,e.prototype.biz_type=0,e.prototype.mode="",e.prototype.id_name="",e.prototype.reqid="",e.prototype.zegoconn_version=0,e.prototype.sdk_type=0,e.prototype.zegoconn_run_env=0,e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(16).uint32(e.appid),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(24).uint32(e.biz_type),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(34).string(e.mode),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(42).string(e.id_name),null!=e.reqid&&Object.hasOwnProperty.call(e,"reqid")&&t.uint32(50).string(e.reqid),null!=e.zegoconn_version&&Object.hasOwnProperty.call(e,"zegoconn_version")&&t.uint32(56).uint32(e.zegoconn_version),null!=e.sdk_type&&Object.hasOwnProperty.call(e,"sdk_type")&&t.uint32(64).int32(e.sdk_type),null!=e.zegoconn_run_env&&Object.hasOwnProperty.call(e,"zegoconn_run_env")&&t.uint32(72).int32(e.zegoconn_run_env),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.GetConfigRequest;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.appid=e.uint32();break;case 3:r.biz_type=e.uint32();break;case 4:r.mode=e.string();break;case 5:r.id_name=e.string();break;case 6:r.reqid=e.string();break;case 7:r.zegoconn_version=e.uint32();break;case 8:r.sdk_type=e.int32();break;case 9:r.zegoconn_run_env=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.GetConfigResponseData=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.quic_hb_interval=0,e.prototype.quic_hb_timeout=0,e.prototype.logic_hb_interval=0,e.prototype.logic_hb_timeout=0,e.prototype.pc_establish_timeout=0,e.prototype.sdk_link_detect_interval=0,e.prototype.sdk_link_detect_duration=0,e.prototype.client_outer_ip="",e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.quic_hb_interval&&Object.hasOwnProperty.call(e,"quic_hb_interval")&&t.uint32(16).uint32(e.quic_hb_interval),null!=e.quic_hb_timeout&&Object.hasOwnProperty.call(e,"quic_hb_timeout")&&t.uint32(24).uint32(e.quic_hb_timeout),null!=e.logic_hb_interval&&Object.hasOwnProperty.call(e,"logic_hb_interval")&&t.uint32(32).uint32(e.logic_hb_interval),null!=e.logic_hb_timeout&&Object.hasOwnProperty.call(e,"logic_hb_timeout")&&t.uint32(40).uint32(e.logic_hb_timeout),null!=e.pc_establish_timeout&&Object.hasOwnProperty.call(e,"pc_establish_timeout")&&t.uint32(48).uint32(e.pc_establish_timeout),null!=e.sdk_link_detect_interval&&Object.hasOwnProperty.call(e,"sdk_link_detect_interval")&&t.uint32(56).uint32(e.sdk_link_detect_interval),null!=e.sdk_link_detect_duration&&Object.hasOwnProperty.call(e,"sdk_link_detect_duration")&&t.uint32(64).uint32(e.sdk_link_detect_duration),null!=e.client_outer_ip&&Object.hasOwnProperty.call(e,"client_outer_ip")&&t.uint32(74).string(e.client_outer_ip),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.GetConfigResponseData;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.quic_hb_interval=e.uint32();break;case 3:r.quic_hb_timeout=e.uint32();break;case 4:r.logic_hb_interval=e.uint32();break;case 5:r.logic_hb_timeout=e.uint32();break;case 6:r.pc_establish_timeout=e.uint32();break;case 7:r.sdk_link_detect_interval=e.uint32();break;case 8:r.sdk_link_detect_duration=e.uint32();break;case 9:r.client_outer_ip=e.string();break;default:e.skipType(7&t)}}return r},e}(),e.GetConfigResponse=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.message="",e.prototype.data=null,e.encode=function(e,t){return t||(t=i.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&a.proto_accesshub.GetConfigResponseData.encode(e.data,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.GetConfigResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.code=e.int32();break;case 2:r.message=e.string();break;case 3:r.data=a.proto_accesshub.GetConfigResponseData.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e}(),e.PCUpwardMessage=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.appid=0,e.prototype.biz_type=0,e.prototype.mode_no=0,e.prototype.id_name="",e.prototype.service_no=0,e.prototype.ack=!1,e.prototype.payload=s.newBuffer([]),e.prototype.sdk_type=0,e.prototype.wss_message_type=0,e.prototype.wss_path="",e.prototype.wss_raw_query="",e.prototype.zegoconn_version=0,e.prototype.zegoconn_run_env=0,e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(16).uint32(e.appid),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(24).uint32(e.biz_type),null!=e.mode_no&&Object.hasOwnProperty.call(e,"mode_no")&&t.uint32(32).int32(e.mode_no),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(42).string(e.id_name),null!=e.service_no&&Object.hasOwnProperty.call(e,"service_no")&&t.uint32(48).int32(e.service_no),null!=e.ack&&Object.hasOwnProperty.call(e,"ack")&&t.uint32(56).bool(e.ack),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(66).bytes(e.payload),null!=e.sdk_type&&Object.hasOwnProperty.call(e,"sdk_type")&&t.uint32(72).int32(e.sdk_type),null!=e.wss_message_type&&Object.hasOwnProperty.call(e,"wss_message_type")&&t.uint32(80).uint32(e.wss_message_type),null!=e.wss_path&&Object.hasOwnProperty.call(e,"wss_path")&&t.uint32(90).string(e.wss_path),null!=e.wss_raw_query&&Object.hasOwnProperty.call(e,"wss_raw_query")&&t.uint32(98).string(e.wss_raw_query),null!=e.zegoconn_version&&Object.hasOwnProperty.call(e,"zegoconn_version")&&t.uint32(104).uint32(e.zegoconn_version),null!=e.zegoconn_run_env&&Object.hasOwnProperty.call(e,"zegoconn_run_env")&&t.uint32(112).int32(e.zegoconn_run_env),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.PCUpwardMessage;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.appid=e.uint32();break;case 3:r.biz_type=e.uint32();break;case 4:r.mode_no=e.int32();break;case 5:r.id_name=e.string();break;case 6:r.service_no=e.int32();break;case 7:r.ack=e.bool();break;case 8:r.payload=e.bytes();break;case 9:r.sdk_type=e.int32();break;case 10:r.wss_message_type=e.uint32();break;case 11:r.wss_path=e.string();break;case 12:r.wss_raw_query=e.string();break;case 13:r.zegoconn_version=e.uint32();break;case 14:r.zegoconn_run_env=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.PCUpwardMessageAck=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.PCUpwardMessageAck;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;default:e.skipType(7&t)}}return r},e}(),e.PCEstablished=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.elapse=0,e.prototype.from=0,e.encode=function(e,t){return t||(t=i.create()),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(8).uint32(e.elapse),null!=e.from&&Object.hasOwnProperty.call(e,"from")&&t.uint32(16).uint32(e.from),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.PCEstablished;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.elapse=e.uint32();break;case 2:r.from=e.uint32();break;default:e.skipType(7&t)}}return r},e}(),e.PCBroken=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.encode=function(e,t){return t||(t=i.create()),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.PCBroken;for(;e.pos<n;){let t=e.uint32();e.skipType(7&t)}return r},e}(),e.PCDownwardMessage=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.payload=s.newBuffer([]),e.prototype.wss_message_type=0,e.encode=function(e,t){return t||(t=i.create()),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(10).bytes(e.payload),null!=e.wss_message_type&&Object.hasOwnProperty.call(e,"wss_message_type")&&t.uint32(16).uint32(e.wss_message_type),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.PCDownwardMessage;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.payload=e.bytes();break;case 2:r.wss_message_type=e.uint32();break;default:e.skipType(7&t)}}return r},e}(),e.Redirect=function(){function e(e){if(this.groups=[],this.opt_ports=[],this.wss_groups=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.rand="",e.prototype.secret="",e.prototype.groups=s.emptyArray,e.prototype.opt_ports=s.emptyArray,e.prototype.wss_groups=s.emptyArray,e.encode=function(e,t){if(t||(t=i.create()),null!=e.rand&&Object.hasOwnProperty.call(e,"rand")&&t.uint32(10).string(e.rand),null!=e.secret&&Object.hasOwnProperty.call(e,"secret")&&t.uint32(18).string(e.secret),null!=e.groups&&e.groups.length)for(let n=0;n<e.groups.length;++n)a.proto_accesshub.AccesshubDispatchGroup.encode(e.groups[n],t.uint32(26).fork()).ldelim();if(null!=e.opt_ports&&e.opt_ports.length)for(let n=0;n<e.opt_ports.length;++n)t.uint32(32).uint32(e.opt_ports[n]);if(null!=e.wss_groups&&e.wss_groups.length)for(let n=0;n<e.wss_groups.length;++n)a.proto_accesshub.WssAccesshubDispatchGroup.encode(e.wss_groups[n],t.uint32(42).fork()).ldelim();return t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.Redirect;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.rand=e.string();break;case 2:r.secret=e.string();break;case 3:r.groups&&r.groups.length||(r.groups=[]),r.groups.push(a.proto_accesshub.AccesshubDispatchGroup.decode(e,e.uint32()));break;case 4:if(r.opt_ports&&r.opt_ports.length||(r.opt_ports=[]),2==(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)r.opt_ports.push(e.uint32())}else r.opt_ports.push(e.uint32());break;case 5:r.wss_groups&&r.wss_groups.length||(r.wss_groups=[]),r.wss_groups.push(a.proto_accesshub.WssAccesshubDispatchGroup.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return r},e}(),e.GetAppConfigRequest=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.appid=0,e.prototype.biz_type=0,e.prototype.mode_no=0,e.prototype.id_name="",e.prototype.config_key="",e.prototype.ts=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.signature=s.newBuffer([]),e.prototype.lite_sign="",e.prototype.token="",e.prototype.sdk_type=0,e.prototype.zegoconn_version=0,e.prototype.zegoconn_run_env=0,e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(16).uint32(e.appid),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(24).uint32(e.biz_type),null!=e.mode_no&&Object.hasOwnProperty.call(e,"mode_no")&&t.uint32(32).int32(e.mode_no),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(42).string(e.id_name),null!=e.config_key&&Object.hasOwnProperty.call(e,"config_key")&&t.uint32(50).string(e.config_key),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(56).uint64(e.ts),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(66).bytes(e.signature),null!=e.lite_sign&&Object.hasOwnProperty.call(e,"lite_sign")&&t.uint32(74).string(e.lite_sign),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(82).string(e.token),null!=e.sdk_type&&Object.hasOwnProperty.call(e,"sdk_type")&&t.uint32(88).int32(e.sdk_type),null!=e.zegoconn_version&&Object.hasOwnProperty.call(e,"zegoconn_version")&&t.uint32(96).uint32(e.zegoconn_version),null!=e.zegoconn_run_env&&Object.hasOwnProperty.call(e,"zegoconn_run_env")&&t.uint32(104).int32(e.zegoconn_run_env),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.GetAppConfigRequest;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.appid=e.uint32();break;case 3:r.biz_type=e.uint32();break;case 4:r.mode_no=e.int32();break;case 5:r.id_name=e.string();break;case 6:r.config_key=e.string();break;case 7:r.ts=e.uint64();break;case 8:r.signature=e.bytes();break;case 9:r.lite_sign=e.string();break;case 10:r.token=e.string();break;case 11:r.sdk_type=e.int32();break;case 12:r.zegoconn_version=e.uint32();break;case 13:r.zegoconn_run_env=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.GetAppConfigResponseData=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.data=s.newBuffer([]),e.prototype.ts=s.Long?s.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(24).uint64(e.ts),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.GetAppConfigResponseData;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.data=e.bytes();break;case 3:r.ts=e.uint64();break;default:e.skipType(7&t)}}return r},e}(),e.GetAppConfigResponse=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.message="",e.prototype.data=null,e.encode=function(e,t){return t||(t=i.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&a.proto_accesshub.GetAppConfigResponseData.encode(e.data,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.GetAppConfigResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.code=e.int32();break;case 2:r.message=e.string();break;case 3:r.data=a.proto_accesshub.GetAppConfigResponseData.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e}(),e.PushAppConfig=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.config_key="",e.prototype.data=s.newBuffer([]),e.encode=function(e,t){return t||(t=i.create()),null!=e.config_key&&Object.hasOwnProperty.call(e,"config_key")&&t.uint32(10).string(e.config_key),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.PushAppConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.config_key=e.string();break;case 2:r.data=e.bytes();break;default:e.skipType(7&t)}}return r},e}(),e.AccesshubDispatchRequest=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.appid=0,e.prototype.biz_type=0,e.prototype.mode_no=0,e.prototype.id_name="",e.prototype.sdk_type=0,e.prototype.zegoconn_version=0,e.prototype.zegoconn_run_env=0,e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(16).uint32(e.appid),null!=e.biz_type&&Object.hasOwnProperty.call(e,"biz_type")&&t.uint32(24).uint32(e.biz_type),null!=e.mode_no&&Object.hasOwnProperty.call(e,"mode_no")&&t.uint32(32).int32(e.mode_no),null!=e.id_name&&Object.hasOwnProperty.call(e,"id_name")&&t.uint32(42).string(e.id_name),null!=e.sdk_type&&Object.hasOwnProperty.call(e,"sdk_type")&&t.uint32(48).int32(e.sdk_type),null!=e.zegoconn_version&&Object.hasOwnProperty.call(e,"zegoconn_version")&&t.uint32(56).uint32(e.zegoconn_version),null!=e.zegoconn_run_env&&Object.hasOwnProperty.call(e,"zegoconn_run_env")&&t.uint32(64).int32(e.zegoconn_run_env),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.AccesshubDispatchRequest;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.appid=e.uint32();break;case 3:r.biz_type=e.uint32();break;case 4:r.mode_no=e.int32();break;case 5:r.id_name=e.string();break;case 6:r.sdk_type=e.int32();break;case 7:r.zegoconn_version=e.uint32();break;case 8:r.zegoconn_run_env=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.AccesshubDispatchGroup=function(){function e(e){if(this.quic_nodes=[],this.mtcp_nodes=[],this.wss_nodes=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.group="",e.prototype.quic_nodes=s.emptyArray,e.prototype.mtcp_nodes=s.emptyArray,e.prototype.wss_nodes=s.emptyArray,e.encode=function(e,t){if(t||(t=i.create()),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(10).string(e.group),null!=e.quic_nodes&&e.quic_nodes.length)for(let n=0;n<e.quic_nodes.length;++n)t.uint32(18).string(e.quic_nodes[n]);if(null!=e.mtcp_nodes&&e.mtcp_nodes.length)for(let n=0;n<e.mtcp_nodes.length;++n)t.uint32(26).string(e.mtcp_nodes[n]);if(null!=e.wss_nodes&&e.wss_nodes.length)for(let n=0;n<e.wss_nodes.length;++n)t.uint32(34).string(e.wss_nodes[n]);return t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.AccesshubDispatchGroup;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.group=e.string();break;case 2:r.quic_nodes&&r.quic_nodes.length||(r.quic_nodes=[]),r.quic_nodes.push(e.string());break;case 3:r.mtcp_nodes&&r.mtcp_nodes.length||(r.mtcp_nodes=[]),r.mtcp_nodes.push(e.string());break;case 4:r.wss_nodes&&r.wss_nodes.length||(r.wss_nodes=[]),r.wss_nodes.push(e.string());break;default:e.skipType(7&t)}}return r},e}(),e.WssAccesshubDispatchGroup=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.group="",e.prototype.host="",e.encode=function(e,t){return t||(t=i.create()),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(10).string(e.group),null!=e.host&&Object.hasOwnProperty.call(e,"host")&&t.uint32(18).string(e.host),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.WssAccesshubDispatchGroup;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.group=e.string();break;case 2:r.host=e.string();break;default:e.skipType(7&t)}}return r},e}(),e.AccesshubDispatchResponseData=function(){function e(e){if(this.groups=[],this.opt_ports=[],this.wss_groups=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.rand="",e.prototype.secret="",e.prototype.groups=s.emptyArray,e.prototype.opt_ports=s.emptyArray,e.prototype.wss_groups=s.emptyArray,e.encode=function(e,t){if(t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.rand&&Object.hasOwnProperty.call(e,"rand")&&t.uint32(18).string(e.rand),null!=e.secret&&Object.hasOwnProperty.call(e,"secret")&&t.uint32(26).string(e.secret),null!=e.groups&&e.groups.length)for(let n=0;n<e.groups.length;++n)a.proto_accesshub.AccesshubDispatchGroup.encode(e.groups[n],t.uint32(34).fork()).ldelim();if(null!=e.opt_ports&&e.opt_ports.length)for(let n=0;n<e.opt_ports.length;++n)t.uint32(40).uint32(e.opt_ports[n]);if(null!=e.wss_groups&&e.wss_groups.length)for(let n=0;n<e.wss_groups.length;++n)a.proto_accesshub.WssAccesshubDispatchGroup.encode(e.wss_groups[n],t.uint32(50).fork()).ldelim();return t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.AccesshubDispatchResponseData;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.rand=e.string();break;case 3:r.secret=e.string();break;case 4:r.groups&&r.groups.length||(r.groups=[]),r.groups.push(a.proto_accesshub.AccesshubDispatchGroup.decode(e,e.uint32()));break;case 5:if(r.opt_ports&&r.opt_ports.length||(r.opt_ports=[]),2==(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)r.opt_ports.push(e.uint32())}else r.opt_ports.push(e.uint32());break;case 6:r.wss_groups&&r.wss_groups.length||(r.wss_groups=[]),r.wss_groups.push(a.proto_accesshub.WssAccesshubDispatchGroup.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return r},e}(),e.AccesshubDispatchResponse=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.message="",e.prototype.data=null,e.encode=function(e,t){return t||(t=i.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&a.proto_accesshub.AccesshubDispatchResponseData.encode(e.data,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.AccesshubDispatchResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.code=e.int32();break;case 2:r.message=e.string();break;case 3:r.data=a.proto_accesshub.AccesshubDispatchResponseData.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e}(),e.GetIMConfigRequest=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.appid=0,e.prototype.mode_no=0,e.prototype.user_id="",e.prototype.config_key="",e.prototype.token="",e.prototype.lite_sign="",e.prototype.sdk_type=0,e.prototype.zegoconn_version=0,e.prototype.zegoconn_run_env=0,e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.appid&&Object.hasOwnProperty.call(e,"appid")&&t.uint32(16).uint32(e.appid),null!=e.mode_no&&Object.hasOwnProperty.call(e,"mode_no")&&t.uint32(24).int32(e.mode_no),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(34).string(e.user_id),null!=e.config_key&&Object.hasOwnProperty.call(e,"config_key")&&t.uint32(42).string(e.config_key),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(50).string(e.token),null!=e.lite_sign&&Object.hasOwnProperty.call(e,"lite_sign")&&t.uint32(58).string(e.lite_sign),null!=e.sdk_type&&Object.hasOwnProperty.call(e,"sdk_type")&&t.uint32(64).int32(e.sdk_type),null!=e.zegoconn_version&&Object.hasOwnProperty.call(e,"zegoconn_version")&&t.uint32(72).uint32(e.zegoconn_version),null!=e.zegoconn_run_env&&Object.hasOwnProperty.call(e,"zegoconn_run_env")&&t.uint32(80).int32(e.zegoconn_run_env),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.GetIMConfigRequest;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.appid=e.uint32();break;case 3:r.mode_no=e.int32();break;case 4:r.user_id=e.string();break;case 5:r.config_key=e.string();break;case 6:r.token=e.string();break;case 7:r.lite_sign=e.string();break;case 8:r.sdk_type=e.int32();break;case 9:r.zegoconn_version=e.uint32();break;case 10:r.zegoconn_run_env=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.GetIMConfigResponseData=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.prototype.data=s.newBuffer([]),e.encode=function(e,t){return t||(t=i.create()),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(8).uint64(e.txid),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.GetIMConfigResponseData;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.txid=e.uint64();break;case 2:r.data=e.bytes();break;default:e.skipType(7&t)}}return r},e}(),e.GetIMConfigResponse=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.prototype.message="",e.prototype.data=null,e.encode=function(e,t){return t||(t=i.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&a.proto_accesshub.GetIMConfigResponseData.encode(e.data,t.uint32(26).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.GetIMConfigResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.code=e.int32();break;case 2:r.message=e.string();break;case 3:r.data=a.proto_accesshub.GetIMConfigResponseData.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e}(),e.PushException=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.reason=0,e.prototype.msg="",e.prototype.txid=s.Long?s.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=i.create()),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(8).int32(e.reason),null!=e.msg&&Object.hasOwnProperty.call(e,"msg")&&t.uint32(18).string(e.msg),null!=e.txid&&Object.hasOwnProperty.call(e,"txid")&&t.uint32(24).uint64(e.txid),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_accesshub.PushException;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.reason=e.int32();break;case 2:r.msg=e.string();break;case 3:r.txid=e.uint64();break;default:e.skipType(7&t)}}return r},e}(),e})(),u=a.proto_initconfig=(()=>{const e={};return e.ProtoVersion=function(){const e={},t=Object.create(e);return t[e[0]="RPOTO_V000000"]=0,t[e[65536]="RPOTO_V010000"]=65536,t}(),e.ResourceType=function(){const e={},t=Object.create(e);return t[e[0]="CDN"]=0,t[e[1]="RTC"]=1,t[e[2]="L3"]=2,t}(),e.ProtocolType=function(){const e={},t=Object.create(e);return t[e[0]="UDP"]=0,t[e[1]="RTMP"]=1,t[e[2]="FLV"]=2,t[e[3]="HLS"]=3,t[e[4]="WEBRTC"]=4,t}(),e.ResolveType=function(){const e={},t=Object.create(e);return t[e[0]="LOCAL_DNS"]=0,t[e[1]="DISPATCH"]=1,t}(),e.AppConfig=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.test_id=null,e.prototype.domain=null,e.prototype.flexible_domain=null,e.prototype.replace_flexible_domain=null,Object.defineProperty(e.prototype,"_test_id",{get:s.oneOfGetter(t=["test_id"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_domain",{get:s.oneOfGetter(t=["domain"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_flexible_domain",{get:s.oneOfGetter(t=["flexible_domain"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_replace_flexible_domain",{get:s.oneOfGetter(t=["replace_flexible_domain"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.test_id&&Object.hasOwnProperty.call(e,"test_id")&&t.uint32(8).int32(e.test_id),null!=e.domain&&Object.hasOwnProperty.call(e,"domain")&&t.uint32(18).string(e.domain),null!=e.flexible_domain&&Object.hasOwnProperty.call(e,"flexible_domain")&&t.uint32(26).string(e.flexible_domain),null!=e.replace_flexible_domain&&Object.hasOwnProperty.call(e,"replace_flexible_domain")&&t.uint32(34).string(e.replace_flexible_domain),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.AppConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.test_id=e.int32();break;case 2:r.domain=e.string();break;case 3:r.flexible_domain=e.string();break;case 4:r.replace_flexible_domain=e.string();break;default:e.skipType(7&t)}}return r},e}(),e.RoomConfig=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.license_url=null,Object.defineProperty(e.prototype,"_license_url",{get:s.oneOfGetter(t=["license_url"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.license_url&&Object.hasOwnProperty.call(e,"license_url")&&t.uint32(10).string(e.license_url),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.RoomConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.license_url=e.string();break;default:e.skipType(7&t)}}return r},e}(),e.VEConfig=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.audio_session_protect=null,Object.defineProperty(e.prototype,"_audio_session_protect",{get:s.oneOfGetter(t=["audio_session_protect"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.audio_session_protect&&Object.hasOwnProperty.call(e,"audio_session_protect")&&t.uint32(8).int32(e.audio_session_protect),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.VEConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.audio_session_protect=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.SpeedlogConfig=function(){function e(e){if(this.disable_report_pull=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.report_count=null,e.prototype.report_retry_interval=null,e.prototype.push_quality_sample_count=null,e.prototype.pull_quality_sample_count=null,e.prototype.hardware_report_cycle=null,e.prototype.room_user_max_count=null,e.prototype.room_stream_max_count=null,e.prototype.charge_info_report_cycle=null,e.prototype.charge_info_report_mode=null,e.prototype.disable_report_pull=s.emptyArray,e.prototype.report_max_bytes=null,Object.defineProperty(e.prototype,"_report_count",{get:s.oneOfGetter(t=["report_count"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_report_retry_interval",{get:s.oneOfGetter(t=["report_retry_interval"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_push_quality_sample_count",{get:s.oneOfGetter(t=["push_quality_sample_count"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_pull_quality_sample_count",{get:s.oneOfGetter(t=["pull_quality_sample_count"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_hardware_report_cycle",{get:s.oneOfGetter(t=["hardware_report_cycle"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_room_user_max_count",{get:s.oneOfGetter(t=["room_user_max_count"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_room_stream_max_count",{get:s.oneOfGetter(t=["room_stream_max_count"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_charge_info_report_cycle",{get:s.oneOfGetter(t=["charge_info_report_cycle"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_charge_info_report_mode",{get:s.oneOfGetter(t=["charge_info_report_mode"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_report_max_bytes",{get:s.oneOfGetter(t=["report_max_bytes"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){if(t||(t=i.create()),null!=e.report_count&&Object.hasOwnProperty.call(e,"report_count")&&t.uint32(8).int32(e.report_count),null!=e.report_retry_interval&&Object.hasOwnProperty.call(e,"report_retry_interval")&&t.uint32(16).int32(e.report_retry_interval),null!=e.push_quality_sample_count&&Object.hasOwnProperty.call(e,"push_quality_sample_count")&&t.uint32(24).int32(e.push_quality_sample_count),null!=e.pull_quality_sample_count&&Object.hasOwnProperty.call(e,"pull_quality_sample_count")&&t.uint32(32).int32(e.pull_quality_sample_count),null!=e.hardware_report_cycle&&Object.hasOwnProperty.call(e,"hardware_report_cycle")&&t.uint32(40).int32(e.hardware_report_cycle),null!=e.room_user_max_count&&Object.hasOwnProperty.call(e,"room_user_max_count")&&t.uint32(48).int32(e.room_user_max_count),null!=e.room_stream_max_count&&Object.hasOwnProperty.call(e,"room_stream_max_count")&&t.uint32(56).int32(e.room_stream_max_count),null!=e.charge_info_report_cycle&&Object.hasOwnProperty.call(e,"charge_info_report_cycle")&&t.uint32(64).int32(e.charge_info_report_cycle),null!=e.charge_info_report_mode&&Object.hasOwnProperty.call(e,"charge_info_report_mode")&&t.uint32(72).int32(e.charge_info_report_mode),null!=e.disable_report_pull&&e.disable_report_pull.length){t.uint32(82).fork();for(let n=0;n<e.disable_report_pull.length;++n)t.int32(e.disable_report_pull[n]);t.ldelim()}return null!=e.report_max_bytes&&Object.hasOwnProperty.call(e,"report_max_bytes")&&t.uint32(88).int32(e.report_max_bytes),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.SpeedlogConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.report_count=e.int32();break;case 2:r.report_retry_interval=e.int32();break;case 3:r.push_quality_sample_count=e.int32();break;case 4:r.pull_quality_sample_count=e.int32();break;case 5:r.hardware_report_cycle=e.int32();break;case 6:r.room_user_max_count=e.int32();break;case 7:r.room_stream_max_count=e.int32();break;case 8:r.charge_info_report_cycle=e.int32();break;case 9:r.charge_info_report_mode=e.int32();break;case 10:if(r.disable_report_pull&&r.disable_report_pull.length||(r.disable_report_pull=[]),2==(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)r.disable_report_pull.push(e.int32())}else r.disable_report_pull.push(e.int32());break;case 11:r.report_max_bytes=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.MediaServiceProtocolInfo=function(){function e(e){if(this.cdn_quic_version=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.config_id=null,e.prototype.protocol=null,e.prototype.url_template=null,e.prototype.resolve_type=null,e.prototype.push_cdn_authentication=null,e.prototype.cdn_quic_version=s.emptyArray,Object.defineProperty(e.prototype,"_config_id",{get:s.oneOfGetter(t=["config_id"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_protocol",{get:s.oneOfGetter(t=["protocol"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_url_template",{get:s.oneOfGetter(t=["url_template"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_resolve_type",{get:s.oneOfGetter(t=["resolve_type"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_push_cdn_authentication",{get:s.oneOfGetter(t=["push_cdn_authentication"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){if(t||(t=i.create()),null!=e.config_id&&Object.hasOwnProperty.call(e,"config_id")&&t.uint32(10).string(e.config_id),null!=e.protocol&&Object.hasOwnProperty.call(e,"protocol")&&t.uint32(16).int32(e.protocol),null!=e.url_template&&Object.hasOwnProperty.call(e,"url_template")&&t.uint32(26).string(e.url_template),null!=e.resolve_type&&Object.hasOwnProperty.call(e,"resolve_type")&&t.uint32(32).int32(e.resolve_type),null!=e.push_cdn_authentication&&Object.hasOwnProperty.call(e,"push_cdn_authentication")&&t.uint32(40).int32(e.push_cdn_authentication),null!=e.cdn_quic_version&&e.cdn_quic_version.length){t.uint32(50).fork();for(let n=0;n<e.cdn_quic_version.length;++n)t.int32(e.cdn_quic_version[n]);t.ldelim()}return t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.MediaServiceProtocolInfo;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.config_id=e.string();break;case 2:r.protocol=e.int32();break;case 3:r.url_template=e.string();break;case 4:r.resolve_type=e.int32();break;case 5:r.push_cdn_authentication=e.int32();break;case 6:if(r.cdn_quic_version&&r.cdn_quic_version.length||(r.cdn_quic_version=[]),2==(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)r.cdn_quic_version.push(e.int32())}else r.cdn_quic_version.push(e.int32());break;default:e.skipType(7&t)}}return r},e}(),e.MediaResourceInfo=function(){function e(e){if(this.service_info=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.resource_type=null,e.prototype.service_info=s.emptyArray,Object.defineProperty(e.prototype,"_resource_type",{get:s.oneOfGetter(t=["resource_type"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){if(t||(t=i.create()),null!=e.resource_type&&Object.hasOwnProperty.call(e,"resource_type")&&t.uint32(8).int32(e.resource_type),null!=e.service_info&&e.service_info.length)for(let n=0;n<e.service_info.length;++n)a.proto_initconfig.MediaServiceProtocolInfo.encode(e.service_info[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.MediaResourceInfo;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.resource_type=e.int32();break;case 2:r.service_info&&r.service_info.length||(r.service_info=[]),r.service_info.push(a.proto_initconfig.MediaServiceProtocolInfo.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return r},e}(),e.TrafficControl=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.enable_traffic_control=null,e.prototype.traffic_properties=null,Object.defineProperty(e.prototype,"_enable_traffic_control",{get:s.oneOfGetter(t=["enable_traffic_control"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_traffic_properties",{get:s.oneOfGetter(t=["traffic_properties"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.enable_traffic_control&&Object.hasOwnProperty.call(e,"enable_traffic_control")&&t.uint32(8).int32(e.enable_traffic_control),null!=e.traffic_properties&&Object.hasOwnProperty.call(e,"traffic_properties")&&t.uint32(16).int32(e.traffic_properties),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.TrafficControl;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.enable_traffic_control=e.int32();break;case 2:r.traffic_properties=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.SupplementFrameControl=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.enable=null,e.prototype.threshold=null,e.prototype.probability=null,Object.defineProperty(e.prototype,"_enable",{get:s.oneOfGetter(t=["enable"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_threshold",{get:s.oneOfGetter(t=["threshold"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_probability",{get:s.oneOfGetter(t=["probability"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.enable&&Object.hasOwnProperty.call(e,"enable")&&t.uint32(8).int32(e.enable),null!=e.threshold&&Object.hasOwnProperty.call(e,"threshold")&&t.uint32(16).int32(e.threshold),null!=e.probability&&Object.hasOwnProperty.call(e,"probability")&&t.uint32(24).int32(e.probability),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.SupplementFrameControl;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.enable=e.int32();break;case 2:r.threshold=e.int32();break;case 3:r.probability=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.VideoParam=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.video_width=null,e.prototype.video_height=null,e.prototype.video_codec_id=null,e.prototype.video_bitrate=null,Object.defineProperty(e.prototype,"_video_width",{get:s.oneOfGetter(t=["video_width"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_video_height",{get:s.oneOfGetter(t=["video_height"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_video_codec_id",{get:s.oneOfGetter(t=["video_codec_id"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_video_bitrate",{get:s.oneOfGetter(t=["video_bitrate"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.video_width&&Object.hasOwnProperty.call(e,"video_width")&&t.uint32(8).int32(e.video_width),null!=e.video_height&&Object.hasOwnProperty.call(e,"video_height")&&t.uint32(16).int32(e.video_height),null!=e.video_codec_id&&Object.hasOwnProperty.call(e,"video_codec_id")&&t.uint32(24).int32(e.video_codec_id),null!=e.video_bitrate&&Object.hasOwnProperty.call(e,"video_bitrate")&&t.uint32(32).int32(e.video_bitrate),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.VideoParam;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.video_width=e.int32();break;case 2:r.video_height=e.int32();break;case 3:r.video_codec_id=e.int32();break;case 4:r.video_bitrate=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.PushConfig=function(){function e(e){if(this.video_param=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.channel_idx=null,e.prototype.mode=null,e.prototype.traffic_control=null,e.prototype.resolution_rate=null,e.prototype.video_param=s.emptyArray,Object.defineProperty(e.prototype,"_channel_idx",{get:s.oneOfGetter(t=["channel_idx"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_mode",{get:s.oneOfGetter(t=["mode"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_traffic_control",{get:s.oneOfGetter(t=["traffic_control"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_resolution_rate",{get:s.oneOfGetter(t=["resolution_rate"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){if(t||(t=i.create()),null!=e.channel_idx&&Object.hasOwnProperty.call(e,"channel_idx")&&t.uint32(8).int32(e.channel_idx),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(16).int32(e.mode),null!=e.traffic_control&&Object.hasOwnProperty.call(e,"traffic_control")&&a.proto_initconfig.TrafficControl.encode(e.traffic_control,t.uint32(42).fork()).ldelim(),null!=e.resolution_rate&&Object.hasOwnProperty.call(e,"resolution_rate")&&t.uint32(48).int32(e.resolution_rate),null!=e.video_param&&e.video_param.length)for(let n=0;n<e.video_param.length;++n)a.proto_initconfig.VideoParam.encode(e.video_param[n],t.uint32(58).fork()).ldelim();return t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.PushConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.channel_idx=e.int32();break;case 2:r.mode=e.int32();break;case 5:r.traffic_control=a.proto_initconfig.TrafficControl.decode(e,e.uint32());break;case 6:r.resolution_rate=e.int32();break;case 7:r.video_param&&r.video_param.length||(r.video_param=[]),r.video_param.push(a.proto_initconfig.VideoParam.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return r},e}(),e.MediaPublishConfig=function(){function e(e){if(this.resource_info=[],this.push_config=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.push_type=null,e.prototype.resource_info=s.emptyArray,e.prototype.push_config=s.emptyArray,Object.defineProperty(e.prototype,"_push_type",{get:s.oneOfGetter(t=["push_type"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){if(t||(t=i.create()),null!=e.push_type&&Object.hasOwnProperty.call(e,"push_type")&&t.uint32(8).int32(e.push_type),null!=e.resource_info&&e.resource_info.length)for(let n=0;n<e.resource_info.length;++n)a.proto_initconfig.MediaResourceInfo.encode(e.resource_info[n],t.uint32(18).fork()).ldelim();if(null!=e.push_config&&e.push_config.length)for(let n=0;n<e.push_config.length;++n)a.proto_initconfig.PushConfig.encode(e.push_config[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.MediaPublishConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.push_type=e.int32();break;case 2:r.resource_info&&r.resource_info.length||(r.resource_info=[]),r.resource_info.push(a.proto_initconfig.MediaResourceInfo.decode(e,e.uint32()));break;case 3:r.push_config&&r.push_config.length||(r.push_config=[]),r.push_config.push(a.proto_initconfig.PushConfig.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return r},e}(),e.TranscodingConfig=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.video_codec_h264=null,Object.defineProperty(e.prototype,"_video_codec_h264",{get:s.oneOfGetter(t=["video_codec_h264"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.video_codec_h264&&Object.hasOwnProperty.call(e,"video_codec_h264")&&t.uint32(10).string(e.video_codec_h264),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.TranscodingConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.video_codec_h264=e.string();break;default:e.skipType(7&t)}}return r},e}(),e.MediaPlayConfig=function(){function e(e){if(this.resource_order=[],this.resource_info=[],this.play_order_protocol_type=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.pull_type=null,e.prototype.l3_play_buffer_ms=null,e.prototype.allow_playing_specific_url=null,e.prototype.resource_order=s.emptyArray,e.prototype.resource_info=s.emptyArray,e.prototype.play_order_protocol_type=s.emptyArray,e.prototype.jitter_buffer_flag=null,e.prototype.min_jitter_buffer=null,e.prototype.max_jitter_buffer=null,e.prototype.supplement_frame_control=null,e.prototype.open_l3_play_resource_prefer=null,e.prototype.switch_to_l3_after_online=null,e.prototype.transcoding=null,Object.defineProperty(e.prototype,"_pull_type",{get:s.oneOfGetter(t=["pull_type"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_l3_play_buffer_ms",{get:s.oneOfGetter(t=["l3_play_buffer_ms"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_allow_playing_specific_url",{get:s.oneOfGetter(t=["allow_playing_specific_url"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_jitter_buffer_flag",{get:s.oneOfGetter(t=["jitter_buffer_flag"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_min_jitter_buffer",{get:s.oneOfGetter(t=["min_jitter_buffer"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_max_jitter_buffer",{get:s.oneOfGetter(t=["max_jitter_buffer"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_supplement_frame_control",{get:s.oneOfGetter(t=["supplement_frame_control"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_open_l3_play_resource_prefer",{get:s.oneOfGetter(t=["open_l3_play_resource_prefer"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_switch_to_l3_after_online",{get:s.oneOfGetter(t=["switch_to_l3_after_online"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_transcoding",{get:s.oneOfGetter(t=["transcoding"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){if(t||(t=i.create()),null!=e.pull_type&&Object.hasOwnProperty.call(e,"pull_type")&&t.uint32(8).int32(e.pull_type),null!=e.l3_play_buffer_ms&&Object.hasOwnProperty.call(e,"l3_play_buffer_ms")&&t.uint32(16).int32(e.l3_play_buffer_ms),null!=e.allow_playing_specific_url&&Object.hasOwnProperty.call(e,"allow_playing_specific_url")&&t.uint32(24).int32(e.allow_playing_specific_url),null!=e.resource_order&&e.resource_order.length){t.uint32(34).fork();for(let n=0;n<e.resource_order.length;++n)t.int32(e.resource_order[n]);t.ldelim()}if(null!=e.resource_info&&e.resource_info.length)for(let n=0;n<e.resource_info.length;++n)a.proto_initconfig.MediaResourceInfo.encode(e.resource_info[n],t.uint32(42).fork()).ldelim();if(null!=e.play_order_protocol_type&&e.play_order_protocol_type.length){t.uint32(50).fork();for(let n=0;n<e.play_order_protocol_type.length;++n)t.int32(e.play_order_protocol_type[n]);t.ldelim()}return null!=e.jitter_buffer_flag&&Object.hasOwnProperty.call(e,"jitter_buffer_flag")&&t.uint32(80).int32(e.jitter_buffer_flag),null!=e.min_jitter_buffer&&Object.hasOwnProperty.call(e,"min_jitter_buffer")&&t.uint32(88).int32(e.min_jitter_buffer),null!=e.max_jitter_buffer&&Object.hasOwnProperty.call(e,"max_jitter_buffer")&&t.uint32(96).int32(e.max_jitter_buffer),null!=e.supplement_frame_control&&Object.hasOwnProperty.call(e,"supplement_frame_control")&&a.proto_initconfig.SupplementFrameControl.encode(e.supplement_frame_control,t.uint32(106).fork()).ldelim(),null!=e.open_l3_play_resource_prefer&&Object.hasOwnProperty.call(e,"open_l3_play_resource_prefer")&&t.uint32(112).int32(e.open_l3_play_resource_prefer),null!=e.switch_to_l3_after_online&&Object.hasOwnProperty.call(e,"switch_to_l3_after_online")&&t.uint32(120).int32(e.switch_to_l3_after_online),null!=e.transcoding&&Object.hasOwnProperty.call(e,"transcoding")&&a.proto_initconfig.TranscodingConfig.encode(e.transcoding,t.uint32(130).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.MediaPlayConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.pull_type=e.int32();break;case 2:r.l3_play_buffer_ms=e.int32();break;case 3:r.allow_playing_specific_url=e.int32();break;case 4:if(r.resource_order&&r.resource_order.length||(r.resource_order=[]),2==(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)r.resource_order.push(e.int32())}else r.resource_order.push(e.int32());break;case 5:r.resource_info&&r.resource_info.length||(r.resource_info=[]),r.resource_info.push(a.proto_initconfig.MediaResourceInfo.decode(e,e.uint32()));break;case 6:if(r.play_order_protocol_type&&r.play_order_protocol_type.length||(r.play_order_protocol_type=[]),2==(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)r.play_order_protocol_type.push(e.int32())}else r.play_order_protocol_type.push(e.int32());break;case 10:r.jitter_buffer_flag=e.int32();break;case 11:r.min_jitter_buffer=e.int32();break;case 12:r.max_jitter_buffer=e.int32();break;case 13:r.supplement_frame_control=a.proto_initconfig.SupplementFrameControl.decode(e,e.uint32());break;case 14:r.open_l3_play_resource_prefer=e.int32();break;case 15:r.switch_to_l3_after_online=e.int32();break;case 16:r.transcoding=a.proto_initconfig.TranscodingConfig.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e}(),e.MediaDispatchProtocolInfo=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.protocol=null,e.prototype.url_template=null,e.prototype.reusable=null,Object.defineProperty(e.prototype,"_protocol",{get:s.oneOfGetter(t=["protocol"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_url_template",{get:s.oneOfGetter(t=["url_template"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_reusable",{get:s.oneOfGetter(t=["reusable"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.protocol&&Object.hasOwnProperty.call(e,"protocol")&&t.uint32(8).int32(e.protocol),null!=e.url_template&&Object.hasOwnProperty.call(e,"url_template")&&t.uint32(18).string(e.url_template),null!=e.reusable&&Object.hasOwnProperty.call(e,"reusable")&&t.uint32(24).int32(e.reusable),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.MediaDispatchProtocolInfo;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.protocol=e.int32();break;case 2:r.url_template=e.string();break;case 3:r.reusable=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.MediaDispatchResourceInfo=function(){function e(e){if(this.dispatch_protocol_info=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.resource_type=null,e.prototype.dispatch_protocol_info=s.emptyArray,Object.defineProperty(e.prototype,"_resource_type",{get:s.oneOfGetter(t=["resource_type"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){if(t||(t=i.create()),null!=e.resource_type&&Object.hasOwnProperty.call(e,"resource_type")&&t.uint32(8).int32(e.resource_type),null!=e.dispatch_protocol_info&&e.dispatch_protocol_info.length)for(let n=0;n<e.dispatch_protocol_info.length;++n)a.proto_initconfig.MediaDispatchProtocolInfo.encode(e.dispatch_protocol_info[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.MediaDispatchResourceInfo;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.resource_type=e.int32();break;case 2:r.dispatch_protocol_info&&r.dispatch_protocol_info.length||(r.dispatch_protocol_info=[]),r.dispatch_protocol_info.push(a.proto_initconfig.MediaDispatchProtocolInfo.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return r},e}(),e.MediaDispatchConfig=function(){function e(e){if(this.dispatch_resource_info=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.dispatch_resource_info=s.emptyArray,e.encode=function(e,t){if(t||(t=i.create()),null!=e.dispatch_resource_info&&e.dispatch_resource_info.length)for(let n=0;n<e.dispatch_resource_info.length;++n)a.proto_initconfig.MediaDispatchResourceInfo.encode(e.dispatch_resource_info[n],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.MediaDispatchConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.dispatch_resource_info&&r.dispatch_resource_info.length||(r.dispatch_resource_info=[]),r.dispatch_resource_info.push(a.proto_initconfig.MediaDispatchResourceInfo.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return r},e}(),e.MediaServiceUrlList=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.base_url=null,e.prototype.push_status_url=null,Object.defineProperty(e.prototype,"_base_url",{get:s.oneOfGetter(t=["base_url"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_push_status_url",{get:s.oneOfGetter(t=["push_status_url"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.base_url&&Object.hasOwnProperty.call(e,"base_url")&&t.uint32(10).string(e.base_url),null!=e.push_status_url&&Object.hasOwnProperty.call(e,"push_status_url")&&t.uint32(18).string(e.push_status_url),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.MediaServiceUrlList;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.base_url=e.string();break;case 2:r.push_status_url=e.string();break;default:e.skipType(7&t)}}return r},e}(),e.ZeusMediaConfig=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.push_dispatch_type=null,e.prototype.pull_dispatch_type=null,e.prototype.open_auth=null,e.prototype.send_anchor_login_after_push_cdn=null,Object.defineProperty(e.prototype,"_push_dispatch_type",{get:s.oneOfGetter(t=["push_dispatch_type"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_pull_dispatch_type",{get:s.oneOfGetter(t=["pull_dispatch_type"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_open_auth",{get:s.oneOfGetter(t=["open_auth"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_send_anchor_login_after_push_cdn",{get:s.oneOfGetter(t=["send_anchor_login_after_push_cdn"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.push_dispatch_type&&Object.hasOwnProperty.call(e,"push_dispatch_type")&&t.uint32(8).int32(e.push_dispatch_type),null!=e.pull_dispatch_type&&Object.hasOwnProperty.call(e,"pull_dispatch_type")&&t.uint32(16).int32(e.pull_dispatch_type),null!=e.open_auth&&Object.hasOwnProperty.call(e,"open_auth")&&t.uint32(24).int32(e.open_auth),null!=e.send_anchor_login_after_push_cdn&&Object.hasOwnProperty.call(e,"send_anchor_login_after_push_cdn")&&t.uint32(32).int32(e.send_anchor_login_after_push_cdn),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.ZeusMediaConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.push_dispatch_type=e.int32();break;case 2:r.pull_dispatch_type=e.int32();break;case 3:r.open_auth=e.int32();break;case 4:r.send_anchor_login_after_push_cdn=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e.MediaConfig=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.play_config=null,e.prototype.publish_config=null,e.prototype.dispatch_config=null,e.prototype.service_url_list=null,e.prototype.zeus_config=null,Object.defineProperty(e.prototype,"_play_config",{get:s.oneOfGetter(t=["play_config"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_publish_config",{get:s.oneOfGetter(t=["publish_config"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_dispatch_config",{get:s.oneOfGetter(t=["dispatch_config"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_service_url_list",{get:s.oneOfGetter(t=["service_url_list"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_zeus_config",{get:s.oneOfGetter(t=["zeus_config"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.play_config&&Object.hasOwnProperty.call(e,"play_config")&&a.proto_initconfig.MediaPlayConfig.encode(e.play_config,t.uint32(10).fork()).ldelim(),null!=e.publish_config&&Object.hasOwnProperty.call(e,"publish_config")&&a.proto_initconfig.MediaPublishConfig.encode(e.publish_config,t.uint32(18).fork()).ldelim(),null!=e.dispatch_config&&Object.hasOwnProperty.call(e,"dispatch_config")&&a.proto_initconfig.MediaDispatchConfig.encode(e.dispatch_config,t.uint32(26).fork()).ldelim(),null!=e.service_url_list&&Object.hasOwnProperty.call(e,"service_url_list")&&a.proto_initconfig.MediaServiceUrlList.encode(e.service_url_list,t.uint32(34).fork()).ldelim(),null!=e.zeus_config&&Object.hasOwnProperty.call(e,"zeus_config")&&a.proto_initconfig.ZeusMediaConfig.encode(e.zeus_config,t.uint32(42).fork()).ldelim(),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.MediaConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.play_config=a.proto_initconfig.MediaPlayConfig.decode(e,e.uint32());break;case 2:r.publish_config=a.proto_initconfig.MediaPublishConfig.decode(e,e.uint32());break;case 3:r.dispatch_config=a.proto_initconfig.MediaDispatchConfig.decode(e,e.uint32());break;case 4:r.service_url_list=a.proto_initconfig.MediaServiceUrlList.decode(e,e.uint32());break;case 5:r.zeus_config=a.proto_initconfig.ZeusMediaConfig.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e}(),e.InitConfig=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.app_config=null,e.prototype.room_config=null,e.prototype.ve_config=null,e.prototype.speedlog_config=null,e.prototype.media_config=null,e.prototype.proto_version=null,Object.defineProperty(e.prototype,"_app_config",{get:s.oneOfGetter(t=["app_config"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_room_config",{get:s.oneOfGetter(t=["room_config"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_ve_config",{get:s.oneOfGetter(t=["ve_config"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_speedlog_config",{get:s.oneOfGetter(t=["speedlog_config"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_media_config",{get:s.oneOfGetter(t=["media_config"]),set:s.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_proto_version",{get:s.oneOfGetter(t=["proto_version"]),set:s.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=i.create()),null!=e.app_config&&Object.hasOwnProperty.call(e,"app_config")&&a.proto_initconfig.AppConfig.encode(e.app_config,t.uint32(10).fork()).ldelim(),null!=e.room_config&&Object.hasOwnProperty.call(e,"room_config")&&a.proto_initconfig.RoomConfig.encode(e.room_config,t.uint32(18).fork()).ldelim(),null!=e.ve_config&&Object.hasOwnProperty.call(e,"ve_config")&&a.proto_initconfig.VEConfig.encode(e.ve_config,t.uint32(26).fork()).ldelim(),null!=e.speedlog_config&&Object.hasOwnProperty.call(e,"speedlog_config")&&a.proto_initconfig.SpeedlogConfig.encode(e.speedlog_config,t.uint32(34).fork()).ldelim(),null!=e.media_config&&Object.hasOwnProperty.call(e,"media_config")&&a.proto_initconfig.MediaConfig.encode(e.media_config,t.uint32(42).fork()).ldelim(),null!=e.proto_version&&Object.hasOwnProperty.call(e,"proto_version")&&t.uint32(48).int32(e.proto_version),t},e.decode=function(e,t){e instanceof o||(e=o.create(e));let n=void 0===t?e.len:e.pos+t,r=new a.proto_initconfig.InitConfig;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.app_config=a.proto_initconfig.AppConfig.decode(e,e.uint32());break;case 2:r.room_config=a.proto_initconfig.RoomConfig.decode(e,e.uint32());break;case 3:r.ve_config=a.proto_initconfig.VEConfig.decode(e,e.uint32());break;case 4:r.speedlog_config=a.proto_initconfig.SpeedlogConfig.decode(e,e.uint32());break;case 5:r.media_config=a.proto_initconfig.MediaConfig.decode(e,e.uint32());break;case 6:r.proto_version=e.int32();break;default:e.skipType(7&t)}}return r},e}(),e})()},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoWssLink=void 0;var a=n(32),c=n(0),u=n(33),l=n(34),h=n(4),p=n(2),f=function(e){function t(t,n,r,o,i){var s=e.call(this)||this;return s.appID=t,s.env=n,s.protobuf=r,s.logger=o,s.stateCenter=i,s.socketService=new l.NetSocketService(s.env),s.urlIndex=0,s.updatedMsgTime=0,s.unUpdateMsgTimeTypes=[c.AccessHubMessageType.MSG_TYPE_HB_REQUEST,c.AccessHubMessageType.MSG_TYPE_HB_RESPONSE,c.AccessHubMessageType.MSG_TYPE_GET_CONFIG_REQUEST,c.AccessHubMessageType.MSG_TYPE_GET_CONFIG_RESPONSE],s.netLinkState=c.ENUM_CONNECT_STATE.disconnect,s.sendCommandList=new a.LinkedList,s.unSendCommandList=new a.LinkedList,s.sendCommandMap={},s.unSendCommandMap={},s.sendDataCheckOnceCount=100,s.sendDataDropTimeout=1e4,s.sendDataCheckInterval=2e3,s.timeout=5e3,s.connectInterval=1e4,s.connectTimer=null,s.connectRsp={},s.unlogTypes=[12,13],s.tryServers=[],s.updatedMsgTime=Date.now(),s}return o(t,e),t.prototype.initEvent=function(e,t,n,r){this.onConnectedEvent=e,this.onDisConnectedEvent=t,this.onConnectingEvent=n,this.onPushEvent=r},t.prototype.createSocket=function(e){this.servers=e,this.urlIndex=0},t.prototype.destroySocket=function(){this.logger.info("zn.wl.ds.0 call"),this.socketService.closeSocket(),this.netLinkState=c.ENUM_CONNECT_STATE.disconnect,this.resetConnect()},t.prototype.refreshServers=function(e){this.servers=s(s([],e,!0),this.servers,!0)},t.prototype.connectSocket=function(e,t,n){var r=this;if(void 0===e&&(e=!0),this.logger.info("zn.wl.cs.0 call"),this.connectRsp.suc=t,this.connectRsp.fail=n,this.stateCenter.networkState!==c.ENUM_NETWORK_STATE.online)return!1;e&&(this.urlIndex=(this.urlIndex+1)%this.servers.length);var o=this.servers[this.urlIndex];return this.connectServer=o,this.logger.info("zn.wl.cs.0 server "+o),this.tryServers.push(o),this.closeSocket(),this.netLinkState=c.ENUM_CONNECT_STATE.connecting,this.socketService.createSocket(o),this.onConnectingEvent&&this.onConnectingEvent(!0),this.bindSocketEvent(),this.connectTimer=setTimeout((function(){r.logger.info("zn.wl.cs.0 timeout"),r.connectRsp.fail&&r.connectRsp.fail()}),this.connectInterval),!0},t.prototype.bindSocketEvent=function(){var e=this;this.openHandler((function(){e.logger.info("zn.wl.bse open"),e.resetConnect(),e.connectRsp.suc&&e.connectRsp.suc(),e.netLinkState=c.ENUM_CONNECT_STATE.connected,e.onConnectedEvent&&e.onConnectedEvent(e.tryServers),e.checkUnSendMsgs(e.unSendCommandList),e.startCheck()})),this.closeHandler((function(t){e.logger.warn("zn.wl.bse close "+JSON.stringify(t)),e.resetConnect(),e.connectRsp.fail&&e.connectRsp.fail(),e.onDisConnectedEvent&&e.onDisConnectedEvent(!0),e.netLinkState=c.ENUM_CONNECT_STATE.disconnect})),this.errorHandler((function(t){e.logger.warn("zn.wl.bse error "+JSON.stringify(t)),e.resetConnect(),e.connectRsp.fail&&e.connectRsp.fail(),e.onDisConnectedEvent&&e.onDisConnectedEvent(!0),e.netLinkState=c.ENUM_CONNECT_STATE.disconnect})),this.onMessage()},t.prototype.closeSocket=function(){this.logger.info("zn.wl.cs.1 call"),this.socketService.closeSocket(),this.netLinkState=c.ENUM_CONNECT_STATE.disconnect},t.prototype.resetConnect=function(){this.connectTimer&&(clearTimeout(this.connectTimer),this.connectTimer=null),this.stopCheck()},t.prototype.isConnect=function(){return this.netLinkState===c.ENUM_CONNECT_STATE.connected},t.prototype.isDisConnect=function(){return!this.socketService||this.socketService.isDisConnect()},t.prototype.setState=function(e){this.netLinkState=e},t.prototype.closeHandler=function(e){this.socketService.closeHandler(e)},t.prototype.openHandler=function(e){this.socketService.openHandler(e)},t.prototype.errorHandler=function(e){this.socketService.errorHandler(e)},t.prototype.updateMsgTime=function(){this.updatedMsgTime=Date.now()},t.prototype.sendMessage=function(e,t,n,r,o,s,a,u){var l;void 0===r&&(r=!0),void 0===o&&(o=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u={}),void 0===u.timeout&&(u.timeout=5e3),void 0===u.isInSendMap&&(u.isInSendMap=!0),this.txid++;var h={appid:this.appID,biz_type:0,mode_no:(null===(l=this.stateCenter.appInfo)||void 0===l?void 0:l.mode)||p.NET_ACCESS_CONFIG.modeNo,id_name:this.stateCenter.userId,sdk_type:p.NET_ACCESS_CONFIG.sdkType,zegoconn_run_env:0===this.env?c.ZegoconnRunEnv.ZEGOCONN_RUN_ENV_BROWSER:c.ZegoconnRunEnv.ZEGOCONN_RUN_ENV_APPLET},f=i(i({txid:this.txid},h),n),d={data:f,txid:this.txid,sendTime:Date.now(),streamID:t,type:e,timeOut:u.timeout||this.timeout,ack:n.ack,success:o,error:s,ackFunc:a,isSend:!0};if(u.isInSendMap){var _=this.sendCommandList.push(d);this.sendCommandMap[this.txid]=_}if(this.unUpdateMsgTimeTypes.includes(e)||(this.updatedMsgTime=Date.now()),-1===this.unlogTypes.indexOf(e)&&this.logger.info("zn.wl.sm type: "+e+"-"+c.typeMap[e]+" streamID: "+t+" txid: "+this.txid),this.isConnect())this.sendUint8Data(e,f,t);else{d.isSend=!1;var g=this.unSendCommandList.push(d);this.unSendCommandMap[this.txid]=g}},t.prototype.checkUnSendMsgs=function(e){for(var t,n=e.getFirst();null!=n;)e.remove(n),n._data&&!1===(null===(t=n._data)||void 0===t?void 0:t.isSend)&&n._data.type&&n._data.streamID&&n._data.data&&(this.sendUint8Data(n._data.type,n._data.data,n._data.streamID),n._data.isSend=!0),n=e.getFirst()},t.prototype.sendUint8Data=function(e,t,n){var r=this.protobuf.encodeRequest(e,t,n);this.socketService.sendMessage(r)},t.prototype.onMessage=function(){var e=this;this.socketService.onMessage=function(t){var n,r,o,i=new Uint8Array(t),s=e.protobuf.decodeResponse(i),a=s[0],u=s[1],l=s[2];e.unUpdateMsgTimeTypes.includes(u)||(e.updatedMsgTime=Date.now()),-1===e.unlogTypes.indexOf(u)&&e.logger.info("zn.wl.om"+" streamID: ".concat(a,", msgType: ").concat(u,"-").concat(c.typeMap[u])),((null==l?void 0:l.txid)||(null===(n=null==l?void 0:l.data)||void 0===n?void 0:n.txid))&&e.isRspMsg((null==l?void 0:l.txid)||(null===(r=null==l?void 0:l.data)||void 0===r?void 0:r.txid))?e.handleSendCommandMsgRsp(a,u,(null==l?void 0:l.txid)||(null===(o=null==l?void 0:l.data)||void 0===o?void 0:o.txid),l):e.onPushEvent(a,u,l)}},t.prototype.isRspMsg=function(e){return void 0!==this.sendCommandMap[e]},t.prototype.startCheck=function(){var e=this;this.checkMessageListTimeout(this.sendCommandList,this.sendCommandMap),this.sendDataCheckTimer=setTimeout((function(){e.startCheck()}),this.sendDataCheckInterval)},t.prototype.stopCheck=function(){this.checkSendMessageList(this.sendCommandList),clearTimeout(this.sendDataCheckTimer)},t.prototype.checkMessageListTimeout=function(e,t){for(var n=e.getFirst(),r=Date.now(),o=0,i=function(){if(n._data&&n._data.sendTime+n._data.timeOut>r)return"break";if(n._data&&delete t[n._data.data.txid],e.remove(n),n._data&&null==n._data.error||n._data&&n._data.sendTime+s.sendDataDropTimeout<r);else{var i=n&&n._data&&n._data.error,a=n&&n._data&&n._data.txid;setTimeout((function(){i&&i({},a,h.errorCodeList.TIMEOUT)}),0)}if(++o>=s.sendDataCheckOnceCount)return"break";n=e.getFirst()},s=this;null!=n&&"break"!==i(););},t.prototype.checkSendMessageList=function(e){for(var t=e.getFirst(),n=function(){if(e.remove(t),t._data.isSend&&t._data.error){var n=t&&t._data&&t._data.error,r=t&&t._data&&t._data.txid;setTimeout((function(){n&&n({},r,h.errorCodeList.TIMEOUT)}),0)}t=e.getFirst()};null!=t&&t._data;)n()},t.prototype.handleSendCommandMsgRsp=function(e,t,n,r){var o=this.sendCommandMap[n];if(null!=o){var i=o._data;(null==i?void 0:i.ack)||(delete this.sendCommandMap[n],this.sendCommandList.remove(o)),r.code&&0!==r.code?i&&null!=i.error&&i.error(r,n):t===c.AccessHubMessageType.MSG_TYPE_PUSH_EXCEPTION?(r.code=r.reason,r.message=r.msg,i&&null!=i.error&&i.error(r,n)):t===c.AccessHubMessageType.MSG_TYPE_HTTP_REQUEST_ACK?i&&null!=i.ackFunc&&i.ackFunc(r,n):i&&null!=i.success&&i.success(r,n)}},t}(u.ZegoLink);t.ZegoWssLink=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedList=t.ListNode=void 0;var r=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.next=null,this.prev=null,this._id=e,this._data=t}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id?this._id:null},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!1,configurable:!0}),e.prototype.hasNext=function(){return this.next&&this.next.id},e.prototype.hasPrev=function(){return this.prev&&this.prev.id},e}();t.ListNode=r;var o=function(){function e(){this.start=new r,this.end=new r,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}return e.prototype.insertBefore=function(e,t){var n=new r(this._idCounter,t);return n.next=e,n.prev=e.prev,e.prev&&(e.prev.next=n),e.prev=n,++this._idCounter,++this._numNodes,n},e.prototype.addLast=function(e){return this.insertBefore(this.end,e)},e.prototype.add=function(e){return this.addLast(e)},e.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},e.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},e.prototype.size=function(){return this._numNodes},e.prototype.getFromFirst=function(e){var t=0,n=this.start.next;if(e>=0)for(;t<e&&null!==n;)n=n.next,++t;else n=null;if(null===n)throw"Index out of bounds.";return n},e.prototype.get=function(e){return 0===e?this.getFirst():e===this._numNodes-1?this.getLast():this.getFromFirst(e)},e.prototype.remove=function(e){return e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),--this._numNodes,e},e.prototype.removeFirst=function(){var e=null;return this._numNodes>0&&this.start.next&&(e=this.remove(this.start.next)),e},e.prototype.removeLast=function(){var e=null;return this._numNodes>0&&this.end.prev&&(e=this.remove(this.end.prev)),e},e.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},e.prototype.each=function(e){for(var t=this.start;t.hasNext();)e(t=t.next)},e.prototype.find=function(e){for(var t=this.start,n=!1,r=null;t.hasNext()&&!n;)e(t=t.next)&&(r=t,n=!0);return r},e.prototype.map=function(e){for(var t=this.start,n=[];t.hasNext();)e(t=t.next)&&n.push(t);return n},e.prototype.push=function(e){return this.addLast(e)},e.prototype.unshift=function(e){this._numNodes>0?this.insertBefore(this.start.next,e):this.insertBefore(this.end,e)},e.prototype.pop=function(){return this.removeLast()},e.prototype.shift=function(){return this.removeFirst()},e}();t.LinkedList=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLink=void 0;var r=function(){function e(){this.txid=0,this.linkRetryTime=60,this.updatedMsgTime=0,this.connectServer=""}return e.prototype.createSocket=function(e){},e.prototype.setState=function(e){},e.prototype.initEvent=function(e,t,n,r){},e.prototype.sendMessage=function(e,t,n,r,o,i,s,a){void 0===r&&(r=!0),void 0===o&&(o=null),void 0===i&&(i=null),void 0===s&&(s=null),void 0===a&&(a={timeout:5e3,isInSendMap:!0})},e}();t.ZegoLink=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetSocketService=void 0;var r=n(35),o=function(){function e(e){this.socket=null,this.ENV=e}return e.prototype.createSocket=function(e){this.socket=(0,r.createZegoWebSocket)(e,this.ENV%2)},e.prototype.openHandler=function(e){var t=this;this.socket&&(this.socket.onopen=function(n){t.socket.binaryType="arraybuffer",t.responseHandler(),e(n)})},e.prototype.responseHandler=function(){var e=this;this.socket&&(this.socket.onmessage=function(t){var n="string"==typeof t.data?JSON.parse(t.data):t.data;e.onMessage(n)})},e.prototype.onMessage=function(e){},e.prototype.closeHandler=function(e){this.socket&&(this.socket.onclose=function(t){e(t)})},e.prototype.errorHandler=function(e){this.socket&&(this.socket.onerror=e)},e.prototype.closeSocket=function(){this.socket&&(this.socket.onclose=null,this.socket.onerror=null,this.socket.close(),this.socket=null)},e.prototype.isDisConnect=function(){return!this.socket||1!==this.socket.readyState},e.prototype.sendMessage=function(e){this.isDisConnect()||this.socket&&(this.ENV%2==1||this.socket.send(e))},e}();t.NetSocketService=o},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.createZegoWebSocket=t.ZegoWeiXinMiniWebSocket=t.ZEGO_ENV=void 0,function(e){e[e.BROWSER=0]="BROWSER",e[e.WEIXINMINI=1]="WEIXINMINI"}(r=t.ZEGO_ENV||(t.ZEGO_ENV={}));var o=function(){function e(e,t){this.url=e,this.readyState=3,this._websocket=wx.connectSocket({url:e}),this.init()}return e.prototype.init=function(){var e=this;this._websocket&&(this.readyState=0,this._websocket.onOpen((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onopen&&(e.onopen(t),e._websocket.onClose((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onclose&&e.onclose(t)})),e._websocket.onMessage((function(t){"function"==typeof e.onmessage&&e.onmessage(t)})))})),this._websocket.onError((function(t){e.readyState=e._websocket.readyState,"function"==typeof e.onerror&&e.onerror(t)})))},e.prototype.onopen=function(e){},e.prototype.onerror=function(e){},e.prototype.onclose=function(e){},e.prototype.onmessage=function(e){},e.prototype.send=function(e){this._websocket&&this._websocket.send({data:e})},e.prototype.close=function(){this._websocket&&this._websocket.close()},e}();t.ZegoWeiXinMiniWebSocket=o,t.createZegoWebSocket=function(e,t){return t%2===r.BROWSER?new WebSocket(e):new o(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetAgentBusinessRequestMgr=void 0;var r=n(0),o=n(2),i=function(){function e(e,t,n,r){this.streamManager=e,this.protobuf=t,this.logger=n,this.stateCenter=r}return e.prototype.getConfig=function(e,t){this.logger.info("zn.nab.gc call"),this.streamManager.createStream(r.StreamType.OTHER).sendMessage(r.AccessHubMessageType.MSG_TYPE_GET_CONFIG_REQUEST,{zegoconn_version:o.NET_ACCESS_CONFIG.connectVer},e,t)},e.prototype.dispatchURL=function(e,t){var n=this;this.logger.info("zn.nab.du call"),this.streamManager.createStream(r.StreamType.OTHER).sendMessage(r.AccessHubMessageType.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST,{},(function(t){n.logger.info("zn.nab.du suc "),e&&e(t)}),(function(e,r,o){n.logger.info("zn.nab.du fail"),t&&t(o||e)}))},e.prototype.getAppConfig=function(e,t,n,i){var s=this;return new Promise((function(a,c){var u;s.logger.info("zn.nab.gac call");var l={id_name:t,config_key:e,token:n,mode_no:(null===(u=s.stateCenter.appInfo)||void 0===u?void 0:u.mode)||o.NET_ACCESS_CONFIG.modeNo},h=function(e,t,n){if(n)return s.logger.error("zn.nab.gac fail "+JSON.stringify(n)),void c(n);if(0===e.code){s.logger.info("zn.nab.gac suc");var r=s.decodeConfigMessage(e.data.data);a({code:0,data:r})}else s.logger.error("zn.nab.gac fail "+e.code),c({code:e.code})};s.streamManager.createStream(r.StreamType.OTHER).sendMessage(r.AccessHubMessageType.MSG_TYPE_GET_APPCONFIG_REQUEST,l,h,h,null,{timeout:i})}))},e.prototype.decodeConfigMessage=function(e){return this.protobuf.decodeConfigMessage(e)},e}();t.NetAgentBusinessRequestMgr=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetHeartBeatHandler=void 0;var r=n(4),o=n(0),i=function(){function e(e,t){this.streamManager=e,this.logger=t,this.hbTimer=null,this.hbInterval=5,this.hbTimeout=10,this.hbTimeoutMaxCount=0,this.tryHbCount=0}return e.prototype.init=function(e){var t=this;this.logger.info("zn.nhb.ii call"),this.hbStream||(this.hbStream=this.streamManager.createStream(o.StreamType.OTHER)),e.data.logic_hb_interval>=1&&e.data.logic_hb_interval<=10&&(this.hbInterval=e.data.logic_hb_interval),e.data.logic_hb_timeout>=3&&e.data.logic_hb_timeout<=30&&(this.hbTimeout=e.data.logic_hb_timeout),this.hbTimeoutMaxCount=this.hbTimeout/this.hbInterval,this.hbTimer&&clearTimeout(this.hbTimer),this.hbTimer=setTimeout((function(){t.start()}),1e3*this.hbInterval)},e.prototype.start=function(){var e=this;if(this.logger.debug("zn.nhb.s call "),this.tryHbCount++>this.hbTimeoutMaxCount)return this.logger.error("zn.nhb.s come to try limit"),this.reset(),void this.netHbLogout(r.errorCodeList.NET_HB_TIMEOUT);var t=(new Date).getTime(),n=function(n,r,o){e.logger.debug("zn.nhb.s hb callback "+((new Date).getTime()-t)),o&&0!==(null==o?void 0:o.code)?e.logger.info("zn.nhb.s fail "+JSON.stringify(o)):e.tryHbCount=0},i={ts:Date.now()};this.hbStream.sendMessage(o.AccessHubMessageType.MSG_TYPE_HB_REQUEST,i,n,n,null),this.hbTimer&&clearTimeout(this.hbTimer),this.hbTimer=setTimeout((function(){e.start()}),1e3*this.hbInterval)},e.prototype.netHbLogout=function(e){},e.prototype.reset=function(){this.hbTimer&&(clearTimeout(this.hbTimer),this.hbTimer=null),this.tryHbCount=0},e}();t.NetHeartBeatHandler=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetAgentPCRequestMgr=void 0;var r=n(0),o=n(2),i=n(8),s=function(){function e(e,t){this.streamManager=e,this.logger=t,this.pcStreamRequests=[],this.pcEstablishTimeout=o.NET_ACCESS_CONFIG.pcEstablishTimeout}return e.prototype.getRequest=function(e,t){var n=new i.NetAgentPCRequest(this.logger,e,this.streamManager,this.pcEstablishTimeout,t);return this.pcStreamRequests.push(n),n},e.prototype.updateConnectState=function(e,t,n){this.pcStreamRequests.forEach((function(o){e===r.PcConnectState.BROKEN?o.eventManager.emit("broken"):e===r.PcConnectState.DISCONNECT&&o.eventManager.emit("disconnected",t,n)}))},e.prototype.closePCs=function(){this.pcStreamRequests.forEach((function(e){e.closePc()}))},e.prototype.setEstablishTimeout=function(e){this.pcEstablishTimeout=e},e}();t.NetAgentPCRequestMgr=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetRetryLinkHandler=void 0;var r=n(4),o=n(0),i=function(){function e(e,t){this.logger=e,this.stateCenter=t,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryTimer=null,this.maxTimer=null,this.retryStartTime=0,this.retryActiveCount=1,this.isOverTime=!1,this.RETRY_MAX_TIME=90}return e.prototype.initLink=function(e){this.link=e},e.prototype.startMaxTime=function(){var e=this;this.maxTimer||(this.maxTimer=setTimeout((function(){e.logger.warn("zn.rlh.sm"+" over max time ".concat(e.RETRY_MAX_TIME,"s, stop retry")),e.isOverTime=!0,e.link.resetConnect(),e.stopMaxTime(),e.invalid(),e.onactive(!1,r.errorCodeList.NET_SOCKET_TIMEOUT)}),1e3*this.RETRY_MAX_TIME))},e.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},e.prototype.active=function(e,t){var n=this;if(this.logger.info("zn.rlh.at call "+e+" "+t),this.stateCenter.networkState==o.ENUM_NETWORK_STATE.offline)return this.logger.info("zn.rlh.at network is broken, stop retry"),!1;if(this.retryTimer)return this.logger.info("zn.rlh.at has actived, ignore"),!1;if(this.isOverTime)return this.logger.info("zn.rlh.at retry over time, stop retry"),!1;if(1==this.retryActiveCount)this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL);else{var r=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1));this.retryActiveInterval=r>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:r}return this.logger.info("zn.rlh.at interval "+this.retryActiveInterval),this.retryTimer=setTimeout((function(){n.link.destroySocket(),n.link.connectSocket(e,(function(){n.logger.info("zn.rlh.at suc"),n.stopMaxTime(),n.invalid(),n.onactive(!0)}),(function(){n.logger.info("zn.rlh.at fail"),!n.maxTimer&&n.startMaxTime(),n.active(!0)})),n.retryTimer&&clearTimeout(n.retryTimer),n.retryTimer=null,n.retryActiveCount++}),t?0:1e3*this.retryActiveInterval),!0},e.prototype.onactive=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.init=function(e,t,n,r){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,"number"==typeof e&&e<3600&&(this.RETRY_MAX_TIME=e),"number"==typeof t&&(this.RETRY_START_TIME_INTERVAL=t),"number"==typeof n&&(this.RETRY_CONTINUE_COUNT=n),"number"==typeof r&&(this.RETRY_MAX_TIME_INTERVAL=r)},e.prototype.invalid=function(){this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.retryStartTime=0,this.retryActiveCount=1},e}();t.NetRetryLinkHandler=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateCenter=void 0;var r=n(0);t.StateCenter=function(){this.networkState=r.ENUM_NETWORK_STATE.offline,this.useNetAgent=!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLogger=void 0;var r=function(){function e(){}return e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.join(" ");console.log(n)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.join(" ");console.debug(n)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.join(" ");console.info(n)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.join(" ");console.warn(n)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.join(" ");console.error(n)},e}();t.ZegoLogger=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamManager=void 0;var r=n(0),o=n(43),i=function(){function e(e){this.zegoLink=e,this.streamID=1,this.httpStreams=[],this.pcStreams=[]}return e.prototype.createStream=function(e){if(e===r.StreamType.HTTP)return this.getStream(e,this.httpStreams);if(e===r.StreamType.PC){var t=new o.ZegoLinkStream(e,this.streamID++,this.zegoLink);return this.pcStreams.push(t),t}return this.getStream(e,this.httpStreams)},e.prototype.getStream=function(e,t){var n=t.find((function(e){return!0===e.isFree}));if(n)return n.isFree=!1,n.isFirst=!1,n;var r=new o.ZegoLinkStream(e,this.streamID++,this.zegoLink);return this.httpStreams.push(r),r},e.prototype.onPushEvent=function(e,t,n){var r=this.pcStreams.find((function(t){return t.StreamID===e}));r&&r.onPushEvent(t,n)},e.prototype.getStreamID=function(){return this.streamID++},e}();t.StreamManager=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLinkStream=void 0;var r=n(0),o=function(){function e(e,t,n){this.type=e,this.streamID=t,this.zegoLink=n,this.isFree=!1,this.isFirst=!0}return Object.defineProperty(e.prototype,"StreamID",{get:function(){return this.streamID},enumerable:!1,configurable:!0}),e.prototype.refresh=function(e){this.streamID=e},e.prototype.sendMessage=function(e,t,n,o,i,s){var a=this;void 0===n&&(n=null),void 0===o&&(o=null),void 0===i&&(i=null),void 0===s&&(s={timeout:5e3,isInSendMap:!0}),this.zegoLink.sendMessage(e,this.streamID,t,this.isFirst,(function(e){a.type!==r.StreamType.PC&&(a.isFree=!0),n&&n(e)}),(function(e,t,n){a.type!==r.StreamType.PC&&(a.isFree=!0),o&&o(e,t,n)}),i,s)},e.prototype.onPushEvent=function(e,t){},e.prototype.closeStream=function(e,t){this.zegoLink.sendMessage(r.AccessHubMessageType.MSG_TYPE_STREAM_CLOSED,this.streamID,{code:e,msg:t})},e.prototype.isConnect=function(){return this.zegoLink.isConnect()},e}();t.ZegoLinkStream=o}])},module.exports=t()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;var r=function(){function e(){}return e.base64encode=function(t){var n,r,o,i,s,a;for(o=t.length,r=0,n="";r<o;){if(i=255&t.charCodeAt(r++),r==o){n+=e.base64EncodeChars.charAt(i>>2),n+=e.base64EncodeChars.charAt((3&i)<<4),n+="==";break}if(s=t.charCodeAt(r++),r==o){n+=e.base64EncodeChars.charAt(i>>2),n+=e.base64EncodeChars.charAt((3&i)<<4|(240&s)>>4),n+=e.base64EncodeChars.charAt((15&s)<<2),n+="=";break}a=t.charCodeAt(r++),n+=e.base64EncodeChars.charAt(i>>2),n+=e.base64EncodeChars.charAt((3&i)<<4|(240&s)>>4),n+=e.base64EncodeChars.charAt((15&s)<<2|(192&a)>>6),n+=e.base64EncodeChars.charAt(63&a)}return n},e.base64decode=function(t){var n,r,o,i,s,a,c;for(a=t.length,s=0,c="";s<a;){do{n=e.base64DecodeChars[255&t.charCodeAt(s++)]}while(s<a&&-1==n);if(-1==n)break;do{r=e.base64DecodeChars[255&t.charCodeAt(s++)]}while(s<a&&-1==r);if(-1==r)break;c+=String.fromCharCode(n<<2|(48&r)>>4);do{if(61==(o=255&t.charCodeAt(s++)))return c;o=e.base64DecodeChars[o]}while(s<a&&-1==o);if(-1==o)break;c+=String.fromCharCode((15&r)<<4|(60&o)>>2);do{if(61==(i=255&t.charCodeAt(s++)))return c;i=e.base64DecodeChars[i]}while(s<a&&-1==i);if(-1==i)break;c+=String.fromCharCode((3&o)<<6|i)}return c},e.utf16to8=function(e){var t,n,r,o;for(t="",r=e.length,n=0;n<r;n++)(o=e.charCodeAt(n))>=1&&o<=127?t+=e.charAt(n):o>2047?(t+=String.fromCharCode(224|o>>12&15),t+=String.fromCharCode(128|o>>6&63),t+=String.fromCharCode(128|o>>0&63)):(t+=String.fromCharCode(192|o>>6&31),t+=String.fromCharCode(128|o>>0&63));return t},e.utf8to16=function(e){var t,n,r,o,i,s;for(t="",r=e.length,n=0;n<r;)switch((o=e.charCodeAt(n++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(n-1);break;case 12:case 13:i=e.charCodeAt(n++),t+=String.fromCharCode((31&o)<<6|63&i);break;case 14:i=e.charCodeAt(n++),s=e.charCodeAt(n++),t+=String.fromCharCode((15&o)<<12|(63&i)<<6|(63&s)<<0)}return t},e.base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e.base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],e}();t.Base64=r},function(e,t){},function(e,t,n){var r,o,i;e.exports=(i=n(2),o=(r=i).lib.WordArray,r.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var s=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;a<4&&i+.75*a<n;a++)o.push(r.charAt(s>>>6*(3-a)&63));var c=r.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var i=0;i<n.length;i++)r[n.charCodeAt(i)]=i}var s=n.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return function(e,t,n){for(var r=[],i=0,s=0;s<t;s++)if(s%4){var a=n[e.charCodeAt(s-1)]<<s%4*2,c=n[e.charCodeAt(s)]>>>6-s%4*2,u=a|c;r[i>>>2]|=u<<24-i%4*8,i++}return o.create(r,i)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},i.enc.Base64)},function(e,t,n){var r,o,i,s,a,c,u,l;e.exports=(l=n(2),o=(r=l).lib,i=o.WordArray,s=o.Hasher,a=r.algo,c=[],u=a.SHA1=s.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],a=n[4],u=0;u<80;u++){if(u<16)c[u]=0|e[t+u];else{var l=c[u-3]^c[u-8]^c[u-14]^c[u-16];c[u]=l<<1|l>>>31}var h=(r<<5|r>>>27)+a+c[u];h+=u<20?1518500249+(o&i|~o&s):u<40?1859775393+(o^i^s):u<60?(o&i|o&s|i&s)-1894007588:(o^i^s)-899497514,a=s,s=i,i=o<<30|o>>>2,o=r,r=h}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),r.SHA1=s._createHelper(u),r.HmacSHA1=s._createHmacHelper(u),l.SHA1)},function(e,t,n){var r,o,i,s;e.exports=(r=n(2),i=(o=r).lib.Base,s=o.enc.Utf8,void(o.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),a=o.words,c=i.words,u=0;u<n;u++)a[u]^=1549556828,c[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))},function(e,t,n){var r,o,i,s,a,c,u,l,h,p,f,d,_,g,m,y,v,b,E;e.exports=(r=n(2),n(17),void(r.lib.Cipher||(o=r,i=o.lib,s=i.Base,a=i.WordArray,c=i.BufferedBlockAlgorithm,u=o.enc,u.Utf8,l=u.Base64,h=o.algo.EvpKDF,p=i.Cipher=c.extend({cfg:s.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?E:v}return function(t){return{encrypt:function(n,r,o){return e(r).encrypt(t,n,r,o)},decrypt:function(n,r,o){return e(r).decrypt(t,n,r,o)}}}}()}),i.StreamCipher=p.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),f=o.mode={},d=i.BlockCipherMode=s.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),_=f.CBC=function(){var e=d.extend();function t(e,t,n){var r,o=this._iv;o?(r=o,this._iv=void 0):r=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=r[i]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize;t.call(this,e,n,o),r.encryptBlock(e,n),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize,i=e.slice(n,n+o);r.decryptBlock(e,n),t.call(this,e,n,o),this._prevBlock=i}}),e}(),g=(o.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,o=r<<24|r<<16|r<<8|r,i=[],s=0;s<r;s+=4)i.push(o);var c=a.create(i,r);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},i.BlockCipher=p.extend({cfg:p.cfg.extend({mode:_,padding:g}),reset:function(){var e;p.reset.call(this);var t=this.cfg,n=t.iv,r=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=r.createEncryptor:(e=r.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(r,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),m=i.CipherParams=s.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),y=(o.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?a.create([1398893684,1701076831]).concat(n).concat(t):t).toString(l)},parse:function(e){var t,n=l.parse(e),r=n.words;return 1398893684==r[0]&&1701076831==r[1]&&(t=a.create(r.slice(2,4)),r.splice(0,4),n.sigBytes-=16),m.create({ciphertext:n,salt:t})}},v=i.SerializableCipher=s.extend({cfg:s.extend({format:y}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r),i=o.finalize(t),s=o.cfg;return m.create({ciphertext:i,key:n,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),b=(o.kdf={}).OpenSSL={execute:function(e,t,n,r){r||(r=a.random(8));var o=h.create({keySize:t+n}).compute(e,r),i=a.create(o.words.slice(t),4*n);return o.sigBytes=4*t,m.create({key:o,iv:i,salt:r})}},E=i.PasswordBasedCipher=v.extend({cfg:v.cfg.extend({kdf:b}),encrypt:function(e,t,n,r){var o=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=o.iv;var i=v.encrypt.call(this,e,t,o.key,r);return i.mixIn(o),i},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var o=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);return r.iv=o.iv,v.decrypt.call(this,e,t,o.key,r)}}))))},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.RetryRoomHandler=void 0;var i=n(44),s=n(0),a=n(4),c=n(1),u=n(3),l=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.logger=t,o.stateCenter=n,o.room=r,o.loginRoomCallback={},o}return o(t,e),t.prototype.renewLocalToken=function(e,t){this.token=e,this.room.token=this.token;var n=(new Date).getTime(),r=void 0;t&&"number"==typeof t?r=1e3*t:["03","04"].includes(e.substring(0,2))&&(r=1e3*u.ClientUtil.decodeTokenExpire(e.substring(2))-n),r&&this.roomHandler.resetTokenTimer(r-this.stateCenter.local_time_deviation),this.stateCenter.actionListener("_tokenRenewed",e,this.room.roomID)},t.prototype.initRoom=function(e,t,n,r,o,i,s){this.roomHandler=e,this.roomID=t,this.renewLocalToken(n),this.user=r,this.server=o,this.serverBak=i||o,this.config=s},t.prototype.active=function(e){var t,n=this;if(this.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" retry call"),this.roomHandler.setRunState(s.ENUM_RUN_STATE.trylogin),this.room.isMulti&&(null===(t=this.stateCenter.roomModulesList.find((function(e){return!e.isMulti})))||void 0===t?void 0:t.runState)!==s.ENUM_RUN_STATE.login)this.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" service is disconnected, multi room stop retry");else if(this.stateCenter.networkState!=s.ENUM_NETWORK_STATE.offline)if(this.retryTimer)this.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" has actived, ignore");else if(this.isOverTime)this.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" retry over time, stop retry");else{if(1==this.retryActiveCount)this.retryActiveInterval=Math.floor(Math.random()*(1-this.RETRY_START_TIME_INTERVAL)+this.RETRY_START_TIME_INTERVAL);else{var r=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1));this.retryActiveInterval=r>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:r}this.retryTimer=setTimeout((function(){n.roomHandler.login(n.retryActiveCount%2==1?n.server:n.serverBak,n.roomID,n.token,n.user,n.config,(function(e){n.handleLoginFinish(e)}),(function(e,t){n.handleLoginFinish(!1,e,t)})),n.retryTimer&&clearTimeout(n.retryTimer),n.retryTimer=null,n.retryActiveCount++}),e?0:1e3*this.retryActiveInterval)}else this.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" network is broken, stop retry")},t.prototype.startMaxTime=function(){var e=this;this.maxTimer||(this.maxTimer=setTimeout((function(){e.logger.info(a.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" over max time "+e.RETRY_MAX_TIME+"s, stop retry"),e.isOverTime=!0,e.roomHandler.resetRoom(),e.stopMaxTime(),e.invalid(),e.onactive(!1,c.errorCodeList.LOGIN_TIMEOUT),e.loginRoomCallback.fail&&(e.loginRoomCallback.fail(c.errorCodeList.LOGIN_TIMEOUT),e.roomHandler.disconnectedHandle(c.errorCodeList.LOGIN_TIMEOUT),e.resetCallBack())}),1e3*this.RETRY_MAX_TIME))},t.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},t.prototype.onactive=function(e,t){},t.prototype.handleError=function(e,t){if(this.RETRY_MAX_TIME<3)return!1;if(t){var n=void 0,r=void 0,o=void 0;this.stateCenter.useNetAgent?(n=["202002","205030","205035","50116","50117","50118","50119","50120","50121","50122","50123","50124","50125","50126","50127","50128"],r=["40001","40100"],o=["201002","30019"]):(n=["1000002002","1000005030","1000005035","1010","1011","1013","1014","1015","1016","1017","1018","1019","1020","1021","1023"],r=["1100040001","1100040100"]);var i=e.code+"";return this.stateCenter.useNetAgent&&(e.code>=40001&&e.code<=40100||e.code>=50200&&e.code<=50299||(null==o?void 0:o.includes(i)))?(this.room.resetSessionInfo(),!0):!n.includes(i)&&(!!r.includes(i)||this.room.lastRunState==s.ENUM_RUN_STATE.login&&(this.room.sessionID="0",this.invalid(),!0))}return!0},t.prototype.setLoginRoomCallback=function(e,t){this.loginRoomCallback.success=e,this.loginRoomCallback.fail=t},t.prototype.loginFail=function(e){this.roomHandler.resetRoom(),this.stopMaxTime(),this.invalid(),this.onactive(!1,e),this.loginRoomCallback.fail&&(this.loginRoomCallback.fail(e),this.roomHandler.disconnectedHandle(e),this.resetCallBack())},t.prototype.handleLoginFinish=function(e,t,n){t?this.handleError(t,n)?(!this.maxTimer&&this.startMaxTime(),this.active()):(this.roomHandler.resetRoom(),this.stopMaxTime(),this.invalid(),this.onactive(e,t),this.loginRoomCallback.fail&&(this.loginRoomCallback.fail(t),this.roomHandler.disconnectedHandle(t),this.resetCallBack())):(this.stopMaxTime(),this.invalid(),this.onactive(e,{code:0,msg:""}),this.loginRoomCallback.success&&(this.loginRoomCallback.success(e),this.resetCallBack()))},t.prototype.resetCallBack=function(){this.loginRoomCallback.success=void 0,this.loginRoomCallback.fail=void 0},t}(i.TryHandler);t.RetryRoomHandler=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TryHandler=void 0;var r=function(){function e(e,t){this.logger=e,this.stateCenter=t,this.RETRY_MAX_TIME=300,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryTimer=null,this.maxTimer=null,this.retryStartTime=0,this.retryActiveCount=1,this.isOverTime=!1}return e.prototype.init=function(e,t,n,r){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,"number"==typeof e&&e<3600&&(this.RETRY_MAX_TIME=e),"number"==typeof t&&(this.RETRY_START_TIME_INTERVAL=t),"number"==typeof n&&(this.RETRY_CONTINUE_COUNT=n),"number"==typeof r&&(this.RETRY_MAX_TIME_INTERVAL=r)},e.prototype.invalid=function(){this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.retryStartTime=0,this.retryActiveCount=1},e}();t.TryHandler=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkParams=t.RULE_SUCCESS=t.RULE_PARAM_NAME=void 0;var r,o=n(3);!function(e){e.NOT_EMPTY="NOT_EMPTY",e.ILLEGAL_CHARACTERS="ILLEGAL_CHARACTERS",e.TYPE_STRING="TYPE_STRING",e.TYPE_INTEGER="TYPE_INTEGER",e.TYPE_OBJECT="TYPE_OBJECT",e.MAX_LENGTH_10="MAX_LENGTH_10",e.MAX_LENGTH_64="MAX_LENGTH_64",e.MAX_LENGTH_100="MAX_LENGTH_100",e.MAX_LENGTH_128="MAX_LENGTH_128",e.MAX_LENGTH_256="MAX_LENGTH_256",e.MAX_LENGTH_1024="MAX_LENGTH_1024"}(r=t.RULE_PARAM_NAME||(t.RULE_PARAM_NAME={})),t.RULE_SUCCESS={error:{code:0,msg:"suc"}};var i={NOT_EMPTY:function(e,n,r,o,i){return void 0===n||""===n||null===n?(o.error(r+" "+e+" is empty"),i):t.RULE_SUCCESS},ILLEGAL_CHARACTERS:function(e,n,r,i,s){return o.ClientUtil.checkIllegalCharacters(n)?t.RULE_SUCCESS:(i.error(r+" "+e+" contains illegal characters"),s)},TYPE_STRING:function(e,n,r,o,i){return"string"!=typeof n?(o.error(r+" "+e+" must be string"),i):t.RULE_SUCCESS},TYPE_INTEGER:function(e,n,r,i,s){return o.ClientUtil.checkInteger(n,!1)?t.RULE_SUCCESS:(i.error(r+" "+e+"  must be integer number"),s)},TYPE_OBJECT:function(e,n,r,o,i){return n&&"object"==typeof n?t.RULE_SUCCESS:(o.error(r+" "+e+"  must be object"),i)},MAX_LENGTH_10:function(e,n,r,o,i){return n.length>10?(o.error(r+" "+e+" is too long"),i):t.RULE_SUCCESS},MAX_LENGTH_64:function(e,n,r,o,i){return n.length>64?(o.error(r+" "+e+" is too long"),i):t.RULE_SUCCESS},MAX_LENGTH_100:function(e,n,r,o,i){return n.length>100?(o.error(r+" "+e+" is too long"),i):t.RULE_SUCCESS},MAX_LENGTH_128:function(e,n,r,o,i){return n.length>128?(o.error(r+" "+e+" is too long"),i):t.RULE_SUCCESS},MAX_LENGTH_256:function(e,n,r,o,i){return n.length>256?(o.error(r+" "+e+" is too long"),i):t.RULE_SUCCESS},MAX_LENGTH_1024:function(e,n,r,o,i){return n.length>1024?(o.error(r+" "+e+" is too long"),i):t.RULE_SUCCESS}};t.checkParams=function(e,n){var o=[],s={};for(var a in e){s[e[a].order]=e[a],e[a].key=a}for(var c in s)o.push(s[c]);for(var u=0;u<o.length;u++)for(var l=o[u].rules,h=0;h<l.length;h++){var p={key:o[u].key,value:o[u].value,action:n.action,logger:n.logger},f=p.key,d=p.value,_=p.action,g=p.logger,m=l[h].name?""+l[h].name:"";if((void 0===d&&m===r.NOT_EMPTY||void 0!==d)&&i[m]){var y=i[m](f,d,_,g,l[h]);if(y!=t.RULE_SUCCESS)return y}}return t.RULE_SUCCESS}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateCenter=void 0;var r=n(0),o=n(4),i=n(6),s=function(){function e(e,t){this.logger=e,this.dataReport=t,this._debug=!1,this.appConfigFetched=!1,this.requestList={},this.mode=r.Mode.MODE_ONLINE,this._testEnvironment=!1,this._env=0,this.type="PUBLIC",this.debugCustom=!1,this.configOK=!1,this.role=2,this.relateService=[],this.maxMemberCount=0,this.roomCreateFlag=1,this.local_time_deviation=0,this.callbackList={},this.listenerList={roomUserUpdate:[],roomOnlineUserCountUpdate:[],getAnchorInfo:[],_getAnchorInfo:[],IMRecvCustomCommand:[],IMRecvBroadcastMessage:[],recvReliableMessage:[],roomExtraInfoUpdate:[],IMRecvBarrageMessage:[],recvJoinLiveRequest:[],recvInviteJoinLiveRequest:[],recvEndJoinLiveCommand:[],roomLoginResponse:[],_roomLogin:[],_appConfigRsp:[],HBResponse:[],roomStateUpdate:[],_roomStateUpdate:[],_getTotalUserList:[],_userStateUpdate:[],_recvBigRoomMessage:[],_recvRoomMsg:[],_kickout:[],tokenWillExpire:[],_tokenExpired:[],roomStateChanged:[],hallStateUpdate:[],_hallStateUpdate:[],roomTokenWillExpire:[],_tokenRenewed:[],_protobufResponse:[],_cloudSettingNotify:[],_settingCanFetch:[]},this.reportList={},this.reportSeqList={login:0,relogin:0},this.networkState=r.ENUM_NETWORK_STATE.offline,this.roomRetryTime=300,this.roomModulesList=[],this.isMultiRoom=!1,this.setMultiRoom=!1,this.protoFormat="json",this.settingFetched=!1,this.useNetAgent=!0,this.configRoomAuth=!1,this.configCheckToken=!1,this._sdkVersion="unknown"}return Object.defineProperty(e.prototype,"debug",{get:function(){return this._debug},set:function(e){this._debug=e,r.LoggerStateCenter.getInstance().debug=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"testEnvironment",{get:function(){return this._testEnvironment},set:function(e){this._testEnvironment=e,r.LoggerStateCenter.getInstance().testEnvironment=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ENV",{get:function(){return this._env},set:function(e){this._env=e,r.LoggerStateCenter.getInstance().ENV=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roomid",{get:function(){return this.roomModulesList[0]?this.roomModulesList[0].roomID:""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverTimeOffset",{get:function(){return this.roomModulesList[0]?this.roomModulesList[0].messageHandler.serverTimeOffset:0},enumerable:!1,configurable:!0}),e.prototype.getRequestId=function(){return this.idName+"-"+r.getSeq()},e.prototype.actionListener=function(e){for(var t=this,n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];if(this.listenerList[e]){var a=r.getReportSeq();this.dataReport.newReport(a,i.ZegoRTMLogEvent.kZegoListener.event),this.dataReport.addMsgInfo(a,{listener:e,params:n}),this.dataReport.uploadReport(a)}this.listenerList[e]&&this.listenerList[e].forEach((function(r){try{r.apply(void 0,n)}catch(n){t.logger.error(o.ZEGO_RTM_ACTION.STATE_ACTION+" ",e," ",JSON.stringify(n))}}))},e.prototype.onListener=function(e,t){return this.listenerList[e]?"function"!=typeof t?(this.logger.error(o.ZEGO_RTM_ACTION.ON_LISTENER+" listener callBack must be funciton"),!1):(-1==this.listenerList[e].indexOf(t)&&this.listenerList[e].push(t),!0):(this.logger.error(o.ZEGO_RTM_ACTION.ON_LISTENER+" event "+e+" no found"),!1)},Object.defineProperty(e.prototype,"sdKVersion",{get:function(){return this._sdkVersion},set:function(e){this._sdkVersion=e},enumerable:!1,configurable:!0}),e}();t.StateCenter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveRoomModules=void 0;var r=n(0),o=n(20),i=n(48),s=n(21),a=n(3),c=n(1),u=n(8),l=function(){function e(e,t,n,a,c,u,l){this.roomID=e,this.stateCenter=t,this.logger=n,this.dataReport=a,this.service=c,this.rtm=u,this.liveRoomHandler=l,this.runState=r.ENUM_RUN_STATE.logout,this.lastRunState=r.ENUM_RUN_STATE.logout,this.lastRoomState="DISCONNECTED",this.roomState="DISCONNECTED",this.roomSessionID="0",this.sessionID="0",this.isMulti=!1,this.token="",this.thirdToken="",this.maxMemberCount=0,this.lvKey="",this.roomName="",this.roomHandler=new i.RoomHandler(this.logger,this.stateCenter,this.dataReport,this.service,this,l),this.heartBeatHandler=new o.HeartBeatHandler(this.logger,this.stateCenter,this.dataReport,this.service,this.liveRoomHandler,this),this.userHandler=new s.UserHandler(this.logger,this.stateCenter,this.dataReport,this.service,this.liveRoomHandler,this),this.initMessageHandler(),this.initLiveHandler(),this.init()}return e.prototype.initMessageHandler=function(){},e.prototype.initLiveHandler=function(){},e.prototype.init=function(){this.bindHeatBeatHandler(),this.bindRoomHandler(),this.bindMessageHandler(),this.bindLiveHandler()},e.prototype.bindHeatBeatHandler=function(){var e=this;this.heartBeatHandler.hbLogout=function(t){e.roomHandler.handleHbLogout(t)},this.heartBeatHandler.heartbeatRspNotiFy=function(t){e.messageHandler&&e.messageHandler.loginRsp(t),e.userHandler.patchUserList(t),e.HBResponse(t)}},e.prototype.bindRoomHandler=function(){var e=this;this.roomHandler.loginSuccessCallBack=function(t,n){e.heartBeatHandler.init(n),e.stateCenter.useNetAgent?e.liveRoomHandler.startCheck():e.service.startCheck(),e.userHandler.loginRsp(n,t),e.messageHandler&&e.messageHandler.loginRsp(n),e.isMulti||e.handleMultiRoom(),e.roomLoginResponse(n)},this.roomHandler.resetRoomCallBack=function(){e.heartBeatHandler.resetHeartbeat(),e.liveHandler&&e.liveHandler.resetLiveHandler(),e.messageHandler&&e.messageHandler.resetMessageInfo(),e.stateCenter.useNetAgent&&e.liveRoomHandler&&e.liveRoomHandler.stopCheck(),e.userHandler.resetUserHandler(),e.roomTryHandler&&(e.roomTryHandler.invalid(),e.roomTryHandler.stopMaxTime())}},e.prototype.bindUserHandler=function(){},e.prototype.bindMessageHandler=function(){},e.prototype.bindLiveHandler=function(){},e.prototype.HBResponse=function(e){this.stateCenter.actionListener("HBResponse",e)},e.prototype.roomLoginResponse=function(e){this.stateCenter.actionListener("roomLoginResponse",e)},e.prototype.handleMultiRoom=function(){var e=this;this.stateCenter.roomModulesList.forEach((function(t){t.runState!==r.ENUM_RUN_STATE.login&&t.roomTryHandler&&1==t.isMulti&&(t.roomTryHandler.onactive=function(n,r){if(r&&0!==r.code){if(0!==r.code){var o=a.ClientUtil.getLiveRoomError(r.code,e.stateCenter.useNetAgent);o&&c.errorCodeList[o]&&(r=c.errorCodeList[o])}t.roomHandler.roomStateHandle("DISCONNECTED",u.ZegoRoomStateChangedReason.ReconnectFailed,r,r.msg)}else t.roomHandler.roomStateHandle("CONNECTED",u.ZegoRoomStateChangedReason.Reconnected,r)},t.roomTryHandler.startMaxTime(),t.roomTryHandler.active())}))},e.prototype.isLogin=function(){return this.runState===r.ENUM_RUN_STATE.login},e.prototype.isDisConnect=function(){return this.stateCenter.useNetAgent?this.liveRoomHandler.isDisConnect():this.service.isDisConnect()},e.prototype.resetSessionInfo=function(){var e;this.logger.info("zm.lrm.rsi call"),this.sessionID="0",this.roomSessionID="0",null===(e=this.liveRoomHandler)||void 0===e||e.reset()},e}();t.LiveRoomModules=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RoomHandler=void 0;var r=n(0),o=n(3),i=n(4),s=n(1),a=n(6),c=n(8),u=function(){function e(e,t,n,r,o,i){this.logger=e,this.stateCenter=t,this.dataReport=n,this.service=r,this.room=o,this.liveRoomHandler=i,this.tryLoginTimer=null,this.tryLoginCount=0,this.tryLoginInterval=1e4,this.tokenTimer=null,this.beforeExpire=30,this.loginCallback={}}return e.prototype.resetTokenTimer=function(e){var t=this;e=(e=(e-=3e4)<0?0:e)>2147483647?2147483647:e,this.logger.info(i.ZEGO_RTM_ACTION.ROOM_RESETTOKEN_TIMER+"  call: "+e),this.tokenTimer&&clearTimeout(this.tokenTimer),this.tokenTimer=setTimeout((function(){t.stateCenter.actionListener("tokenWillExpire",t.room.roomID),t.stateCenter.actionListener("roomTokenWillExpire",t.room.roomID)}),e)},e.prototype.stopTokenTimer=function(){this.tokenTimer&&clearTimeout(this.tokenTimer),this.tokenTimer=null},e.prototype.setRunState=function(e){this.room.runState!==e&&(this.room.lastRunState=this.room.runState,this.room.runState=e)},e.prototype.resetTryLogin=function(){this.tryLoginTimer&&clearTimeout(this.tryLoginTimer),this.tryLoginTimer=null},e.prototype.resetRoom=function(e){var t,n=this;if(this.logger.info(i.ZEGO_RTM_ACTION.ROOM_RESET_ROOM+" call"),this.stateCenter.roomModulesList.length>1&&!e&&(this.room.isMulti=!0),this.resetTryLogin(),"0"!==this.room.sessionID&&this.room.runState!==r.ENUM_RUN_STATE.logout&&!this.room.isDisConnect()){var o=function(e){n.handleLogoutRsp(e,!n.room.isMulti)};(this.stateCenter.useNetAgent?this.liveRoomHandler:this.service).logout(this.room,o,o)}this.setRunState(r.ENUM_RUN_STATE.logout),this.room.sessionID="0",this.room.roomSessionID="0",this.room.isMulti||(this.stateCenter.userid="",this.logger.setSessionInfo(this.stateCenter.appid,this.room.roomID,this.room.sessionID,this.stateCenter.idName,this.stateCenter.nickName,this.stateCenter.sdKVersion),this.stateCenter.useNetAgent?null===(t=this.liveRoomHandler)||void 0===t||t.reset():this.service.closeSocket()),this.resetRoomCallBack(),this.stateCenter.roomModulesList=this.stateCenter.roomModulesList.filter((function(e){return e!==n.room}));var s=this.stateCenter.roomModulesList[0];s&&(s.isMulti=!1,s.runState!==r.ENUM_RUN_STATE.login&&s.roomTryHandler&&(s.roomTryHandler.startMaxTime(),s.roomTryHandler.active())),this.logger.info(i.ZEGO_RTM_ACTION.ROOM_RESET_ROOM+" call success")},e.prototype.resetRoomCallBack=function(){},e.prototype.loginSuccessCallBack=function(e,t){},e.prototype.handlePushKickout=function(e,t,n){var c=this;if(this.logger.info(i.ZEGO_RTM_ACTION.ROOM_KICK_OUT+"  call "+JSON.stringify(e)),n||this.room.sessionID===e.header.session_id||this.room.sessionID===e.body.session_id){var u=r.getReportSeq();this.dataReport.newReport(u,a.ZegoRTMLogEvent.kZegoTaskKickout.event),this.dataReport.addMsgInfo(u,{user_id:a.ZegoRTMLogEvent.kZegoTaskKickout.user_id(this.stateCenter.idName)});var l=o.ClientUtil.getKickoutError(e.body.reason||e.body.kickout_reason,this.stateCenter.useNetAgent);this.dataReport.addMsgInfo(u,{error:l.code,message:l.message}),this.dataReport.uploadReport(u);var h=this.room.roomTryHandler;if(h)if(h.onactive=function(e,t){c.disconnectedHandle(t),c.stateCenter.actionListener("_kickout",t)},e.body.need_relogin&&1==e.body.need_relogin)this.room.sessionID="0",h.startMaxTime(),h.active();else{this.setRunState(r.ENUM_RUN_STATE.logout),this.resetRoom(t);var p={};if(e&&e.body.custom_reason)p.custom_kickout_message=e.body.custom_reason;else if(l.name&&s.errorCodeList[l.name]){var f=e.body.reason||e.body.kickout_reason;p.custom_kickout_message=s.errorCodeList[l.name].msg+"; kickout reason: "+f}l.name&&s.errorCodeList[l.name]?this.disconnectedHandle(s.errorCodeList[l.name],{extendedData:JSON.stringify(p),isKickout:!0}):this.disconnectedHandle(s.errorCodeList.ROOM_INNER_ERROR,{extendedData:JSON.stringify(p),isKickout:!0}),this.stateCenter.actionListener("_kickout",{code:s.errorCodeList.MANUAL_KICKOUT.code,msg:s.errorCodeList.MANUAL_KICKOUT.msg+e.body.reason||e.body.kickout_reason})}else this.logger.info(i.ZEGO_RTM_ACTION.ROOM_KICK_OUT+" try handler no found")}else this.logger.info(i.ZEGO_RTM_ACTION.ROOM_KICK_OUT+" session id wrong, ignore")},e.prototype.handleHbLogout=function(e){var t=this,n=this.room.roomTryHandler;n&&(n.onactive=function(e,n){t.disconnectedHandle(n)},[s.errorCodeList.HEARTBEAT_TIMEOUT,s.errorCodeList.SOCKET_CLOSE,s.errorCodeList.TIMEOUT].includes(e)||[105,152,2001].includes(null==e?void 0:e.code)||e.msg.endsWith("1000002001")||e.msg.endsWith("1000000152")||e.msg.endsWith("1000000105")?(n.startMaxTime(),this.stateCenter.useNetAgent&&this.room.resetSessionInfo(),n.active()):(n.stopMaxTime(),n.invalid(),this.resetRoom(),this.disconnectedHandle(e)))},e.prototype.onDisconnect=function(e){var t=this;if(this.logger.error(i.ZEGO_RTM_ACTION.ROOM_DISCONNECT+" "+e.msg),"string"==typeof e.code&&"Error.Network"===e.code)this.dataReport.addMsgInfo(this.stateCenter.reportSeqList.relogin,{error:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.error.ROOM_DISCONNECT.code,message:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.error.ROOM_DISCONNECT.msg});else if("number"==typeof e.code){var n=void 0;(n=e.code<2e9&&e.code>1e9||e.code<1e6?o.ClientUtil.decodeServerError(e.code,e.msg):{code:e.code,message:e.msg})&&this.dataReport.addMsgInfo(this.stateCenter.reportSeqList.relogin,{error:n.code,message:n.message})}this.dataReport.uploadReport(this.stateCenter.reportSeqList.relogin),this.stateCenter.reportSeqList.relogin=0,o.ClientUtil.unregisterCallback(a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event,this.stateCenter.reportList);var r=this.room.roomTryHandler;r?(r.onactive=function(e,n){n&&0!==n.code?t.roomStateHandle("DISCONNECTED",c.ZegoRoomStateChangedReason.ReconnectFailed,n):t.roomStateHandle("CONNECTED",c.ZegoRoomStateChangedReason.Reconnected,n)},r.startMaxTime(),r.active()):this.logger.error(i.ZEGO_RTM_ACTION.ROOM_DISCONNECT+" try handler no found")},e.prototype.onConnecting=function(e){this.roomStateHandle("CONNECTING",c.ZegoRoomStateChangedReason.Logining,e)},e.prototype.disconnectedHandle=function(e,t){if(e&&0!==e.code){this.stopTokenTimer();var n=(null==t?void 0:t.isKickout)?c.ZegoRoomStateChangedReason.Kickout:c.ZegoRoomStateChangedReason.ReconnectFailed;this.roomStateHandle("DISCONNECTED",n,e,null==t?void 0:t.extendedData)}else this.roomStateHandle("CONNECTED",c.ZegoRoomStateChangedReason.Reconnected,e,null==t?void 0:t.extendedData)},e.prototype.roomStateHandle=function(e,t,n,r){var o,s,a;this.logger.info(i.ZEGO_RTM_ACTION.ROOM_STATUS_CALLBACK+" "+e+" "+JSON.stringify(n)),t&&[c.ZegoRoomStateChangedReason.LoginFailed,c.ZegoRoomStateChangedReason.ReconnectFailed].includes(t)&&(t=(null===(o=this.room.roomTryHandler)||void 0===o?void 0:o.loginRoomCallback.fail)?c.ZegoRoomStateChangedReason.LoginFailed:c.ZegoRoomStateChangedReason.ReconnectFailed),t&&[c.ZegoRoomStateChangedReason.Logined,c.ZegoRoomStateChangedReason.Reconnected].includes(t)&&(t=(null===(s=this.room.roomTryHandler)||void 0===s?void 0:s.loginRoomCallback.success)?c.ZegoRoomStateChangedReason.Logined:c.ZegoRoomStateChangedReason.Reconnected),t&&[c.ZegoRoomStateChangedReason.Logining,c.ZegoRoomStateChangedReason.Reconnecting].includes(t)&&(t=(null===(a=this.room.roomTryHandler)||void 0===a?void 0:a.loginRoomCallback.success)?c.ZegoRoomStateChangedReason.Logining:c.ZegoRoomStateChangedReason.Reconnecting),this.room.lastRoomState=this.room.roomState,this.room.roomState=e,this.room.roomState!==this.room.lastRoomState&&(this.stateCenter.actionListener("_roomStateUpdate",this.room.roomID,e,n?n.code:0,r),this.stateCenter.actionListener("roomStateUpdate",this.room.roomID,e,n?n.code:0,r),this.stateCenter.actionListener("roomStateChanged",this.room.roomID,t,n?n.code:0,r))},e.prototype.login=function(e,t,n,c,u,l,h){if(this.logger.info(i.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" call:"+t+" "+n),!this.room.isMulti&&this.logger.setSessionInfo(this.stateCenter.appid,t,"",c.userID,"",this.stateCenter.sdKVersion),u&&(u.userUpdate&&"boolean"==typeof u.userUpdate&&(this.stateCenter.userStateUpdate=u.userUpdate),u.maxMemberCount&&"number"==typeof u.maxMemberCount&&(this.room.maxMemberCount=u.maxMemberCount)),!this.stateCenter.configOK)return this.logger.error(i.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" init sdk wrong"),void h(s.errorCodeList.INIT);if(this.room.runState!==r.ENUM_RUN_STATE.trylogin&&this.setRunState(r.ENUM_RUN_STATE.trylogin),this.room.roomID=t,this.room.token=n,this.room.thirdToken=n,this.stateCenter.idName=c.userID,this.stateCenter.nickName=c.userName||c.userID,this.loginCallback.success=l,this.loginCallback.fail=h,0===this.stateCenter.reportSeqList.login){var p=r.getReportSeq();this.stateCenter.reportSeqList.relogin=p,this.dataReport.newReport(p,a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event),this.dataReport.addMsgInfo(p,{server:e}),o.ClientUtil.logReportCallback(a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event,this.dataReport,p,this.stateCenter.reportList)}this.resetTryLogin(),this.onConnecting({code:0,msg:""}),this.tryLogin(e),this.logger.info(i.ZEGO_RTM_ACTION.ROOM_LOGIN_ROOM+" call success")},e.prototype.tryLogin=function(e){var t,n=this;if(this.room.runState===r.ENUM_RUN_STATE.trylogin){var s=0!==this.stateCenter.reportSeqList.login?a.ZegoRTMLogEvent.kZegoTaskLoginRoom.event:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event;if(this.stateCenter.useNetAgent){if(this.room.isMulti&&this.room.isDisConnect())return void this.logger.warn(i.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" liveroom is not connected");var c=function(e,t){n.handleLoginRsp(e,t)};(null===(t=this.liveRoomHandler)||void 0===t?void 0:t.isUaConnect())?this.liveRoomHandler.login(this.room,c,c):(this.tryLoginTimer=setTimeout((function(){n.logger.info(i.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" over time no response, login timeout"),n.loginCallback.fail&&n.loginCallback.fail(a.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.LOGIN_TIMEOUT)}),this.tryLoginInterval),this.logger.warn(i.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" ua is not connected"))}else{if(this.service.isDisConnect())try{this.service.closeSocket(),this.logger.debug(i.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" new websocket"),o.ClientUtil.actionSuccessCallback(s,this.stateCenter.reportList)&&(this.tryLoginCount>1&&o.ClientUtil.actionSuccessCallback(s,this.stateCenter.reportList)(r.REPORT_ACTION.eventEnd,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.create_socket.event),o.ClientUtil.actionSuccessCallback(s,this.stateCenter.reportList)(r.REPORT_ACTION.eventStart,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.create_socket.event),o.ClientUtil.actionSuccessCallback(s,this.stateCenter.reportList)(r.REPORT_ACTION.addEventMsg,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.create_socket.event,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.create_socket.server("server"),e)),this.service.createSocket(e),this.service.openHandler((function(){n.openHandler()})),this.service.closeHandler((function(e){n.logger.error(i.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" close "+JSON.stringify(e.code?e.code:e)),n.service.closeSocket(),n.closeHandler(e)})),this.service.errorHandler((function(e){n.logger.error(i.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" error "+JSON.stringify(e.code?e.code:e)),n.service.closeSocket(),n.closeHandler(e)}))}catch(e){this.logger.error(i.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+"  websocket err:"+JSON.stringify(e))}else{this.logger.info(i.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" use current websocket and sent login"),o.ClientUtil.actionSuccessCallback(s,this.stateCenter.reportList)&&o.ClientUtil.actionSuccessCallback(s,this.stateCenter.reportList)(r.REPORT_ACTION.eventStart,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.liveroom_login.event);c=function(e,t){n.handleLoginRsp(e,t)};this.service.login(this.room,c,c)}this.tryLoginTimer=setTimeout((function(){n.logger.info(i.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" over time no response, login timeout"),n.loginCallback.fail&&n.loginCallback.fail(a.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.LOGIN_TIMEOUT)}),this.tryLoginInterval),this.logger.info(i.ZEGO_RTM_ACTION.ROOM_TRY_LOGIN+" call success")}}else this.logger.error("zb.rh.tl state error")},e.prototype.openHandler=function(){var e=this;this.logger.info(i.ZEGO_RTM_ACTION.ROOM_OPEN_HANDLER+" websocket.onpen call");var t=0!==this.stateCenter.reportSeqList.login?a.ZegoRTMLogEvent.kZegoTaskLoginRoom.event:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event;o.ClientUtil.actionSuccessCallback(t,this.stateCenter.reportList)&&o.ClientUtil.actionSuccessCallback(t,this.stateCenter.reportList)(r.REPORT_ACTION.eventEndWithMsgInfo,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.create_socket.event,{try_cnt:this.tryLoginCount}),this.service.onPush(),o.ClientUtil.actionSuccessCallback(t,this.stateCenter.reportList)&&o.ClientUtil.actionSuccessCallback(t,this.stateCenter.reportList)(r.REPORT_ACTION.eventStart,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.liveroom_login.event);var n=function(t,n){e.handleLoginRsp(t,n)};this.service.login(this.room,n,n)},e.prototype.handleLoginRsp=function(e,t){this.logger.info(i.ZEGO_RTM_ACTION.ROOM_HANDLE_LOGINRSP+" seq: "+t+" "+JSON.stringify(e));var n=0!==this.stateCenter.reportSeqList.login?a.ZegoRTMLogEvent.kZegoTaskLoginRoom.event:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event;if(o.ClientUtil.actionSuccessCallback(n,this.stateCenter.reportList)&&o.ClientUtil.actionSuccessCallback(n,this.stateCenter.reportList)(r.REPORT_ACTION.eventEndWithMsgInfo,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.liveroom_login.event),this.room.runState===r.ENUM_RUN_STATE.trylogin)if(e.header&&e.body){if(e.header.seq!==t&&0==this.room.isMulti)return void this.logger.error(i.ZEGO_RTM_ACTION.ROOM_HANDLE_LOGINRSP+" in wrong seq, local=",t+"",",recv=",e.header.seq);0!==e.body.err_code?(this.logger.error(i.ZEGO_RTM_ACTION.ROOM_HANDLE_LOGINRSP+" server error=",e.body.err_code),this.handleLoginFail(e)):(this.logger.info(i.ZEGO_RTM_ACTION.ROOM_HANDLE_LOGINRSP+" call success."),this.handleLoginSuccess(e))}else this.logger.error(i.ZEGO_RTM_ACTION.ROOM_HANDLE_LOGINRSP+" "+JSON.stringify(e)),this.handleLoginFail(e);else this.logger.error(i.ZEGO_RTM_ACTION.ROOM_HANDLE_LOGINRSP+" state error")},e.prototype.handleLoginFail=function(e){this.resetTryLogin();var t=a.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.INNER_ERROR;e.header&&e.body?t=o.ClientUtil.getServerError(e.body.err_code):e.code&&e.msg&&(t=e),this.loginCallback.fail&&this.loginCallback.fail(t,!0)},e.prototype.handleLoginSuccess=function(e){var t,n={},i=this.room.lastRunState;this.setRunState(r.ENUM_RUN_STATE.login),this.stateCenter.userid=e.body.user_id,this.room.sessionID=e.body.session_id,this.room.roomSessionID=e.body.room_session_id,this.room.lvKey=e.body.lv_key;var s=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.token_remain_time;if(this.stateCenter.configRoomAuth=s>0,e.body.ret_timestamp&&["03","04"].includes(this.room.token.substring(0,2))){var u=(new Date).getTime(),l=u-e.body.ret_timestamp;this.stateCenter.local_time_deviation=l<5e3?0:l;var h=s>0?1e3*s:1e3*o.ClientUtil.decodeTokenExpire(this.room.token.substring(2))-u;this.resetTokenTimer(h-this.stateCenter.local_time_deviation)}if(!this.room.isMulti&&this.logger.setSessionInfo(this.stateCenter.appid,this.room.roomID,this.room.sessionID,this.stateCenter.idName,this.stateCenter.nickName,this.stateCenter.sdKVersion),!this.stateCenter.useNetAgent){if(e.body.config_info){var p=this.stateCenter.settingConfig.getSetting("remote_log_level",!0)||e.body.config_info.log_level;this.logger.setRemoteLogLevel(p),n.log_level=p,""==e.body.config_info.log_url||this.logger.url||(this.logger.setLogServer(e.body.config_info.log_url),n.log_url=e.body.config_info.log_url)}e.body.cluster_env&&1===e.body.cluster_env&&(this.stateCenter.testEnvironment=!0,n.test_environment="true",!this.stateCenter.debugCustom&&(this.stateCenter.debug=!0))}var f=0!==this.stateCenter.reportSeqList.login?a.ZegoRTMLogEvent.kZegoTaskLoginRoom.event:a.ZegoRTMLogEvent.kZegoTaskReLoginRoom.event;o.ClientUtil.actionSuccessCallback(f,this.stateCenter.reportList)&&o.ClientUtil.actionSuccessCallback(f,this.stateCenter.reportList)(r.REPORT_ACTION.addEventMsg,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.liveroom_login.event,a.ZegoRTMLogEvent.kZegoTaskLoginRoom.subEvent.liveroom_login.respond_info("respond_info"),n),this.resetTryLogin(),this.loginSuccessCallBack(i,e),this.roomStateHandle("CONNECTED",c.ZegoRoomStateChangedReason.Logined,{code:0,msg:""}),this.loginCallback.success&&this.loginCallback.success(!0)},e.prototype.closeHandler=function(e){this.logger.error(i.ZEGO_RTM_ACTION.ROOM_CLOSEHANDLER+" room websocket close "+JSON.stringify(e.code?e.code:e)),this.room.runState!==r.ENUM_RUN_STATE.logout?this.room.runState===r.ENUM_RUN_STATE.trylogin?(this.resetTryLogin(),this.loginCallback.fail&&this.loginCallback.fail(1006==e.code?a.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.LOGIN_TIMEOUT:e)):this.room.runState===r.ENUM_RUN_STATE.login&&(this.logger.info(i.ZEGO_RTM_ACTION.ROOM_CLOSEHANDLER+" is called because of network broken"),this.resetTryLogin(),this.onDisconnect(a.ZegoRTMLogEvent.kZegoTaskLoginRoom.error.NETWORK_BROKEN)):this.logger.info(i.ZEGO_RTM_ACTION.ROOM_CLOSEHANDLER+" onclose logout flow call websocket.close")},e.prototype.logout=function(e){this.logger.info(i.ZEGO_RTM_ACTION.ROOM_LOGOUT+" call"),this.room.runState!==r.ENUM_RUN_STATE.logout?(this.resetRoom(e),this.roomStateHandle("DISCONNECTED",c.ZegoRoomStateChangedReason.Logout,{code:0,msg:""}),this.stopTokenTimer(),this.logger.info(i.ZEGO_RTM_ACTION.ROOM_LOGOUT+" call success")):this.logger.warn("zb.rh.lo at logout")},e.prototype.handleLogoutRsp=function(e,t){var n;this.logger.info(i.ZEGO_RTM_ACTION.ROOM_LOGOUT+" result=",e.body&&e.body.err_code?e.body.err_code:"-1"),this.stateCenter.useNetAgent&&t&&(null===(n=this.liveRoomHandler)||void 0===n||n.closeRequest())},e}();t.RoomHandler=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveRoomModules=void 0;var r=n(0),o=n(20),i=n(21),s=function(){function e(e,t,n,s,a){this.stateCenter=e,this.logger=t,this.dataReport=n,this.service=s,this.rtm=a,this.roomID="",this._dispatchServer="",this.deviceID="",this.deviceType="",this.anType=0,this.sessionExpire="",this.pri_roomID="",this.roomSid="0",this.roomFlag=1,this.timeStamp=0,this.netType=2,this.userSeq=0,this.hallRunState=r.ENUM_RUN_STATE.logout,this.hallToken="",this.roomSessionID="",this.lastHallRunState=r.ENUM_RUN_STATE.logout,this.runRoomState=r.ENUM_RUN_STATE.logout,this.lastRunRoomState=r.ENUM_RUN_STATE.logout,this.lastHallState="DISCONNECTED",this.hallState="DISCONNECTED",this.lastRoomState="DISCONNECTED",this.roomState="DISCONNECTED",this.sessionID="",this.initHandler(),this.heartBeatHandler=new o.HeartBeatHandler(this.logger,this.stateCenter,this.dataReport,this.service,void 0,this),this.userHandler=new i.UserHandler(this.logger,this.stateCenter,this.dataReport,this.service,void 0,this),this.initMessageHandler(),this.init()}return e.prototype.initMessageHandler=function(){},e.prototype.initHandler=function(){},e.prototype.init=function(){this.bindSocketHandler(),this.bindHeatBeatHandler(),this.bindMessageHandler(),this.bindLiveHandler()},e.prototype.bindSocketHandler=function(){var e=this;this.service.handlePushUserStateUpdateMsg=function(t){e.userHandler.handlePushUserStateUpdateMsg(t)}},e.prototype.bindHeatBeatHandler=function(){var e=this;this.heartBeatHandler.hbLogout=function(e){},this.heartBeatHandler.heartbeatRspNotiFy=function(t){e.HBResponse(t)}},e.prototype.bindHallHandler=function(){},e.prototype.bindUserHandler=function(){},e.prototype.bindMessageHandler=function(){},e.prototype.bindLiveHandler=function(){},e.prototype.bindRoomHandler=function(){},e.prototype.handleHbLogout=function(e){},e.prototype.HBResponse=function(e){this.stateCenter.actionListener("HBResponse",e)},e.prototype.roomLoginResponse=function(e){this.stateCenter.actionListener("roomLoginResponse",e)},e.prototype.isLogin=function(){return this.hallRunState===r.ENUM_RUN_STATE.login},e}();t.LiveRoomModules=s},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.LiveRoomPrivateService=void 0;var i=n(23),s=n(0),a=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.stateCenter=t,o.logger=n,o.service=new i.ZegoSocketService(o.stateCenter.ENV),o.cmdSeq=0,o.responseRouters={},o}return o(t,e),t.prototype.checkResponse=function(e){return e.header.app_id!==this.stateCenter.appid||e.header.user_uid!==this.stateCenter.userid||this.stateCenter.priModules.hallRunState!==s.ENUM_RUN_STATE.login},t.prototype.handleHallKickout=function(e){},t.prototype.handlePushKickout=function(e){},t.prototype.handlePushCustomMsg=function(e){},t.prototype.handlePushRoomMsg=function(e){},t.prototype.handlePushUserStateUpdateMsg=function(e){},t.prototype.handlePushMergeMsg=function(e){},t.prototype.handlePushTransMsg=function(e){},t.prototype.handleBigImMsgRsp=function(e){},t.prototype.handlePushSignalMsg=function(e){},t.prototype.closeHandler=function(e){this.service.closeHandler(e)},t.prototype.openHandler=function(e){this.service.openHandler(e)},t.prototype.errorHandler=function(e){this.service.errorHandler(e)},t.prototype.getHeader=function(e){return{cmd:e,seq:++this.cmdSeq,timestamp:Math.ceil((new Date).getTime()/1e3)+"",app_id:this.stateCenter.appid,user_uid:this.stateCenter.userid||"0",session_id:this.stateCenter.priModules.sessionID||"0"}},t.prototype.startCheck=function(){this.service.startCheck()},t.prototype.stopCheck=function(){this.service.stopCheck()},t.prototype.isDisConnect=function(){return!this.service||this.service.isDisConnect()},t.prototype.closeSocket=function(){this.service.closeSocket()},t.prototype.on=function(e,t){this.responseRouters[e]=t},t}(n(22).LiveRoomService);t.LiveRoomPrivateService=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSettingConfig=void 0;var r=function(){function e(){this.defaultSetting={remote_log_level:"info"},this.requestList={},this.setting=JSON.parse(JSON.stringify(this.defaultSetting))}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setSetting=function(e,t){var n=Array.isArray(t)&&t.length>0;for(var r in e)if("number"==typeof e[r].ctrlmode&&[1,2].includes(e[r].ctrlmode))this.setting[r]=e[r],this.setting[r+"_ctrlmode"]=e[r].ctrlmode;else for(var o in e[r])if(!o.endsWith("_ctrlmode")){if(n&&-1==t.indexOf(o))continue;var i=e[r][o+"_ctrlmode"];1===i||2===i?this.setting[o]=e[r][o]:this.defaultSetting[o]&&(this.setting[o]=this.defaultSetting[o]),"number"==typeof i&&(this.setting[o+"_ctrlmode"]=e[r][o+"_ctrlmode"])}},e.prototype.getSetting=function(e,t){return void 0===t&&(t=!1),t?2==this.setting[e+"_ctrlmode"]?this.setting[e]:void 0:this.setting[e]},e}();t.ZegoSettingConfig=r},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LiveRoomHandler=t.LIVEROOM_STATE=void 0;var u=n(0),l=n(12),h=c(n(12)),p=s(n(24)),f=n(12),d=n(1),_=n(67),g=n(72),m=n(73),y=c(n(13)),v=n(3),b=n(19),E=n(4),O=n(8);p.util.Long=y.default,p.configure();var T,S=1001,R=1002,k=1003,C=1004;!function(e){e[e.disconnected=0]="disconnected",e[e.broken=1]="broken",e[e.connected=2]="connected"}(T=t.LIVEROOM_STATE||(t.LIVEROOM_STATE={}));var w=function(){function e(e,t,n,r){var o=this;this.logger=e,this.stateCenter=t,this.ua=n,this.rtm=r,this.seq=0,this.controls=new Uint8Array(1),this.flags=new Uint8Array(1),this.sendCommandList=new u.LinkedList,this.sendCommandMap={},this.isEncrypt=!1,this.sendDataCheckOnceCount=100,this.sendDataDropTimeout=1e4,this.sendDataCheckInterval=2e3,this.protoInstance=h.default,this.swPushCmdList=["/sw/push","/sw/merge_push","/sw/push_kickout","/sw/push_redirect"],this.onSwitchCmdList=["/lr/login_room_rsp","/lr/logout_room_rsp","/sw/push_kickout","/sw/push","/sw/merge_push"],this.unEncryptCmdList=["/lr/login_room","/lr/login_room_rsp"],this.whiteboardPushCmdList=["/edu/push/set_room","/edu/push/set_user","/edu/push/joinlive","/edu/push/set_mod","/edu/push/draw_graphics","/edu/push/clear_graphics","/edu/push/draw_page_graphics","/edu/push/clear_page_graphics","/edu/push/clear_user_graphic_list","/edu/push/qaa","/edu/push/set_user_auth","/edu/push/set_room_auth"],this.state=T.disconnected,this.unStructCmdList=["/lr/push/joinlive_request","/lr/push/joinlive_result","/lr/push/joinlive_invite","/lr/push/joinlive_stop"],this.joinLiveMap={"/lr/push/joinlive_request":11001,"/lr/push/joinlive_result":11002,"/lr/push/joinlive_invite":11003,"/lr/push/joinlive_stop":11004},this.reloginToken="",this.crypto=new _.Crypto,this.liveroomRequest=this.ua.getPCRequest(u.BusinessService.SERVICE_SWITCH4LIVEROOM),this.switchSessionID=y.default.fromInt(0),this.liveroomRequest.on("connected",(function(e){o.handleConnected(e)})),this.liveroomRequest.on("broken",(function(){o.handleBroken()})),this.liveroomRequest.on("disconnected",(function(e,t){o.handleDisconnected(e,t)})),this.liveroomRequest.on("downLoadMessage",(function(e){o.handlePush(e)}))}return Object.defineProperty(e.prototype,"nickName",{get:function(){return g.encodeString(this.stateCenter.nickName)},enumerable:!1,configurable:!0}),e.prototype.isDisConnect=function(){return this.state!==T.connected},e.prototype.getHeader=function(e){var t={cmd:e,seq:++this.seq,timestamp:(new Date).getTime(),session_id:this.switchSessionID,controls:this.controls,flags:this.flags},n=l.proto_switch.Header.create(t),r=l.proto_switch.Header.encode(n).finish();return[t.seq,r]},e.prototype.isUaConnect=function(){return this.ua.isConnect()},e.prototype.sendMessage=function(e,t,n,r,o,i){var s,a=this;if(void 0===o&&(o={timeout:6e3}),void 0===i&&(i=!0),this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDMESSAGE+" call"),"/lr/login_room"!==e&&this.state!==T.connected)return this.logger.warn(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDMESSAGE+" state "+this.state),-1;var c=this.getHeader(e),u=c[1],l=t;!this.unEncryptCmdList.includes(e)&&this.isEncrypt&&(l=this.crypto.encrypt(t));var h=this.getHead(u.length,l.length),p=new Uint8Array(Array.from(h).concat(Array.from(u)).concat(Array.from(l)));if(i){var f={seq:this.seq,deleted:!1,sendTime:Date.parse(new Date+""),timeout:o.timeout,success:n,error:function(e,t){var n,o,i;a.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDMESSAGE+" seq: "+t+" "+JSON.stringify(e)),"/lr/login_room_rsp"!==(null===(n=null==e?void 0:e.header)||void 0===n?void 0:n.cmd)&&[1002,105].indexOf(null===(o=null==e?void 0:e.body)||void 0===o?void 0:o.err_code)>-1?a.rtm.retryRoom():([207,208].indexOf(null===(i=null==e?void 0:e.body)||void 0===i?void 0:i.err_code),r&&r(e,t))}},d=this.sendCommandList.push(f);this.sendCommandMap[f.seq]=d}this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDMESSAGE+" seq: "+c[0]+" cmd: "+e);var _="/lr/login_room"===e;return null===(s=this.liveroomRequest)||void 0===s||s.sendRequest({payload:p,ack:_},(function(e){a.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDMESSAGE+" fail")}),(function(){a.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDMESSAGE+" ack")})),c[0]},e.prototype.getHead=function(e,t){var n=new Uint8Array(7);return n[0]=33,n[1]=e>>8,n[2]=e-(n[1]<<8),n.set(new Uint8Array(Int32Array.from([t]).buffer).reverse(),3),n},e.prototype.handlePush=function(e){if(33===e[0]){var t=(e[1]<<8)+e[2],n=l.proto_switch.Header.decode(e.slice(7,7+t)),r=e.slice(7+t),o=r;if(!this.unEncryptCmdList.includes(n.cmd)&&this.isEncrypt&&(o=this.crypto.decrypt(r)),!m.LiveroomProMap[n.cmd])return this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_HANDLEPUSH+" cmd is not rtc"),void this.onSwitchMessage(n,o);var i=this.decodeResponseBody(n,o);if(this.swPushCmdList.includes(n.cmd))this.handleSwitchPush(n,i);else{this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_HANDLEPUSH+" down "+JSON.stringify(this.transBuf(i)));var s={header:this.transHeader(n),body:this.transRsp(i)};this.handleSendCommandMsgRsp(s)}}},e.prototype.handleSwitchPush=function(e,t){if("/sw/push"===e.cmd){var n=(c=this.transRsp(t.head)).room_id;if(!this.stateCenter.roomModulesList.find((function(e){return e.roomID==n})))return void this.logger.warn(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_HANDLESWITCHPUSH+" room no found ignore ");var r=void 0,o={header:c,body:r=this.unStructCmdList.includes(t.head.sub_cmd)?{signal_msg:g.decodeString(t.msg_body),sub_cmd:this.joinLiveMap[t.head.sub_cmd]}:"/lr/push/signal_custom"===t.head.sub_cmd?{custommsg:g.decodeString(t.msg_body)}:m.LiveroomProMap[t.head.sub_cmd]?this.transRsp(this.decode(f.liveroom_cs[m.LiveroomProMap[t.head.sub_cmd]],t.msg_body)):{}};if(this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_HANDLESWITCHPUSH+" push "+JSON.stringify(this.transBuf(o))),this.whiteboardPushCmdList.includes(t.head.sub_cmd))this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_HANDLESWITCHPUSH+" white "),this.onSwitchMessage(e,t);else switch(t.head.sub_cmd){case"/lr/push/user_updated":this.handlePushUserStateUpdateMsg(o);break;case"/lr/push/user_kickout":this.handlePushKickout(o,!1);break;case"/lr/push/trans":this.handlePushTransMsg(o);break;case"/lr/push/im_chat":this.handlePushRoomMsg(o);break;case"/lr/push/signal_custom":this.handlePushCustomMsg(o);break;case"/lr/push/stream_add":case"/lr/push/stream_delete":case"/lr/push/stream_update":this.handlePushStreamMsg(o);break;case"/lr/push/joinlive_request":case"/lr/push/joinlive_result":case"/lr/push/joinlive_invite":case"/lr/push/joinlive_stop":this.handlePushSignalMsg(o);break;case"/lr/push/user_token_expire":this.handlePushTokenExpire(o)}if(1==t.head.qos_flag){var i={code:0,message:"",sub_cmd:t.head.sub_cmd,msg_id:t.head.msg_id,server_send_time:t.head.send_time},s=l.proto_switch.PushRsp.create(i),a=l.proto_switch.PushRsp.encode(s).finish();this.sendMessage("/sw/push_rsp",a,void 0,void 0)}}else if("/sw/merge_push"===e.cmd){var c,u=(c=this.transRsp(t.head)).room_id;if(!this.stateCenter.roomModulesList.find((function(e){return e.roomID==u})))return void this.logger.warn(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_HANDLESWITCHPUSH+" room no found ignore ");var h=[];t.messages.forEach((function(e){var t;h.push({sub_cmd:e.sub_cmd,sub_seq:e.sub_seq,msg_id:e.msg_id}),"/lr/push/bigim_chat"===e.sub_cmd&&(t=f.liveroom_cs.PushBigImChat.decode(e.msg_body),e.msg_body=t)}));var p={header:(r=this.transRsp(t)).head,body:r};if(delete p.body.head,this.handlePushMergeMsg(p),1==t.head.qos_flag){i={messages:h},s=l.proto_switch.CmdMergePushRsp.create(i),a=l.proto_switch.CmdMergePushRsp.encode(s).finish();this.sendMessage("/sw/merge_push_rsp",a,void 0,void 0)}}else if("/sw/push_kickout"===e.cmd){r={reason:t.reason>900?t.reason-900:t.reason,msg:t.message,need_relogin:void 0!==t.need_relogin?t.need_relogin:0};this.handlePushKickout({header:e,body:r},!0)}},e.prototype.handlePushTokenExpire=function(e){var t,n,r,o,i=null===(n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.stop_stream)||void 0===n?void 0:n.stream_id_list.map((function(e){return g.decodeString(e)}));null===(o=null===(r=null==e?void 0:e.body)||void 0===r?void 0:r.stop_stream)||void 0===o||(o.stream_id_list=i),this.stateCenter.actionListener("_tokenExpired",e)},e.prototype.handlePushKickout=function(e,t){var n,r;if(t)a(this.stateCenter.roomModulesList).forEach((function(t){t.roomHandler.handlePushKickout(e,!0,!0)}));else{var o=null===(n=null==e?void 0:e.header)||void 0===n?void 0:n.room_id,i=this.stateCenter.roomModulesList.find((function(e){return e.roomID==o}));if(this.longToStringNumber(e.body,["session_id"],"toString"),!i)return void this.logger.error(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_PUSHKICKOUT+" room no found ignore "+JSON.stringify(null===(r=e.header)||void 0===r?void 0:r.room_id));i.roomHandler.handlePushKickout(e)}},e.prototype.handlePushStreamMsg=function(e){},e.prototype.handlePushSignalMsg=function(e){},e.prototype.handlePushMergeMsg=function(e){},e.prototype.handlePushCustomMsg=function(e){},e.prototype.handlePushRoomMsg=function(e){},e.prototype.handlePushTransMsg=function(e){},e.prototype.onSwitchMessage=function(e,t){},e.prototype.decodeResponseBody=function(e,t){var n=this.onSwitchCmdList.includes(e.cmd)?"proto_switch":"liveroom_cs";return this.decode(this.protoInstance[n][m.LiveroomProMap[e.cmd]],t)},e.prototype.handlePushUserStateUpdateMsg=function(e){var t,n=null===(t=null==e?void 0:e.header)||void 0===t?void 0:t.room_id,r=this.stateCenter.roomModulesList.find((function(e){return e.roomID==n}));if(r){var o={body:{user_actions:e.body.user_list.map((function(e){return{Action:e.action,IdName:e.id_name,NickName:e.nick_name,Role:e.role,LoginTime:e.login_time.toString()}})),user_list_seq:e.body.server_user_seq.toNumber(),room_id:e.body.room_id}};r.userHandler.handlePushUserStateUpdateMsg(o)}else this.logger.error(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_PUSHUSERUPDATE+" room no found ignore "+JSON.stringify(e))},e.prototype.login=function(e,t,n){var o=this;this.state==T.disconnected&&(this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_LOGIN+" state disconnect"),this.closeRequest());var i=(new Date).getTime()+"";if(e.isMulti){var s={req_head:this.getReqHead(e),switch_session_id:this.switchSessionID,nick_name:this.nickName,role:this.stateCenter.role,net_type:v.ClientUtil.getNetTypeNum(),config:{room_create_flag:this.stateCenter.roomCreateFlag,user_state_flag:this.stateCenter.userStateUpdate?1:0},lv_key:e.lvKey,third_token:g.encodeString(e.token),user_count_limit:e.maxMemberCount,relate_service:this.stateCenter.relateService.join()||"",conn_type:2,room_name:g.encodeString(e.roomName)},a=r(r({},s),{room_name:e.roomName,third_token:e.token});this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_LOGIN+" enter "+JSON.stringify(a));var c=f.liveroom_cs.EnterReq.create(s),h=f.liveroom_cs.EnterReq.encode(c).finish();this.sendMessage("/lr/room/enter",h,(function(e,n){o.longToStringNumber(e.body,["user_session_id","room_session_id","ret_timestamp"],"toString"),o.transKeysName(e.body,[["user_session_id","session_id"],["hb_interval","hearbeat_interval"]]),o.keysExist(e.body,["token_remain_time","stream_seq"]),t&&t(e,n)}),(function(e,t){n&&n(e,t)}))}else{var p={app_id:this.stateCenter.appid,id_name:g.encodeString(this.stateCenter.idName),device_id:this.stateCenter.deviceID,term_type:this.stateCenter.ENV%2==0?u.TermType.TT_WEB:u.TermType.TT_MINIPROGRAM,net_type:v.ClientUtil.getNetTypeNum(),sdk_ver:parseInt(this.rtm.version.replace(/\./g,"")),proto_ver:b.PROTO_VER,nick_name:this.nickName,client_stamp:g.encodeString(i),crypt_version:b.CRYPT_VERSION,k1_sign:this.crypto.generateK1Sign(),relogin_token:this.switchSessionID.notEquals(y.default.fromInt(0))?g.encodeString(this.reloginToken):"",role:this.stateCenter.role,liveroom_session_id:y.default.fromString(e.roomSessionID),room_id:g.encodeString(e.roomID),room_name:g.encodeString(e.roomName),biz_type:b.BIZ_TYPE,room_create_flag:this.stateCenter.roomCreateFlag,user_state_flag:this.stateCenter.userStateUpdate?1:0,lv_key:e.lvKey,third_token:g.encodeString(e.token),user_count_limit:e.maxMemberCount,relate_service:this.stateCenter.relateService.join()||"",biz_version:this.stateCenter.bizVersion||"",login_logic:this.stateCenter.isMultiRoom?3:1,sdk_conn_type:b.SDK_CONN_TYPE};a=r(r({},p),{id_name:this.stateCenter.idName,nick_name:this.stateCenter.nickName,client_stamp:i,k1_sign:void 0,relogin_token:this.reloginToken,liveroom_session_id:e.roomSessionID,room_id:e.roomID,room_name:e.roomName,third_token:e.token});this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_LOGIN+" login "+JSON.stringify(a)),this.k1SignLogoutBuffer=this.crypto.md5Bytes(p.k1_sign);c=l.proto_switch.LoginRoomReq.create(p),h=l.proto_switch.LoginRoomReq.encode(c).finish();this.sendMessage("/lr/login_room",h,(function(e,n){o.switchSessionID=e.header.session_id,o.reloginToken=e.body.relogin_token,o.crypto.decryptK2Sign(e.body.k2_sign),1===e.body.crypt_option?o.isEncrypt=!1:void 0===e.body.crypt_option&&(o.isEncrypt=!0),o.longToStringNumber(e.body,["liveroom_session_id","room_session_id","ret_timestamp"],"toString"),delete e.body.heartbeat_interval,delete e.body.heartbeat_timeout,o.transKeysName(e.body,[["liveroom_session_id","session_id"],["liveroom_hb_interval","hearbeat_interval"]]),o.keysExist(e.body,["token_remain_time","stream_seq"]),t&&t(e,n)}),(function(e,t){n&&n(e,t)}))}},e.prototype.transKeysName=function(e,t){t.forEach((function(t){e[t[1]]=e[t[0]],delete e[t[0]]}))},e.prototype.keysExist=function(e,t){t.forEach((function(t){void 0===e[t]&&(e[t]=0)}))},e.prototype.longToStringNumber=function(e,t,n){t.forEach((function(t){y.default.isLong(e[t])&&(e[t]=e[t][n]())}))},e.prototype.logout=function(e,t,n){if(e.isMulti){var r={req_head:this.getReqHead(e),switch_session_id:this.switchSessionID,nick_name:this.nickName,role:this.stateCenter.role,config_list:{room_create_flag:this.stateCenter.roomCreateFlag,user_state_flag:this.stateCenter.userStateUpdate?1:0}},o=this.transBuf(r);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_LOGOUT+" quit "+JSON.stringify(o));var i=f.liveroom_cs.QuitReq.create(r),s=f.liveroom_cs.QuitReq.encode(i).finish();return this.sendMessage("/lr/room/quit",s,t,n)}r={logout_code:0,logout_check:this.crypto.md5Bytes(g.encodeString(e.token)),liveroom_session_id:y.default.fromString(e.sessionID),room_id:g.encodeString(e.roomID),role:this.stateCenter.role,nickname:this.nickName,logout_logic:this.stateCenter.isMultiRoom?3:1},o=this.transBuf(r);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_LOGOUT+" logout "+JSON.stringify(o));i=l.proto_switch.LogoutRoomReq.create(r),s=l.proto_switch.LogoutRoomReq.encode(i).finish();return this.sendMessage("/lr/logout_room",s,t,n)},e.prototype.checkSendMessageList=function(e){for(var t=e.getFirst();null!=t;)e.remove(t),t._data&&t._data.error&&setTimeout((function(){t&&t._data&&t._data.error&&t._data.error(d.errorCodeList.TIMEOUT,t._data.seq)}),0),t=e.getFirst()},e.prototype.checkMessageListTimeout=function(e,t){for(var n=e.getFirst(),r=Date.parse(new Date+""),o=0,i=function(){if(n._data&&n._data.sendTime+n._data.timeout>r)return"break";if(n._data&&delete t[n._data.seq],e.remove(n),n._data&&null==n._data.error||n._data&&n._data.sendTime+s.sendDataDropTimeout<r)0;else{var i=n&&n._data&&n._data.error,a=n&&n._data&&n._data.seq;setTimeout((function(){i&&i(d.errorCodeList.TIMEOUT,a)}),0)}if(++o>=s.sendDataCheckOnceCount)return"break";n=e.getFirst()},s=this;null!=n;){if("break"===i())break}},e.prototype.startCheck=function(){var e=this;this.checkMessageListTimeout(this.sendCommandList,this.sendCommandMap),this.sendDataCheckTimer=setTimeout((function(){e.startCheck()}),this.sendDataCheckInterval)},e.prototype.stopCheck=function(){this.checkSendMessageList(this.sendCommandList),clearTimeout(this.sendDataCheckTimer)},e.prototype.handleSendCommandMsgRsp=function(e){var t=this,n=this.sendCommandMap[e.header.seq];if(null!=n){var r=n._data;delete this.sendCommandMap[e.header.seq],this.sendCommandList.remove(n),0===e.body.err_code?setTimeout((function(){r&&null!=r.success&&r.success(e,t.seq)}),0):setTimeout((function(){r&&null!=r.error&&r.error(e,t.seq)}),0)}},e.prototype.getReqHead=function(e){return{room_id:e.roomID,user_session_id:y.default.fromString(e.sessionID),room_session_id:y.default.fromString(e.roomSessionID)}},e.prototype.heartBeat=function(e,t,n){var r=this,o={req_head:this.getReqHead(n),role:this.stateCenter.role,lv_key:n.lvKey},i=f.liveroom_cs.HbReq.create(o),s=f.liveroom_cs.HbReq.encode(i).finish();this.sendMessage("/lr/room/hb",s,(function(t){r.transKeysName(t.body,[["hb_interval","hearbeat_interval"],["hb_timeout","hearbeat_timeout"]]),t.body.server_user_seq=t.body.user_seq.toNumber(),r.longToStringNumber(t.body,["dati_time_window"],"toNumber"),e&&e(t)}),t)},e.prototype.fetchUserList=function(e,t,n,o){var i=this,s=this.getReqHead(o),a=r({req_head:s},e),c=this.transBuf(a);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_FETCH_USER_LIST+" "+JSON.stringify(c));var u=f.liveroom_cs.UserlistReq.create(a),l=f.liveroom_cs.UserlistReq.encode(u).finish();return this.sendMessage("/lr/userlist/userlist",l,(function(e,n){i.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_FETCH_USER_LIST+" suc "+n),i.transKeysName(e.body,[["user_basic_list","user_baseinfos"]]),i.longToStringNumber(e.body,["server_user_seq","server_user_index","ret_user_index"],"toNumber"),t&&t(e,n)}),n)},e.prototype.sendRoomMsg=function(e,t,n,r){var o=this,i={req_head:this.getReqHead(r),msg_category:e.msg_category,msg_priority:e.msg_priority,msg_type:e.msg_type,msg_content:g.encodeString(e.msg_content)},s=this.transBuf(i);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDROOMMSG+" "+JSON.stringify(s));var a=f.liveroom_cs.ImChatReq.create(i),c=f.liveroom_cs.ImChatReq.encode(a).finish();return this.sendMessage("/lr/im/chat",c,(function(e){o.longToStringNumber(e.body,["msg_id"],"toNumber"),t&&t(e)}),n)},e.prototype.sendReliableMessage=function(e,t,n,r){var o={req_head:this.getReqHead(r),role:this.stateCenter.role,nick_name:this.nickName,trans_type:g.encodeString(e.trans_type),trans_data:g.encodeString(e.trans_data),trans_local_seq:e.trans_local_seq,trans_channel:g.encodeString(e.trans_channel)},i=this.transBuf(o);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDRELIABLEMESSAGE+" "+JSON.stringify(i));var s=f.liveroom_cs.TransReq.create(o),a=f.liveroom_cs.TransReq.encode(s).finish();return this.sendMessage("/lr/trans/trans",a,t,n)},e.prototype.fetchReliableMessage=function(e,t,n,r){var o=this.getReqHead(r),i=e.fetch_array.map((function(e){return{trans_type:g.encodeString(e.trans_type),trans_local_seq:e.trans_seq}})),s={req_head:o,trans_channel:g.encodeString(e.trans_channel),fetch_array:i},a=this.transBuf(s);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_FETCHRELIABLEMESSAGE+" "+JSON.stringify(a));var c=f.liveroom_cs.TransFetchReq.create(s),u=f.liveroom_cs.TransFetchReq.encode(c).finish();return this.sendMessage("/lr/trans/transfetch",u,t,n)},e.prototype.sendCustomCommand=function(e,t,n,o){var i=this,s=this.getReqHead(o),a=e.dest_id_name.map((function(e){return{id_name:g.encodeString(e)}})),c=r({req_head:s,dst_userlist:a,push_message:g.encodeString(e.custom_msg)},e),u=this.transBuf(c);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDCUSTOMCOMMAND+" "+JSON.stringify(u));var l=f.liveroom_cs.SignalLiveReq.create(c),h=f.liveroom_cs.SignalLiveReq.encode(l).finish();return this.sendMessage("/lr/signal/livescustom",h,(function(e){t&&t(i.transRsp(e))}),(function(e){n&&n(i.transRspHead(e.rsp_head))}))},e.prototype.sendBigRoomMessage=function(e,t,n,r){var o=this.getReqHead(r),i=e.msgs.map((function(e){return{msg_category:e.msg_category,msg_type:e.msg_type,msg_timestamp:y.default.fromNumber(Date.now()),msg_content:g.encodeString(e.msg_content),bigmsg_client_id:g.encodeString(e.bigmsg_client_id)}})),s={req_head:o,nick_name:this.nickName,role:this.stateCenter.role,msgs:i},a=this.transBuf(s);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDBIGROOMMESSAGE+" "+JSON.stringify(a));var c=f.liveroom_cs.BigimChatReq.create(s),u=f.liveroom_cs.BigimChatReq.encode(c).finish();return this.sendMessage("/lr/bigim/chat",u,t,n)},e.prototype.sendRelayMessage=function(e,t,n,r){var o={req_head:this.getReqHead(r),nick_name:this.nickName,role:this.stateCenter.role,relay_type:g.encodeString(e.relay_type),relay_data:g.encodeString(e.relay_data)},i=f.liveroom_cs.RelayReq.create(o),s=f.liveroom_cs.RelayReq.encode(i).finish();return this.sendMessage("/lr/relay",s,t,n)},e.prototype.sendSignalCmd=function(e,t,n,r){var o="",i="";switch(e.sub_cmd){case k:o="/lr/signal/liveinvite",i="SignalLiveInviteReq";break;case S:o="/lr/signal/liverequest",i="SignalLiveReq";break;case R:o="/lr/signal/liverresult",i="SignalLiveResultReq";break;case C:o="/lr/signal/livestop",i="SignalLiveStopReq"}var s=this.getReqHead(r),a=e.dest_id_name.map((function(e){return{id_name:g.encodeString(e)}})),c={req_head:s,push_message:g.encodeString(e.signal_msg),dst_userlist:a},u=this.transBuf(c);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDSIGNALCMD+" "+JSON.stringify(u));var l=f.liveroom_cs[i].create(c),h=f.liveroom_cs[i].encode(l).finish();f.liveroom_cs[i].decode(h);return this.sendMessage(o,h,t,n)},e.prototype.sendStreamUpdate=function(e,t,n,r){var o,i=this;try{o=JSON.parse(e.stream_msg)}catch(e){}var s,a,c="";this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDSTREAMUPDATE+" "+JSON.stringify(e));var u=this.stateCenter.roomModulesList.find((function(e){return e.roomID==r.roomID}));if(u){switch(e.sub_cmd){case 2001:c="/lr/stream/add",s="StreamAddReq",a={req_head:this.getReqHead(u),stream_id:g.encodeString(o.stream_id),extra_info:g.encodeString(o.extra_info),client_req_seq:this.seq+1,login_mode:1,third_token:g.encodeString(e.third_token||"")};break;case 2002:c="/lr/stream/delete",s="StreamDeleteReq",a={req_head:this.getReqHead(u),stream_id:g.encodeString(o.stream_id),stream_sid:o.stream_sid,client_req_seq:this.seq+1};break;case 2003:c="/lr/stream/update",s="StreamUpdateReq",a={req_head:this.getReqHead(u),stream_id:g.encodeString(o.stream_id),stream_sid:o.stream_sid,client_req_seq:this.seq+1,extra_info:g.encodeString(o.extra_info)}}var l=this.transBuf(a);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDSTREAMUPDATE+" "+JSON.stringify(l));var h=f.liveroom_cs[s].create(a),p=f.liveroom_cs[s].encode(h).finish();this.sendMessage(c,p,(function(e){i.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDSTREAMUPDATE+" suc "+c+" "+JSON.stringify(e)),e.header.room_id=u.roomID,t&&t(e)}),(function(e){i.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDSTREAMUPDATE+" fail "+c+" "+JSON.stringify(e)),n&&n(e)}))}else this.logger.error(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_SENDSTREAMUPDATE+" room no found ignore ")},e.prototype.getStreamList=function(e,t,n,r){var o,i=this.stateCenter.roomModulesList.find((function(e){return e.roomID==r.roomID}));if(i){o={req_head:this.getReqHead(i)};var s=this.transBuf(o);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_GETSTREAMLIST+" "+JSON.stringify(s));var a=f.liveroom_cs.StreamListReq.create(o),c=f.liveroom_cs.StreamListReq.encode(a).finish();this.sendMessage("/lr/stream/list",c,(function(e){t&&t(e)}),(function(e){n&&n(e)}))}else this.logger.error(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_GETSTREAMLIST+" room no found ignore "+r.roomID)},e.prototype.transBuf=function(e){var t=this,n={};return Object.keys(e).forEach((function(r){["logout_check","k2_sign","k1_sign"].includes(r)?n[r]=e[r]:t.transReqBytes(n,e,r)})),n},e.prototype.transReqBytes=function(e,t,n){var r=this;if(y.default.isLong(t[n]))e[n]=t[n].toString();else if("[object Object]"===Object.prototype.toString.call(t[n]))e[n]={},Object.keys(t[n]).forEach((function(o){return r.transReqBytes(e[n],t[n],o)}));else if("[object Array]"===Object.prototype.toString.call(t[n])&&"[object Object]"===Object.prototype.toString.call(t[n][0])){e[n]=[];for(var o=function(o){var i={};Object.keys(t[n][o]).forEach((function(e){r.transReqBytes(i,t[n][o],e)})),e[n].push(i)},i=0;i<t[n].length;i++)o(i)}else"[object Uint8Array]"===Object.prototype.toString.call(t[n])?e[n]=g.decodeString(t[n]):e[n]=t[n]},e.prototype.transHeader=function(e){return e.timestamp=y.default.isLong(e.timestamp)?e.timestamp.toString():e.timestamp,e},e.prototype.transRsp=function(e){var t=this,n=e&&e.rsp_head?this.transRspHead(e.rsp_head):{},o=r(r({},e),n);delete o.rsp_head;var i={};return Object.keys(o).forEach((function(e){"k2_sign"===e?i[e]=o[e]:t.transBytes(i,o,e)})),i},e.prototype.transBytes=function(e,t,n){var r=this;if(y.default.isLong(t[n]))e[n]=t[n];else if("[object Object]"===Object.prototype.toString.call(t[n]))e[n]={},Object.keys(t[n]).forEach((function(o){return r.transBytes(e[n],t[n],o)}));else if("[object Array]"===Object.prototype.toString.call(t[n])&&"[object Object]"===Object.prototype.toString.call(t[n][0])){e[n]=[];for(var o=function(o){var i={};Object.keys(t[n][o]).forEach((function(e){r.transBytes(i,t[n][o],e)})),e[n].push(i)},i=0;i<t[n].length;i++)o(i)}else"[object Uint8Array]"===Object.prototype.toString.call(t[n])?e[n]=g.decodeString(t[n]):e[n]=t[n]},e.prototype.transRspHead=function(e){return e?{err_code:e.code||0,err_message:e.message}:{}},e.prototype.decode=function(e,t){return r({},e.decode(t))},e.prototype.handleDisconnected=function(e,t){var n=this;this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_HANDLEDISCONNECTED+" call"),this.state=T.disconnected,e===u.DisconnectedType.TIMEOUT&&this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&(n.ua.isConnect()?(n.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_HANDLEDISCONNECTED+" ua is connect"),e.roomTryHandler.active()):(n.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_HANDLEDISCONNECTED+" ua is disconnect"),n.ua.connectUa()))}))},e.prototype.handleBroken=function(){this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_HANDLEBROKEN+" call"),this.state=T.broken,this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&(e.roomTryHandler.invalid(),e.roomTryHandler.onactive=function(t,n){e.roomHandler.disconnectedHandle(n)},e.roomTryHandler.startMaxTime(),e.roomHandler.roomStateHandle("CONNECTING",O.ZegoRoomStateChangedReason.Reconnecting,d.errorCodeList.NETWORK_BROKEN))}))},e.prototype.handleConnected=function(e){var t=this;this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_HANDLECONNECTED+" call "+e),this.state=T.connected,e===u.ConnectedType.AUTO?this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&t.ua.isConnect()&&e.roomTryHandler.active()})):this.stateCenter.roomModulesList.forEach((function(e){e.roomTryHandler&&(e.roomTryHandler.stopMaxTime(),e.roomTryHandler.invalid())}))},e.prototype.renewToken=function(e,t,n,r){var o=this,i={req_head:this.getReqHead(r),token:e.token},s=f.liveroom_cs.RenewTokenReq.create(i),a=f.liveroom_cs.RenewTokenReq.encode(s).finish(),c=this.transBuf(i);this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_RENEW_TOKEN+" "+JSON.stringify(c)),this.sendMessage("/lr/token/renew_token",a,(function(e,n){o.keysExist(e.body,["token_remain_time"]),t&&t(e,n)}),n)},e.prototype.reset=function(){this.logger.info(E.ZEGO_RTM_ACTION.LIVEROOMHANDLER_RESET+" call "),this.state=T.disconnected,this.switchSessionID=y.default.fromInt(0),this.sendDataCheckTimer&&clearTimeout(this.sendDataCheckTimer)},e.prototype.closeRequest=function(){var e;null===(e=this.liveroomRequest)||void 0===e||e.closeRequest()},e.prototype.resetSessionInfo=function(){this.switchSessionID=y.default.fromInt(0)},e}();t.LiveRoomHandler=w},function(e,t,n){"use strict";var r=t;function o(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(25),r.BufferWriter=n(62),r.Reader=n(26),r.BufferReader=n(63),r.util=n(5),r.rpc=n(64),r.roots=n(66),r.configure=o,o()},function(e,t,n){"use strict";e.exports=function(e,t){var n=new Array(arguments.length-1),r=0,o=2,i=!0;for(;o<arguments.length;)n[r++]=arguments[o++];return new Promise((function(o,s){n[r]=function(e){if(i)if(i=!1,e)s(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];o.apply(null,t)}};try{e.apply(t||null,n)}catch(e){i&&(i=!1,s(e))}}))}},function(e,t,n){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var o=new Array(64),i=new Array(123),s=0;s<64;)i[o[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;r.encode=function(e,t,n){for(var r,i=null,s=[],a=0,c=0;t<n;){var u=e[t++];switch(c){case 0:s[a++]=o[u>>2],r=(3&u)<<4,c=1;break;case 1:s[a++]=o[r|u>>4],r=(15&u)<<2,c=2;break;case 2:s[a++]=o[r|u>>6],s[a++]=o[63&u],c=0}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=o[r],s[a++]=61,1===c&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};r.decode=function(e,t,n){for(var r,o=n,s=0,a=0;a<e.length;){var c=e.charCodeAt(a++);if(61===c&&s>1)break;if(void 0===(c=i[c]))throw Error("invalid encoding");switch(s){case 0:r=c,s=1;break;case 1:t[n++]=r<<2|(48&c)>>4,r=c,s=2;break;case 2:t[n++]=(15&r)<<4|(60&c)>>2,r=c,s=3;break;case 3:t[n++]=(3&r)<<6|c,s=0}}if(1===s)throw Error("invalid encoding");return n-o},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,n){"use strict";function r(){this._listeners={}}e.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},function(e,t,n){"use strict";function r(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3]}function i(e,r,o){t[0]=e,r[o]=n[3],r[o+1]=n[2],r[o+2]=n[1],r[o+3]=n[0]}function s(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function a(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?o:i,e.writeFloatBE=r?i:o,e.readFloatLE=r?s:a,e.readFloatBE=r?a:s}():function(){function t(e,t,n,r){var o=t<0?1:0;if(o&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((o<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((o<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var i=Math.floor(Math.log(t)/Math.LN2);e((o<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),o=2*(r>>31)+1,i=r>>>23&255,s=8388607&r;return 255===i?s?NaN:o*(1/0):0===i?1401298464324817e-60*o*s:o*Math.pow(2,i-150)*(s+8388608)}e.writeFloatLE=t.bind(null,o),e.writeFloatBE=t.bind(null,i),e.readFloatLE=n.bind(null,s),e.readFloatBE=n.bind(null,a)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function o(e,r,o){t[0]=e,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3],r[o+4]=n[4],r[o+5]=n[5],r[o+6]=n[6],r[o+7]=n[7]}function i(e,r,o){t[0]=e,r[o]=n[7],r[o+1]=n[6],r[o+2]=n[5],r[o+3]=n[4],r[o+4]=n[3],r[o+5]=n[2],r[o+6]=n[1],r[o+7]=n[0]}function s(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function a(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?o:i,e.writeDoubleBE=r?i:o,e.readDoubleLE=r?s:a,e.readDoubleBE=r?a:s}():function(){function t(e,t,n,r,o,i){var s=r<0?1:0;if(s&&(r=-r),0===r)e(0,o,i+t),e(1/r>0?0:2147483648,o,i+n);else if(isNaN(r))e(0,o,i+t),e(2146959360,o,i+n);else if(r>17976931348623157e292)e(0,o,i+t),e((s<<31|2146435072)>>>0,o,i+n);else{var a;if(r<22250738585072014e-324)e((a=r/5e-324)>>>0,o,i+t),e((s<<31|a/4294967296)>>>0,o,i+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=r*Math.pow(2,-c))>>>0,o,i+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,o,i+n)}}}function n(e,t,n,r,o){var i=e(r,o+t),s=e(r,o+n),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+i;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,o,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=n.bind(null,s,0,4),e.readDoubleBE=n.bind(null,a,4,0)}(),e}function o(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function i(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=r(r)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,n){"use strict";var r=t;r.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},r.read=function(e,t,n){if(n-t<1)return"";for(var r,o=null,i=[],s=0;t<n;)(r=e[t++])<128?i[s++]=r:r>191&&r<224?i[s++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[s++]=55296+(r>>10),i[s++]=56320+(1023&r)):i[s++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))},r.write=function(e,t,n){for(var r,o,i=n,s=0;s<e.length;++s)(r=e.charCodeAt(s))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(o=e.charCodeAt(s+1)))?(r=65536+((1023&r)<<10)+(1023&o),++s,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-i}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=n||8192,o=r>>>1,i=null,s=r;return function(n){if(n<1||n>o)return e(n);s+n>r&&(i=e(r),s=0);var a=t.call(i,s,s+=n);return 7&s&&(s=1+(7|s)),a}}},function(e,t,n){"use strict";e.exports=o;var r=n(5);function o(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=o.zero=new o(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var s=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new o(n,r)},o.from=function(e){if("number"==typeof e)return o.fromNumber(e);if(r.isString(e)){if(!r.Long)return o.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new o(e.low>>>0,e.high>>>0):i},o.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;o.fromHash=function(e){return e===s?i:new o((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},o.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},o.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){"use strict";e.exports=i;var r=n(25);(i.prototype=Object.create(r.prototype)).constructor=i;var o=n(5);function i(){r.call(this)}function s(e,t,n){e.length<40?o.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}i._configure=function(){i.alloc=o._Buffer_allocUnsafe,i.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},i.prototype.bytes=function(e){o.isString(e)&&(e=o._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=o.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},i._configure()},function(e,t,n){"use strict";e.exports=i;var r=n(26);(i.prototype=Object.create(r.prototype)).constructor=i;var o=n(5);function i(e){r.call(this,e)}i._configure=function(){o.Buffer&&(i.prototype._slice=o.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},function(e,t,n){"use strict";t.Service=n(65)},function(e,t,n){"use strict";e.exports=o;var r=n(5);function o(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(o.prototype=Object.create(r.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function e(t,n,o,i,s){if(!i)throw TypeError("request must be specified");var a=this;if(!s)return r.asPromise(e,a,t,n,o,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return a.emit("error",e,t),s(e);if(null!==n){if(!(n instanceof o))try{n=o[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",n,t),s(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){s(e)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Crypto=void 0;var o=n(68),i=r(n(15)),s=r(n(69)),a=r(n(18)),c=r(n(70)),u=r(n(16)),l=r(n(71)),h=function(){function e(){}return Object.defineProperty(e.prototype,"publicKey",{get:function(){return"-----BEGIN PUBLIC KEY-----\n        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxtEM51skf+Bg29Mdb+WN\n        IkgbGDZ/wOP4MTntlut65WpPpXOkg2m9EKscmzfE6kUNLYnYV77fZGFSjr+Wkmoz\n        VK1lJ3seswBNyP6X5LUszkf1WoeEyBbfegTf3XkHEeWJ5BlD9syurlA2Fh+cTaNO\n        RNlAGBZO7SdgTHPYAcHu0fAnJZwCZ9+ZZkVnjyTBqQckovMttKqvtoUKcp7NgGve\n        w0OJxFKwIITu1keGdZ+yN9wBul4qJfTy8otOcwGL4bnoABMhCNvJc3xA70BuaaF0\n        fvhxA8diV/2W+qg+LAzdqajLaNciuDHIY5Y+z5kZI1eBa3J3aqUASse4YzzTYv48\n        7wIDAQAB\n        -----END PUBLIC KEY-----"},enumerable:!1,configurable:!0}),e.prototype.encrypt=function(e){var t=i.default.encrypt(this.uint8Array2WordArray(e),this.key2,{iv:this.iv2}).toString();return o.Base64.toUint8Array(t)},e.prototype.decrypt=function(e){return this.wordArray2Uint8Array(i.default.decrypt(o.Base64.fromUint8Array(e),this.key2,{iv:this.iv2}))},e.prototype.generateK1Sign=function(){var e=this.generateNonce();this.key1=a.default.parse(e),this.iv1=s.default.parse(u.default(e).toString().toLowerCase());var t=new l.default;t.setPublicKey(this.publicKey);var n=t.getKey().encrypt(e);return this.wordArray2Uint8Array(s.default.parse(n))},e.prototype.decryptK2Sign=function(e){try{this.key2=i.default.decrypt(o.Base64.fromUint8Array(e),this.key1,{iv:this.iv1}),this.iv2=u.default(this.key2)}catch(e){}},e.prototype.generateNonce=function(){var e=Math.random().toString().substr(2,16);return e.length<16&&(e+=e.substr(0,16-e.length)),e},e.prototype.md5=function(e){return u.default(e).toString()},e.prototype.md5Bytes=function(e){return this.wordArray2Uint8Array(u.default(this.uint8Array2WordArray(e)))},e.prototype.wordArray2Uint8Array=function(e){for(var t=e.words,n=e.sigBytes,r=new Uint8Array(n),o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r[o]=i}return r},e.prototype.uint8Array2WordArray=function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e[r])<<24-r%4*8;return c.default.create(n,t)},e}();t.Crypto=h},function(e,t,n){"use strict";n.r(t),n.d(t,"version",(function(){return r})),n.d(t,"VERSION",(function(){return o})),n.d(t,"atob",(function(){return I})),n.d(t,"atobPolyfill",(function(){return M})),n.d(t,"btoa",(function(){return y})),n.d(t,"btoaPolyfill",(function(){return m})),n.d(t,"fromBase64",(function(){return j})),n.d(t,"toBase64",(function(){return R})),n.d(t,"utob",(function(){return T})),n.d(t,"encode",(function(){return R})),n.d(t,"encodeURI",(function(){return k})),n.d(t,"encodeURL",(function(){return k})),n.d(t,"btou",(function(){return N})),n.d(t,"decode",(function(){return j})),n.d(t,"isValid",(function(){return U})),n.d(t,"fromUint8Array",(function(){return b})),n.d(t,"toUint8Array",(function(){return P})),n.d(t,"extendString",(function(){return B})),n.d(t,"extendUint8Array",(function(){return q})),n.d(t,"extendBuiltins",(function(){return G})),n.d(t,"Base64",(function(){return x}));const r="3.7.2",o=r,i="function"==typeof atob,s="function"==typeof btoa,a="function"==typeof Buffer,c="function"==typeof TextDecoder?new TextDecoder:void 0,u="function"==typeof TextEncoder?new TextEncoder:void 0,l=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),h=(e=>{let t={};return e.forEach((e,n)=>t[e]=n),t})(l),p=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,f=String.fromCharCode.bind(String),d="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(e,t=(e=>e))=>new Uint8Array(Array.prototype.slice.call(e,0).map(t)),_=e=>e.replace(/=/g,"").replace(/[+\/]/g,e=>"+"==e?"-":"_"),g=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),m=e=>{let t,n,r,o,i="";const s=e.length%3;for(let s=0;s<e.length;){if((n=e.charCodeAt(s++))>255||(r=e.charCodeAt(s++))>255||(o=e.charCodeAt(s++))>255)throw new TypeError("invalid character found");t=n<<16|r<<8|o,i+=l[t>>18&63]+l[t>>12&63]+l[t>>6&63]+l[63&t]}return s?i.slice(0,s-3)+"===".substring(s):i},y=s?e=>btoa(e):a?e=>Buffer.from(e,"binary").toString("base64"):m,v=a?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let n=0,r=e.length;n<r;n+=4096)t.push(f.apply(null,e.subarray(n,n+4096)));return y(t.join(""))},b=(e,t=!1)=>t?_(v(e)):v(e),E=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?f(192|t>>>6)+f(128|63&t):f(224|t>>>12&15)+f(128|t>>>6&63)+f(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return f(240|t>>>18&7)+f(128|t>>>12&63)+f(128|t>>>6&63)+f(128|63&t)},O=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,T=e=>e.replace(O,E),S=a?e=>Buffer.from(e,"utf8").toString("base64"):u?e=>v(u.encode(e)):e=>y(T(e)),R=(e,t=!1)=>t?_(S(e)):S(e),k=e=>R(e,!0),C=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,w=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return f(55296+(t>>>10))+f(56320+(1023&t));case 3:return f((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return f((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},N=e=>e.replace(C,w),M=e=>{if(e=e.replace(/\s+/g,""),!p.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,n,r,o="";for(let i=0;i<e.length;)t=h[e.charAt(i++)]<<18|h[e.charAt(i++)]<<12|(n=h[e.charAt(i++)])<<6|(r=h[e.charAt(i++)]),o+=64===n?f(t>>16&255):64===r?f(t>>16&255,t>>8&255):f(t>>16&255,t>>8&255,255&t);return o},I=i?e=>atob(g(e)):a?e=>Buffer.from(e,"base64").toString("binary"):M,L=a?e=>d(Buffer.from(e,"base64")):e=>d(I(e),e=>e.charCodeAt(0)),P=e=>L(D(e)),A=a?e=>Buffer.from(e,"base64").toString("utf8"):c?e=>c.decode(L(e)):e=>N(I(e)),D=e=>g(e.replace(/[-_]/g,e=>"-"==e?"+":"/")),j=e=>A(D(e)),U=e=>{if("string"!=typeof e)return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},H=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),B=function(){const e=(e,t)=>Object.defineProperty(String.prototype,e,H(t));e("fromBase64",(function(){return j(this)})),e("toBase64",(function(e){return R(this,e)})),e("toBase64URI",(function(){return R(this,!0)})),e("toBase64URL",(function(){return R(this,!0)})),e("toUint8Array",(function(){return P(this)}))},q=function(){const e=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,H(t));e("toBase64",(function(e){return b(this,e)})),e("toBase64URI",(function(){return b(this,!0)})),e("toBase64URL",(function(){return b(this,!0)}))},G=()=>{B(),q()},x={version:r,VERSION:o,atob:I,atobPolyfill:M,btoa:y,btoaPolyfill:m,fromBase64:j,toBase64:R,encode:R,encodeURI:k,encodeURL:k,utob:T,btou:N,decode:j,isValid:U,fromUint8Array:b,toUint8Array:P,extendString:B,extendUint8Array:q,extendBuiltins:G}},function(e,t,n){var r;e.exports=(r=n(2),r.enc.Hex)},function(e,t,n){var r;e.exports=(r=n(2),function(){if("function"==typeof ArrayBuffer){var e=r.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,r=[],o=0;o<n;o++)r[o>>>2]|=e[o]<<24-o%4*8;t.call(this,r,n)}else t.apply(this,arguments)}).prototype=e}}(),r.lib.WordArray)},function(e,t,n){"use strict";n.r(t);var r=[,(e,t,n)=>{function r(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function o(e,t){return e&t}function i(e,t){return e|t}function s(e,t){return e^t}function a(e,t){return e&~t}function c(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function u(e){for(var t=0;0!=e;)e&=e-1,++t;return t}n.d(t,{default:()=>ne});var l,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function p(e){var t,n,r="";for(t=0;t+3<=e.length;t+=3)n=parseInt(e.substring(t,t+3),16),r+=h.charAt(n>>6)+h.charAt(63&n);for(t+1==e.length?(n=parseInt(e.substring(t,t+1),16),r+=h.charAt(n<<2)):t+2==e.length&&(n=parseInt(e.substring(t,t+2),16),r+=h.charAt(n>>2)+h.charAt((3&n)<<4));(3&r.length)>0;)r+="=";return r}function f(e){var t,n="",o=0,i=0;for(t=0;t<e.length&&"="!=e.charAt(t);++t){var s=h.indexOf(e.charAt(t));s<0||(0==o?(n+=r(s>>2),i=3&s,o=1):1==o?(n+=r(i<<2|s>>4),i=15&s,o=2):2==o?(n+=r(i),n+=r(s>>2),i=3&s,o=3):(n+=r(i<<2|s>>4),n+=r(15&s),o=0))}return 1==o&&(n+=r(i<<2)),n}var d,_={decode:function(e){var t;if(void 0===d){var n="= \f\n\r\t\u2028\u2029";for(d=Object.create(null),t=0;t<64;++t)d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t)]=t;for(d["-"]=62,d._=63,t=0;t<n.length;++t)d[n.charAt(t)]=-1}var r=[],o=0,i=0;for(t=0;t<e.length;++t){var s=e.charAt(t);if("="==s)break;if(-1!=(s=d[s])){if(void 0===s)throw new Error("Illegal character at offset "+t);o|=s,++i>=4?(r[r.length]=o>>16,r[r.length]=o>>8&255,r[r.length]=255&o,o=0,i=0):o<<=6}}switch(i){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:r[r.length]=o>>10;break;case 3:r[r.length]=o>>16,r[r.length]=o>>8&255}return r},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(e){var t=_.re.exec(e);if(t)if(t[1])e=t[1];else{if(!t[2])throw new Error("RegExp out of sync");e=t[2]}return _.decode(e)}},g=1e13,m=function(){function e(e){this.buf=[+e||0]}return e.prototype.mulAdd=function(e,t){var n,r,o=this.buf,i=o.length;for(n=0;n<i;++n)(r=o[n]*e+t)<g?t=0:r-=(t=0|r/g)*g,o[n]=r;t>0&&(o[n]=t)},e.prototype.sub=function(e){var t,n,r=this.buf,o=r.length;for(t=0;t<o;++t)(n=r[t]-e)<0?(n+=g,e=1):e=0,r[t]=n;for(;0===r[r.length-1];)r.pop()},e.prototype.toString=function(e){if(10!=(e||10))throw new Error("only base 10 is supported");for(var t=this.buf,n=t[t.length-1].toString(),r=t.length-2;r>=0;--r)n+=(g+t[r]).toString().substring(1);return n},e.prototype.valueOf=function(){for(var e=this.buf,t=0,n=e.length-1;n>=0;--n)t=t*g+e[n];return t},e.prototype.simplify=function(){var e=this.buf;return 1==e.length?e[0]:this},e}(),y=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,v=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function b(e,t){return e.length>t&&(e=e.substring(0,t)+""),e}var E,O=function(){function e(t,n){this.hexDigits="0123456789ABCDEF",t instanceof e?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=n)}return e.prototype.get=function(e){if(void 0===e&&(e=this.pos++),e>=this.enc.length)throw new Error("Requesting byte offset "+e+" on a stream of length "+this.enc.length);return"string"==typeof this.enc?this.enc.charCodeAt(e):this.enc[e]},e.prototype.hexByte=function(e){return this.hexDigits.charAt(e>>4&15)+this.hexDigits.charAt(15&e)},e.prototype.hexDump=function(e,t,n){for(var r="",o=e;o<t;++o)if(r+=this.hexByte(this.get(o)),!0!==n)switch(15&o){case 7:r+="  ";break;case 15:r+="\n";break;default:r+=" "}return r},e.prototype.isASCII=function(e,t){for(var n=e;n<t;++n){var r=this.get(n);if(r<32||r>176)return!1}return!0},e.prototype.parseStringISO=function(e,t){for(var n="",r=e;r<t;++r)n+=String.fromCharCode(this.get(r));return n},e.prototype.parseStringUTF=function(e,t){for(var n="",r=e;r<t;){var o=this.get(r++);n+=o<128?String.fromCharCode(o):o>191&&o<224?String.fromCharCode((31&o)<<6|63&this.get(r++)):String.fromCharCode((15&o)<<12|(63&this.get(r++))<<6|63&this.get(r++))}return n},e.prototype.parseStringBMP=function(e,t){for(var n,r,o="",i=e;i<t;)n=this.get(i++),r=this.get(i++),o+=String.fromCharCode(n<<8|r);return o},e.prototype.parseTime=function(e,t,n){var r=this.parseStringISO(e,t),o=(n?y:v).exec(r);return o?(n&&(o[1]=+o[1],o[1]+=+o[1]<70?2e3:1900),r=o[1]+"-"+o[2]+"-"+o[3]+" "+o[4],o[5]&&(r+=":"+o[5],o[6]&&(r+=":"+o[6],o[7]&&(r+="."+o[7]))),o[8]&&(r+=" UTC","Z"!=o[8]&&(r+=o[8],o[9]&&(r+=":"+o[9]))),r):"Unrecognized time: "+r},e.prototype.parseInteger=function(e,t){for(var n,r=this.get(e),o=r>127,i=o?255:0,s="";r==i&&++e<t;)r=this.get(e);if(0==(n=t-e))return o?-1:0;if(n>4){for(s=r,n<<=3;0==(128&(+s^i));)s=+s<<1,--n;s="("+n+" bit)\n"}o&&(r-=256);for(var a=new m(r),c=e+1;c<t;++c)a.mulAdd(256,this.get(c));return s+a.toString()},e.prototype.parseBitString=function(e,t,n){for(var r=this.get(e),o="("+((t-e-1<<3)-r)+" bit)\n",i="",s=e+1;s<t;++s){for(var a=this.get(s),c=s==t-1?r:0,u=7;u>=c;--u)i+=a>>u&1?"1":"0";if(i.length>n)return o+b(i,n)}return o+i},e.prototype.parseOctetString=function(e,t,n){if(this.isASCII(e,t))return b(this.parseStringISO(e,t),n);var r=t-e,o="("+r+" byte)\n";r>(n/=2)&&(t=e+n);for(var i=e;i<t;++i)o+=this.hexByte(this.get(i));return r>n&&(o+=""),o},e.prototype.parseOID=function(e,t,n){for(var r="",o=new m,i=0,s=e;s<t;++s){var a=this.get(s);if(o.mulAdd(128,127&a),i+=7,!(128&a)){if(""===r)if((o=o.simplify())instanceof m)o.sub(80),r="2."+o.toString();else{var c=o<80?o<40?0:1:2;r=c+"."+(o-40*c)}else r+="."+o.toString();if(r.length>n)return b(r,n);o=new m,i=0}}return i>0&&(r+=".incomplete"),r},e}(),T=function(){function e(e,t,n,r,o){if(!(r instanceof S))throw new Error("Invalid tag value.");this.stream=e,this.header=t,this.length=n,this.tag=r,this.sub=o}return e.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},e.prototype.content=function(e){if(void 0===this.tag)return null;void 0===e&&(e=1/0);var t=this.posContent(),n=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(t,t+n,e);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(t)?"false":"true";case 2:return this.stream.parseInteger(t,t+n);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(t,t+n,e);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(t,t+n,e);case 6:return this.stream.parseOID(t,t+n,e);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return b(this.stream.parseStringUTF(t,t+n),e);case 18:case 19:case 20:case 21:case 22:case 26:return b(this.stream.parseStringISO(t,t+n),e);case 30:return b(this.stream.parseStringBMP(t,t+n),e);case 23:case 24:return this.stream.parseTime(t,t+n,23==this.tag.tagNumber)}return null},e.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},e.prototype.toPrettyString=function(e){void 0===e&&(e="");var t=e+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(t+="+"),t+=this.length,this.tag.tagConstructed?t+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(t+=" (encapsulates)"),t+="\n",null!==this.sub){e+="  ";for(var n=0,r=this.sub.length;n<r;++n)t+=this.sub[n].toPrettyString(e)}return t},e.prototype.posStart=function(){return this.stream.pos},e.prototype.posContent=function(){return this.stream.pos+this.header},e.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},e.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},e.decodeLength=function(e){var t=e.get(),n=127&t;if(n==t)return n;if(n>6)throw new Error("Length over 48 bits not supported at position "+(e.pos-1));if(0===n)return null;t=0;for(var r=0;r<n;++r)t=256*t+e.get();return t},e.prototype.getHexStringValue=function(){var e=this.toHexString(),t=2*this.header,n=2*this.length;return e.substr(t,n)},e.decode=function(t){var n;n=t instanceof O?t:new O(t,0);var r=new O(n),o=new S(n),i=e.decodeLength(n),s=n.pos,a=s-r.pos,c=null,u=function(){var t=[];if(null!==i){for(var r=s+i;n.pos<r;)t[t.length]=e.decode(n);if(n.pos!=r)throw new Error("Content size is not correct for container starting at offset "+s)}else try{for(;;){var o=e.decode(n);if(o.tag.isEOC())break;t[t.length]=o}i=s-n.pos}catch(e){throw new Error("Exception while decoding undefined length content: "+e)}return t};if(o.tagConstructed)c=u();else if(o.isUniversal()&&(3==o.tagNumber||4==o.tagNumber))try{if(3==o.tagNumber&&0!=n.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");c=u();for(var l=0;l<c.length;++l)if(c[l].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(e){c=null}if(null===c){if(null===i)throw new Error("We can't skip over an invalid tag with undefined length at offset "+s);n.pos=s+Math.abs(i)}return new e(r,a,i,o,c)},e}(),S=function(){function e(e){var t=e.get();if(this.tagClass=t>>6,this.tagConstructed=0!=(32&t),this.tagNumber=31&t,31==this.tagNumber){var n=new m;do{t=e.get(),n.mulAdd(128,127&t)}while(128&t);this.tagNumber=n.simplify()}}return e.prototype.isUniversal=function(){return 0===this.tagClass},e.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},e}(),R=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],k=(1<<26)/R[R.length-1],C=function(){function e(e,t,n){null!=e&&("number"==typeof e?this.fromNumber(e,t,n):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}return e.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var n,o=(1<<t)-1,i=!1,s="",a=this.t,c=this.DB-a*this.DB%t;if(a-- >0)for(c<this.DB&&(n=this[a]>>c)>0&&(i=!0,s=r(n));a>=0;)c<t?(n=(this[a]&(1<<c)-1)<<t-c,n|=this[--a]>>(c+=this.DB-t)):(n=this[a]>>(c-=t)&o,c<=0&&(c+=this.DB,--a)),n>0&&(i=!0),i&&(s+=r(n));return i?s:"0"},e.prototype.negate=function(){var t=L();return e.ZERO.subTo(this,t),t},e.prototype.abs=function(){return this.s<0?this.negate():this},e.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var n=this.t;if(0!=(t=n-e.t))return this.s<0?-t:t;for(;--n>=0;)if(0!=(t=this[n]-e[n]))return t;return 0},e.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+q(this[this.t-1]^this.s&this.DM)},e.prototype.mod=function(t){var n=L();return this.abs().divRemTo(t,null,n),this.s<0&&n.compareTo(e.ZERO)>0&&t.subTo(n,n),n},e.prototype.modPowInt=function(e,t){var n;return n=e<256||t.isEven()?new N(t):new M(t),this.exp(e,n)},e.prototype.clone=function(){var e=L();return this.copyTo(e),e},e.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},e.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},e.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},e.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},e.prototype.toByteArray=function(){var e=this.t,t=[];t[0]=this.s;var n,r=this.DB-e*this.DB%8,o=0;if(e-- >0)for(r<this.DB&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[o++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=this[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),0!=(128&n)&&(n|=-256),0==o&&(128&this.s)!=(128&n)&&++o,(o>0||n!=this.s)&&(t[o++]=n);return t},e.prototype.equals=function(e){return 0==this.compareTo(e)},e.prototype.min=function(e){return this.compareTo(e)<0?this:e},e.prototype.max=function(e){return this.compareTo(e)>0?this:e},e.prototype.and=function(e){var t=L();return this.bitwiseTo(e,o,t),t},e.prototype.or=function(e){var t=L();return this.bitwiseTo(e,i,t),t},e.prototype.xor=function(e){var t=L();return this.bitwiseTo(e,s,t),t},e.prototype.andNot=function(e){var t=L();return this.bitwiseTo(e,a,t),t},e.prototype.not=function(){for(var e=L(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},e.prototype.shiftLeft=function(e){var t=L();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},e.prototype.shiftRight=function(e){var t=L();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},e.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+c(this[e]);return this.s<0?this.t*this.DB:-1},e.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,n=0;n<this.t;++n)e+=u(this[n]^t);return e},e.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},e.prototype.setBit=function(e){return this.changeBit(e,i)},e.prototype.clearBit=function(e){return this.changeBit(e,a)},e.prototype.flipBit=function(e){return this.changeBit(e,s)},e.prototype.add=function(e){var t=L();return this.addTo(e,t),t},e.prototype.subtract=function(e){var t=L();return this.subTo(e,t),t},e.prototype.multiply=function(e){var t=L();return this.multiplyTo(e,t),t},e.prototype.divide=function(e){var t=L();return this.divRemTo(e,t,null),t},e.prototype.remainder=function(e){var t=L();return this.divRemTo(e,null,t),t},e.prototype.divideAndRemainder=function(e){var t=L(),n=L();return this.divRemTo(e,t,n),[t,n]},e.prototype.modPow=function(e,t){var n,r,o=e.bitLength(),i=B(1);if(o<=0)return i;n=o<18?1:o<48?3:o<144?4:o<768?5:6,r=o<8?new N(t):t.isEven()?new I(t):new M(t);var s=[],a=3,c=n-1,u=(1<<n)-1;if(s[1]=r.convert(this),n>1){var l=L();for(r.sqrTo(s[1],l);a<=u;)s[a]=L(),r.mulTo(l,s[a-2],s[a]),a+=2}var h,p,f=e.t-1,d=!0,_=L();for(o=q(e[f])-1;f>=0;){for(o>=c?h=e[f]>>o-c&u:(h=(e[f]&(1<<o+1)-1)<<c-o,f>0&&(h|=e[f-1]>>this.DB+o-c)),a=n;0==(1&h);)h>>=1,--a;if((o-=a)<0&&(o+=this.DB,--f),d)s[h].copyTo(i),d=!1;else{for(;a>1;)r.sqrTo(i,_),r.sqrTo(_,i),a-=2;a>0?r.sqrTo(i,_):(p=i,i=_,_=p),r.mulTo(_,s[h],i)}for(;f>=0&&0==(e[f]&1<<o);)r.sqrTo(i,_),p=i,i=_,_=p,--o<0&&(o=this.DB-1,--f)}return r.revert(i)},e.prototype.modInverse=function(t){var n=t.isEven();if(this.isEven()&&n||0==t.signum())return e.ZERO;for(var r=t.clone(),o=this.clone(),i=B(1),s=B(0),a=B(0),c=B(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),n?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;o.isEven();)o.rShiftTo(1,o),n?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(t,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(t,c),c.rShiftTo(1,c);r.compareTo(o)>=0?(r.subTo(o,r),n&&i.subTo(a,i),s.subTo(c,s)):(o.subTo(r,o),n&&a.subTo(i,a),c.subTo(s,c))}return 0!=o.compareTo(e.ONE)?e.ZERO:c.compareTo(t)>=0?c.subtract(t):c.signum()<0?(c.addTo(t,c),c.signum()<0?c.add(t):c):c},e.prototype.pow=function(e){return this.exp(e,new w)},e.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var r=t;t=n,n=r}var o=t.getLowestSetBit(),i=n.getLowestSetBit();if(i<0)return t;for(o<i&&(i=o),i>0&&(t.rShiftTo(i,t),n.rShiftTo(i,n));t.signum()>0;)(o=t.getLowestSetBit())>0&&t.rShiftTo(o,t),(o=n.getLowestSetBit())>0&&n.rShiftTo(o,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return i>0&&n.lShiftTo(i,n),n},e.prototype.isProbablePrime=function(e){var t,n=this.abs();if(1==n.t&&n[0]<=R[R.length-1]){for(t=0;t<R.length;++t)if(n[0]==R[t])return!0;return!1}if(n.isEven())return!1;for(t=1;t<R.length;){for(var r=R[t],o=t+1;o<R.length&&r<k;)r*=R[o++];for(r=n.modInt(r);t<o;)if(r%R[t++]==0)return!1}return n.millerRabin(e)},e.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},e.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},e.prototype.fromString=function(t,n){var r;if(16==n)r=4;else if(8==n)r=3;else if(256==n)r=8;else if(2==n)r=1;else if(32==n)r=5;else{if(4!=n)return void this.fromRadix(t,n);r=2}this.t=0,this.s=0;for(var o=t.length,i=!1,s=0;--o>=0;){var a=8==r?255&+t[o]:H(t,o);a<0?"-"==t.charAt(o)&&(i=!0):(i=!1,0==s?this[this.t++]=a:s+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&+t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&e.ZERO.subTo(this,this)},e.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},e.prototype.dlShiftTo=function(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s},e.prototype.drShiftTo=function(e,t){for(var n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s},e.prototype.lShiftTo=function(e,t){for(var n=e%this.DB,r=this.DB-n,o=(1<<r)-1,i=Math.floor(e/this.DB),s=this.s<<n&this.DM,a=this.t-1;a>=0;--a)t[a+i+1]=this[a]>>r|s,s=(this[a]&o)<<n;for(a=i-1;a>=0;--a)t[a]=0;t[i]=s,t.t=this.t+i+1,t.s=this.s,t.clamp()},e.prototype.rShiftTo=function(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t)t.t=0;else{var r=e%this.DB,o=this.DB-r,i=(1<<r)-1;t[0]=this[n]>>r;for(var s=n+1;s<this.t;++s)t[s-n-1]|=(this[s]&i)<<o,t[s-n]=this[s]>>r;r>0&&(t[this.t-n-1]|=(this.s&i)<<o),t.t=this.t-n,t.clamp()}},e.prototype.subTo=function(e,t){for(var n=0,r=0,o=Math.min(e.t,this.t);n<o;)r+=this[n]-e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r-=e[n],t[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[n++]=this.DV+r:r>0&&(t[n++]=r),t.t=n,t.clamp()},e.prototype.multiplyTo=function(t,n){var r=this.abs(),o=t.abs(),i=r.t;for(n.t=i+o.t;--i>=0;)n[i]=0;for(i=0;i<o.t;++i)n[i+r.t]=r.am(0,o[i],n,i,0,r.t);n.s=0,n.clamp(),this.s!=t.s&&e.ZERO.subTo(n,n)},e.prototype.squareTo=function(e){for(var t=this.abs(),n=e.t=2*t.t;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()},e.prototype.divRemTo=function(t,n,r){var o=t.abs();if(!(o.t<=0)){var i=this.abs();if(i.t<o.t)return null!=n&&n.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=L());var s=L(),a=this.s,c=t.s,u=this.DB-q(o[o.t-1]);u>0?(o.lShiftTo(u,s),i.lShiftTo(u,r)):(o.copyTo(s),i.copyTo(r));var l=s.t,h=s[l-1];if(0!=h){var p=h*(1<<this.F1)+(l>1?s[l-2]>>this.F2:0),f=this.FV/p,d=(1<<this.F1)/p,_=1<<this.F2,g=r.t,m=g-l,y=null==n?L():n;for(s.dlShiftTo(m,y),r.compareTo(y)>=0&&(r[r.t++]=1,r.subTo(y,r)),e.ONE.dlShiftTo(l,y),y.subTo(s,s);s.t<l;)s[s.t++]=0;for(;--m>=0;){var v=r[--g]==h?this.DM:Math.floor(r[g]*f+(r[g-1]+_)*d);if((r[g]+=s.am(0,v,r,m,0,l))<v)for(s.dlShiftTo(m,y),r.subTo(y,r);r[g]<--v;)r.subTo(y,r)}null!=n&&(r.drShiftTo(l,n),a!=c&&e.ZERO.subTo(n,n)),r.t=l,r.clamp(),u>0&&r.rShiftTo(u,r),a<0&&e.ZERO.subTo(r,r)}}},e.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},e.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},e.prototype.exp=function(t,n){if(t>4294967295||t<1)return e.ONE;var r=L(),o=L(),i=n.convert(this),s=q(t)-1;for(i.copyTo(r);--s>=0;)if(n.sqrTo(r,o),(t&1<<s)>0)n.mulTo(o,i,r);else{var a=r;r=o,o=a}return n.revert(r)},e.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},e.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),n=Math.pow(e,t),r=B(n),o=L(),i=L(),s="";for(this.divRemTo(r,o,i);o.signum()>0;)s=(n+i.intValue()).toString(e).substr(1)+s,o.divRemTo(r,o,i);return i.intValue().toString(e)+s},e.prototype.fromRadix=function(t,n){this.fromInt(0),null==n&&(n=10);for(var r=this.chunkSize(n),o=Math.pow(n,r),i=!1,s=0,a=0,c=0;c<t.length;++c){var u=H(t,c);u<0?"-"==t.charAt(c)&&0==this.signum()&&(i=!0):(a=n*a+u,++s>=r&&(this.dMultiply(o),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(n,s)),this.dAddOffset(a,0)),i&&e.ZERO.subTo(this,this)},e.prototype.fromNumber=function(t,n,r){if("number"==typeof n)if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),i,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(n);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(e.ONE.shiftLeft(t-1),this);else{var o=[],s=7&t;o.length=1+(t>>3),n.nextBytes(o),s>0?o[0]&=(1<<s)-1:o[0]=0,this.fromString(o,256)}},e.prototype.bitwiseTo=function(e,t,n){var r,o,i=Math.min(e.t,this.t);for(r=0;r<i;++r)n[r]=t(this[r],e[r]);if(e.t<this.t){for(o=e.s&this.DM,r=i;r<this.t;++r)n[r]=t(this[r],o);n.t=this.t}else{for(o=this.s&this.DM,r=i;r<e.t;++r)n[r]=t(o,e[r]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()},e.prototype.changeBit=function(t,n){var r=e.ONE.shiftLeft(t);return this.bitwiseTo(r,n,r),r},e.prototype.addTo=function(e,t){for(var n=0,r=0,o=Math.min(e.t,this.t);n<o;)r+=this[n]+e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r+=e[n],t[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t[n++]=r:r<-1&&(t[n++]=this.DV+r),t.t=n,t.clamp()},e.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},e.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},e.prototype.multiplyLowerTo=function(e,t,n){var r=Math.min(this.t+e.t,t);for(n.s=0,n.t=r;r>0;)n[--r]=0;for(var o=n.t-this.t;r<o;++r)n[r+this.t]=this.am(0,e[r],n,r,0,this.t);for(o=Math.min(e.t,t);r<o;++r)this.am(0,e[r],n,r,0,t-r);n.clamp()},e.prototype.multiplyUpperTo=function(e,t,n){--t;var r=n.t=this.t+e.t-t;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)n[this.t+r-t]=this.am(t-r,e[r],n,0,0,this.t+r-t);n.clamp(),n.drShiftTo(1,n)},e.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(0==t)n=this[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this[r])%e;return n},e.prototype.millerRabin=function(t){var n=this.subtract(e.ONE),r=n.getLowestSetBit();if(r<=0)return!1;var o=n.shiftRight(r);(t=t+1>>1)>R.length&&(t=R.length);for(var i=L(),s=0;s<t;++s){i.fromInt(R[Math.floor(Math.random()*R.length)]);var a=i.modPow(o,this);if(0!=a.compareTo(e.ONE)&&0!=a.compareTo(n)){for(var c=1;c++<r&&0!=a.compareTo(n);)if(0==(a=a.modPowInt(2,this)).compareTo(e.ONE))return!1;if(0!=a.compareTo(n))return!1}}return!0},e.prototype.square=function(){var e=L();return this.squareTo(e),e},e.prototype.gcda=function(e,t){var n=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(n.compareTo(r)<0){var o=n;n=r,r=o}var i=n.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)t(n);else{i<s&&(s=i),s>0&&(n.rShiftTo(s,n),r.rShiftTo(s,r));var a=function(){(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),n.compareTo(r)>=0?(n.subTo(r,n),n.rShiftTo(1,n)):(r.subTo(n,r),r.rShiftTo(1,r)),n.signum()>0?setTimeout(a,0):(s>0&&r.lShiftTo(s,r),setTimeout((function(){t(r)}),0))};setTimeout(a,10)}},e.prototype.fromNumberAsync=function(t,n,r,o){if("number"==typeof n)if(t<2)this.fromInt(1);else{this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),i,this),this.isEven()&&this.dAddOffset(1,0);var s=this,a=function(){s.dAddOffset(2,0),s.bitLength()>t&&s.subTo(e.ONE.shiftLeft(t-1),s),s.isProbablePrime(n)?setTimeout((function(){o()}),0):setTimeout(a,0)};setTimeout(a,0)}else{var c=[],u=7&t;c.length=1+(t>>3),n.nextBytes(c),u>0?c[0]&=(1<<u)-1:c[0]=0,this.fromString(c,256)}},e}(),w=function(){function e(){}return e.prototype.convert=function(e){return e},e.prototype.revert=function(e){return e},e.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n)},e.prototype.sqrTo=function(e,t){e.squareTo(t)},e}(),N=function(){function e(e){this.m=e}return e.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},e.prototype.revert=function(e){return e},e.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},e.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},e.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},e}(),M=function(){function e(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}return e.prototype.convert=function(e){var t=L();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(C.ZERO)>0&&this.m.subTo(t,t),t},e.prototype.revert=function(e){var t=L();return e.copyTo(t),this.reduce(t),t},e.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=32767&e[t],r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[n=t+this.m.t]+=this.m.am(0,r,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},e.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},e.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},e}(),I=function(){function e(e){this.m=e,this.r2=L(),this.q3=L(),C.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e)}return e.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=L();return e.copyTo(t),this.reduce(t),t},e.prototype.revert=function(e){return e},e.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},e.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},e.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},e}();function L(){return new C(null)}function P(e,t){return new C(e,t)}var A="undefined"!=typeof navigator;A&&"Microsoft Internet Explorer"==navigator.appName?(C.prototype.am=function(e,t,n,r,o,i){for(var s=32767&t,a=t>>15;--i>=0;){var c=32767&this[e],u=this[e++]>>15,l=a*c+u*s;o=((c=s*c+((32767&l)<<15)+n[r]+(1073741823&o))>>>30)+(l>>>15)+a*u+(o>>>30),n[r++]=1073741823&c}return o},E=30):A&&"Netscape"!=navigator.appName?(C.prototype.am=function(e,t,n,r,o,i){for(;--i>=0;){var s=t*this[e++]+n[r]+o;o=Math.floor(s/67108864),n[r++]=67108863&s}return o},E=26):(C.prototype.am=function(e,t,n,r,o,i){for(var s=16383&t,a=t>>14;--i>=0;){var c=16383&this[e],u=this[e++]>>14,l=a*c+u*s;o=((c=s*c+((16383&l)<<14)+n[r]+o)>>28)+(l>>14)+a*u,n[r++]=268435455&c}return o},E=28),C.prototype.DB=E,C.prototype.DM=(1<<E)-1,C.prototype.DV=1<<E,C.prototype.FV=Math.pow(2,52),C.prototype.F1=52-E,C.prototype.F2=2*E-52;var D,j,U=[];for(D="0".charCodeAt(0),j=0;j<=9;++j)U[D++]=j;for(D="a".charCodeAt(0),j=10;j<36;++j)U[D++]=j;for(D="A".charCodeAt(0),j=10;j<36;++j)U[D++]=j;function H(e,t){var n=U[e.charCodeAt(t)];return null==n?-1:n}function B(e){var t=L();return t.fromInt(e),t}function q(e){var t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}C.ZERO=B(0),C.ONE=B(1);var G,x,Z=function(){function e(){this.i=0,this.j=0,this.S=[]}return e.prototype.init=function(e){var t,n,r;for(t=0;t<256;++t)this.S[t]=t;for(n=0,t=0;t<256;++t)n=n+this.S[t]+e[t%e.length]&255,r=this.S[t],this.S[t]=this.S[n],this.S[n]=r;this.i=0,this.j=0},e.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]},e}(),V=null;if(null==V){V=[],x=0;var z=void 0;if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){var F=new Uint32Array(256);for(window.crypto.getRandomValues(F),z=0;z<F.length;++z)V[x++]=255&F[z]}}function W(){if(null==G){for(G=new Z;x<256;){var e=Math.floor(65536*Math.random());V[x++]=255&e}for(G.init(V),x=0;x<V.length;++x)V[x]=0;x=0}return G.next()}var Y=function(){function e(){}return e.prototype.nextBytes=function(e){for(var t=0;t<e.length;++t)e[t]=W()},e}(),K=function(){function e(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return e.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},e.prototype.doPrivate=function(e){if(null==this.p||null==this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),n=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(n)<0;)t=t.add(this.p);return t.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},e.prototype.setPublic=function(e,t){null!=e&&null!=t&&e.length>0&&t.length>0?(this.n=P(e,16),this.e=parseInt(t,16)):console.error("Invalid RSA public key")},e.prototype.encrypt=function(e){var t=this.n.bitLength()+7>>3,n=function(e,t){if(t<e.length+11)return console.error("Message too long for RSA"),null;for(var n=[],r=e.length-1;r>=0&&t>0;){var o=e.charCodeAt(r--);o<128?n[--t]=o:o>127&&o<2048?(n[--t]=63&o|128,n[--t]=o>>6|192):(n[--t]=63&o|128,n[--t]=o>>6&63|128,n[--t]=o>>12|224)}n[--t]=0;for(var i=new Y,s=[];t>2;){for(s[0]=0;0==s[0];)i.nextBytes(s);n[--t]=s[0]}return n[--t]=2,n[--t]=0,new C(n)}(e,t);if(null==n)return null;var r=this.doPublic(n);if(null==r)return null;for(var o=r.toString(16),i=o.length,s=0;s<2*t-i;s++)o="0"+o;return o},e.prototype.setPrivate=function(e,t,n){null!=e&&null!=t&&e.length>0&&t.length>0?(this.n=P(e,16),this.e=parseInt(t,16),this.d=P(n,16)):console.error("Invalid RSA private key")},e.prototype.setPrivateEx=function(e,t,n,r,o,i,s,a){null!=e&&null!=t&&e.length>0&&t.length>0?(this.n=P(e,16),this.e=parseInt(t,16),this.d=P(n,16),this.p=P(r,16),this.q=P(o,16),this.dmp1=P(i,16),this.dmq1=P(s,16),this.coeff=P(a,16)):console.error("Invalid RSA private key")},e.prototype.generate=function(e,t){var n=new Y,r=e>>1;this.e=parseInt(t,16);for(var o=new C(t,16);;){for(;this.p=new C(e-r,1,n),0!=this.p.subtract(C.ONE).gcd(o).compareTo(C.ONE)||!this.p.isProbablePrime(10););for(;this.q=new C(r,1,n),0!=this.q.subtract(C.ONE).gcd(o).compareTo(C.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var i=this.p;this.p=this.q,this.q=i}var s=this.p.subtract(C.ONE),a=this.q.subtract(C.ONE),c=s.multiply(a);if(0==c.gcd(o).compareTo(C.ONE)){this.n=this.p.multiply(this.q),this.d=o.modInverse(c),this.dmp1=this.d.mod(s),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}},e.prototype.decrypt=function(e){var t=P(e,16),n=this.doPrivate(t);return null==n?null:function(e,t){for(var n=e.toByteArray(),r=0;r<n.length&&0==n[r];)++r;if(n.length-r!=t-1||2!=n[r])return null;for(++r;0!=n[r];)if(++r>=n.length)return null;for(var o="";++r<n.length;){var i=255&n[r];i<128?o+=String.fromCharCode(i):i>191&&i<224?(o+=String.fromCharCode((31&i)<<6|63&n[r+1]),++r):(o+=String.fromCharCode((15&i)<<12|(63&n[r+1])<<6|63&n[r+2]),r+=2)}return o}(n,this.n.bitLength()+7>>3)},e.prototype.generateAsync=function(e,t,n){var r=new Y,o=e>>1;this.e=parseInt(t,16);var i=new C(t,16),s=this,a=function(){var t=function(){if(s.p.compareTo(s.q)<=0){var e=s.p;s.p=s.q,s.q=e}var t=s.p.subtract(C.ONE),r=s.q.subtract(C.ONE),o=t.multiply(r);0==o.gcd(i).compareTo(C.ONE)?(s.n=s.p.multiply(s.q),s.d=i.modInverse(o),s.dmp1=s.d.mod(t),s.dmq1=s.d.mod(r),s.coeff=s.q.modInverse(s.p),setTimeout((function(){n()}),0)):setTimeout(a,0)},c=function(){s.q=L(),s.q.fromNumberAsync(o,1,r,(function(){s.q.subtract(C.ONE).gcda(i,(function(e){0==e.compareTo(C.ONE)&&s.q.isProbablePrime(10)?setTimeout(t,0):setTimeout(c,0)}))}))},u=function(){s.p=L(),s.p.fromNumberAsync(e-o,1,r,(function(){s.p.subtract(C.ONE).gcda(i,(function(e){0==e.compareTo(C.ONE)&&s.p.isProbablePrime(10)?setTimeout(c,0):setTimeout(u,0)}))}))};setTimeout(u,0)};setTimeout(a,0)},e.prototype.sign=function(e,t,n){var r=function(e,t){if(t<e.length+22)return console.error("Message too long for RSA"),null;for(var n=t-e.length-6,r="",o=0;o<n;o+=2)r+="ff";return P("0001"+r+"00"+e,16)}((X[n]||"")+t(e).toString(),this.n.bitLength()/4);if(null==r)return null;var o=this.doPrivate(r);if(null==o)return null;var i=o.toString(16);return 0==(1&i.length)?i:"0"+i},e.prototype.verify=function(e,t,n){var r=P(t,16),o=this.doPublic(r);return null==o?null:function(e){for(var t in X)if(X.hasOwnProperty(t)){var n=X[t],r=n.length;if(e.substr(0,r)==n)return e.substr(r)}return e}(o.toString(16).replace(/^1f+00/,""))==n(e).toString()},e}(),X={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"},J={};J.lang={extend:function(e,t,n){if(!t||!e)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var r=function(){};if(r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t),n){var o;for(o in n)e.prototype[o]=n[o];var i=function(){},s=["toString","valueOf"];try{"undefined"!=typeof navigator&&/MSIE/.test(navigator.userAgent)&&(i=function(e,t){for(o=0;o<s.length;o+=1){var n=s[o],r=t[n];"function"==typeof r&&r!=Object.prototype[n]&&(e[n]=r)}})}catch(e){}i(e.prototype,n)}}};var Q={};void 0!==Q.asn1&&Q.asn1||(Q.asn1={}),Q.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){var t=e.toString(16);if("-"!=t.substr(0,1))t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var n=t.substr(1).length;n%2==1?n+=1:t.match(/^[0-7]/)||(n+=2);for(var r="",o=0;o<n;o++)r+="f";t=new C(r,16).xor(e).add(C.ONE).toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(e,t){return hextopem(e,t)},this.newObject=function(e){var t=Q.asn1,n=t.DERBoolean,r=t.DERInteger,o=t.DERBitString,i=t.DEROctetString,s=t.DERNull,a=t.DERObjectIdentifier,c=t.DEREnumerated,u=t.DERUTF8String,l=t.DERNumericString,h=t.DERPrintableString,p=t.DERTeletexString,f=t.DERIA5String,d=t.DERUTCTime,_=t.DERGeneralizedTime,g=t.DERSequence,m=t.DERSet,y=t.DERTaggedObject,v=t.ASN1Util.newObject,b=Object.keys(e);if(1!=b.length)throw"key of param shall be only one.";var E=b[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+E+":"))throw"undefined key: "+E;if("bool"==E)return new n(e[E]);if("int"==E)return new r(e[E]);if("bitstr"==E)return new o(e[E]);if("octstr"==E)return new i(e[E]);if("null"==E)return new s(e[E]);if("oid"==E)return new a(e[E]);if("enum"==E)return new c(e[E]);if("utf8str"==E)return new u(e[E]);if("numstr"==E)return new l(e[E]);if("prnstr"==E)return new h(e[E]);if("telstr"==E)return new p(e[E]);if("ia5str"==E)return new f(e[E]);if("utctime"==E)return new d(e[E]);if("gentime"==E)return new _(e[E]);if("seq"==E){for(var O=e[E],T=[],S=0;S<O.length;S++){var R=v(O[S]);T.push(R)}return new g({array:T})}if("set"==E){for(O=e[E],T=[],S=0;S<O.length;S++)R=v(O[S]),T.push(R);return new m({array:T})}if("tag"==E){var k=e[E];if("[object Array]"===Object.prototype.toString.call(k)&&3==k.length){var C=v(k[2]);return new y({tag:k[0],explicit:k[1],obj:C})}var w={};if(void 0!==k.explicit&&(w.explicit=k.explicit),void 0!==k.tag&&(w.tag=k.tag),void 0===k.obj)throw"obj shall be specified for 'tag'.";return w.obj=v(k.obj),new y(w)}},this.jsonToASN1HEX=function(e){return this.newObject(e).getEncodedHex()}},Q.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",n=parseInt(e.substr(0,2),16),r=(t=Math.floor(n/40)+"."+n%40,""),o=2;o<e.length;o+=2){var i=("00000000"+parseInt(e.substr(o,2),16).toString(2)).slice(-8);r+=i.substr(1,7),"0"==i.substr(0,1)&&(t=t+"."+new C(r,2).toString(10),r="")}return t},Q.asn1.ASN1Util.oidIntToHex=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},n=function(e){var n="",r=new C(e,10).toString(2),o=7-r.length%7;7==o&&(o=0);for(var i="",s=0;s<o;s++)i+="0";for(r=i+r,s=0;s<r.length-1;s+=7){var a=r.substr(s,7);s!=r.length-7&&(a="1"+a),n+=t(parseInt(a,2))}return n};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var r="",o=e.split("."),i=40*parseInt(o[0])+parseInt(o[1]);r+=t(i),o.splice(0,2);for(var s=0;s<o.length;s++)r+=n(o[s]);return r},Q.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var e=this.hV.length/2,t=e.toString(16);if(t.length%2==1&&(t="0"+t),e<128)return t;var n=t.length/2;if(n>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+n).toString(16)+t},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},Q.asn1.DERAbstractString=function(e){Q.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=stohex(this.s)},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0!==e.str?this.setString(e.str):void 0!==e.hex&&this.setStringHex(e.hex))},J.lang.extend(Q.asn1.DERAbstractString,Q.asn1.ASN1Object),Q.asn1.DERAbstractTime=function(e){Q.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){return utc=e.getTime()+6e4*e.getTimezoneOffset(),new Date(utc)},this.formatDate=function(e,t,n){var r=this.zeroPadding,o=this.localDateToUTC(e),i=String(o.getFullYear());"utc"==t&&(i=i.substr(2,2));var s=i+r(String(o.getMonth()+1),2)+r(String(o.getDate()),2)+r(String(o.getHours()),2)+r(String(o.getMinutes()),2)+r(String(o.getSeconds()),2);if(!0===n){var a=o.getMilliseconds();if(0!=a){var c=r(String(a),3);s=s+"."+(c=c.replace(/[0]+$/,""))}}return s+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=stohex(e)},this.setByDateValue=function(e,t,n,r,o,i){var s=new Date(Date.UTC(e,t-1,n,r,o,i,0));this.setByDate(s)},this.getFreshValueHex=function(){return this.hV}},J.lang.extend(Q.asn1.DERAbstractTime,Q.asn1.ASN1Object),Q.asn1.DERAbstractStructured=function(e){Q.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},J.lang.extend(Q.asn1.DERAbstractStructured,Q.asn1.ASN1Object),Q.asn1.DERBoolean=function(){Q.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},J.lang.extend(Q.asn1.DERBoolean,Q.asn1.ASN1Object),Q.asn1.DERInteger=function(e){Q.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=Q.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new C(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.bigint?this.setByBigInteger(e.bigint):void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},J.lang.extend(Q.asn1.DERInteger,Q.asn1.ASN1Object),Q.asn1.DERBitString=function(e){if(void 0!==e&&void 0!==e.obj){var t=Q.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.getEncodedHex()}Q.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(e<0||7<e)throw"unused bits shall be from 0 to 7: u = "+e;var n="0"+e;this.hTLV=null,this.isModified=!0,this.hV=n+t},this.setByBinaryString=function(e){var t=8-(e=e.replace(/0+$/,"")).length%8;8==t&&(t=0);for(var n=0;n<=t;n++)e+="0";var r="";for(n=0;n<e.length-1;n+=8){var o=e.substr(n,8),i=parseInt(o,2).toString(16);1==i.length&&(i="0"+i),r+=i}this.hTLV=null,this.isModified=!0,this.hV="0"+t+r},this.setByBooleanArray=function(e){for(var t="",n=0;n<e.length;n++)1==e[n]?t+="1":t+="0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):void 0!==e.hex?this.setHexValueIncludingUnusedBits(e.hex):void 0!==e.bin?this.setByBinaryString(e.bin):void 0!==e.array&&this.setByBooleanArray(e.array))},J.lang.extend(Q.asn1.DERBitString,Q.asn1.ASN1Object),Q.asn1.DEROctetString=function(e){if(void 0!==e&&void 0!==e.obj){var t=Q.asn1.ASN1Util.newObject(e.obj);e.hex=t.getEncodedHex()}Q.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},J.lang.extend(Q.asn1.DEROctetString,Q.asn1.DERAbstractString),Q.asn1.DERNull=function(){Q.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},J.lang.extend(Q.asn1.DERNull,Q.asn1.ASN1Object),Q.asn1.DERObjectIdentifier=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},n=function(e){var n="",r=new C(e,10).toString(2),o=7-r.length%7;7==o&&(o=0);for(var i="",s=0;s<o;s++)i+="0";for(r=i+r,s=0;s<r.length-1;s+=7){var a=r.substr(s,7);s!=r.length-7&&(a="1"+a),n+=t(parseInt(a,2))}return n};Q.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var r="",o=e.split("."),i=40*parseInt(o[0])+parseInt(o[1]);r+=t(i),o.splice(0,2);for(var s=0;s<o.length;s++)r+=n(o[s]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(e){var t=Q.asn1.x509.OID.name2oid(e);if(""===t)throw"DERObjectIdentifier oidName undefined: "+e;this.setValueOidString(t)},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e):void 0!==e.oid?this.setValueOidString(e.oid):void 0!==e.hex?this.setValueHex(e.hex):void 0!==e.name&&this.setValueName(e.name))},J.lang.extend(Q.asn1.DERObjectIdentifier,Q.asn1.ASN1Object),Q.asn1.DEREnumerated=function(e){Q.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=Q.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new C(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},J.lang.extend(Q.asn1.DEREnumerated,Q.asn1.ASN1Object),Q.asn1.DERUTF8String=function(e){Q.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},J.lang.extend(Q.asn1.DERUTF8String,Q.asn1.DERAbstractString),Q.asn1.DERNumericString=function(e){Q.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},J.lang.extend(Q.asn1.DERNumericString,Q.asn1.DERAbstractString),Q.asn1.DERPrintableString=function(e){Q.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},J.lang.extend(Q.asn1.DERPrintableString,Q.asn1.DERAbstractString),Q.asn1.DERTeletexString=function(e){Q.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},J.lang.extend(Q.asn1.DERTeletexString,Q.asn1.DERAbstractString),Q.asn1.DERIA5String=function(e){Q.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},J.lang.extend(Q.asn1.DERIA5String,Q.asn1.DERAbstractString),Q.asn1.DERUTCTime=function(e){Q.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{12}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date))},J.lang.extend(Q.asn1.DERUTCTime,Q.asn1.DERAbstractTime),Q.asn1.DERGeneralizedTime=function(e){Q.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{14}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date),!0===e.millis&&(this.withMillis=!0))},J.lang.extend(Q.asn1.DERGeneralizedTime,Q.asn1.DERAbstractTime),Q.asn1.DERSequence=function(e){Q.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++)e+=this.asn1Array[t].getEncodedHex();return this.hV=e,this.hV}},J.lang.extend(Q.asn1.DERSequence,Q.asn1.DERAbstractStructured),Q.asn1.DERSet=function(e){Q.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var n=this.asn1Array[t];e.push(n.getEncodedHex())}return 1==this.sortFlag&&e.sort(),this.hV=e.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},J.lang.extend(Q.asn1.DERSet,Q.asn1.DERAbstractStructured),Q.asn1.DERTaggedObject=function(e){Q.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(e,t,n){this.hT=t,this.isExplicit=e,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,t),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.tag&&(this.hT=e.tag),void 0!==e.explicit&&(this.isExplicit=e.explicit),void 0!==e.obj&&(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},J.lang.extend(Q.asn1.DERTaggedObject,Q.asn1.ASN1Object);var $,ee=($=function(e,t){return($=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}$(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),te=function(e){function t(n){var r=e.call(this)||this;return n&&("string"==typeof n?r.parseKey(n):(t.hasPrivateKeyProperty(n)||t.hasPublicKeyProperty(n))&&r.parsePropertiesFrom(n)),r}return ee(t,e),t.prototype.parseKey=function(e){try{var t=0,n=0,r=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(e)?function(e){var t;if(void 0===l){var n="0123456789ABCDEF",r=" \f\n\r\t\u2028\u2029";for(l={},t=0;t<16;++t)l[n.charAt(t)]=t;for(n=n.toLowerCase(),t=10;t<16;++t)l[n.charAt(t)]=t;for(t=0;t<r.length;++t)l[r.charAt(t)]=-1}var o=[],i=0,s=0;for(t=0;t<e.length;++t){var a=e.charAt(t);if("="==a)break;if(-1!=(a=l[a])){if(void 0===a)throw new Error("Illegal character at offset "+t);i|=a,++s>=2?(o[o.length]=i,i=0,s=0):i<<=4}}if(s)throw new Error("Hex encoding incomplete: 4 bits missing");return o}(e):_.unarmor(e),o=T.decode(r);if(3===o.sub.length&&(o=o.sub[2].sub[0]),9===o.sub.length){t=o.sub[1].getHexStringValue(),this.n=P(t,16),n=o.sub[2].getHexStringValue(),this.e=parseInt(n,16);var i=o.sub[3].getHexStringValue();this.d=P(i,16);var s=o.sub[4].getHexStringValue();this.p=P(s,16);var a=o.sub[5].getHexStringValue();this.q=P(a,16);var c=o.sub[6].getHexStringValue();this.dmp1=P(c,16);var u=o.sub[7].getHexStringValue();this.dmq1=P(u,16);var h=o.sub[8].getHexStringValue();this.coeff=P(h,16)}else{if(2!==o.sub.length)return!1;var p=o.sub[1].sub[0];t=p.sub[0].getHexStringValue(),this.n=P(t,16),n=p.sub[1].getHexStringValue(),this.e=parseInt(n,16)}return!0}catch(e){return!1}},t.prototype.getPrivateBaseKey=function(){var e={array:[new Q.asn1.DERInteger({int:0}),new Q.asn1.DERInteger({bigint:this.n}),new Q.asn1.DERInteger({int:this.e}),new Q.asn1.DERInteger({bigint:this.d}),new Q.asn1.DERInteger({bigint:this.p}),new Q.asn1.DERInteger({bigint:this.q}),new Q.asn1.DERInteger({bigint:this.dmp1}),new Q.asn1.DERInteger({bigint:this.dmq1}),new Q.asn1.DERInteger({bigint:this.coeff})]};return new Q.asn1.DERSequence(e).getEncodedHex()},t.prototype.getPrivateBaseKeyB64=function(){return p(this.getPrivateBaseKey())},t.prototype.getPublicBaseKey=function(){var e=new Q.asn1.DERSequence({array:[new Q.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new Q.asn1.DERNull]}),t=new Q.asn1.DERSequence({array:[new Q.asn1.DERInteger({bigint:this.n}),new Q.asn1.DERInteger({int:this.e})]}),n=new Q.asn1.DERBitString({hex:"00"+t.getEncodedHex()});return new Q.asn1.DERSequence({array:[e,n]}).getEncodedHex()},t.prototype.getPublicBaseKeyB64=function(){return p(this.getPublicBaseKey())},t.wordwrap=function(e,t){if(!e)return e;var n="(.{1,"+(t=t||64)+"})( +|$\n?)|(.{1,"+t+"})";return e.match(RegExp(n,"g")).join("\n")},t.prototype.getPrivateKey=function(){var e="-----BEGIN RSA PRIVATE KEY-----\n";return(e+=t.wordwrap(this.getPrivateBaseKeyB64())+"\n")+"-----END RSA PRIVATE KEY-----"},t.prototype.getPublicKey=function(){var e="-----BEGIN PUBLIC KEY-----\n";return(e+=t.wordwrap(this.getPublicBaseKeyB64())+"\n")+"-----END PUBLIC KEY-----"},t.hasPublicKeyProperty=function(e){return(e=e||{}).hasOwnProperty("n")&&e.hasOwnProperty("e")},t.hasPrivateKeyProperty=function(e){return(e=e||{}).hasOwnProperty("n")&&e.hasOwnProperty("e")&&e.hasOwnProperty("d")&&e.hasOwnProperty("p")&&e.hasOwnProperty("q")&&e.hasOwnProperty("dmp1")&&e.hasOwnProperty("dmq1")&&e.hasOwnProperty("coeff")},t.prototype.parsePropertiesFrom=function(e){this.n=e.n,this.e=e.e,e.hasOwnProperty("d")&&(this.d=e.d,this.p=e.p,this.q=e.q,this.dmp1=e.dmp1,this.dmq1=e.dmq1,this.coeff=e.coeff)},t}(K);const ne=function(){function e(e){void 0===e&&(e={}),e=e||{},this.default_key_size=e.default_key_size?parseInt(e.default_key_size,10):1024,this.default_public_exponent=e.default_public_exponent||"010001",this.log=e.log||!1,this.key=null}return e.prototype.setKey=function(e){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new te(e)},e.prototype.setPrivateKey=function(e){this.setKey(e)},e.prototype.setPublicKey=function(e){this.setKey(e)},e.prototype.decrypt=function(e){try{return this.getKey().decrypt(f(e))}catch(e){return!1}},e.prototype.encrypt=function(e){try{return p(this.getKey().encrypt(e))}catch(e){return!1}},e.prototype.sign=function(e,t,n){try{return p(this.getKey().sign(e,t,n))}catch(e){return!1}},e.prototype.verify=function(e,t,n){try{return this.getKey().verify(e,f(t),n)}catch(e){return!1}},e.prototype.getKey=function(e){if(!this.key){if(this.key=new te,e&&"[object Function]"==={}.toString.call(e))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,e);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},e.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},e.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},e.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},e.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},e.version="3.2.1",e}()}],o={d:(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},i={};r[1](0,i,o),t.default=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeString=t.encodeString=void 0,t.encodeString=function(e){return Uint8Array.from(Array.from(unescape(encodeURIComponent(e))).map((function(e){return e.charCodeAt(0)})))},t.decodeString=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(String,Array.from(e))))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveroomProMap=void 0,t.LiveroomProMap={"/lr/login_room_rsp":"LoginRoomRsp","/lr/logout_room_rsp":"LogoutRoomRsp","/sw/push_kickout":"PushKickout","/sw/push":"PushReq","/sw/merge_push":"CmdMergePushReq","/lr/room/hb_rsp":"HbRsp","/lr/userlist/userlist_rsp":"UserlistRsp","/lr/stream/add_rsp":"StreamAddRsp","/lr/stream/delete_rsp":"StreamDeleteRsp","/lr/stream/update_rsp":"StreamUpdateRsp","/lr/stream/list_rsp":"StreamListRsp","/lr/push/stream_add":"PushStream","/lr/push/stream_delete":"PushStream","/lr/push/stream_update":"PushStream","/lr/signal/liverequest_rsp":"SignalLiveRsp","/lr/signal/liverresult_rsp":"SignalLiveResulRsp","/lr/signal/liveinvite_rsp":"SignalLiveInviteRsp","/lr/signal/livestop_rsp":"SignalLiveStopRsp","/lr/signal/livescustom_rsp":"SignalLiveCustomRsp","/lr/im/chat_rsp":"ImChatRsp","/lr/room/enter_rsp":"EnterRsp","/lr/room/quit_rsp":"QuitRsp","/lr/trans/trans_rsp":"TransRsp","/lr/trans/transfetch_rsp":"TransFetchRsp","/lr/bigim/chat_rsp":"BigimChatRsp","/lr/relay_rsp":"RelayRsp","/lr/token/renew_token_rsp":"RenewTokenRsp","/lr/push/user_updated":"PushUserInfoUpdated","/lr/push/user_token_expire":"PushUserTokenExpire","/lr/push/im_chat":"PushImChat","/lr/push/bigim_chat":"PushBigImChat","/lr/push/trans":"PushTrans","/lr/push/user_kickout":"PushUserKickout","/lr/push/user_logreport":"PushUserLogReport","/lr/push/usertrans":"PushUserTrans"}},function(e,t,n){"undefined"!=typeof self&&self,e.exports=function(e){return r={},t.m=n=[function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZEGO_SETTING_ACTION=void 0,(t=t.ZEGO_SETTING_ACTION||(t.ZEGO_SETTING_ACTION={})).CONSTRUCTOR="zs.0",t.SETTING_INIT="zs.ii.0",t.SETTING_FETCH_SETTING="zs.fs.0",t.SETTING__FETCH_SETTING="zs.fs.1",t.SETTING_GET_CLOUD_SETTING="zs.gcs.0",t.SETTING_POLLING_SETTING="zs.ps.0",t.SETTINGCACHEHANDLER_GET_CACHE_SETTING="zs.sch.gcs.0",t.SETTINGCACHEHANDLER_STORE_SETTING="zs.sch.ss.0",t.SETTINGFETCHHANDLER_FETCHSETTING="zs.sfh.fs.0"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorList=void 0,t.errorList={NOT_INIT:{code:1001,msg:"not init"},FILE_REQUEST_FAIL:{code:1002,msg:"fetch request fail"},INFLATE_DATA_FAIL:{code:1003,msg:"inflate fail"},MULTI_FILE_NOT_EXIST:{code:1004,msg:"get multi file fail"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUUID=t.checkValidNumber=t.analyzeKey=t.getCurrentTime=t.getBrowser=void 0,t.getBrowser=function(){var e=window.navigator.userAgent,t=null!=window.ActiveXObject&&-1!=e.indexOf("MSIE"),n=-1!=e.indexOf("Firefox"),r=null!=window.opr,o=e.indexOf("Chrome")&&window.chrome,i=-1!=e.indexOf("Safari")&&-1!=e.indexOf("Version");return e=e.toLowerCase().match(/MicroMessenger/i)&&"micromessenger"===e.toLowerCase().match(/MicroMessenger/i)[0],t?"IE":n?"FIREFOX":r?"OPERA":o?"CHROME":i?"SAFARI":e?"WEIXIN":"UNKOWN"};var r=["00","01","02","03","04","05","06","07","08","09"];t.getCurrentTime=function(){var e=new Date;return[e.getFullYear()+"/",(r[e.getMonth()+1]||e.getMonth()+1)+"/",(r[e.getDate()]||e.getDate())+" ",(r[e.getHours()]||e.getHours())+":",(r[e.getMinutes()]||e.getMinutes())+":",r[e.getSeconds()]||e.getSeconds(),"."+e.getTime()%1e3].join("")},t.analyzeKey=function(e){return e=e.split("_"),{level:Number(e[0]),timestamp:e[1],seq:e[2]}},t.checkValidNumber=function(e,t,n){return t=t||1,n=n||1e4,"number"==typeof e&&e%1==0&&t<=e&&e<=n},t.generateUUID=function(e){if(0===(e=void 0===e?0:e)?n=localStorage.getItem("z_deviceID"):wx.getStorageSync("z_deviceID"),n)return n;var t=(new Date).getTime(),n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(36)}));return 0===e?localStorage.setItem("z_deviceID",n):wx.setStorageSync("z_deviceID",n),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSetting=void 0;var r=n(4);Object.defineProperty(t,"ZegoSetting",{enumerable:!0,get:function(){return r.ZegoSetting}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n=n||Promise)((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoSetting=void 0;var s=n(5),a=n(6),c=n(10),u=n(0),l=n(12),h=n(1),p=n(2);function f(){this.fileList=[],this.publicEnvVariable={},this.proEnvVariable={},this.pollingTimer=null,this.pollingInterval=300,this.inited=!1,this.log=new s.ZegoLog}Object.defineProperty(f.prototype,"envVariable",{get:function(){return Object.assign({},this.publicEnvVariable,this.proEnvVariable)},enumerable:!1,configurable:!0}),f.prototype.init=function(e){var t=this;return e.pollingFreq&&!p.checkValidNumber(e.pollingFreq)?(this.log.error(u.ZEGO_SETTING_ACTION.SETTING_INIT+" pollingFreq must be integer number"),!1):(this.options=Object.assign({},l.INIT_CONFIG,e),this.getPublicEnvVariable(),this.settingFetchHandler=new c.SettingFetchHandler(this.options,this.log),this.settingFetchHandler.setDataReport(this.options.reportNotify),e=Math.round(60*Math.random()),this.log.info(u.ZEGO_SETTING_ACTION.SETTING_INIT+" delay "+e),this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null),this.options.pollingFreq&&60<=this.options.pollingFreq&&(this.pollingInterval=this.options.pollingFreq),this.delayTimer=setTimeout((function(){t.pollingSetting(1e3*t.pollingInterval)}),1e3*e),this.settingCacheHandler=new a.SettingCacheHandler("setting_"+(this.options.online?"online_":"test_")+this.options.product+"_"+this.options.appID,this.log,this.options.env),this.inited=!0)},f.prototype.uninit=function(){this.pollingTimer&&(clearTimeout(this.pollingTimer),this.pollingTimer=null)},f.prototype.setEnvVariable=function(e,t){this.proEnvVariable[e]=String(t)},f.prototype.getEnvVariable=function(e){return this.envVariable[e]},f.prototype.setEnvVariables=function(e){var t=this;Object.keys(e).forEach((function(n){"string"!=typeof e[n]&&"number"!=typeof e[n]&&t.log.error("zs.sev env "+n+" type error"),t.proEnvVariable[n]=String(e[n])}))},f.prototype.getEnvVariables=function(){return this.envVariable},f.prototype.enablePolling=function(e,t){var n=this;t?t.forEach((function(t){var r=n.fileList.find((function(e){return e.fileName===t}));r&&(r.needPolling=e)})):this.fileList.forEach((function(t){return t.needPolling=e}))},f.prototype.setToken=function(e){this.token=e},f.prototype.setUserID=function(e){this.userID=e},f.prototype.getSettingCache=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return this.inited?(t=this.fileList.find((function(t){return t.fileName===e})))?[2,Promise.resolve({setting:t.setting,versions:t.versions})]:[3,1]:[2,Promise.reject(h.errorList.NOT_INIT)];case 1:return n=this._getFileName(e),[4,this.settingCacheHandler.getCacheSetting(n)];case 2:return(n=o.sent())&&(this.fileList.find((function(t){return t.fileName===e}))||this.fileList.push({fileName:e,fetchedTime:0,needPolling:!1,setting:n.setting,versions:n.versions}),r={setting:n.setting,versions:n.versions}),[2,Promise.resolve(r)]}}))}))},f.prototype.fetchSetting=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n=!0),this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" call "+e),this.inited?(this.activePolling(),0<Object.keys(t).length?(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" get file with params"),this._getCloudSetting(e,r(r({},this.envVariable),t))):(t=this.fileList.find((function(t){return t.fileName===e})))?(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" file exist"),(new Date).getTime()-t.fetchedTime<1e3*this.pollingInterval?(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" fetch time interval in freq"),t.needPolling=n,Promise.resolve({setting:t.setting,versions:t.versions})):this._fetchSetting(e,t,n)):(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" file not found"),this._fetchSetting(e,t,n))):Promise.reject(h.errorList.NOT_INIT)},f.prototype.fetchMultiSetting=function(e,t,n){var s=this;return void 0===t&&(t={}),void 0===n&&(n=!0),this.inited?(this.activePolling(),0<Object.keys(t).length?(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" get file with params"),this._getCloudSetting(e,r(r({},this.envVariable),t))):new Promise((function(t,r){var a={},c=[];if(e.forEach((function(e){return o(s,void 0,void 0,(function(){var t;return i(this,(function(n){return(t=this.fileList.find((function(t){return t.fileName===e})))&&(new Date).getTime()-t.fetchedTime<1e3*this.pollingInterval?(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_FETCH_SETTING+" fetch time interval in freq"),a[e]={setting:t.setting,versions:t.versions}):c.push(e),[2]}))}))})),!(0<c.length))return t(a);s._getCloudSetting(c,s.envVariable).then((function(e){return s.handleFetchFiles(e,n),Object.assign(a,e),t(a)})).catch((function(e){c.forEach((function(e){return o(s,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return(t=this.fileList.find((function(t){return t.fileName==e})))?t.fetchedTime=(new Date).getTime():this.fileList.find((function(t){return t.fileName===e}))||this.fileList.push({fileName:e,fetchedTime:(new Date).getTime(),needPolling:n,setting:{},versions:{}}),[4,this.settingCacheHandler.getCacheSetting(e)];case 1:return t=r.sent(),a[e]={setting:t.setting,versions:t.versions},[2]}}))}))})),0<Object.keys(a).length?t(a):r(e)}))}))):Promise.reject(h.errorList.NOT_INIT)},f.prototype.setLog=function(e){this.log=e},f.prototype._getCloudSetting=function(e,t){var n=this;return new Promise((function(r,s){return o(n,void 0,void 0,(function(){var n,o,a,c,l,p;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),c=e instanceof Array,[4,this.settingFetchHandler.fetchSetting(c?e:[e],t,this.token,this.userID)];case 1:return o=i.sent(),n=o.data,"number"==typeof(o=o.polling_interval)&&5<=o&&this.pollingInterval!==60*o&&(this.log.warn(u.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" polling interval change"),this.pollingInterval=60*o,this.uninit(),this.activePolling()),c?(a={},e.forEach((function(e){var t,r;0==(null===(t=n[e])||void 0===t?void 0:t.code)&&void 0!==(null===(r=n[e])||void 0===r?void 0:r.data)&&(a[e]={setting:null===(r=n[e])||void 0===r?void 0:r.data,versions:null===(e=n[e])||void 0===e?void 0:e.versions})})),0<Object.keys(a).length?r(a):s(h.errorList.MULTI_FILE_NOT_EXIST)):0===(null===(c=n[e])||void 0===c?void 0:c.code)&&null!==(l=n[e])&&void 0!==l&&l.data?r({setting:null===(l=n[e])||void 0===l?void 0:l.data,versions:null===(l=n[e])||void 0===l?void 0:l.versions}):s({code:null===(p=n[e])||void 0===p?void 0:p.code,msg:null===(p=n[e])||void 0===p?void 0:p.message}),[3,3];case 2:return p=i.sent(),s(p),this.log.info(u.ZEGO_SETTING_ACTION.SETTING_GET_CLOUD_SETTING+" fail"),[3,3];case 3:return[2]}}))}))}))},f.prototype.handleFetchFiles=function(e,t){var n=this;Object.keys(e).forEach((function(r){var o=n.fileList.find((function(e){return e.fileName==r}));o?(o.fetchedTime=(new Date).getTime(),o.setting=e[r].setting,o.versions=e[r].versions,o.needPolling=t):n.fileList.find((function(e){return e.fileName===r}))||n.fileList.push({fileName:r,fetchedTime:(new Date).getTime(),needPolling:t,setting:e[r].setting,versions:e[r].versions}),o=n._getFileName(r),n.settingCacheHandler.storeSetting(o,e[r])}))},f.prototype._fetchSetting=function(e,t,n){var r=this;return new Promise((function(s,a){r.log.info(u.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" call"),r._getCloudSetting(e,r.envVariable).then((function(o){t?(t.fetchedTime=(new Date).getTime(),t.setting=o.setting,t.versions=o.versions,t.needPolling=n):r.fileList.find((function(t){return t.fileName===e}))||r.fileList.push({fileName:e,fetchedTime:(new Date).getTime(),needPolling:n,setting:o.setting,versions:o.versions});var i=r._getFileName(e);r.settingCacheHandler.storeSetting(i,o),s(o),r.log.info(u.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" call suc")})).catch((function(c){return o(r,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:t?t.fetchedTime=(new Date).getTime():this.fileList.find((function(t){return t.fileName===e}))||this.fileList.push({fileName:e,fetchedTime:(new Date).getTime(),needPolling:n,setting:{},versions:{}}),r=this._getFileName(e),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.settingCacheHandler.getCacheSetting(r)];case 2:return r=o.sent(),s(r),[3,4];case 3:return o.sent(),a(c),[3,4];case 4:return this.log.info(u.ZEGO_SETTING_ACTION.SETTING__FETCH_SETTING+" setting not contain or fetch file fail"),[2]}}))}))}))}))},f.prototype.getPublicEnvVariable=function(){var e;0==this.options.env?(this.publicEnvVariable.userAgent=navigator.userAgent,this.publicEnvVariable.platform=navigator.platform,this.publicEnvVariable.browser=p.getBrowser(),this.publicEnvVariable.deviceid=p.generateUUID()):1==this.options.env&&(e=wx.getSystemInfoSync(),this.publicEnvVariable.brand=e.brand,this.publicEnvVariable.model=e.model,this.publicEnvVariable.system=e.system,this.publicEnvVariable.platform=e.platform,this.publicEnvVariable.wechatVersion=e.version,this.publicEnvVariable.wechatSDKVersion=e.SDKVersion,this.publicEnvVariable.deviceid=p.generateUUID(this.options.env))},f.prototype.pollingSetting=function(e){return o(this,void 0,void 0,(function(){var t,n,r,s,a=this;return i(this,(function(c){switch(c.label){case 0:if(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" call "+e),t=[],this.fileList.forEach((function(e){e.fileName,e.needPolling&&t.push(e.fileName)})),n=e,!(0<t.length))return[3,5];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.settingFetchHandler.fetchSetting(t,this.envVariable,this.token,this.userID)];case 2:return s=c.sent(),r=s.data,"number"==typeof(s=s.polling_interval)&&5<=s&&this.pollingInterval!==60*s&&(this.log.warn(u.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" polling interval change"),this.pollingInterval=60*s,n=1e3*this.pollingInterval),this.fileList.forEach((function(e){return o(a,void 0,void 0,(function(){var t,n,o,s;return i(this,(function(i){switch(i.label){case 0:return e.fetchedTime=(new Date).getTime(),t=this._getFileName(e.fileName),r[e.fileName]&&0===r[e.fileName].code&&r[e.fileName].data?(n=JSON.stringify(r[e.fileName].data),o=JSON.stringify(e.setting),s={setting:r[e.fileName].data,versions:null===(s=r[e.fileName])||void 0===s?void 0:s.versions},o!==n&&(this.log.info(u.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" "+e.fileName+" setting changed"),e.setting=s.setting,e.versions=s.versions,this.options.pollingNotify(e.fileName,s)),[4,this.settingCacheHandler.getCacheSetting(t)]):[3,2];case 1:o=i.sent(),n=JSON.stringify(o),o=JSON.stringify(s),n!==o&&this.settingCacheHandler.storeSetting(t,s),i.label=2;case 2:return[2]}}))}))})),[3,4];case 3:return s=c.sent(),this.log.error(u.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" fetch fail "+JSON.stringify(s)),[3,4];case 4:return[3,6];case 5:this.log.info(u.ZEGO_SETTING_ACTION.SETTING_POLLING_SETTING+" polling no file"),c.label=6;case 6:return this.pollingTimer&&clearTimeout(this.pollingTimer),this.pollingTimer=setTimeout((function(){a.pollingSetting(n)}),n),[2]}}))}))},f.prototype._getFileName=function(e){return e},f.prototype.activePolling=function(){this.pollingTimer||this.pollingSetting(1e3*this.pollingInterval)},n=f,t.ZegoSetting=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZegoLog=void 0;var r=(o.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},o.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},o.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},o.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},o.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.join(" ")},o);function o(){}t.ZegoLog=r},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n=n||Promise)((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SettingCacheHandler=void 0;var i=n(0),s=n(7);function a(e,t,n){void 0===n&&(n=0),this.storeName=e,this.log=t,this.store=s.createZegoStore(e,n)}a.prototype.getCacheSetting=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return this.log.info(i.ZEGO_SETTING_ACTION.SETTINGCACHEHANDLER_GET_CACHE_SETTING+" call"),[4,this.store.getItem(e)];case 1:return[2,t.sent()||""]}}))}))},a.prototype.storeSetting=function(e,t){return r(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return this.log.info(i.ZEGO_SETTING_ACTION.SETTINGCACHEHANDLER_STORE_SETTING+" call"),[4,this.store.setItem(e,t)];case 1:return n.sent(),[2]}}))}))},n=a,t.SettingCacheHandler=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createZegoStore=t.ZegoWechatMiniStore=void 0;var r=n(8),o=n(9),i=(s.prototype.getItem=function(e){var t=this;return new Promise((function(n,r){try{n(wx.getStorageSync(t.keyPrefix+e))}catch(n){r(n)}}))},s.prototype.setItem=function(e,t){var n=this;return new Promise((function(r,o){try{wx.setStorageSync(n.keyPrefix+e,t),r()}catch(r){o(r)}}))},s.prototype.removeItem=function(e){var t=this;return new Promise((function(n,r){try{n(wx.removeStorageSync(t.keyPrefix+e))}catch(n){r(n)}}))},s.prototype.clear=function(){return new Promise((function(e,t){try{wx.clearStorageSync(),e()}catch(e){t(e)}}))},s.prototype.keys=function(){var e=this;return new Promise((function(t,n){try{var r=wx.getStorageInfoSync().keys,o=[];r.forEach((function(t){0==t.indexOf(e.keyPrefix)&&o.push(t.replace(e.keyPrefix,""))})),o.sort(),t(o)}catch(t){n(t)}}))},s);function s(e){this.storeName=e,this.keyPrefix=e+"/",this.storeName}t.ZegoWechatMiniStore=i,t.createZegoStore=function(e,t){return t===o.ZEGO_ENV.BROWSER?r.createInstance({name:e}):new i(e)}},function(t,n){t.exports=e},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SOCKET_DISCONNECT=t.ENUM_REMOTE_TYPE=t.ZEGO_BROWSER_TYPE=t.ZEGO_ENV=t.PROTO_VERSION=void 0,t.PROTO_VERSION="1.0.3",(r=t.ZEGO_ENV||(t.ZEGO_ENV={}))[r.BROWSER=0]="BROWSER",r[r.WEIXINMINI=1]="WEIXINMINI",(r=t.ZEGO_BROWSER_TYPE||(t.ZEGO_BROWSER_TYPE={}))[r.IE=0]="IE",r[r.FIREFOX=1]="FIREFOX",r[r.CHROME=2]="CHROME",r[r.SAFARI=3]="SAFARI",r[r.OPERA=4]="OPERA",r[r.WEIXIN=5]="WEIXIN",r[r.WEIXINMINI=6]="WEIXINMINI",r[r.UNKOWN=7]="UNKOWN",(r=t.ENUM_REMOTE_TYPE||(t.ENUM_REMOTE_TYPE={}))[r.DISABLE=0]="DISABLE",r[r.WEBSOCKET=1]="WEBSOCKET",r[r.HTTPS=2]="HTTPS",t.SOCKET_DISCONNECT=-1},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.SettingFetchHandler=void 0;var o=n(0),i=n(11),s=n(2);function a(e,t){this.options=e,this.log=t,this.seq=0}a.prototype.setOptions=function(e){this.options=e},a.prototype.setDataReport=function(e){this.reportFunc=e},a.prototype.fetchSetting=function(e,t,n,a){var c=this;return new Promise((function(u,l){var h={product:c.options.product,files:e,param:r(r({},t),{deviceid:void 0}),appid:c.options.appID,token:n,id_name:a,timestamp:(new Date).getTime(),biztype:0,deviceid:t.deviceid||s.generateUUID(c.options.env),compress:!1,mode:c.options.online?"online":"test"},p=c.seq++;c.reportFunc&&c.reportFunc(p,"request_start"),i.fetch(c.options.urls,h,c.options.env||0).then((function(e){var t,n=e.code,r=(e.msg,e.data),i=e.polling_interval;e=e.reportData,c.log.info(o.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" "+n),r&&(t=[],Object.keys(r).forEach((function(e){t.push({name:e,error:r[e].code})}))),c.reportFunc&&c.reportFunc(p,"request_end",{code:n,reportData:e,params:h,files:t}),u({data:r,polling_interval:i})})).catch((function(e){var t=e.code,n=e.msg;e.data,e=e.reportData,c.log.warn(o.ZEGO_SETTING_ACTION.SETTINGFETCHHANDLER_FETCHSETTING+" "+t),c.reportFunc&&c.reportFunc(p,"request_end",{code:t,params:h,reportData:e}),l({code:t,msg:n})}))}))},n=a,t.SettingFetchHandler=n},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.fetch=void 0;var o=n(1);t.fetch=function e(t,n,i,s,a,c){return void 0===s&&(s=5),void 0===a&&(a=0),void 0===c&&(c=[]),new Promise((function(u,l){a=a||(new Date).getTime();var h,p,f,d=(new Date).getTime();0===i?(h=new XMLHttpRequest,p=t[(s+1)%2]||t[0],h.open("post",p),1==n.compress&&(h.responseType="arraybuffer"),h.ontimeout=function(){},h.onreadystatechange=function(){var f,_,g,m,y;4==h.readyState&&(200<=h.status&&h.status<300||304==h.status?(_=void 0,1==n.compress||(_=h.responseText),y=(new Date).getTime()-d,f=(g=JSON.parse(_)).code,m=g.message,_=g.data,g=g.polling_interval,c.push({timestamp:d,url:p,error:f,duration:y}),0===f?u({code:f,msg:m,data:_,polling_interval:g,reportData:c}):l({code:f,msg:m,reportData:c})):(m=(new Date).getTime()-d,c.push({timestamp:d,url:p,error:h.status,duration:m}),y=(new Date).getTime()-a,0<s&&y<8e3?e(t,n,i,--s,a,c).then((function(e){u(e)})).catch((function(e){l(e)})):l(r(r({},o.errorList.FILE_REQUEST_FAIL),{reportData:c}))))},h.timeout=8e3,h.send(JSON.stringify(n))):(f=t[(s+1)%2]||t[0],wx.request({url:f,data:n,method:"POST",success:function(h){var p=(m=h.data).code,_=m.message,g=m.data,m=m.polling_interval;void 0!==p?0===p?u({code:p,msg:_,data:g,polling_interval:m,reportData:c}):l({code:p,msg:_,reportData:c}):(_=(new Date).getTime()-d,c.push({timestamp:d,url:f,error:o.errorList.FILE_REQUEST_FAIL.code,msg:h.data,duration:_}),0<s?e(t,n,i,--s,a,c).then((function(e){u(e)})).catch((function(e){l(e)})):l(r(r({},o.errorList.FILE_REQUEST_FAIL),{reportData:c})))},fail:function(h){var p=(new Date).getTime()-d;c.push({timestamp:d,url:f,error:o.errorList.FILE_REQUEST_FAIL.code,msg:h.errMsg,duration:p}),0<s?e(t,n,i,--s,a,c).then((function(e){u(e)})).catch((function(e){l(e)})):l(r(r({},o.errorList.FILE_REQUEST_FAIL),{reportData:c}))}}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INIT_CONFIG=void 0,t.INIT_CONFIG={env:0}}],t.c=r,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(t){return e[t]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3);function t(e){if(r[e])return r[e].exports;var o=r[e]={i:e,l:!1,exports:{}};return n[e].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n,r}(n(75))},function(e,t,n){(function(t){e.exports=function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,(function(e){var n=t[s][1][e];return o(n||e)}),u,u.exports,e,t,n,r)}return n[s].exports}for(var i=!1,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,n,r){(function(e){"use strict";var t,r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var i=0,s=new o(l),a=e.document.createTextNode("");s.observe(a,{characterData:!0}),t=function(){a.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){l(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(l,0)};else{var c=new e.MessageChannel;c.port1.onmessage=l,t=function(){c.port2.postMessage(0)}}var u=[];function l(){var e,t;r=!0;for(var n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}r=!1}n.exports=function(e){1!==u.push(e)||r||t()}}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";var r=e(1);function o(){}var i={},s=["REJECTED"],a=["FULFILLED"],c=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==o&&f(this,e)}function l(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(e,t,n){r((function(){var r;try{r=t(n)}catch(t){return i.reject(e,t)}r===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,r)}))}function p(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function r(t){n||(n=!0,i.reject(e,t))}function o(t){n||(n=!0,i.resolve(e,t))}var s=d((function(){t(o,r)}));"error"===s.status&&r(s.value)}function d(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}t.exports=u,u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var n=new this.constructor(o);return this.state!==c?h(n,this.state===a?e:t,this.outcome):this.queue.push(new l(n,e,t)),n},l.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){i.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},i.resolve=function(e,t){var n=d(p,t);if("error"===n.status)return i.reject(e,n.value);var r=n.value;if(r)f(e,r);else{e.state=a,e.outcome=t;for(var o=-1,s=e.queue.length;++o<s;)e.queue[o].callFulfilled(t)}return e},i.reject=function(e,t){e.state=s,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},u.resolve=function(e){return e instanceof this?e:i.resolve(new this(o),e)},u.reject=function(e){var t=new this(o);return i.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,c=-1,u=new this(o);++c<n;)l(e[c],c);return u;function l(e,o){t.resolve(e).then((function(e){s[o]=e,++a!==n||r||(r=!0,i.resolve(u,s))}),(function(e){r||(r=!0,i.reject(u,e))}))}},u.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s,a=-1,c=new this(o);++a<n;)s=e[a],t.resolve(s).then((function(e){r||(r=!0,i.resolve(c,e))}),(function(e){r||(r=!0,i.reject(c,e))}));return c}},{1:1}],3:[function(e,n,r){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function i(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var s=Promise;function a(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function c(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function u(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function l(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var h=void 0,p={},f=Object.prototype.toString;function d(e){return"boolean"==typeof h?s.resolve(h):function(e){return new s((function(t){var n=e.transaction("local-forage-detect-blob-support","readwrite"),r=i([""]);n.objectStore("local-forage-detect-blob-support").put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return h=e}))}function _(e){var t=p[e.name],n={};n.promise=new s((function(e,t){n.resolve=e,n.reject=t})),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then((function(){return n.promise})):t.dbReady=n.promise}function g(e){var t=p[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function m(e,t){var n=p[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function y(e,t){return new s((function(n,r){if(p[e.name]=p[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return n(e.db);_(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var s=o.open.apply(o,i);t&&(s.onupgradeneeded=function(t){var n=s.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore("local-forage-detect-blob-support")}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),s.onerror=function(e){e.preventDefault(),r(s.error)},s.onsuccess=function(){n(s.result),g(e)}}))}function v(e){return y(e,!1)}function b(e){return y(e,!0)}function E(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,o=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||n){if(n){var i=e.db.version+1;i>e.version&&(e.version=i)}return!0}return!1}function O(e){return i([function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}(atob(e.data))],{type:e.type})}function T(e){return e&&e.__local_forage_encoded_blob}function S(e){var t=this,n=t._initReady().then((function(){var e=p[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return c(n,e,e),n}function R(e,t,n,r){void 0===r&&(r=1);try{var o=e.db.transaction(e.storeName,t);n(null,o)}catch(o){if(r>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return s.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),b(e)})).then((function(){return function(e){_(e);for(var t=p[e.name],n=t.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,v(e).then((function(t){return e.db=t,E(e)?b(e):t})).then((function(r){e.db=t.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r})).catch((function(t){throw m(e,t),t}))}(e).then((function(){R(e,t,n,r-1)}))})).catch(n);n(o)}}var k={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var o=p[n.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},p[n.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=S);var i=[];function a(){return s.resolve()}for(var c=0;c<o.forages.length;c++){var u=o.forages[c];u!==t&&i.push(u._initReady().catch(a))}var l=o.forages.slice(0);return s.all(i).then((function(){return n.db=o.db,v(n)})).then((function(e){return n.db=e,E(n,t._defaultConfig.version)?b(n):e})).then((function(e){n.db=o.db=e,t._dbInfo=n;for(var r=0;r<l.length;r++){var i=l[r];i!==t&&(i._dbInfo.db=n.db,i._dbInfo.version=n.version)}}))},_support:function(){try{if(!o||!o.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){R(n._dbInfo,"readonly",(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;T(r)&&(r=O(r));var o=e(r,n.key,a++);void 0!==o?t(o):n.continue()}else t()},s.onerror=function(){r(s.error)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},getItem:function(e,t){var n=this;e=u(e);var r=new s((function(t,r){n.ready().then((function(){R(n._dbInfo,"readonly",(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName).get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),T(e)&&(e=O(e)),t(e)},s.onerror=function(){r(s.error)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},setItem:function(e,t,n){var r=this;e=u(e);var o=new s((function(n,o){var i;r.ready().then((function(){return i=r._dbInfo,"[object Blob]"===f.call(t)?d(i.db).then((function(e){return e?t:(n=t,new s((function(e,t){var r=new FileReader;r.onerror=t,r.onloadend=function(t){var r=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:n.type})},r.readAsBinaryString(n)})));var n})):t})).then((function(t){R(r._dbInfo,"readwrite",(function(i,s){if(i)return o(i);try{var a=s.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var c=a.put(t,e);s.oncomplete=function(){void 0===t&&(t=null),n(t)},s.onabort=s.onerror=function(){var e=c.error?c.error:c.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return a(o,n),o},removeItem:function(e,t){var n=this;e=u(e);var r=new s((function(t,r){n.ready().then((function(){R(n._dbInfo,"readwrite",(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName).delete(e);i.oncomplete=function(){t()},i.onerror=function(){r(s.error)},i.onabort=function(){var e=s.error?s.error:s.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){R(t._dbInfo,"readwrite",(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return a(n,e),n},length:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){R(t._dbInfo,"readonly",(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).count();i.onsuccess=function(){e(i.result)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return a(n,e),n},key:function(e,t){var n=this,r=new s((function(t,r){e<0?t(null):n.ready().then((function(){R(n._dbInfo,"readonly",(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName),a=!1,c=s.openKeyCursor();c.onsuccess=function(){var n=c.result;n?0===e||a?t(n.key):(a=!0,n.advance(e)):t(null)},c.onerror=function(){r(c.error)}}catch(e){r(e)}}))})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){R(t._dbInfo,"readonly",(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).openKeyCursor(),s=[];i.onsuccess=function(){var t=i.result;t?(s.push(t.key),t.continue()):e(s)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return a(n,e),n},dropInstance:function(e,t){t=l.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,i=this;if(e.name){var c=e.name===n.name&&i._dbInfo.db,u=c?s.resolve(i._dbInfo.db):v(e).then((function(t){var n=p[e.name],r=n.forages;n.db=t;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=t;return t}));r=e.storeName?u.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;_(e);var r=p[e.name],i=r.forages;t.close();for(var a=0;a<i.length;a++){var c=i[a];c._dbInfo.db=null,c._dbInfo.version=n}return new s((function(t,r){var i=o.open(e.name,n);i.onerror=function(e){i.result.close(),r(e)},i.onupgradeneeded=function(){i.result.deleteObjectStore(e.storeName)},i.onsuccess=function(){var e=i.result;e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<i.length;t++){var n=i[t];n._dbInfo.db=e,g(n._dbInfo)}})).catch((function(t){throw(m(e,t)||s.resolve()).catch((function(){})),t}))}})):u.then((function(t){_(e);var n=p[e.name],r=n.forages;t.close();for(var i=0;i<r.length;i++)r[i]._dbInfo.db=null;return new s((function(t,n){var r=o.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<r.length;t++)g(r[t]._dbInfo)})).catch((function(t){throw(m(e,t)||s.resolve()).catch((function(){})),t}))}))}else r=s.reject("Invalid arguments");return a(r,t),r}},C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w=/^~~local_forage_type~([^~]+)~/,N="__lfsc__:".length,M=N+"arbf".length,I=Object.prototype.toString;function L(e){var t,n,r,o,i,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var u=new ArrayBuffer(s),l=new Uint8Array(u);for(t=0;t<a;t+=4)n=C.indexOf(e[t]),r=C.indexOf(e[t+1]),o=C.indexOf(e[t+2]),i=C.indexOf(e[t+3]),l[c++]=n<<2|r>>4,l[c++]=(15&r)<<4|o>>2,l[c++]=(3&o)<<6|63&i;return u}function P(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=C[n[t]>>2],r+=C[(3&n[t])<<4|n[t+1]>>4],r+=C[(15&n[t+1])<<2|n[t+2]>>6],r+=C[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var A={serialize:function(e,t){var n="";if(e&&(n=I.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===I.call(e.buffer))){var r,o="__lfsc__:";e instanceof ArrayBuffer?(r=e,o+="arbf"):(r=e.buffer,"[object Int8Array]"===n?o+="si08":"[object Uint8Array]"===n?o+="ui08":"[object Uint8ClampedArray]"===n?o+="uic8":"[object Int16Array]"===n?o+="si16":"[object Uint16Array]"===n?o+="ur16":"[object Int32Array]"===n?o+="si32":"[object Uint32Array]"===n?o+="ui32":"[object Float32Array]"===n?o+="fl32":"[object Float64Array]"===n?o+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(o+P(r))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n="~~local_forage_type~"+e.type+"~"+P(this.result);t("__lfsc__:blob"+n)},i.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if("__lfsc__:"!==e.substring(0,N))return JSON.parse(e);var t,n=e.substring(M),r=e.substring(N,M);if("blob"===r&&w.test(n)){var o=n.match(w);t=o[1],n=n.substring(o[0].length)}var s=L(n);switch(r){case"arbf":return s;case"blob":return i([s],{type:t});case"si08":return new Int8Array(s);case"ui08":return new Uint8Array(s);case"uic8":return new Uint8ClampedArray(s);case"si16":return new Int16Array(s);case"ur16":return new Uint16Array(s);case"si32":return new Int32Array(s);case"ui32":return new Uint32Array(s);case"fl32":return new Float32Array(s);case"fl64":return new Float64Array(s);default:throw new Error("Unkown type: "+r)}},stringToBuffer:L,bufferToString:P};function D(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function j(e,t,n,r,o,i){e.executeSql(n,r,o,(function(e,s){s.code===s.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?i(e,s):D(e,t,(function(){e.executeSql(n,r,o,i)}),i)}),i):i(e,s)}),i)}function U(e,t,n,r){var o=this;e=u(e);var i=new s((function(i,s){o.ready().then((function(){void 0===t&&(t=null);var a=t,c=o._dbInfo;c.serializer.serialize(t,(function(t,u){u?s(u):c.db.transaction((function(n){j(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){i(a)}),(function(e,t){s(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void i(U.apply(o,[e,a,n,r-1]));s(t)}}))}))})).catch(s)}));return a(i,n),i}function H(e){return new s((function(t,n){e.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var o=[],i=0;i<r.rows.length;i++)o.push(r.rows.item(i).name);t({db:e,storeNames:o})}),(function(e,t){n(t)}))}),(function(e){n(e)}))}))}var B={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var o=new s((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(o){D(o,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=A,o},_support:"function"==typeof openDatabase,iterate:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){j(n,o,"SELECT * FROM "+o.storeName,[],(function(n,r){for(var i=r.rows,s=i.length,a=0;a<s;a++){var c=i.item(a),u=c.value;if(u&&(u=o.serializer.deserialize(u)),void 0!==(u=e(u,c.key,a+1)))return void t(u)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},getItem:function(e,t){var n=this;e=u(e);var r=new s((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){j(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},setItem:function(e,t,n){return U.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;e=u(e);var r=new s((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){j(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){j(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},length:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){j(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){var r=n.rows.item(0).c;e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},key:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){j(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){j(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},dropInstance:function(e,t){t=l.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;return a(r=e.name?new s((function(t){var r;r=e.name===n.name?o._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:r,storeNames:[e.storeName]}):t(H(r))})).then((function(e){return new s((function(t,n){e.db.transaction((function(r){function o(e){return new s((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}for(var i=[],a=0,c=e.storeNames.length;a<c;a++)i.push(o(e.storeNames[a]));s.all(i).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):s.reject("Invalid arguments"),t),r}};function q(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function G(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var x={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=q(e,this._defaultConfig),G()?(this._dbInfo=t,t.serializer=A,s.resolve()):s.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,o=r.length,i=localStorage.length,s=1,a=0;a<i;a++){var c=localStorage.key(a);if(0===c.indexOf(r)){var u=localStorage.getItem(c);if(u&&(u=t.serializer.deserialize(u)),void 0!==(u=e(u,c.substring(o),s++)))return u}}}));return a(r,t),r},getItem:function(e,t){var n=this;e=u(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r}));return a(r,t),r},setItem:function(e,t,n){var r=this;e=u(e);var o=r.ready().then((function(){void 0===t&&(t=null);var n=t;return new s((function(o,i){var s=r._dbInfo;s.serializer.serialize(t,(function(t,r){if(r)i(r);else try{localStorage.setItem(s.keyPrefix+e,t),o(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||i(e),i(e)}}))}))}));return a(o,n),o},removeItem:function(e,t){var n=this;e=u(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return a(r,t),r},clear:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return a(n,e),n},length:function(e){var t=this.keys().then((function(e){return e.length}));return a(t,e),t},key:function(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t}));return a(r,t),r},keys:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var i=localStorage.key(o);0===i.indexOf(e.keyPrefix)&&r.push(i.substring(e.keyPrefix.length))}return r}));return a(n,e),n},dropInstance:function(e,t){if(t=l.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,o=this;return a(r=e.name?new s((function(t){e.storeName?t(q(e,o._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):s.reject("Invalid arguments"),t),r}},Z=function(e,t){for(var n,r,o=e.length,i=0;i<o;){if((n=e[i])===(r=t)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return!0;i++}return!1},V=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},z={},F={},W={INDEXEDDB:k,WEBSQL:B,LOCALSTORAGE:x},Y=[W.INDEXEDDB._driver,W.WEBSQL._driver,W.LOCALSTORAGE._driver],K=["dropInstance"],X=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(K),J={description:"",driver:Y.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Q(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}function $(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(V(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var ee=new(function(){function e(t){for(var n in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),W)if(W.hasOwnProperty(n)){var r=W[n],o=r._driver;this[n]=o,z[o]||this.defineDriver(r)}this._defaultConfig=$({},J),this._config=$({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":r(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new s((function(t,n){try{var r=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(o);for(var i=X.concat("_initStorage"),c=0,u=i.length;c<u;c++){var l=i[c];if((!Z(K,l)||e[l])&&"function"!=typeof e[l])return void n(o)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=s.reject(t);return a(n,arguments[arguments.length-1]),n}},n=0,r=K.length;n<r;n++){var o=K[n];e[o]||(e[o]=t(o))}}();var h=function(n){z[r]&&console.info("Redefining LocalForage driver: "+r),z[r]=e,F[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(h,n):h(!!e._support):h(!0)}catch(e){n(e)}}));return c(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=z[e]?s.resolve(z[e]):s.reject(new Error("Driver not found."));return c(r,t,n),r},e.prototype.getSerializer=function(e){var t=s.resolve(A);return c(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return c(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;V(e)||(e=[e]);var o=this._getSupportedDrivers(e);function i(){r._config.driver=r.driver()}function a(e){return r._extend(e),i(),r._ready=r._initStorage(r._config),r._ready}var u=null!==this._driverSet?this._driverSet.catch((function(){return s.resolve()})):s.resolve();return this._driverSet=u.then((function(){var e=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,i(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(e){return function(){var t=0;return function n(){for(;t<e.length;){var o=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(a).catch(n)}i();var c=new Error("No available storage method found.");return r._driverSet=s.reject(c),r._driverSet}()}}(o)}))})).catch((function(){i();var e=new Error("No available storage method found.");return r._driverSet=s.reject(e),r._driverSet})),c(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!F[e]},e.prototype._extend=function(e){$(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=X.length;e<t;e++)Q(this,X[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=ee},{3:3}]},{},[4])(4)}).call(this,n(11))}])}));
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../zego_express_web_flutter_wrapper/node_modules/buffer/index.js */ "./node_modules/buffer/index.js").Buffer))

/***/ }),

/***/ "./node_modules/base64-js/index.js":
/*!*****************************************!*\
  !*** ./node_modules/base64-js/index.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


exports.byteLength = byteLength
exports.toByteArray = toByteArray
exports.fromByteArray = fromByteArray

var lookup = []
var revLookup = []
var Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array

var code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
for (var i = 0, len = code.length; i < len; ++i) {
  lookup[i] = code[i]
  revLookup[code.charCodeAt(i)] = i
}

// Support decoding URL-safe base64 strings, as Node.js does.
// See: https://en.wikipedia.org/wiki/Base64#URL_applications
revLookup['-'.charCodeAt(0)] = 62
revLookup['_'.charCodeAt(0)] = 63

function getLens (b64) {
  var len = b64.length

  if (len % 4 > 0) {
    throw new Error('Invalid string. Length must be a multiple of 4')
  }

  // Trim off extra bytes after placeholder bytes are found
  // See: https://github.com/beatgammit/base64-js/issues/42
  var validLen = b64.indexOf('=')
  if (validLen === -1) validLen = len

  var placeHoldersLen = validLen === len
    ? 0
    : 4 - (validLen % 4)

  return [validLen, placeHoldersLen]
}

// base64 is 4/3 + up to two characters of the original data
function byteLength (b64) {
  var lens = getLens(b64)
  var validLen = lens[0]
  var placeHoldersLen = lens[1]
  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen
}

function _byteLength (b64, validLen, placeHoldersLen) {
  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen
}

function toByteArray (b64) {
  var tmp
  var lens = getLens(b64)
  var validLen = lens[0]
  var placeHoldersLen = lens[1]

  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))

  var curByte = 0

  // if there are placeholders, only get up to the last complete 4 chars
  var len = placeHoldersLen > 0
    ? validLen - 4
    : validLen

  var i
  for (i = 0; i < len; i += 4) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 18) |
      (revLookup[b64.charCodeAt(i + 1)] << 12) |
      (revLookup[b64.charCodeAt(i + 2)] << 6) |
      revLookup[b64.charCodeAt(i + 3)]
    arr[curByte++] = (tmp >> 16) & 0xFF
    arr[curByte++] = (tmp >> 8) & 0xFF
    arr[curByte++] = tmp & 0xFF
  }

  if (placeHoldersLen === 2) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 2) |
      (revLookup[b64.charCodeAt(i + 1)] >> 4)
    arr[curByte++] = tmp & 0xFF
  }

  if (placeHoldersLen === 1) {
    tmp =
      (revLookup[b64.charCodeAt(i)] << 10) |
      (revLookup[b64.charCodeAt(i + 1)] << 4) |
      (revLookup[b64.charCodeAt(i + 2)] >> 2)
    arr[curByte++] = (tmp >> 8) & 0xFF
    arr[curByte++] = tmp & 0xFF
  }

  return arr
}

function tripletToBase64 (num) {
  return lookup[num >> 18 & 0x3F] +
    lookup[num >> 12 & 0x3F] +
    lookup[num >> 6 & 0x3F] +
    lookup[num & 0x3F]
}

function encodeChunk (uint8, start, end) {
  var tmp
  var output = []
  for (var i = start; i < end; i += 3) {
    tmp =
      ((uint8[i] << 16) & 0xFF0000) +
      ((uint8[i + 1] << 8) & 0xFF00) +
      (uint8[i + 2] & 0xFF)
    output.push(tripletToBase64(tmp))
  }
  return output.join('')
}

function fromByteArray (uint8) {
  var tmp
  var len = uint8.length
  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes
  var parts = []
  var maxChunkLength = 16383 // must be multiple of 3

  // go through the array every three bytes, we'll deal with trailing stuff later
  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {
    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))
  }

  // pad the end with zeros, but make sure to not forget the extra bytes
  if (extraBytes === 1) {
    tmp = uint8[len - 1]
    parts.push(
      lookup[tmp >> 2] +
      lookup[(tmp << 4) & 0x3F] +
      '=='
    )
  } else if (extraBytes === 2) {
    tmp = (uint8[len - 2] << 8) + uint8[len - 1]
    parts.push(
      lookup[tmp >> 10] +
      lookup[(tmp >> 4) & 0x3F] +
      lookup[(tmp << 2) & 0x3F] +
      '='
    )
  }

  return parts.join('')
}


/***/ }),

/***/ "./node_modules/buffer/index.js":
/*!**************************************!*\
  !*** ./node_modules/buffer/index.js ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(global) {/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
/* eslint-disable no-proto */



var base64 = __webpack_require__(/*! base64-js */ "./node_modules/base64-js/index.js")
var ieee754 = __webpack_require__(/*! ieee754 */ "./node_modules/ieee754/index.js")
var isArray = __webpack_require__(/*! isarray */ "./node_modules/isarray/index.js")

exports.Buffer = Buffer
exports.SlowBuffer = SlowBuffer
exports.INSPECT_MAX_BYTES = 50

/**
 * If `Buffer.TYPED_ARRAY_SUPPORT`:
 *   === true    Use Uint8Array implementation (fastest)
 *   === false   Use Object implementation (most compatible, even IE6)
 *
 * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,
 * Opera 11.6+, iOS 4.2+.
 *
 * Due to various browser bugs, sometimes the Object implementation will be used even
 * when the browser supports typed arrays.
 *
 * Note:
 *
 *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,
 *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.
 *
 *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.
 *
 *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of
 *     incorrect length in some situations.

 * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they
 * get the Object implementation, which is slower but behaves correctly.
 */
Buffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined
  ? global.TYPED_ARRAY_SUPPORT
  : typedArraySupport()

/*
 * Export kMaxLength after typed array support is determined.
 */
exports.kMaxLength = kMaxLength()

function typedArraySupport () {
  try {
    var arr = new Uint8Array(1)
    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}
    return arr.foo() === 42 && // typed array instances can be augmented
        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`
        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`
  } catch (e) {
    return false
  }
}

function kMaxLength () {
  return Buffer.TYPED_ARRAY_SUPPORT
    ? 0x7fffffff
    : 0x3fffffff
}

function createBuffer (that, length) {
  if (kMaxLength() < length) {
    throw new RangeError('Invalid typed array length')
  }
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = new Uint8Array(length)
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    if (that === null) {
      that = new Buffer(length)
    }
    that.length = length
  }

  return that
}

/**
 * The Buffer constructor returns instances of `Uint8Array` that have their
 * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of
 * `Uint8Array`, so the returned instances will have all the node `Buffer` methods
 * and the `Uint8Array` methods. Square bracket notation works as expected -- it
 * returns a single octet.
 *
 * The `Uint8Array` prototype remains unmodified.
 */

function Buffer (arg, encodingOrOffset, length) {
  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {
    return new Buffer(arg, encodingOrOffset, length)
  }

  // Common case.
  if (typeof arg === 'number') {
    if (typeof encodingOrOffset === 'string') {
      throw new Error(
        'If encoding is specified then the first argument must be a string'
      )
    }
    return allocUnsafe(this, arg)
  }
  return from(this, arg, encodingOrOffset, length)
}

Buffer.poolSize = 8192 // not used by this implementation

// TODO: Legacy, not needed anymore. Remove in next major version.
Buffer._augment = function (arr) {
  arr.__proto__ = Buffer.prototype
  return arr
}

function from (that, value, encodingOrOffset, length) {
  if (typeof value === 'number') {
    throw new TypeError('"value" argument must not be a number')
  }

  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {
    return fromArrayBuffer(that, value, encodingOrOffset, length)
  }

  if (typeof value === 'string') {
    return fromString(that, value, encodingOrOffset)
  }

  return fromObject(that, value)
}

/**
 * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError
 * if value is a number.
 * Buffer.from(str[, encoding])
 * Buffer.from(array)
 * Buffer.from(buffer)
 * Buffer.from(arrayBuffer[, byteOffset[, length]])
 **/
Buffer.from = function (value, encodingOrOffset, length) {
  return from(null, value, encodingOrOffset, length)
}

if (Buffer.TYPED_ARRAY_SUPPORT) {
  Buffer.prototype.__proto__ = Uint8Array.prototype
  Buffer.__proto__ = Uint8Array
  if (typeof Symbol !== 'undefined' && Symbol.species &&
      Buffer[Symbol.species] === Buffer) {
    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97
    Object.defineProperty(Buffer, Symbol.species, {
      value: null,
      configurable: true
    })
  }
}

function assertSize (size) {
  if (typeof size !== 'number') {
    throw new TypeError('"size" argument must be a number')
  } else if (size < 0) {
    throw new RangeError('"size" argument must not be negative')
  }
}

function alloc (that, size, fill, encoding) {
  assertSize(size)
  if (size <= 0) {
    return createBuffer(that, size)
  }
  if (fill !== undefined) {
    // Only pay attention to encoding if it's a string. This
    // prevents accidentally sending in a number that would
    // be interpretted as a start offset.
    return typeof encoding === 'string'
      ? createBuffer(that, size).fill(fill, encoding)
      : createBuffer(that, size).fill(fill)
  }
  return createBuffer(that, size)
}

/**
 * Creates a new filled Buffer instance.
 * alloc(size[, fill[, encoding]])
 **/
Buffer.alloc = function (size, fill, encoding) {
  return alloc(null, size, fill, encoding)
}

function allocUnsafe (that, size) {
  assertSize(size)
  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) {
    for (var i = 0; i < size; ++i) {
      that[i] = 0
    }
  }
  return that
}

/**
 * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.
 * */
Buffer.allocUnsafe = function (size) {
  return allocUnsafe(null, size)
}
/**
 * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.
 */
Buffer.allocUnsafeSlow = function (size) {
  return allocUnsafe(null, size)
}

function fromString (that, string, encoding) {
  if (typeof encoding !== 'string' || encoding === '') {
    encoding = 'utf8'
  }

  if (!Buffer.isEncoding(encoding)) {
    throw new TypeError('"encoding" must be a valid string encoding')
  }

  var length = byteLength(string, encoding) | 0
  that = createBuffer(that, length)

  var actual = that.write(string, encoding)

  if (actual !== length) {
    // Writing a hex string, for example, that contains invalid characters will
    // cause everything after the first invalid character to be ignored. (e.g.
    // 'abxxcd' will be treated as 'ab')
    that = that.slice(0, actual)
  }

  return that
}

function fromArrayLike (that, array) {
  var length = array.length < 0 ? 0 : checked(array.length) | 0
  that = createBuffer(that, length)
  for (var i = 0; i < length; i += 1) {
    that[i] = array[i] & 255
  }
  return that
}

function fromArrayBuffer (that, array, byteOffset, length) {
  array.byteLength // this throws if `array` is not a valid ArrayBuffer

  if (byteOffset < 0 || array.byteLength < byteOffset) {
    throw new RangeError('\'offset\' is out of bounds')
  }

  if (array.byteLength < byteOffset + (length || 0)) {
    throw new RangeError('\'length\' is out of bounds')
  }

  if (byteOffset === undefined && length === undefined) {
    array = new Uint8Array(array)
  } else if (length === undefined) {
    array = new Uint8Array(array, byteOffset)
  } else {
    array = new Uint8Array(array, byteOffset, length)
  }

  if (Buffer.TYPED_ARRAY_SUPPORT) {
    // Return an augmented `Uint8Array` instance, for best performance
    that = array
    that.__proto__ = Buffer.prototype
  } else {
    // Fallback: Return an object instance of the Buffer class
    that = fromArrayLike(that, array)
  }
  return that
}

function fromObject (that, obj) {
  if (Buffer.isBuffer(obj)) {
    var len = checked(obj.length) | 0
    that = createBuffer(that, len)

    if (that.length === 0) {
      return that
    }

    obj.copy(that, 0, 0, len)
    return that
  }

  if (obj) {
    if ((typeof ArrayBuffer !== 'undefined' &&
        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {
      if (typeof obj.length !== 'number' || isnan(obj.length)) {
        return createBuffer(that, 0)
      }
      return fromArrayLike(that, obj)
    }

    if (obj.type === 'Buffer' && isArray(obj.data)) {
      return fromArrayLike(that, obj.data)
    }
  }

  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')
}

function checked (length) {
  // Note: cannot use `length < kMaxLength()` here because that fails when
  // length is NaN (which is otherwise coerced to zero.)
  if (length >= kMaxLength()) {
    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +
                         'size: 0x' + kMaxLength().toString(16) + ' bytes')
  }
  return length | 0
}

function SlowBuffer (length) {
  if (+length != length) { // eslint-disable-line eqeqeq
    length = 0
  }
  return Buffer.alloc(+length)
}

Buffer.isBuffer = function isBuffer (b) {
  return !!(b != null && b._isBuffer)
}

Buffer.compare = function compare (a, b) {
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
    throw new TypeError('Arguments must be Buffers')
  }

  if (a === b) return 0

  var x = a.length
  var y = b.length

  for (var i = 0, len = Math.min(x, y); i < len; ++i) {
    if (a[i] !== b[i]) {
      x = a[i]
      y = b[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

Buffer.isEncoding = function isEncoding (encoding) {
  switch (String(encoding).toLowerCase()) {
    case 'hex':
    case 'utf8':
    case 'utf-8':
    case 'ascii':
    case 'latin1':
    case 'binary':
    case 'base64':
    case 'ucs2':
    case 'ucs-2':
    case 'utf16le':
    case 'utf-16le':
      return true
    default:
      return false
  }
}

Buffer.concat = function concat (list, length) {
  if (!isArray(list)) {
    throw new TypeError('"list" argument must be an Array of Buffers')
  }

  if (list.length === 0) {
    return Buffer.alloc(0)
  }

  var i
  if (length === undefined) {
    length = 0
    for (i = 0; i < list.length; ++i) {
      length += list[i].length
    }
  }

  var buffer = Buffer.allocUnsafe(length)
  var pos = 0
  for (i = 0; i < list.length; ++i) {
    var buf = list[i]
    if (!Buffer.isBuffer(buf)) {
      throw new TypeError('"list" argument must be an Array of Buffers')
    }
    buf.copy(buffer, pos)
    pos += buf.length
  }
  return buffer
}

function byteLength (string, encoding) {
  if (Buffer.isBuffer(string)) {
    return string.length
  }
  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&
      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {
    return string.byteLength
  }
  if (typeof string !== 'string') {
    string = '' + string
  }

  var len = string.length
  if (len === 0) return 0

  // Use a for loop to avoid recursion
  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'ascii':
      case 'latin1':
      case 'binary':
        return len
      case 'utf8':
      case 'utf-8':
      case undefined:
        return utf8ToBytes(string).length
      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return len * 2
      case 'hex':
        return len >>> 1
      case 'base64':
        return base64ToBytes(string).length
      default:
        if (loweredCase) return utf8ToBytes(string).length // assume utf8
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}
Buffer.byteLength = byteLength

function slowToString (encoding, start, end) {
  var loweredCase = false

  // No need to verify that "this.length <= MAX_UINT32" since it's a read-only
  // property of a typed array.

  // This behaves neither like String nor Uint8Array in that we set start/end
  // to their upper/lower bounds if the value passed is out of range.
  // undefined is handled specially as per ECMA-262 6th Edition,
  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.
  if (start === undefined || start < 0) {
    start = 0
  }
  // Return early if start > this.length. Done here to prevent potential uint32
  // coercion fail below.
  if (start > this.length) {
    return ''
  }

  if (end === undefined || end > this.length) {
    end = this.length
  }

  if (end <= 0) {
    return ''
  }

  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.
  end >>>= 0
  start >>>= 0

  if (end <= start) {
    return ''
  }

  if (!encoding) encoding = 'utf8'

  while (true) {
    switch (encoding) {
      case 'hex':
        return hexSlice(this, start, end)

      case 'utf8':
      case 'utf-8':
        return utf8Slice(this, start, end)

      case 'ascii':
        return asciiSlice(this, start, end)

      case 'latin1':
      case 'binary':
        return latin1Slice(this, start, end)

      case 'base64':
        return base64Slice(this, start, end)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return utf16leSlice(this, start, end)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = (encoding + '').toLowerCase()
        loweredCase = true
    }
  }
}

// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect
// Buffer instances.
Buffer.prototype._isBuffer = true

function swap (b, n, m) {
  var i = b[n]
  b[n] = b[m]
  b[m] = i
}

Buffer.prototype.swap16 = function swap16 () {
  var len = this.length
  if (len % 2 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 16-bits')
  }
  for (var i = 0; i < len; i += 2) {
    swap(this, i, i + 1)
  }
  return this
}

Buffer.prototype.swap32 = function swap32 () {
  var len = this.length
  if (len % 4 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 32-bits')
  }
  for (var i = 0; i < len; i += 4) {
    swap(this, i, i + 3)
    swap(this, i + 1, i + 2)
  }
  return this
}

Buffer.prototype.swap64 = function swap64 () {
  var len = this.length
  if (len % 8 !== 0) {
    throw new RangeError('Buffer size must be a multiple of 64-bits')
  }
  for (var i = 0; i < len; i += 8) {
    swap(this, i, i + 7)
    swap(this, i + 1, i + 6)
    swap(this, i + 2, i + 5)
    swap(this, i + 3, i + 4)
  }
  return this
}

Buffer.prototype.toString = function toString () {
  var length = this.length | 0
  if (length === 0) return ''
  if (arguments.length === 0) return utf8Slice(this, 0, length)
  return slowToString.apply(this, arguments)
}

Buffer.prototype.equals = function equals (b) {
  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')
  if (this === b) return true
  return Buffer.compare(this, b) === 0
}

Buffer.prototype.inspect = function inspect () {
  var str = ''
  var max = exports.INSPECT_MAX_BYTES
  if (this.length > 0) {
    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')
    if (this.length > max) str += ' ... '
  }
  return '<Buffer ' + str + '>'
}

Buffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {
  if (!Buffer.isBuffer(target)) {
    throw new TypeError('Argument must be a Buffer')
  }

  if (start === undefined) {
    start = 0
  }
  if (end === undefined) {
    end = target ? target.length : 0
  }
  if (thisStart === undefined) {
    thisStart = 0
  }
  if (thisEnd === undefined) {
    thisEnd = this.length
  }

  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {
    throw new RangeError('out of range index')
  }

  if (thisStart >= thisEnd && start >= end) {
    return 0
  }
  if (thisStart >= thisEnd) {
    return -1
  }
  if (start >= end) {
    return 1
  }

  start >>>= 0
  end >>>= 0
  thisStart >>>= 0
  thisEnd >>>= 0

  if (this === target) return 0

  var x = thisEnd - thisStart
  var y = end - start
  var len = Math.min(x, y)

  var thisCopy = this.slice(thisStart, thisEnd)
  var targetCopy = target.slice(start, end)

  for (var i = 0; i < len; ++i) {
    if (thisCopy[i] !== targetCopy[i]) {
      x = thisCopy[i]
      y = targetCopy[i]
      break
    }
  }

  if (x < y) return -1
  if (y < x) return 1
  return 0
}

// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,
// OR the last index of `val` in `buffer` at offset <= `byteOffset`.
//
// Arguments:
// - buffer - a Buffer to search
// - val - a string, Buffer, or number
// - byteOffset - an index into `buffer`; will be clamped to an int32
// - encoding - an optional encoding, relevant is val is a string
// - dir - true for indexOf, false for lastIndexOf
function bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {
  // Empty buffer means no match
  if (buffer.length === 0) return -1

  // Normalize byteOffset
  if (typeof byteOffset === 'string') {
    encoding = byteOffset
    byteOffset = 0
  } else if (byteOffset > 0x7fffffff) {
    byteOffset = 0x7fffffff
  } else if (byteOffset < -0x80000000) {
    byteOffset = -0x80000000
  }
  byteOffset = +byteOffset  // Coerce to Number.
  if (isNaN(byteOffset)) {
    // byteOffset: it it's undefined, null, NaN, "foo", etc, search whole buffer
    byteOffset = dir ? 0 : (buffer.length - 1)
  }

  // Normalize byteOffset: negative offsets start from the end of the buffer
  if (byteOffset < 0) byteOffset = buffer.length + byteOffset
  if (byteOffset >= buffer.length) {
    if (dir) return -1
    else byteOffset = buffer.length - 1
  } else if (byteOffset < 0) {
    if (dir) byteOffset = 0
    else return -1
  }

  // Normalize val
  if (typeof val === 'string') {
    val = Buffer.from(val, encoding)
  }

  // Finally, search either indexOf (if dir is true) or lastIndexOf
  if (Buffer.isBuffer(val)) {
    // Special case: looking for empty string/buffer always fails
    if (val.length === 0) {
      return -1
    }
    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)
  } else if (typeof val === 'number') {
    val = val & 0xFF // Search for a byte value [0-255]
    if (Buffer.TYPED_ARRAY_SUPPORT &&
        typeof Uint8Array.prototype.indexOf === 'function') {
      if (dir) {
        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)
      } else {
        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)
      }
    }
    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)
  }

  throw new TypeError('val must be string, number or Buffer')
}

function arrayIndexOf (arr, val, byteOffset, encoding, dir) {
  var indexSize = 1
  var arrLength = arr.length
  var valLength = val.length

  if (encoding !== undefined) {
    encoding = String(encoding).toLowerCase()
    if (encoding === 'ucs2' || encoding === 'ucs-2' ||
        encoding === 'utf16le' || encoding === 'utf-16le') {
      if (arr.length < 2 || val.length < 2) {
        return -1
      }
      indexSize = 2
      arrLength /= 2
      valLength /= 2
      byteOffset /= 2
    }
  }

  function read (buf, i) {
    if (indexSize === 1) {
      return buf[i]
    } else {
      return buf.readUInt16BE(i * indexSize)
    }
  }

  var i
  if (dir) {
    var foundIndex = -1
    for (i = byteOffset; i < arrLength; i++) {
      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {
        if (foundIndex === -1) foundIndex = i
        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize
      } else {
        if (foundIndex !== -1) i -= i - foundIndex
        foundIndex = -1
      }
    }
  } else {
    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength
    for (i = byteOffset; i >= 0; i--) {
      var found = true
      for (var j = 0; j < valLength; j++) {
        if (read(arr, i + j) !== read(val, j)) {
          found = false
          break
        }
      }
      if (found) return i
    }
  }

  return -1
}

Buffer.prototype.includes = function includes (val, byteOffset, encoding) {
  return this.indexOf(val, byteOffset, encoding) !== -1
}

Buffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)
}

Buffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {
  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)
}

function hexWrite (buf, string, offset, length) {
  offset = Number(offset) || 0
  var remaining = buf.length - offset
  if (!length) {
    length = remaining
  } else {
    length = Number(length)
    if (length > remaining) {
      length = remaining
    }
  }

  // must be an even number of digits
  var strLen = string.length
  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')

  if (length > strLen / 2) {
    length = strLen / 2
  }
  for (var i = 0; i < length; ++i) {
    var parsed = parseInt(string.substr(i * 2, 2), 16)
    if (isNaN(parsed)) return i
    buf[offset + i] = parsed
  }
  return i
}

function utf8Write (buf, string, offset, length) {
  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)
}

function asciiWrite (buf, string, offset, length) {
  return blitBuffer(asciiToBytes(string), buf, offset, length)
}

function latin1Write (buf, string, offset, length) {
  return asciiWrite(buf, string, offset, length)
}

function base64Write (buf, string, offset, length) {
  return blitBuffer(base64ToBytes(string), buf, offset, length)
}

function ucs2Write (buf, string, offset, length) {
  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)
}

Buffer.prototype.write = function write (string, offset, length, encoding) {
  // Buffer#write(string)
  if (offset === undefined) {
    encoding = 'utf8'
    length = this.length
    offset = 0
  // Buffer#write(string, encoding)
  } else if (length === undefined && typeof offset === 'string') {
    encoding = offset
    length = this.length
    offset = 0
  // Buffer#write(string, offset[, length][, encoding])
  } else if (isFinite(offset)) {
    offset = offset | 0
    if (isFinite(length)) {
      length = length | 0
      if (encoding === undefined) encoding = 'utf8'
    } else {
      encoding = length
      length = undefined
    }
  // legacy write(string, encoding, offset, length) - remove in v0.13
  } else {
    throw new Error(
      'Buffer.write(string, encoding, offset[, length]) is no longer supported'
    )
  }

  var remaining = this.length - offset
  if (length === undefined || length > remaining) length = remaining

  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {
    throw new RangeError('Attempt to write outside buffer bounds')
  }

  if (!encoding) encoding = 'utf8'

  var loweredCase = false
  for (;;) {
    switch (encoding) {
      case 'hex':
        return hexWrite(this, string, offset, length)

      case 'utf8':
      case 'utf-8':
        return utf8Write(this, string, offset, length)

      case 'ascii':
        return asciiWrite(this, string, offset, length)

      case 'latin1':
      case 'binary':
        return latin1Write(this, string, offset, length)

      case 'base64':
        // Warning: maxLength not taken into account in base64Write
        return base64Write(this, string, offset, length)

      case 'ucs2':
      case 'ucs-2':
      case 'utf16le':
      case 'utf-16le':
        return ucs2Write(this, string, offset, length)

      default:
        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)
        encoding = ('' + encoding).toLowerCase()
        loweredCase = true
    }
  }
}

Buffer.prototype.toJSON = function toJSON () {
  return {
    type: 'Buffer',
    data: Array.prototype.slice.call(this._arr || this, 0)
  }
}

function base64Slice (buf, start, end) {
  if (start === 0 && end === buf.length) {
    return base64.fromByteArray(buf)
  } else {
    return base64.fromByteArray(buf.slice(start, end))
  }
}

function utf8Slice (buf, start, end) {
  end = Math.min(buf.length, end)
  var res = []

  var i = start
  while (i < end) {
    var firstByte = buf[i]
    var codePoint = null
    var bytesPerSequence = (firstByte > 0xEF) ? 4
      : (firstByte > 0xDF) ? 3
      : (firstByte > 0xBF) ? 2
      : 1

    if (i + bytesPerSequence <= end) {
      var secondByte, thirdByte, fourthByte, tempCodePoint

      switch (bytesPerSequence) {
        case 1:
          if (firstByte < 0x80) {
            codePoint = firstByte
          }
          break
        case 2:
          secondByte = buf[i + 1]
          if ((secondByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)
            if (tempCodePoint > 0x7F) {
              codePoint = tempCodePoint
            }
          }
          break
        case 3:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)
            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {
              codePoint = tempCodePoint
            }
          }
          break
        case 4:
          secondByte = buf[i + 1]
          thirdByte = buf[i + 2]
          fourthByte = buf[i + 3]
          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {
            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)
            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {
              codePoint = tempCodePoint
            }
          }
      }
    }

    if (codePoint === null) {
      // we did not generate a valid codePoint so insert a
      // replacement char (U+FFFD) and advance only 1 byte
      codePoint = 0xFFFD
      bytesPerSequence = 1
    } else if (codePoint > 0xFFFF) {
      // encode to utf16 (surrogate pair dance)
      codePoint -= 0x10000
      res.push(codePoint >>> 10 & 0x3FF | 0xD800)
      codePoint = 0xDC00 | codePoint & 0x3FF
    }

    res.push(codePoint)
    i += bytesPerSequence
  }

  return decodeCodePointsArray(res)
}

// Based on http://stackoverflow.com/a/22747272/680742, the browser with
// the lowest limit is Chrome, with 0x10000 args.
// We go 1 magnitude less, for safety
var MAX_ARGUMENTS_LENGTH = 0x1000

function decodeCodePointsArray (codePoints) {
  var len = codePoints.length
  if (len <= MAX_ARGUMENTS_LENGTH) {
    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()
  }

  // Decode in chunks to avoid "call stack size exceeded".
  var res = ''
  var i = 0
  while (i < len) {
    res += String.fromCharCode.apply(
      String,
      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)
    )
  }
  return res
}

function asciiSlice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i] & 0x7F)
  }
  return ret
}

function latin1Slice (buf, start, end) {
  var ret = ''
  end = Math.min(buf.length, end)

  for (var i = start; i < end; ++i) {
    ret += String.fromCharCode(buf[i])
  }
  return ret
}

function hexSlice (buf, start, end) {
  var len = buf.length

  if (!start || start < 0) start = 0
  if (!end || end < 0 || end > len) end = len

  var out = ''
  for (var i = start; i < end; ++i) {
    out += toHex(buf[i])
  }
  return out
}

function utf16leSlice (buf, start, end) {
  var bytes = buf.slice(start, end)
  var res = ''
  for (var i = 0; i < bytes.length; i += 2) {
    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)
  }
  return res
}

Buffer.prototype.slice = function slice (start, end) {
  var len = this.length
  start = ~~start
  end = end === undefined ? len : ~~end

  if (start < 0) {
    start += len
    if (start < 0) start = 0
  } else if (start > len) {
    start = len
  }

  if (end < 0) {
    end += len
    if (end < 0) end = 0
  } else if (end > len) {
    end = len
  }

  if (end < start) end = start

  var newBuf
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    newBuf = this.subarray(start, end)
    newBuf.__proto__ = Buffer.prototype
  } else {
    var sliceLen = end - start
    newBuf = new Buffer(sliceLen, undefined)
    for (var i = 0; i < sliceLen; ++i) {
      newBuf[i] = this[i + start]
    }
  }

  return newBuf
}

/*
 * Need to make sure that buffer isn't trying to write out of bounds.
 */
function checkOffset (offset, ext, length) {
  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')
  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')
}

Buffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }

  return val
}

Buffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    checkOffset(offset, byteLength, this.length)
  }

  var val = this[offset + --byteLength]
  var mul = 1
  while (byteLength > 0 && (mul *= 0x100)) {
    val += this[offset + --byteLength] * mul
  }

  return val
}

Buffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  return this[offset]
}

Buffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return this[offset] | (this[offset + 1] << 8)
}

Buffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  return (this[offset] << 8) | this[offset + 1]
}

Buffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return ((this[offset]) |
      (this[offset + 1] << 8) |
      (this[offset + 2] << 16)) +
      (this[offset + 3] * 0x1000000)
}

Buffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] * 0x1000000) +
    ((this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    this[offset + 3])
}

Buffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var val = this[offset]
  var mul = 1
  var i = 0
  while (++i < byteLength && (mul *= 0x100)) {
    val += this[offset + i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) checkOffset(offset, byteLength, this.length)

  var i = byteLength
  var mul = 1
  var val = this[offset + --i]
  while (i > 0 && (mul *= 0x100)) {
    val += this[offset + --i] * mul
  }
  mul *= 0x80

  if (val >= mul) val -= Math.pow(2, 8 * byteLength)

  return val
}

Buffer.prototype.readInt8 = function readInt8 (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 1, this.length)
  if (!(this[offset] & 0x80)) return (this[offset])
  return ((0xff - this[offset] + 1) * -1)
}

Buffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset] | (this[offset + 1] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 2, this.length)
  var val = this[offset + 1] | (this[offset] << 8)
  return (val & 0x8000) ? val | 0xFFFF0000 : val
}

Buffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset]) |
    (this[offset + 1] << 8) |
    (this[offset + 2] << 16) |
    (this[offset + 3] << 24)
}

Buffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)

  return (this[offset] << 24) |
    (this[offset + 1] << 16) |
    (this[offset + 2] << 8) |
    (this[offset + 3])
}

Buffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, true, 23, 4)
}

Buffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 4, this.length)
  return ieee754.read(this, offset, false, 23, 4)
}

Buffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, true, 52, 8)
}

Buffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {
  if (!noAssert) checkOffset(offset, 8, this.length)
  return ieee754.read(this, offset, false, 52, 8)
}

function checkInt (buf, value, offset, ext, max, min) {
  if (!Buffer.isBuffer(buf)) throw new TypeError('"buffer" argument must be a Buffer instance')
  if (value > max || value < min) throw new RangeError('"value" argument is out of bounds')
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
}

Buffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var mul = 1
  var i = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  byteLength = byteLength | 0
  if (!noAssert) {
    var maxBytes = Math.pow(2, 8 * byteLength) - 1
    checkInt(this, value, offset, byteLength, maxBytes, 0)
  }

  var i = byteLength - 1
  var mul = 1
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    this[offset + i] = (value / mul) & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  this[offset] = (value & 0xff)
  return offset + 1
}

function objectWriteUInt16 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {
    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>
      (littleEndian ? i : 1 - i) * 8
  }
}

Buffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

function objectWriteUInt32 (buf, value, offset, littleEndian) {
  if (value < 0) value = 0xffffffff + value + 1
  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {
    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff
  }
}

Buffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset + 3] = (value >>> 24)
    this[offset + 2] = (value >>> 16)
    this[offset + 1] = (value >>> 8)
    this[offset] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

Buffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = 0
  var mul = 1
  var sub = 0
  this[offset] = value & 0xFF
  while (++i < byteLength && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) {
    var limit = Math.pow(2, 8 * byteLength - 1)

    checkInt(this, value, offset, byteLength, limit - 1, -limit)
  }

  var i = byteLength - 1
  var mul = 1
  var sub = 0
  this[offset + i] = value & 0xFF
  while (--i >= 0 && (mul *= 0x100)) {
    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {
      sub = 1
    }
    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF
  }

  return offset + byteLength
}

Buffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)
  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)
  if (value < 0) value = 0xff + value + 1
  this[offset] = (value & 0xff)
  return offset + 1
}

Buffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
  } else {
    objectWriteUInt16(this, value, offset, true)
  }
  return offset + 2
}

Buffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 8)
    this[offset + 1] = (value & 0xff)
  } else {
    objectWriteUInt16(this, value, offset, false)
  }
  return offset + 2
}

Buffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value & 0xff)
    this[offset + 1] = (value >>> 8)
    this[offset + 2] = (value >>> 16)
    this[offset + 3] = (value >>> 24)
  } else {
    objectWriteUInt32(this, value, offset, true)
  }
  return offset + 4
}

Buffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {
  value = +value
  offset = offset | 0
  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)
  if (value < 0) value = 0xffffffff + value + 1
  if (Buffer.TYPED_ARRAY_SUPPORT) {
    this[offset] = (value >>> 24)
    this[offset + 1] = (value >>> 16)
    this[offset + 2] = (value >>> 8)
    this[offset + 3] = (value & 0xff)
  } else {
    objectWriteUInt32(this, value, offset, false)
  }
  return offset + 4
}

function checkIEEE754 (buf, value, offset, ext, max, min) {
  if (offset + ext > buf.length) throw new RangeError('Index out of range')
  if (offset < 0) throw new RangeError('Index out of range')
}

function writeFloat (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)
  }
  ieee754.write(buf, value, offset, littleEndian, 23, 4)
  return offset + 4
}

Buffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {
  return writeFloat(this, value, offset, true, noAssert)
}

Buffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {
  return writeFloat(this, value, offset, false, noAssert)
}

function writeDouble (buf, value, offset, littleEndian, noAssert) {
  if (!noAssert) {
    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)
  }
  ieee754.write(buf, value, offset, littleEndian, 52, 8)
  return offset + 8
}

Buffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {
  return writeDouble(this, value, offset, true, noAssert)
}

Buffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {
  return writeDouble(this, value, offset, false, noAssert)
}

// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)
Buffer.prototype.copy = function copy (target, targetStart, start, end) {
  if (!start) start = 0
  if (!end && end !== 0) end = this.length
  if (targetStart >= target.length) targetStart = target.length
  if (!targetStart) targetStart = 0
  if (end > 0 && end < start) end = start

  // Copy 0 bytes; we're done
  if (end === start) return 0
  if (target.length === 0 || this.length === 0) return 0

  // Fatal error conditions
  if (targetStart < 0) {
    throw new RangeError('targetStart out of bounds')
  }
  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')
  if (end < 0) throw new RangeError('sourceEnd out of bounds')

  // Are we oob?
  if (end > this.length) end = this.length
  if (target.length - targetStart < end - start) {
    end = target.length - targetStart + start
  }

  var len = end - start
  var i

  if (this === target && start < targetStart && targetStart < end) {
    // descending copy from end
    for (i = len - 1; i >= 0; --i) {
      target[i + targetStart] = this[i + start]
    }
  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {
    // ascending copy from start
    for (i = 0; i < len; ++i) {
      target[i + targetStart] = this[i + start]
    }
  } else {
    Uint8Array.prototype.set.call(
      target,
      this.subarray(start, start + len),
      targetStart
    )
  }

  return len
}

// Usage:
//    buffer.fill(number[, offset[, end]])
//    buffer.fill(buffer[, offset[, end]])
//    buffer.fill(string[, offset[, end]][, encoding])
Buffer.prototype.fill = function fill (val, start, end, encoding) {
  // Handle string cases:
  if (typeof val === 'string') {
    if (typeof start === 'string') {
      encoding = start
      start = 0
      end = this.length
    } else if (typeof end === 'string') {
      encoding = end
      end = this.length
    }
    if (val.length === 1) {
      var code = val.charCodeAt(0)
      if (code < 256) {
        val = code
      }
    }
    if (encoding !== undefined && typeof encoding !== 'string') {
      throw new TypeError('encoding must be a string')
    }
    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {
      throw new TypeError('Unknown encoding: ' + encoding)
    }
  } else if (typeof val === 'number') {
    val = val & 255
  }

  // Invalid ranges are not set to a default, so can range check early.
  if (start < 0 || this.length < start || this.length < end) {
    throw new RangeError('Out of range index')
  }

  if (end <= start) {
    return this
  }

  start = start >>> 0
  end = end === undefined ? this.length : end >>> 0

  if (!val) val = 0

  var i
  if (typeof val === 'number') {
    for (i = start; i < end; ++i) {
      this[i] = val
    }
  } else {
    var bytes = Buffer.isBuffer(val)
      ? val
      : utf8ToBytes(new Buffer(val, encoding).toString())
    var len = bytes.length
    for (i = 0; i < end - start; ++i) {
      this[i + start] = bytes[i % len]
    }
  }

  return this
}

// HELPER FUNCTIONS
// ================

var INVALID_BASE64_RE = /[^+\/0-9A-Za-z-_]/g

function base64clean (str) {
  // Node strips out invalid characters like \n and \t from the string, base64-js does not
  str = stringtrim(str).replace(INVALID_BASE64_RE, '')
  // Node converts strings with length < 2 to ''
  if (str.length < 2) return ''
  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not
  while (str.length % 4 !== 0) {
    str = str + '='
  }
  return str
}

function stringtrim (str) {
  if (str.trim) return str.trim()
  return str.replace(/^\s+|\s+$/g, '')
}

function toHex (n) {
  if (n < 16) return '0' + n.toString(16)
  return n.toString(16)
}

function utf8ToBytes (string, units) {
  units = units || Infinity
  var codePoint
  var length = string.length
  var leadSurrogate = null
  var bytes = []

  for (var i = 0; i < length; ++i) {
    codePoint = string.charCodeAt(i)

    // is surrogate component
    if (codePoint > 0xD7FF && codePoint < 0xE000) {
      // last char was a lead
      if (!leadSurrogate) {
        // no lead yet
        if (codePoint > 0xDBFF) {
          // unexpected trail
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        } else if (i + 1 === length) {
          // unpaired lead
          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
          continue
        }

        // valid lead
        leadSurrogate = codePoint

        continue
      }

      // 2 leads in a row
      if (codePoint < 0xDC00) {
        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
        leadSurrogate = codePoint
        continue
      }

      // valid surrogate pair
      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000
    } else if (leadSurrogate) {
      // valid bmp char, but last char was a lead
      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)
    }

    leadSurrogate = null

    // encode utf8
    if (codePoint < 0x80) {
      if ((units -= 1) < 0) break
      bytes.push(codePoint)
    } else if (codePoint < 0x800) {
      if ((units -= 2) < 0) break
      bytes.push(
        codePoint >> 0x6 | 0xC0,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x10000) {
      if ((units -= 3) < 0) break
      bytes.push(
        codePoint >> 0xC | 0xE0,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else if (codePoint < 0x110000) {
      if ((units -= 4) < 0) break
      bytes.push(
        codePoint >> 0x12 | 0xF0,
        codePoint >> 0xC & 0x3F | 0x80,
        codePoint >> 0x6 & 0x3F | 0x80,
        codePoint & 0x3F | 0x80
      )
    } else {
      throw new Error('Invalid code point')
    }
  }

  return bytes
}

function asciiToBytes (str) {
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    // Node's code seems to be doing this and not & 0x7F..
    byteArray.push(str.charCodeAt(i) & 0xFF)
  }
  return byteArray
}

function utf16leToBytes (str, units) {
  var c, hi, lo
  var byteArray = []
  for (var i = 0; i < str.length; ++i) {
    if ((units -= 2) < 0) break

    c = str.charCodeAt(i)
    hi = c >> 8
    lo = c % 256
    byteArray.push(lo)
    byteArray.push(hi)
  }

  return byteArray
}

function base64ToBytes (str) {
  return base64.toByteArray(base64clean(str))
}

function blitBuffer (src, dst, offset, length) {
  for (var i = 0; i < length; ++i) {
    if ((i + offset >= dst.length) || (i >= src.length)) break
    dst[i + offset] = src[i]
  }
  return i
}

function isnan (val) {
  return val !== val // eslint-disable-line no-self-compare
}

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "./node_modules/ieee754/index.js":
/*!***************************************!*\
  !*** ./node_modules/ieee754/index.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
exports.read = function (buffer, offset, isLE, mLen, nBytes) {
  var e, m
  var eLen = (nBytes * 8) - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var nBits = -7
  var i = isLE ? (nBytes - 1) : 0
  var d = isLE ? -1 : 1
  var s = buffer[offset + i]

  i += d

  e = s & ((1 << (-nBits)) - 1)
  s >>= (-nBits)
  nBits += eLen
  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}

  m = e & ((1 << (-nBits)) - 1)
  e >>= (-nBits)
  nBits += mLen
  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}

  if (e === 0) {
    e = 1 - eBias
  } else if (e === eMax) {
    return m ? NaN : ((s ? -1 : 1) * Infinity)
  } else {
    m = m + Math.pow(2, mLen)
    e = e - eBias
  }
  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)
}

exports.write = function (buffer, value, offset, isLE, mLen, nBytes) {
  var e, m, c
  var eLen = (nBytes * 8) - mLen - 1
  var eMax = (1 << eLen) - 1
  var eBias = eMax >> 1
  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)
  var i = isLE ? 0 : (nBytes - 1)
  var d = isLE ? 1 : -1
  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0

  value = Math.abs(value)

  if (isNaN(value) || value === Infinity) {
    m = isNaN(value) ? 1 : 0
    e = eMax
  } else {
    e = Math.floor(Math.log(value) / Math.LN2)
    if (value * (c = Math.pow(2, -e)) < 1) {
      e--
      c *= 2
    }
    if (e + eBias >= 1) {
      value += rt / c
    } else {
      value += rt * Math.pow(2, 1 - eBias)
    }
    if (value * c >= 2) {
      e++
      c /= 2
    }

    if (e + eBias >= eMax) {
      m = 0
      e = eMax
    } else if (e + eBias >= 1) {
      m = ((value * c) - 1) * Math.pow(2, mLen)
      e = e + eBias
    } else {
      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)
      e = 0
    }
  }

  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}

  e = (e << mLen) | m
  eLen += mLen
  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}

  buffer[offset + i - d] |= s * 128
}


/***/ }),

/***/ "./node_modules/isarray/index.js":
/*!***************************************!*\
  !*** ./node_modules/isarray/index.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

var toString = {}.toString;

module.exports = Array.isArray || function (arr) {
  return toString.call(arr) == '[object Array]';
};


/***/ }),

/***/ "./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),

/***/ "./sdk/src/common/index.ts":
/*!*********************************!*\
  !*** ./sdk/src/common/index.ts ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
exports.BaseCenter = void 0;
var zego_entity_1 = __webpack_require__(/*! ./zego.entity */ "./sdk/src/common/zego.entity.ts");
var zego_express_engine_webrtc_1 = __webpack_require__(/*! zego-express-engine-webrtc */ "../zego-express-WebRTC/dist/ZegoExpressWebRTC.js");
var zego_error_1 = __webpack_require__(/*! ./zego.error */ "./sdk/src/common/zego.error.ts");
var BaseCenter = /** @class */ (function () {
    function BaseCenter() {
    }
    /*********
     *
     * web
     *
     *
     * ****/
    /*
     *    "zl.cm.cf": "ZegoExpressEngine.base.config",
     */
    BaseCenter.prototype.createEngineWithProfile = function (profile) {
        this.zegoEntity = new zego_express_engine_webrtc_1.ZegoExpressEngine(profile["appID"], profile["server"]);
        //@ts-ignore
        this.zegoWebRTC = this.zegoEntity.zegoWebRTC;
        // @ts-ignore
        this.logger = this.zegoEntity.logger;
        this.streamVideoCenter.logger = this.logger;
        this.logger.info("zb.cm.cf call, version " + zego_entity_1.PROTO_VERSION);
        this.listen();
        this.zegoEntity.setDebugVerbose(this.stateCenter.debugVerbose);
        // if (typeof option.maxRetryTime == "number" && option.maxRetryTime < 3600) {
        //   this.stateCenter.roomRetryTime = this.stateCenter.streamRetryTime =
        //     option.maxRetryTime;
        // }\
    };
    //---
    BaseCenter.prototype.loginRoom = function (roomID, user, config) {
        if (typeof config.isUserStatusNotify == "boolean") {
            this.stateCenter.userStateUpdate = config.isUserStatusNotify;
        }
        this.zegoEntity.loginRoom(roomID, config.token, user, { userUpdate: this.stateCenter.userStateUpdate });
    };
    BaseCenter.prototype.logoutRoom = function (roomID) {
        this.logger.info("zc.lg.0 call");
        this.zegoEntity.logoutRoom();
        return true;
    };
    BaseCenter.prototype.setUserStateUpdate = function (update) {
        if (typeof update !== "boolean") {
            console.error("setUserStateUpdate param error");
            return;
        }
        this.stateCenter.userStateUpdate = update;
    };
    /*
     *    "zc.p.r": "ZegoExpressEngine.release"
     */
    BaseCenter.prototype.sendCustomCommand = function (dstMembers, customContent, success, error) {
        if (typeof customContent !== "string" &&
            typeof customContent !== "object") {
            this.logger.error("zl.mh.scc params error");
            return false;
        }
        this.zegoEntity.zegoWebRTM
            ._sendCustomCommand(this.stateCenter.roomid, JSON.stringify(customContent), dstMembers)
            .then(function (res) {
            success(res.seq, JSON.stringify(customContent));
        })
            .catch(function (err) {
            error({ code: err.errorCode, msg: err.extendedData }, err.seq, JSON.stringify(customContent));
        });
        return true;
    };
    BaseCenter.prototype.sendBroadcastMessage = function (roomID, message) {
        this.zegoEntity.sendBroadcastMessage(roomID, message);
    };
    BaseCenter.prototype.sendReliableMessage = function (type, data, success, error) {
        this.zegoEntity.zegoWebRTM
            ._setRoomExtraInfo(this.stateCenter.roomid, type, data)
            .then(function (res) {
            success(res.seq);
        })
            // @ts-ignore
            .catch(function (err, seq) {
            error(err, seq);
        });
    };
    BaseCenter.prototype.onRecvReliableMessage = function (type, seq, data) { };
    BaseCenter.prototype.sendBigRoomMessage = function (category, type, content, success, error) {
        this.zegoEntity.zegoWebRTM
            ._sendBarrageMessage(this.stateCenter.roomid, content, category, type)
            .then(function (res) {
            success(res.seq, res.messageID);
        })
            .catch(function (err) {
            error({ code: err.errorCode, msg: err.extendedData }, err.seq);
        });
    };
    BaseCenter.prototype.onRecvBigRoomMessage = function (messageList, roomId) { };
    BaseCenter.prototype.sendRelayMessage = function (type, data, success, error) {
        this.zegoEntity.zegoWebRTM.sendRelayMessage(type, data, success, error);
    };
    BaseCenter.prototype.requestJoinLive = function (destIdName, success, error, resultCallback) {
        return this.zegoEntity.zegoWebRTM.requestJoinLive(destIdName, success, error, resultCallback);
    };
    BaseCenter.prototype.onRecvJoinLiveRequest = function (requestId, from_userid, from_username, roomid) { };
    BaseCenter.prototype.inviteJoinLive = function (destIdName, success, error, resultCallback) {
        return this.zegoEntity.zegoWebRTM.inviteJoinLive(destIdName, success, error, resultCallback);
    };
    BaseCenter.prototype.onRecvInviteJoinLiveRequest = function (requestId, from_userid, from_username, roomid) { };
    BaseCenter.prototype.endJoinLive = function (destIdName, success, error) {
        return this.zegoEntity.zegoWebRTM.endJoinLive(destIdName, success, error);
    };
    BaseCenter.prototype.onRecvEndJoinLiveCommand = function (requestId, from_userid, from_username, roomid) { };
    BaseCenter.prototype.respondJoinLive = function (requestId, respondResult, success, error) {
        return this.zegoEntity.zegoWebRTM.respondJoinLive(requestId, respondResult, success, error);
    };
    /*
     *    "zc.p.ums": "ZegoExpressEngine.updateMixStream",//
     */
    BaseCenter.prototype.updateMixStream = function (mixStreamConfig, successCallback, errorCallback) {
        var _this = this;
        var _streamList = mixStreamConfig.streamList.map(function (stream) {
            return {
                streamID: stream.streamId,
                contentType: "VIDEO",
                layout: {
                    top: stream.top,
                    left: stream.left,
                    bottom: stream.bottom,
                    right: stream.right
                }
            };
        });
        this.zegoEntity
            .setMixerTaskConfig({
            backgroundColor: mixStreamConfig.outputBgColor,
            backgroundImage: mixStreamConfig.outputBgImage,
            // @ts-ignore
            extraParams: mixStreamConfig.extraParams
        })
            .then(function () {
            _this.zegoEntity
                .startMixerTask({
                inputList: _streamList,
                outputList: [
                    {
                        target: mixStreamConfig.outputStreamId
                            ? mixStreamConfig.outputStreamId
                            : mixStreamConfig.outputUrl
                    }
                ],
                outputConfig: {
                    outputBitrate: mixStreamConfig.outputBitrate / 1000,
                    outputFPS: mixStreamConfig.outputFps,
                    outputWidth: mixStreamConfig.outputWidth,
                    outputHeight: mixStreamConfig.outputHeight,
                    outputAudioCodecID: mixStreamConfig.outputAudioConfig,
                    outputAudioBitrate: mixStreamConfig.outputAudioBitrate &&
                        mixStreamConfig.outputAudioBitrate / 1000,
                    outputAudioChannels: mixStreamConfig.outputAudioChannels
                },
                // @ts-ignore
                noTaskID: true
            })
                .then(function (res) {
                if (res.extendedData) {
                    var mixerOutputList = JSON.parse(res.extendedData).mixerOutputList;
                    var mixInfo_1 = [];
                    mixerOutputList.forEach(function (mixItem) {
                        mixInfo_1.push({
                            rtmpUrls: [mixItem.rtmpURL],
                            hlsUrls: [mixItem.hlsURL],
                            flvUrls: [mixItem.flvURL]
                        });
                    });
                    successCallback(mixStreamConfig.outputStreamId, mixInfo_1);
                }
            })
                .catch(function (err) {
                errorCallback(err);
            });
        });
        return true;
    };
    /*
     *    "zc.p.sms": "ZegoExpressEngine.stopMixStream", //
     */
    BaseCenter.prototype.stopMixStream = function (mixStreamConfig, successCallback, errorCallback) {
        var room = this.zegoWebRTC.stateCenter.roomList[0];
        if (!room) {
            errorCallback(zego_error_1.errorCodeList.NOT_LOGIN);
            return false;
        }
        return room.streamHandler.stopMixStream(
        // @ts-ignore
        undefined, successCallback, errorCallback, mixStreamConfig.outputStreamId, mixStreamConfig.outputUrl);
    };
    BaseCenter.prototype.publishTarget = function (cdnPushConfig, success, error) {
        var room = this.zegoWebRTC.stateCenter.roomList[0];
        if (!room) {
            error(zego_error_1.errorCodeList.NOT_LOGIN);
            return;
        }
        room.streamHandler._publishTarget({
            type: cdnPushConfig.type,
            streamID: cdnPushConfig.streamId,
            pushUrl: cdnPushConfig.pushUrl
        }, success, error);
    };
    BaseCenter.prototype.updateStreamExtraInfo = function (streamid, extraInfo) {
        var room = this.zegoWebRTC.streamCenter.getRoomByStreamID(streamid);
        if (!room) {
            this.logger.error("zc.usei.0 room no found");
            return false;
        }
        room.streamHandler.setStreamExtraInfo(streamid, extraInfo, function () { }, function () { });
        return true;
    };
    BaseCenter.getVersion = function () {
        return zego_entity_1.PROTO_VERSION;
    };
    BaseCenter.setEventHandler = function (handler) {
        BaseCenter._handler = handler;
    };
    BaseCenter._emitEvent = function (methodName, data) {
        var _a;
        if (data === void 0) { data = {}; }
        (_a = BaseCenter._handler) === null || _a === void 0 ? void 0 : _a.call(this, methodName, JSON.stringify(data));
    };
    BaseCenter.prototype.changeStream = function (streamList) {
        return streamList.map(function (item) {
            return {
                anchor_id_name: item.user.userID,
                stream_gid: item.streamGID,
                anchor_nick_name: item.user.userName,
                extra_info: item.extraInfo,
                stream_id: item.streamID,
                urls_flv: [item.urlFlv],
                urls_rtmp: [item.urlRtmp],
                urls_hls: [item.urlHls],
                urls_https_flv: item.urlHttpsFlv,
                urls_https_hls: item.urlHttpsHls
            };
        });
    };
    BaseCenter.prototype.listen = function () {
        var _this = this;
        this.zegoEntity.on(
        // @ts-ignore
        "_getTotalUserList", function (roomId, userList) {
        });
        this.zegoEntity.on("roomUserUpdate", function (roomID, updateType, userList) {
            BaseCenter._emitEvent("onRoomUserUpdate", { roomID: roomID, updateType: updateType, userList: userList });
        });
        this.zegoEntity.on("IMRecvCustomCommand", function (roomID, fromUser, command) {
        });
        this.zegoEntity.on(
        // @ts-ignore
        "recvReliableMessage", function (type, seq, data) {
            _this.onRecvReliableMessage(type, seq, data);
        });
        this.zegoEntity.on("roomOnlineUserCountUpdate", function (roomID, count) {
            BaseCenter._emitEvent("onRoomOnlineUserCountUpdate", { roomID: roomID, count: count });
        });
        this.zegoEntity.on("roomStateUpdate", function (roomID, state, errorCode, extendedData) {
            BaseCenter._emitEvent("onRoomStateUpdate", { roomID: roomID, state: state, errorCode: errorCode, extendedData: extendedData });
        });
        this.zegoEntity.on("soundLevelUpdate", function (soundLevelList) {
        });
        this.zegoEntity.on("videoDeviceStateChanged", function (updateType, deviceInfo) {
        });
        this.zegoEntity.on("audioDeviceStateChanged", function (updateType, deviceType, deviceInfo) {
        });
        this.zegoEntity.on(
        // @ts-ignore
        "_deviceError", function (errorCode, deviceName, deviceType) {
        });
        this.zegoEntity.on(
        // @ts-ignore
        "_remoteCameraStatusUpdate", function (streamID, status) {
        });
        this.zegoEntity.on(
        // @ts-ignore
        "_remoteMicStatusUpdate", function (streamID, status) {
        });
        // @ts-ignore
        this.zegoEntity.on("roomStreamUpdate", function (roomID, updateType, streamList) {
            BaseCenter._emitEvent("onRoomStreamUpdate", { roomID: roomID, updateType: updateType, streamList: streamList });
        });
        this.zegoEntity.on("streamExtraInfoUpdate", function (_roomID, streamList) {
            BaseCenter._emitEvent("onRoomStreamExtraInfoUpdate", { roomID: _roomID, streamList: streamList });
        });
        this.zegoEntity.on("playerStateUpdate", function (playerState) {
            BaseCenter._emitEvent("onPlayerStateUpdate", { playerState: playerState });
        });
        this.zegoEntity.on("playQualityUpdate", function (streamID, stats) {
            var quality = {
                audioBitrate: stats.audio.audioBitrate,
                audioCodeType: stats.audio.audioCodec,
                audioSamplingRate: stats.audio.audioSamplingRate,
                // @ts-ignore
                audioSendLevel: stats.audio.audioSendLevel,
                frameHeight: stats.video.frameHeight,
                frameWidth: stats.video.frameWidth,
                audioJitter: stats.audio.audioJitter,
                videoBitrate: stats.video.videoBitrate,
                videoFPS: stats.video.videoFPS,
                videoTransferFPS: stats.video.videoTransferFPS,
                audioFPS: stats.audio.audioFPS,
                // @ts-ignore
                nackCount: stats.nackCount,
                // @ts-ignore
                pliCount: stats.pliCount,
                // @ts-ignore
                currentRoundTripTime: stats.currentRoundTripTime,
                // @ts-ignore
                totalRoundTripTime: stats.totalRoundTripTime,
                // @ts-ignore
                audioQuality: stats.audio.audioQuality,
                videoQuality: stats.video.videoQuality,
                // @ts-ignore
                videoFramesDropped: stats.video.videoFramesDropped
            };
            BaseCenter._emitEvent("");
        });
        this.zegoEntity.on("publisherStateUpdate", function (publisherState) {
            BaseCenter._emitEvent("onPublisherStateUpdate", { publisherState: publisherState });
        });
        this.zegoEntity.on("publishQualityUpdate", function (streamID, stats) {
            var quality = {
                audioBitrate: stats.audio.audioBitrate,
                audioCodeType: stats.audio.audioCodec,
                frameHeight: stats.video.frameHeight,
                frameWidth: stats.video.frameWidth,
                videoBitrate: stats.video.videoBitrate,
                videoFPS: stats.video.videoFPS,
                videoTransferFPS: stats.video.videoTransferFPS,
                audioFPS: stats.audio.audioFPS,
                // @ts-ignore
                nackCount: stats.nackCount,
                // @ts-ignore
                pliCount: stats.pliCount,
                // @ts-ignore
                currentRoundTripTime: stats.currentRoundTripTime,
                // @ts-ignore
                totalRoundTripTime: stats.totalRoundTripTime,
                // @ts-ignore
                audioQuality: stats.audio.audioQuality
            };
            BaseCenter._emitEvent("onPublisherQualityUpdate", { quality: quality });
        });
    };
    return BaseCenter;
}());
exports.BaseCenter = BaseCenter;


/***/ }),

/***/ "./sdk/src/common/stateCenter.ts":
/*!***************************************!*\
  !*** ./sdk/src/common/stateCenter.ts ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// import { ENUM_RUN_STATE, LinkedList, ENUM_NETWORK_STATE } from "../zego.entity";
// import { getSeq } from "../zego.extern";
// import { RetryRoomHandler } from "./rertyRoomHandler";
Object.defineProperty(exports, "__esModule", { value: true });
exports.StateCenter = void 0;
var StateCenter = /** @class */ (function () {
    function StateCenter() {
        this.testEnvironment = false;
        this.third_token = "";
        this.pullLimited = true;
        this.configOK = false;
        this.userStateUpdate = true;
        this.roomCreateFlag = 1;
        this.debugVerbose = false;
        this.streamUpdated = false;
        this.channelPreviewMap = new Map();
        this.audioConfig = {
            AEC: true,
            AGC: true,
            ANS: true
        };
    }
    return StateCenter;
}());
exports.StateCenter = StateCenter;


/***/ }),

/***/ "./sdk/src/common/zego.entity.ts":
/*!***************************************!*\
  !*** ./sdk/src/common/zego.entity.ts ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// import { ZegoSignal } from './zego.signal';
// import { ZegoPlayWeb } from '../webrtc/zego.play.web';
// import { ZegoHTMLAudioElement, ZegoVideoDecodeType } from '../../types/index'
// import { ZegoPublish } from '../webrtc/zego.publish';
// import { TryStreamHandler } from '../webrtc/tryStreamHandler';
// import { TryDispatchHandler } from '../webrtc/tryDispatchHandler';
Object.defineProperty(exports, "__esModule", { value: true });
exports.ZegoVideoViewType = exports.E_CLIENT_TYPE = exports.ENUM_DISPATCH_TYPE = exports.ENUM_BROADCASTER_STATUS = exports.ENUM_PLAY_SOURCE_TYPE = exports.ENUM_PUSH_SIGNAL_SUB_CMD = exports.ENUM_SIGNAL_SUB_CMD = exports.PublishStreamState = exports.PlayStreamState = exports.QUALITYLEVEL = exports.MIXSTREAM_ERROR_CODE = exports.SERVER_ERROR_CODE = exports.ENUM_STREAM_UPDATE_CMD = exports.MINIUM_HEARTBEAT_INTERVAL = exports.ENUM_PLAY_STATE_UPDATE = exports.ENUM_PUBLISH_STATE_UPDATE = exports.ENUM_NETWORK_STATE = exports.ENUM_RUN_STATE = exports.ENUM_STREAM_UPDATE_TYPE = exports.ENUM_STREAM_SUB_CMD = exports.ENUM_PUBLISH_STREAM_STATE = exports.MAX_TRY_HEARTBEAT_COUNT = exports.SEND_MSG_TIMEOUT = exports.SEND_MSG_RESET = exports.MAX_TRY_CONNECT_COUNT = exports.ENUM_CONNECT_STATE = exports.ENUM_PLAY_STATE_NEGO = exports.ENUM_PLAY_STATE = exports.ENUM_PUBLISH_STATE_NEGO = exports.ENUM_PUBLISH_STATE = exports.ENUM_RETRY_STATE = exports.ENUM_RESOLUTION_TYPE = exports.ENUM_SIGNAL_STATE = exports.sdkErrorList = exports.ENUM_REMOTE_TYPE = exports.ENUM_LOG_LEVEL = exports.LOG_LEVEL = exports.ROOMVERSION = exports.PROTO_VERSION = void 0;
exports.PROTO_VERSION = "1.0.0";
exports.ROOMVERSION = "V1";
exports.LOG_LEVEL = {
    0: "debug",
    1: "info",
    2: "warn",
    3: "error",
    99: "report",
    100: "disable"
};
var ENUM_LOG_LEVEL;
(function (ENUM_LOG_LEVEL) {
    ENUM_LOG_LEVEL[ENUM_LOG_LEVEL["debug"] = 0] = "debug";
    ENUM_LOG_LEVEL[ENUM_LOG_LEVEL["info"] = 1] = "info";
    ENUM_LOG_LEVEL[ENUM_LOG_LEVEL["warn"] = 2] = "warn";
    ENUM_LOG_LEVEL[ENUM_LOG_LEVEL["error"] = 3] = "error";
    ENUM_LOG_LEVEL[ENUM_LOG_LEVEL["report"] = 99] = "report";
    ENUM_LOG_LEVEL[ENUM_LOG_LEVEL["disable"] = 100] = "disable";
})(ENUM_LOG_LEVEL = exports.ENUM_LOG_LEVEL || (exports.ENUM_LOG_LEVEL = {}));
var ENUM_REMOTE_TYPE;
(function (ENUM_REMOTE_TYPE) {
    ENUM_REMOTE_TYPE[ENUM_REMOTE_TYPE["disable"] = 0] = "disable";
    ENUM_REMOTE_TYPE[ENUM_REMOTE_TYPE["websocket"] = 1] = "websocket";
    ENUM_REMOTE_TYPE[ENUM_REMOTE_TYPE["https"] = 2] = "https";
})(ENUM_REMOTE_TYPE = exports.ENUM_REMOTE_TYPE || (exports.ENUM_REMOTE_TYPE = {}));
exports.sdkErrorList = {
    SUCCESS: {
        code: "ZegoExpressEngine.Success",
        msg: "success."
    },
    PARAM: {
        code: "ZegoExpressEngine.Error.Param",
        msg: "input error."
    },
    HEARTBEAT_TIMEOUT: {
        code: "ZegoExpressEngine.Error.Timeout",
        msg: "heartbeat timeout."
    },
    LOGIN_TIMEOUT: {
        code: "ZegoExpressEngine.Error.Timeout",
        msg: "login timeout."
    },
    SEND_MSG_TIMEOUT: {
        code: "ZegoExpressEngine.Error.Timeout",
        msg: "send customsg timeout."
    },
    RESET_QUEUE: {
        code: "ZegoExpressEngine.Error.Timeout",
        msg: "msg waiting ack is clear when reset."
    },
    LOGIN_DISCONNECT: {
        code: "ZegoExpressEngine.Error.Network",
        msg: "network is broken and login fail."
    },
    KICK_OUT: {
        code: "ZegoExpressEngine.Error.Kickout",
        msg: "kickout reason="
    },
    UNKNOWN: {
        code: "ZegoExpressEngine.Error.Unknown",
        msg: "unknown error."
    },
    FREQ_LIMITED: {
        code: "ZegoExpressEngine.Error.requencyLimited",
        msg: "Frequency Limited."
    }
    // SIGNAL_DISCONNECT: {
    //     code: "ZegoExpressEngine.Error.Timeout",
    //     msg: "WebRTC Signal broken"
    // }
};
var ENUM_SIGNAL_STATE;
(function (ENUM_SIGNAL_STATE) {
    ENUM_SIGNAL_STATE[ENUM_SIGNAL_STATE["disconnected"] = 0] = "disconnected";
    ENUM_SIGNAL_STATE[ENUM_SIGNAL_STATE["connecting"] = 1] = "connecting";
    ENUM_SIGNAL_STATE[ENUM_SIGNAL_STATE["connected"] = 2] = "connected";
})(ENUM_SIGNAL_STATE = exports.ENUM_SIGNAL_STATE || (exports.ENUM_SIGNAL_STATE = {}));
exports.ENUM_RESOLUTION_TYPE = {
    LOW: {
        width: 240,
        height: 320,
        frameRate: 15,
        bitRate: 300
    },
    MEDIUM: {
        width: 480,
        height: 640,
        frameRate: 15,
        bitRate: 800
    },
    HIGH: {
        width: 720,
        height: 1280,
        frameRate: 20,
        bitRate: 1500
    }
};
exports.ENUM_RETRY_STATE = {
    didNotStart: 0,
    retrying: 1,
    finished: 2
};
exports.ENUM_PUBLISH_STATE = {
    start: 0,
    waitingSessionRsp: 1,
    waitingOffserRsp: 2,
    waitingServerAnswer: 3,
    waitingServerICE: 4,
    connecting: 5,
    publishing: 6,
    stop: 7,
    didNotStart: 8
};
exports.ENUM_PUBLISH_STATE_NEGO = {
    stop: 0,
    start: 1,
    waiterAnswer: 2,
    waitingCandidate: 3,
    sendCandidate: 4,
    iceConnected: 5,
    iceClosed: 6,
    iceFailed: 7,
    iceDisconnected: 8
};
exports.ENUM_PLAY_STATE = {
    start: 0,
    waitingSessionRsp: 1,
    waitingOffserRsp: 2,
    waitingServerAnswer: 3,
    waitingServerICE: 4,
    connecting: 5,
    playing: 6,
    stop: 7,
    didNotStart: 8
};
exports.ENUM_PLAY_STATE_NEGO = {
    stop: 0,
    start: 1,
    waiterAnswer: 2,
    waitingCandidate: 3,
    sendCandidate: 4,
    iceConnected: 5,
    iceClosed: 6,
    iceFailed: 7,
    iceDisconnected: 8
};
exports.ENUM_CONNECT_STATE = {
    disconnect: 0,
    connecting: 1,
    connected: 2
};
exports.MAX_TRY_CONNECT_COUNT = 1;
exports.SEND_MSG_RESET = 2;
exports.SEND_MSG_TIMEOUT = 1;
exports.MAX_TRY_HEARTBEAT_COUNT = 5;
exports.ENUM_PUBLISH_STREAM_STATE = {
    waiting_url: 1,
    tryPublish: 2,
    update_info: 3,
    publishing: 4,
    stop: 5
};
exports.ENUM_STREAM_SUB_CMD = {
    liveNone: 0,
    liveBegin: 2001,
    liveEnd: 2002,
    liveUpdate: 2003
};
exports.ENUM_STREAM_UPDATE_TYPE = {
    added: 0,
    deleted: 1
};
//
var ENUM_RUN_STATE;
(function (ENUM_RUN_STATE) {
    ENUM_RUN_STATE[ENUM_RUN_STATE["logout"] = 0] = "logout";
    ENUM_RUN_STATE[ENUM_RUN_STATE["trylogin"] = 1] = "trylogin";
    ENUM_RUN_STATE[ENUM_RUN_STATE["login"] = 2] = "login";
})(ENUM_RUN_STATE = exports.ENUM_RUN_STATE || (exports.ENUM_RUN_STATE = {}));
var ENUM_NETWORK_STATE;
(function (ENUM_NETWORK_STATE) {
    ENUM_NETWORK_STATE[ENUM_NETWORK_STATE["offline"] = 0] = "offline";
    ENUM_NETWORK_STATE[ENUM_NETWORK_STATE["online"] = 1] = "online";
})(ENUM_NETWORK_STATE = exports.ENUM_NETWORK_STATE || (exports.ENUM_NETWORK_STATE = {}));
exports.ENUM_PUBLISH_STATE_UPDATE = {
    start: 0,
    error: 1,
    retry: 2
};
exports.ENUM_PLAY_STATE_UPDATE = {
    start: 0,
    error: 1,
    retry: 2
};
exports.MINIUM_HEARTBEAT_INTERVAL = 3000; //
exports.ENUM_STREAM_UPDATE_CMD = {
    added: 12001,
    deleted: 12002,
    updated: 12003
};
exports.SERVER_ERROR_CODE = 10000;
exports.MIXSTREAM_ERROR_CODE = 10000;
var QUALITYLEVEL;
(function (QUALITYLEVEL) {
    QUALITYLEVEL[QUALITYLEVEL["low"] = 1] = "low";
    QUALITYLEVEL[QUALITYLEVEL["stantard"] = 2] = "stantard";
    QUALITYLEVEL[QUALITYLEVEL["hight"] = 3] = "hight";
    QUALITYLEVEL[QUALITYLEVEL["custome"] = 4] = "custome";
})(QUALITYLEVEL = exports.QUALITYLEVEL || (exports.QUALITYLEVEL = {}));
exports.PlayStreamState = {
    PLAYING: 0,
    NO_PLAY: 1,
    PLAY_REQUESTING: 2
};
exports.PublishStreamState = {
    PUBLISHING: 0,
    NO_PUBLISH: 1,
    PUBLISH_REQUESTING: 2
};
exports.ENUM_SIGNAL_SUB_CMD = {
    none: 0,
    joinLiveRequest: 1001,
    joinLiveResult: 1002,
    joinLiveInvite: 1003,
    joinLiveStop: 1004
};
exports.ENUM_PUSH_SIGNAL_SUB_CMD = {
    none: 0,
    pushJoinLiveRequest: 11001,
    pushJoinLiveResult: 11002,
    pushJoinLiveInvite: 11003,
    pushJoinLiveStop: 11004
};
//
var ENUM_PLAY_SOURCE_TYPE;
(function (ENUM_PLAY_SOURCE_TYPE) {
    ENUM_PLAY_SOURCE_TYPE[ENUM_PLAY_SOURCE_TYPE["auto"] = 0] = "auto";
    ENUM_PLAY_SOURCE_TYPE[ENUM_PLAY_SOURCE_TYPE["ultra"] = 1] = "ultra";
})(ENUM_PLAY_SOURCE_TYPE = exports.ENUM_PLAY_SOURCE_TYPE || (exports.ENUM_PLAY_SOURCE_TYPE = {}));
//
var ENUM_BROADCASTER_STATUS;
(function (ENUM_BROADCASTER_STATUS) {
    ENUM_BROADCASTER_STATUS[ENUM_BROADCASTER_STATUS["stop"] = 0] = "stop";
    ENUM_BROADCASTER_STATUS[ENUM_BROADCASTER_STATUS["start"] = 1] = "start";
})(ENUM_BROADCASTER_STATUS = exports.ENUM_BROADCASTER_STATUS || (exports.ENUM_BROADCASTER_STATUS = {}));
//
var ENUM_DISPATCH_TYPE;
(function (ENUM_DISPATCH_TYPE) {
    ENUM_DISPATCH_TYPE[ENUM_DISPATCH_TYPE["cdn"] = 0] = "cdn";
    ENUM_DISPATCH_TYPE[ENUM_DISPATCH_TYPE["ultra"] = 1] = "ultra";
    ENUM_DISPATCH_TYPE[ENUM_DISPATCH_TYPE["customUrl"] = 2] = "customUrl";
})(ENUM_DISPATCH_TYPE = exports.ENUM_DISPATCH_TYPE || (exports.ENUM_DISPATCH_TYPE = {}));
var E_CLIENT_TYPE;
(function (E_CLIENT_TYPE) {
    E_CLIENT_TYPE[E_CLIENT_TYPE["ClientType_None"] = 0] = "ClientType_None";
    E_CLIENT_TYPE[E_CLIENT_TYPE["ClientType_H5"] = 1] = "ClientType_H5";
    E_CLIENT_TYPE[E_CLIENT_TYPE["ClientType_SmallPragram"] = 2] = "ClientType_SmallPragram";
    E_CLIENT_TYPE[E_CLIENT_TYPE["ClientType_Webrtc"] = 3] = "ClientType_Webrtc"; //webrtc
})(E_CLIENT_TYPE = exports.E_CLIENT_TYPE || (exports.E_CLIENT_TYPE = {}));
var ZegoVideoViewType;
(function (ZegoVideoViewType) {
    ZegoVideoViewType[ZegoVideoViewType["Local"] = 0] = "Local";
    ZegoVideoViewType[ZegoVideoViewType["Remote"] = 1] = "Remote";
})(ZegoVideoViewType = exports.ZegoVideoViewType || (exports.ZegoVideoViewType = {}));


/***/ }),

/***/ "./sdk/src/common/zego.error.ts":
/*!**************************************!*\
  !*** ./sdk/src/common/zego.error.ts ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
exports.errorCodeList = exports.innerErrList = void 0;
exports.innerErrList = {
    SUCCESS: {
        code: 0,
        message: ""
    },
    SEND_MSG_TIMEOUT: {
        code: "Error.Timeout",
        message: "send customessage timeout."
    }
};
exports.errorCodeList = {
    // commonErr
    NOT_LOGIN: {
        code: 1000002,
        message: "not login room"
    },
    STREAMID_TOO_LONG: {
        code: 1000014,
        message: "stream ID is too long"
    },
    STREAM_ID_NULL: {
        code: 1000015,
        message: "streamID is empty"
    },
    STREAM_ID_INVALID_CHARACTER: {
        code: 1000016,
        message: "stream ID contains illegal characters"
    },
    NETWORK_BROKEN: {
        code: 1000017,
        message: "network is broken"
    },
    LOCALSTREAM_WRONG: {
        code: 1000018,
        message: "local stream wrong"
    },
    GET_SOUND_LEVEL_FAIL: {
        code: 1000019,
        message: "get sound level error"
    },
    // 
    INPUT_PARAM: {
        code: 1100001,
        message: "input parm error."
    },
    TIMEOUT: {
        code: 1100002,
        message: "network timeout."
    },
    UNKNOWN_SERVER_ERROR: {
        code: 1100999,
        message: "unknown server error"
    },
    // rtc 
    INIT_SDK_WRONG: {
        code: 1101000,
        message: "init sdk wrong"
    },
    // roomErr
    // NONE_APP_ID: {
    //     code: 1001000,
    //     message: 'app id can not be 0',
    // },
    // ROOM_COUNT_EXCEED: {
    //     code: 1002001,
    //     message: 'login rooms exceeds the upper limit',
    // },
    USER_ID_NULL: {
        code: 1002005,
        message: "user ID is empty"
    },
    USER_ID_INVALID_CHARACTER: {
        code: 1002006,
        message: "user ID contains illegal characters"
    },
    USER_ID_TOO_LONG: {
        code: 1002007,
        message: "user ID is too long"
    },
    USER_NAME_NULL: {
        code: 1002008,
        message: "username is empty"
    },
    // USER_NAME_INVALID_CHARACTER: {
    //     code: 1002009,
    //     message: 'username contains illegal characters',
    // },
    USER_NAME_TOO_LONG: {
        code: 1002010,
        message: "username is too long"
    },
    ROOM_ID_NULL: {
        code: 1002011,
        message: "room ID is empty"
    },
    ROOM_ID_INVALID_CHARACTER: {
        code: 1002012,
        message: "room ID contains illegal characters"
    },
    ROOM_ID_TOO_LONG: {
        code: 1002013,
        message: "room ID is too long"
    },
    LOGIN_TIMEOUT: {
        code: 1002031,
        message: "login timeout"
    },
    ROOM_MAX_USER_COUNT: {
        code: 1002034,
        message: "users logging into the room exceeds the maximum number"
    },
    MULTIPLE_LOGIN_KICKOUT: {
        code: 1002050,
        message: "kickout may be the same user ID login other"
    },
    ROOM_RETRY_TIMEOUT: {
        code: 1002053,
        message: "network is broken and login fail."
    },
    MANUAL_KICKOUT: {
        code: 1002055,
        message: "server has sent a signal to kick out"
    },
    ROOM_INNER_ERROR: {
        code: 1002099,
        message: "room inner error"
    },
    // web
    HEARTBEAT_TIMEOUT: {
        code: 1102001,
        message: "heartbeat timeout."
    },
    // access_svr
    PARSE_JSON_ERROR: {
        code: 1102011,
        message: "parse json error."
    },
    LOGIN_PROCESSING: {
        code: 1102012,
        message: "login is processing."
    },
    LIVEROMM_REQUEST_ERROR: {
        code: 1102013,
        message: "liveroom request error."
    },
    ZPUSH_REQUEST_FAIL: {
        code: 1102014,
        message: "zpush request fail."
    },
    LOGIN_STATE_WRONG: {
        code: 1102015,
        message: "user login state is wrong."
    },
    TOKEN_ERROR: {
        code: 1102016,
        message: "token error"
    },
    DISPATCH_ERROR: {
        code: 1102017,
        message: "dispatch error"
    },
    TOKEN_EXPIRED: {
        code: 1102018,
        message: "token expired"
    },
    SUBCMD_ERROR: {
        code: 1102019,
        message: "subcmd error."
    },
    ZEGO_AUTH_ERROR: {
        code: 1102020,
        message: "zego auth error."
    },
    BIZ_CHANNEL_ERROR: {
        code: 1102021,
        message: "biz channel error."
    },
    DISPATCH_TIMEOUT: {
        code: 1102022,
        message: "dispatch request timeout"
    },
    CONNECT_FAILED: {
        code: 1102023,
        message: "connect signal fail"
    },
    // ROOM_INNER_ERROR: {
    //     code: 1102099,
    //     message: 'unknown error.',
    // },
    // publishStreamErr
    PUBLISHER_EXTRA_INFO_NULL: {
        code: 1003050,
        message: "extra info of publshing stream is null"
    },
    PUBLISHER_EXTRA_INFO_TOO_LONG: {
        code: 1003051,
        message: "stream extra info is too long"
    },
    PUBLISHER_PARAM: {
        code: 1103001,
        message: "input parm error"
    },
    PUBLISHER_BROWSER_NOT_SUPPORT: {
        code: 1103002,
        message: "browser do not support"
    },
    PUBLISHER_DISPATCH_FAIL: {
        code: 1103003,
        message: "dispatch request error"
    },
    PUBLISHER_SCREEN_FAILED: {
        code: 1103010,
        message: "screen fail"
    },
    ENUMERATE_DEVICES_FAIL: {
        code: 1103011,
        message: "enumerate devices fail"
    },
    PUBLISHER_DISPATCH_REQUEST_FAIL: {
        code: 1103020,
        message: "dispatch request fail"
    },
    PUBLISHER_SESSION_REQUEST_FAIL: {
        code: 1103021,
        message: "session request fail"
    },
    PUBLISHER_CREATE_OFFER_ERROR: {
        code: 1103022,
        message: "create offer error"
    },
    PUBLISHER_SET_LOCAL_DESC_ERROR: {
        code: 1103023,
        message: "setLocalDescription error"
    },
    PUBLISHER_MEDIA_DESC_ERROR: {
        code: 1103024,
        message: "mediaDesc error"
    },
    PUBLISHER_SET_REMOTE_DESC_ERROR: {
        code: 1103025,
        message: "other side offer error"
    },
    PUBLISHER_CANDIDATE_ERROR: {
        code: 1103026,
        message: "candidate error"
    },
    PUBLISHER_SESSION_CLOSED: {
        code: 1103027,
        message: "server session closed"
    },
    PUBLISHER_MEDIA_CONNECTION_ERROR: {
        code: 1103028,
        message: "ice connection error"
    },
    PUBLISHER_CONSTRAINTS_ERROR: {
        code: 1103029,
        message: "constraint error"
    },
    PUBLISHER_SERVER_NEGO_TIMEOUT: {
        code: 1103030,
        message: "negotiation timeout"
    },
    PUBLISH_NOT_PUBLISH: {
        code: 1103040,
        message: "publisher not found"
    },
    PUBLISH_DEVICE_OUT_ERR: {
        code: 1103041,
        message: "device change "
    },
    PUBLISH_SCREEN_CANCELED: {
        code: 1103042,
        message: "screen canceled"
    },
    PUBLISH_SCREEN_NOT_SUPPORT: {
        code: 1103043,
        message: "screen not support"
    },
    PUBLISH_NO_PREVIEW: {
        code: 1103044,
        message: "stream is not from zego"
    },
    VIDEO_DEVICE_FALSE: {
        code: 1103045,
        message: "video is false"
    },
    AUDIO_DEVICE_FALSE: {
        code: 1103046,
        message: "audio is false"
    },
    TRACK_NOT_FOUND: {
        code: 1103047,
        message: "track is not found"
    },
    DEVICE_NOT_FOUND: {
        code: 1103048,
        message: "device is not found"
    },
    REPEATED_PULL: {
        code: 1103049,
        message: "repeated pull same stream"
    },
    PUBLISHER_WEBSOCKET_DISCONNECTED: {
        code: 1103050,
        message: "websocket disconnected"
    },
    PUBLISHER_RETRY_TIMEOUT: {
        code: 1103051,
        message: "publisher retry timeout"
    },
    PUBLISHER_CDN_PUSH_ERROR: {
        code: 1103052,
        message: "publisher cdn push error"
    },
    PUBLISHER_HTTPS_REQUIRED: {
        code: 1103053,
        message: "https is required"
    },
    PUBLISHER_NO_PREVIEW: {
        code: 1103054,
        message: "no preview"
    },
    PUBLISHER_STREAM_NO_FOUND: {
        code: 1103055,
        message: "publish stream no found"
    },
    PUBLISHER_IS_PUBLISHING: {
        code: 1103056,
        message: "publish is publishing"
    },
    PUBLISHER_DECODE_AUDIO_FAIL: {
        code: 1103057,
        message: "decode audio data fail"
    },
    // play
    PLAYER_PARAM: {
        code: 1104001,
        message: "input parm error"
    },
    PLAYER_DISPATCH_REQUEST_FAIL: {
        code: 1104020,
        message: "dispatch request fail"
    },
    PLAYER_SESSION_REQUEST_FAIL: {
        code: 1104021,
        message: "session request fail"
    },
    PLAYER_CREATE_OFFER_ERROR: {
        code: 1104022,
        message: "create offer error"
    },
    PLAYER_SET_LOCAL_DESC_ERROR: {
        code: 1104023,
        message: "setLocalDescription error"
    },
    PLAYER_MEDIA_DESC_ERROR: {
        code: 1104024,
        message: "mediaDesc error"
    },
    PLAYER_SET_REMOTE_DESC_ERROR: {
        code: 1104025,
        message: "other side offer error"
    },
    PLAYER_CANDIDATE_ERROR: {
        code: 1104026,
        message: "candidate error"
    },
    PLAYER_SESSION_CLOSED: {
        code: 1104027,
        message: "server session closed"
    },
    PLAYER_MEDIA_CONNECTION_ERROR: {
        code: 1104028,
        message: "ice connection error"
    },
    PLAYER_WEBSOCKET_DISCONNECTED: {
        code: 1104029,
        message: "websocket disconnected"
    },
    PLAYER_SERVER_NEGO_TIMEOUT: {
        code: 1104030,
        message: "negotiation timeout"
    },
    PLAYER_RETRY_TIMEOUT: {
        code: 1104031,
        message: "player retry timeout"
    },
    PLAYER_IS_PLAYING: {
        code: 1104032,
        message: "player is playing"
    },
    // mixStreamErr
    MIXER_NO_SERVICES: {
        code: 1005000,
        message: "no mix stream service"
    },
    MIXER_TASK_ID_NULL: {
        code: 1005001,
        message: "mixer task is null"
    },
    MIXER_TASK_ID_TOO_LONG: {
        code: 1005002,
        message: "task ID is too long"
    },
    MIXER_TASK_ID_INVALID_CHARACTER: {
        code: 1005003,
        message: "task ID contains illegal characters"
    },
    MIXER_NO_OUTPUT_TARGET: {
        code: 1005005,
        message: "task configuration does not specify output"
    },
    MIXER_OUTPUT_TARGET_INVALID: {
        code: 1005006,
        message: "stream output target is incorrect"
    },
    MIXER_START_REQUEST_ERROR: {
        code: 1005010,
        message: "start mixer task fail, possibly due to network reasons"
    },
    MIXER_STOP_REQUEST_ERROR: {
        code: 1005011,
        message: "stop mixer task fail, possibly due to network reasons"
    },
    MIXER_NOT_OWNER_STOPMIXER: {
        code: 1005012,
        message: " maxed task must be stopped by the start user of the task"
    },
    MIXER_INPUTLIST_NULL: {
        code: 1005020,
        message: "Mixed stream task input list is null"
    },
    MIXER_OUTPUTLIST_NULL: {
        code: 1005021,
        message: "Mixed stream task output list is null"
    },
    MIXER_VIDEO_CONFIG_INVALID: {
        code: 1005023,
        message: "invalid mixed stream task video configuration"
    },
    MIXER_EXCEED_MAX_INPUT_COUNT: {
        code: 1005025,
        message: "more than the maximum number of input streams"
    },
    MIXER_INPUT_STREAM_NOT_EXISTS: {
        code: 1005026,
        message: "Input stream does not exist"
    },
    MIXER_INPUT_PARAMETERS_ERROR: {
        code: 1005027,
        message: "stream input parameters are wrong"
    },
    MIXER_EXCEED_MAX_OUTPUT_COUNT: {
        code: 1005030,
        message: "more than the maximum number of output streams"
    },
    MIXER_AUTHENTICATION_FAILED: {
        code: 1005050,
        message: "mixed stream authentication failed"
    },
    MIXER_WATERMARK_NULL: {
        code: 1005061,
        mag: "input watermark is null"
    },
    MIXER_WATERMARK_PARAMETERS_ERROR: {
        code: 1005062,
        message: "input watermark parameter is wrong"
    },
    MIXER_WATERMARK_URL_INVALID: {
        code: 1005063,
        message: "illegal input watermark URL"
    },
    MIXER_BACKGROUND_IMAGE_URL_INVALID: {
        code: 1005067,
        message: "illegal input background image URL"
    },
    MIXER_INNER_ERROR: {
        code: 1005099,
        message: "mixed stream internal error"
    },
    DEVICE_ERROR_TYPE_UNPLUGGED: {
        code: 1006006,
        message: "the device is unplugged"
    },
    // imErr
    IM_CONTENT_NULL: {
        code: 1009001,
        message: "message content is empty"
    },
    IM_CONTENT_TOO_LONG: {
        code: 1009002,
        message: "message content is too long"
    },
    IM_SEND_FAILED: {
        code: 1009010,
        message: "failed to send message"
    },
    // web
    FREQ_LIMITED: {
        code: 1109001,
        message: "frequency limited."
    }
};


/***/ }),

/***/ "./sdk/src/common/zego.log.event.ts":
/*!******************************************!*\
  !*** ./sdk/src/common/zego.log.event.ts ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
exports.ZegoRTCLogEvent = void 0;
var zego_error_1 = __webpack_require__(/*! ./zego.error */ "./sdk/src/common/zego.error.ts");
// import * as fs from "fs";
// import * as path from "path";
var getItem = function (item) { return item; };
exports.ZegoRTCLogEvent = {
    kZegoTaskCreateStream: {
        event: "/sdk/create_stream",
        error: {
            kBrowserNotSupportError: zego_error_1.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,
            kParamError: zego_error_1.errorCodeList.PUBLISHER_PARAM,
            kScreenCancelError: zego_error_1.errorCodeList.PUBLISH_SCREEN_CANCELED,
            kScreenFailedError: zego_error_1.errorCodeList.PUBLISHER_SCREEN_FAILED,
            kScreenNotSupportError: zego_error_1.errorCodeList.PUBLISH_SCREEN_NOT_SUPPORT,
            kHttpsRequiredError: zego_error_1.errorCodeList.PUBLISHER_HTTPS_REQUIRED
        },
        stream_type: getItem,
        screen: getItem,
        camera: getItem,
        custom: getItem
    },
    kZegoTaskPublishStart: {
        event: "/sdk/api/publish_request",
        error: {
            kPublishParamError: zego_error_1.errorCodeList.PUBLISHER_PARAM,
            kPublishNetworkTimeoutError: zego_error_1.errorCodeList.TIMEOUT,
            kPublishDispatchTimeoutError: zego_error_1.errorCodeList.DISPATCH_TIMEOUT,
            kPublishDispatchError: zego_error_1.errorCodeList.DISPATCH_ERROR,
            kPublishNetworkBrokenError: zego_error_1.errorCodeList.NETWORK_BROKEN,
            kPublishNoPreviewError: zego_error_1.errorCodeList.PUBLISH_NO_PREVIEW,
            kPublishNoLoginError: zego_error_1.errorCodeList.NOT_LOGIN,
            kPublishRetryTimeoutError: zego_error_1.errorCodeList.PUBLISHER_RETRY_TIMEOUT,
            kPublishSessionClosedError: zego_error_1.errorCodeList.PUBLISHER_SESSION_CLOSED,
            kPublishNegoTimeoutError: zego_error_1.errorCodeList.PUBLISHER_SERVER_NEGO_TIMEOUT,
            kCreateOfferError: zego_error_1.errorCodeList.PUBLISHER_CREATE_OFFER_ERROR,
            kSetLocalDescError: zego_error_1.errorCodeList.PUBLISHER_SET_LOCAL_DESC_ERROR,
            kSessionRequestError: zego_error_1.errorCodeList.PUBLISHER_SESSION_REQUEST_FAIL,
            kSetRemoteDescError: zego_error_1.errorCodeList.PUBLISHER_SET_REMOTE_DESC_ERROR,
            kMediaConnectionError: zego_error_1.errorCodeList.PUBLISHER_MEDIA_CONNECTION_ERROR,
            kWebsocketDisconnectedError: zego_error_1.errorCodeList.PUBLISHER_WEBSOCKET_DISCONNECTED,
            kMediaDescError: zego_error_1.errorCodeList.PUBLISHER_MEDIA_DESC_ERROR,
            kCandidateError: zego_error_1.errorCodeList.PUBLISHER_CANDIDATE_ERROR,
            kIsPublishing: zego_error_1.errorCodeList.PUBLISHER_IS_PUBLISHING
        },
        publishOption: getItem,
        message: getItem,
        session_id: getItem,
        stream: getItem,
        video_en_codec_id: getItem,
        cap_w: getItem,
        cap_h: getItem,
        w: getItem,
        h: getItem,
        video_en_fps: getItem,
        video_en_bps: getItem,
        audio_c_channel_count: getItem,
        audio_en_bps: getItem,
        aec_level: getItem,
        ans_level: getItem,
        agc: getItem,
        traffic_control_min_video_bitrate: getItem
    },
    kZegoTaskVideoCaptureSize: {
        event: "sdk/api/publish_video_c_size",
        session_id: getItem,
        w: getItem,
        h: getItem
    },
    kZegoTaskRePublish: "/sdk/republish",
    kZegoTaskPublishStop: {
        event: "/sdk/stop_publish",
        error: {
            kParamError: zego_error_1.errorCodeList.PUBLISHER_PARAM
        },
        stream: getItem
    },
    // kZegoTaskRtcPublishStateUpdate: '/rtc/publish_stat_report', ///< 
    // kZegoTaskCdnPublishStateUpdate: '/cdn/publish_stat_report', ///< 
    kZegoTaskPlayStart: {
        event: "/sdk/api/play_request",
        error: {
            kStreamIDNullError: zego_error_1.errorCodeList.STREAM_ID_NULL,
            kPlayParamError: zego_error_1.errorCodeList.PLAYER_PARAM,
            kPlayStreamIDToLongError: zego_error_1.errorCodeList.STREAMID_TOO_LONG,
            kPlayStreamIDInvalidCharacterError: zego_error_1.errorCodeList.STREAM_ID_INVALID_CHARACTER,
            kPlayNoLoginError: zego_error_1.errorCodeList.NOT_LOGIN,
            kPlayRepeatedPullError: zego_error_1.errorCodeList.REPEATED_PULL,
            kPlayNetworkTimeoutError: zego_error_1.errorCodeList.TIMEOUT,
            kPlayDispatchTimeoutError: zego_error_1.errorCodeList.DISPATCH_TIMEOUT,
            kPlayDispatchError: zego_error_1.errorCodeList.DISPATCH_ERROR,
            kPlayNetworkBrokenError: zego_error_1.errorCodeList.NETWORK_BROKEN,
            kPlayRetryTimeoutError: zego_error_1.errorCodeList.PLAYER_RETRY_TIMEOUT,
            kPlaySessionClosedError: zego_error_1.errorCodeList.PLAYER_SESSION_CLOSED,
            kPlayNegoTimeoutError: zego_error_1.errorCodeList.PLAYER_SERVER_NEGO_TIMEOUT,
            kCreateOfferError: zego_error_1.errorCodeList.PLAYER_CREATE_OFFER_ERROR,
            kSetLocalDescError: zego_error_1.errorCodeList.PLAYER_SET_LOCAL_DESC_ERROR,
            kSessionRequestError: zego_error_1.errorCodeList.PLAYER_SESSION_REQUEST_FAIL,
            kSetRemoteDescError: zego_error_1.errorCodeList.PLAYER_SET_REMOTE_DESC_ERROR,
            kMediaConnectionError: zego_error_1.errorCodeList.PLAYER_MEDIA_CONNECTION_ERROR,
            kWebsocketDisconnectedError: zego_error_1.errorCodeList.PLAYER_WEBSOCKET_DISCONNECTED,
            kCandidateError: zego_error_1.errorCodeList.PLAYER_CANDIDATE_ERROR,
            kMediaDescError: zego_error_1.errorCodeList.PLAYER_MEDIA_DESC_ERROR,
            kIsPlaying: zego_error_1.errorCodeList.PLAYER_IS_PLAYING
        },
        playOption: getItem,
        message: getItem,
        session_id: getItem,
        stream: getItem,
        audio_activate: getItem,
        video_activate: getItem
    },
    kZegoTaskRePlay: "/sdk/replay",
    kZegoTaskPlayStop: {
        event: "/sdk/stop_play",
        error: {
            kParamError: zego_error_1.errorCodeList.PUBLISHER_PARAM
        },
        stream: getItem
    },
    // kZegoTaskDispatch: '/rtc/dispatch', ///< Dispatch
    kZegoPlayContentChanged: {
        event: "/sdk/play_content_changed",
        session_id: getItem,
        video_activate: getItem,
        audio_activate: getItem
    },
    kZegoTaskMixStart: {
        event: "/mix/start_mix",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM,
            kTaskIDNullError: zego_error_1.errorCodeList.MIXER_TASK_ID_NULL,
            kTaskIDToLongError: zego_error_1.errorCodeList.MIXER_TASK_ID_TOO_LONG,
            kTaskIDInvalidCharacterError: zego_error_1.errorCodeList.MIXER_TASK_ID_INVALID_CHARACTER,
            kInputListNullError: zego_error_1.errorCodeList.MIXER_INPUTLIST_NULL,
            kOutputListNullError: zego_error_1.errorCodeList.MIXER_OUTPUTLIST_NULL,
            kOutputTargetInvalidError: zego_error_1.errorCodeList.MIXER_OUTPUT_TARGET_INVALID,
            kOutputNoTargetError: zego_error_1.errorCodeList.MIXER_NO_OUTPUT_TARGET,
            kRequestError: zego_error_1.errorCodeList.MIXER_START_REQUEST_ERROR,
            kInternalError: zego_error_1.errorCodeList.MIXER_INNER_ERROR
        },
        mix_stream_id: getItem,
        stream_cnt: getItem,
        input_stream_list: getItem,
        output_target_list: getItem
    },
    kZegoTaskMixStop: {
        event: "/mix/stop_mix",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM,
            kTaskIDNullError: zego_error_1.errorCodeList.MIXER_TASK_ID_NULL,
            kRequestError: zego_error_1.errorCodeList.MIXER_STOP_REQUEST_ERROR,
            kInternalError: zego_error_1.errorCodeList.MIXER_INNER_ERROR
        }
    },
    kZegoTaskMixConfig: {
        event: "/mix/config_mix",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM,
            kVideoConfigInvalidError: zego_error_1.errorCodeList.MIXER_VIDEO_CONFIG_INVALID,
            kBackgroundImageUrlInvalidError: zego_error_1.errorCodeList.MIXER_BACKGROUND_IMAGE_URL_INVALID
        },
        config: getItem
    },
    kZegoTaskEnumDevices: {
        event: "/device/list",
        error: {
            kBrowserNotSupportError: zego_error_1.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,
            kEnumDevicesError: zego_error_1.errorCodeList.ENUMERATE_DEVICES_FAIL
        },
        dev_list: getItem
    },
    kZegoTaskAudioOutput: {
        event: "/device/audio_capture",
        error: {
            kBrowserNotSupportError: zego_error_1.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,
            kEnumDevicesError: zego_error_1.errorCodeList.ENUMERATE_DEVICES_FAIL
        },
        session_id: getItem,
        device: getItem
    },
    kZegoTaskVideoCapture: {
        event: "/device/video_capture",
        error: {
            kBrowserNotSupportError: zego_error_1.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,
            kEnumDevicesError: zego_error_1.errorCodeList.ENUMERATE_DEVICES_FAIL
        },
        session_id: getItem,
        device: getItem
    },
    kZegoTaskDeviceInterrupt: {
        event: "/device/interrupt",
        error: {
            kBrowserNotSupportError: zego_error_1.errorCodeList.PUBLISHER_BROWSER_NOT_SUPPORT,
            kEnumDevicesError: zego_error_1.errorCodeList.ENUMERATE_DEVICES_FAIL
        },
        session_id: getItem,
        interrupt: getItem
    },
    kZegoTaskSetDebug: "/sdk/set_debug",
    kZegoTaskSetLog: "/sdk/set_log_config",
    kZegoTaskUseVideoDevice: {
        event: "/sdk/use_video_device",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM,
            kDevicesNoFoundError: zego_error_1.errorCodeList.DEVICE_NOT_FOUND,
            kLocalStreamError: zego_error_1.errorCodeList.LOCALSTREAM_WRONG
        },
        deviceID: getItem
    },
    kZegoTaskUseAudioDevice: {
        event: "/sdk/use_audio_device",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM,
            kDevicesNoFoundError: zego_error_1.errorCodeList.DEVICE_NOT_FOUND,
            kLocalStreamError: zego_error_1.errorCodeList.LOCALSTREAM_WRONG
        },
        deviceID: getItem
    },
    kZegoTaskCheckSystemRequirements: {
        event: "/sdk/check_system",
        capability: getItem
    },
    kZegoTaskMutePublishVideo: "/sdk/mute_publish_video",
    kZegoTaskMutePublishAudio: "/sdk/mute_publish_audio",
    kZegoTaskMutePlayVideo: "/sdk/mute_play_video",
    kZegoTaskMutePlayAudio: "/sdk/mute_play_audio",
    kZegoTaskRemoteCameraUpdate: {
        event: "/sdk/remote_camera_update",
        stream: getItem,
        status: getItem
    },
    kZegoTaskRemoteMicUpdate: {
        event: "/sdk/remote_mic_update",
        stream: getItem,
        status: getItem
    },
    kZegoTaskGetSoundLevel: {
        event: "/sdk/get_sound_level",
        error: {
            kGetSoundLevelError: zego_error_1.errorCodeList.GET_SOUND_LEVEL_FAIL
        }
    },
    kZegoTaskStopSoundLevel: "/sdk/stop_sound_level",
    kZegoTaskAddPublishCdnUrl: {
        event: "/sdk/add_publish_cdn_url",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM
        }
    },
    kZegoTaskRemovePublishCdnUrl: {
        event: "/sdk/remove_publish_cdn_url",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM
        },
        stream: getItem,
        target_url: getItem
    },
    kZegoTaskClearPublishCdnUrl: {
        event: "/sdk/clear_publish_cdn_url",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM
        }
    },
    kZegoTaskPublishTarget: {
        event: "/sdk/publish_target",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM,
            kPublishStreamNoFoundError: zego_error_1.errorCodeList.PUBLISHER_STREAM_NO_FOUND
        }
    },
    kZegoTaskDestroyStream: {
        event: "/sdk/destroy_stream",
        error: {
            kLocalStreamError: zego_error_1.errorCodeList.LOCALSTREAM_WRONG
        }
    },
    kZegoTaskScreenSharingEnded: "/sdk/screen_share_end",
    kZegoTaskAudioOutputChanged: {
        event: "/device/api/audio_output",
        session_id: getItem,
        stream: getItem,
        device: getItem,
        reason: getItem
    },
    kZegoTaskAudioDeviceChanged: {
        event: "/device/api/audio_c",
        session_id: getItem,
        stream: getItem,
        device: getItem,
        reason: getItem
    },
    kZegoTaskVideoDeviceChanged: {
        event: "/device/api/video_c",
        session_id: getItem,
        stream: getItem,
        device: getItem,
        reason: getItem
    },
    kZegoEventPublishStat: "/sdk/publish_stat_report",
    kZegoEventPlayStat: "/sdk/play_stat_report",
    kZegoSetAudioConfig: {
        event: "/sdk/set_audio_config",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM
        }
    },
    kZegoSetVideoConfig: {
        event: "/sdk/set_video_config",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM,
            kLocalStreamError: zego_error_1.errorCodeList.LOCALSTREAM_WRONG
        }
    },
    kZegoReplaceTrack: {
        event: "/sdk/replace_track",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM
        }
    },
    kZegoTaskLiveRoomGetStreamUpdateInfo: {
        event: "/liveroom/get_stream_update_info",
        stream_update_type: getItem,
        update_stream: getItem
    },
    kZegoTaskLiveRoomGetStreamExtraInfo: {
        event: "/liveroom/get_stream_extra_info",
        update_stream: getItem
    },
    kZegoTaskLiveRoomSendStreamExtraInfo: {
        event: "/liveroom/send_stream_extra_info",
        error: {
            kParamError: zego_error_1.errorCodeList.INPUT_PARAM,
            kExtraInfoNullError: zego_error_1.errorCodeList.PUBLISHER_EXTRA_INFO_NULL,
            kNoLoginError: zego_error_1.errorCodeList.NOT_LOGIN,
            kPublishStreamNoFoundError: zego_error_1.errorCodeList.PUBLISHER_STREAM_NO_FOUND
        },
        stream: getItem,
        stream_extra_info: getItem,
        room_sid: getItem
    },
    kZegoTaskPlayDecodeFirstVideoFrame: {
        event: "/sdk/play_decode_first_video_frame",
        session_id: getItem,
        fft_consumed: getItem
    }
};
// fs.writeFile(
//   path.resolve(__dirname, "../../../doc/logevent.json"),
//   JSON.stringify(ZegoRTCLogEvent),
//   "utf8",
//   err => {
//     console.log(err);
//   }
// );


/***/ }),

/***/ "./sdk/src/util/client-util.ts":
/*!*************************************!*\
  !*** ./sdk/src/util/client-util.ts ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
exports.ClientUtil = void 0;
var zego_log_event_1 = __webpack_require__(/*! ../common/zego.log.event */ "./sdk/src/common/zego.log.event.ts");
var ClientUtil = /** @class */ (function () {
    function ClientUtil() {
    }
    ClientUtil.checkIllegalCharacters = function (str) {
        // const reg = /^(?=.*[a-zA-Z\d~!@#$%^&amp;*()_+`\-={}:";'&lt;&gt;?,.\/]).{1,256}$/;
        var reg = /^([0-9a-zA-Z#!$%&()`'+-;<=.>@^_~,\\*])+$/;
        var reg2 = /^[^:/]*$/g;
        return reg.test(str) && reg2.test(str);
    };
    ClientUtil.isUrl = function (str) {
        if (str.startsWith("rtmp://") ||
            (str.startsWith("https://") && str.endsWith(".flv")) ||
            (str.startsWith("https://") && str.endsWith(".m3u8"))) {
            return true;
        }
        return false;
    };
    ClientUtil.registerCallback = function (fName, option, callbackList) {
        var sf, ef;
        if (option.success) {
            sf = option.success;
            callbackList[fName + "SuccessCallback"] = sf;
        }
        if (option.error) {
            ef = option.error;
            callbackList[fName + "ErrorCallback"] = ef;
        }
    };
    ClientUtil.actionErrorCallback = function (fName, callbackList) {
        return callbackList[fName + "ErrorCallback"];
    };
    // 
    ClientUtil.actionSuccessCallback = function (fName, callbackList) {
        return callbackList[fName + "SuccessCallback"];
    };
    ClientUtil.logReportCallback = function (logEvent, dataReport, reportSeq, callbackList) {
        ClientUtil.registerCallback(logEvent, {
            success: function (reportName, eventName) {
                var args = [];
                for (var _i = 2; _i < arguments.length; _i++) {
                    args[_i - 2] = arguments[_i];
                }
                ClientUtil.dataReportEvent(dataReport, reportSeq, reportName, eventName, args);
            }
        }, callbackList);
    };
    //   static getServerError(code: number): ERRO {
    //     const serverErrorList = {
    //       1: "parse json error.",
    //       1001: "login is processing.",
    //       1002: "liveroom request error.",
    //       1003: "zpush connect fail.",
    //       1004: "zpush handshake fail.",
    //       1005: "zpush login fail.",
    //       1006: "user login state is wrong.",
    //       1007: "got no zpush addr",
    //       1008: "token error",
    //       1009: "dispatch error",
    //       1010: "token expired",
    //       1011: "token format error",
    //       2002: "biz channel error",
    //       1000000000: "liveroom cmd error, code:"
    //     };
    //     if (code === 0) {
    //       return {
    //         code: 0,
    //         message: ""
    //       };
    //     }
    //     const err = {
    //       code: 0,
    //       message: "liveroom cmd error"
    //     };
    //     err.code = code as number;
    //     if (code > 1000000000) {
    //       err.message = serverErrorList[1000000000] + code;
    //       //@ts-ignore
    //     } else if (serverErrorList[code]) {
    //       //@ts-ignore
    //       err.message = serverErrorList[code] + " code:" + code;
    //     } else {
    //       err.message = "unknown error code:" + code;
    //     }
    //     return err;
    //   }
    ClientUtil.unregisterCallback = function (fName, callbackList) {
        delete callbackList[fName + "SuccessCallback"];
        delete callbackList[fName + "ErrorCallback"];
    };
    ClientUtil.decodeServerError = function (code, msg) {
        var err = {
            code: -1,
            message: "server error"
        };
        if (code > 1000000000) {
            err.code = code - 1000000000 + 52000000;
        }
        msg && (err.message = msg);
        return err;
    };
    ClientUtil.getLiveRoomError = function (code) {
        var prefix = 1000000000;
        var liveRoomErrMap = {
            1105: "ROOM_MAX_USER_COUNT",
            1012: "PUBLISHER_ERROR_REPETITIVE_PUBLISH_STREAM",
            2002: "ROOM_ERROR_AUTHENTICATION_FAILED",
            2003: "ROOM_ERROR_LOGIN_TIMEOUT"
        };
        var accessSvrErrMap = {
            1: "PARSE_JSON_ERROR",
            1001: "LOGIN_PROCESSING",
            1002: "LIVEROMM_REQUEST_ERROR",
            1003: "ZPUSH_REQUEST_FAIL",
            1004: "ZPUSH_REQUEST_FAIL",
            1005: "ZPUSH_REQUEST_FAIL",
            1006: "LOGIN_STATE_WRONG",
            1007: "ZPUSH_REQUEST_FAIL",
            1008: "TOKEN_ERROR",
            1009: "DIAPATCH_ERROR",
            1010: "TOKEN_EXPIRED",
            1011: "TOKEN_ERROR",
            1012: "SUBCMD_ERROR",
            1101: "ZEGO_AUTH_ERROR",
            2001: "BIZ_CHANNEL_ERROR",
            2002: "BIZ_CHANNEL_ERROR"
        };
        if (code > 1000000000) {
            return liveRoomErrMap[code - prefix] || "";
        }
        else {
            return accessSvrErrMap[code] || "ROOM_INNER_ERROR";
        }
    };
    ClientUtil.mixServerError = function (code) {
        var mixServerErrorList = {
            82000001: "kMixStreamFailError",
            82000002: "kMixStreamInputError",
            82000003: "kMixStreamAuthError",
            82000150: "kMixStreamNotExistError",
            82000151: "kMixStreamStartMixError",
            82000152: "kMixStreamStopMixError",
            82000155: "kMixStreamInputFormatError",
            82000156: "kMixStreamOutputFormatError",
            82000157: "kMixStreamNotOpenError",
            82000158: "kMixStreamInputExceedError",
            82000159: "kMixStreamDispatchError",
            82000160: "kMixStreamStopMixOwnerError",
            82000170: "kMixStreamWaterMarkParamError",
            82000171: "kMixStreamWaterMarkImageError",
            82000190: "kMixStreamQpsOverloadError"
        };
        var mixServerErrorMap = {
            1: "MIXER_START_REQUEST_ERROR",
            3: "MIXER_AUTHENTICATION_FAILED",
            150: "MIXER_INPUT_STREAM_NOT_EXISTS",
            151: "MIXER_START_REQUEST_ERROR",
            152: "MIXER_STOP_REQUEST_ERROR",
            153: "MIXER_INPUT_PARAMETERS_ERROR",
            154: "MIXER_EXCEED_MAX_OUTPUT_COUNT",
            155: "MIXER_INPUT_PARAMETERS_ERROR",
            156: "MIXER_VIDEO_CONFIG_INVALID",
            157: "MIXER_NO_SERVICES",
            158: "MIXER_EXCEED_MAX_INPUT_COUNT",
            159: "MIXER_START_REQUEST_ERROR",
            160: "MIXER_NOT_OWNER_STOPMIXER",
            170: "MIXER_WATERMARK_PARAMETERS_ERROR",
            171: "MIXER_WATERMARK_NULL",
            190: "MIXER_START_REQUEST_ERROR"
        };
        var res = [];
        if (code > 1000000000) {
            var errcode = code - 1000000000 + 82000000;
            if (mixServerErrorList[errcode]) {
                res[0] = mixServerErrorList[errcode];
            }
            else {
                res[0] = "";
            }
            if (mixServerErrorMap[code - 1000000000]) {
                res[1] = mixServerErrorMap[code - 1000000000];
            }
            else {
                res[1] = "";
            }
        }
        return res;
    };
    ClientUtil.getKickoutError = function (code) {
        var err = {};
        switch (code) {
            case 1:
                err.code = 63000001;
                err.message = "zpush multiple login kickout";
                err.name = "MULTIPLE_LOGIN_KICKOUT";
                break;
            case 2:
                err.code = 63000002;
                err.message = "zpush manual kickout";
                err.name = "MANUAL_KICKOUT";
                break;
            case 3:
                err.code = 63000003;
                err.message = "kickout reason = " + code;
                break;
            case 4:
                err.code = 63000001;
                err.message = "zpush multiple login kickout";
                err.name = "MULTIPLE_LOGIN_KICKOUT";
                break;
            default:
                err.code = code;
                err.message = "kickout reason = " + code;
                break;
        }
        return err;
    };
    ClientUtil.dataReportEvent = function (dataReport, reportSeq, reportName, eventName, args) {
        switch (reportName) {
            case "eventStart":
                dataReport.eventStart(reportSeq, eventName);
                break;
            case "eventEndWithMsgInfo":
                dataReport.eventEndWithMsgInfo(reportSeq, eventName, args[0]);
                break;
            case "addEventMsg":
                dataReport.addEventMsg(reportSeq, eventName, args[0], args[1]);
                break;
            case "addEvent":
                dataReport.addEvent(reportSeq, eventName);
                break;
            case "eventEnd":
                dataReport.eventEnd(reportSeq, eventName);
                break;
            case "addMsgInfo":
                dataReport.addMsgInfo(reportSeq, args[0]);
                break;
            default:
                break;
        }
    };
    ClientUtil.isKeepTryLogin = function (code) {
        switch (code) {
            case 1002: //liveroom connect error
            case 1003: //zpush connect error
                return true;
            default:
                return false;
        }
    };
    ClientUtil.mergeStreamList = function (idName, oldStreamList, newStreamList, callbackResult) {
        var addStreamList = [];
        var delStreamList = [];
        var updateStreamList = [];
        var flag;
        if (!newStreamList) {
            newStreamList = [];
        }
        for (var i = 0; i < newStreamList.length; i++) {
            if (newStreamList[i].anchor_id_name == idName) {
                continue;
            }
            flag = false;
            for (var j = 0; j < oldStreamList.length; j++) {
                if (newStreamList[i].stream_id === oldStreamList[j].stream_id) {
                    if (newStreamList[i].extra_info !== oldStreamList[j].extra_info) {
                        updateStreamList.push(newStreamList[i]);
                    }
                    flag = true;
                    break;
                }
            }
            if (!flag) {
                addStreamList.push(newStreamList[i]);
            }
        }
        for (var k = 0; k < oldStreamList.length; k++) {
            flag = false;
            for (var n = 0; n < newStreamList.length; n++) {
                if (oldStreamList[k].stream_id === newStreamList[n].stream_id) {
                    flag = true;
                    break;
                }
            }
            if (!flag) {
                delStreamList.push(oldStreamList[k]);
            }
        }
        oldStreamList.splice(0);
        for (var i = 0; i < newStreamList.length; i++) {
            oldStreamList.push(newStreamList[i]);
        }
        callbackResult(addStreamList, delStreamList, updateStreamList);
    };
    ClientUtil.checkInteger = function (num, positive) {
        if (positive == false)
            return typeof num === "number" && num % 1 === 0 && num >= 0;
        return typeof num === "number" && num % 1 === 0 && num > 0;
    };
    ClientUtil.checkValidNumber = function (param, min, max) {
        min = min || 1;
        max = max || 1 * 1e4;
        return (typeof param === "number" &&
            param % 1 == 0 &&
            param >= min &&
            param <= max);
    };
    //
    ClientUtil.uuid = function (len, radix) {
        var chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");
        var uuid = [];
        var i;
        radix = radix || chars.length;
        if (len) {
            // Compact form
            for (i = 0; i < len; i++)
                uuid[i] = chars[0 | (Math.random() * radix)];
        }
        else {
            // rfc4122, version 4 form
            var r = void 0;
            // rfc4122 requires these characters
            uuid[8] = uuid[13] = uuid[18] = uuid[23] = "-";
            uuid[14] = "4";
            // Fill in random data. At i==19 set the high bits of clock sequence as
            // per rfc4122, sec. 4.1.5
            for (i = 0; i < 36; i++) {
                if (!uuid[i]) {
                    r = 0 | (Math.random() * 16);
                    uuid[i] = chars[i == 19 ? (r & 0x3) | 0x8 : r];
                }
            }
        }
        return uuid.join("");
    };
    //   static async supportDetection(screenShotReady: boolean, success: Function) {
    //     const result: any = {
    //       webRTC: false,
    //       customCapture: false,
    //       camera: false,
    //       microphone: false,
    //       videoCodec: {
    //         H264: false,
    //         H265: false,
    //         VP8: false,
    //         VP9: false
    //       },
    //       screenSharing: screenShotReady,
    //       errInfo: {}
    //     };
    //     const videoEle = document.createElement("video");
    //     // @ts-ignore
    //     if (videoEle["captureStream"] || videoEle["mozCaptureStream"]) {
    //       result.customCapture = true;
    //     }
    //     if (
    //       navigator &&
    //       navigator.mediaDevices &&
    //       navigator.mediaDevices.getUserMedia
    //     ) {
    //       if (
    //         window.location.protocol !== "https:" &&
    //         window.location.protocol !== "file:" &&
    //         window.location.hostname.indexOf("127.0.0.1") == -1 &&
    //         window.location.hostname.indexOf("localhost") == -1
    //       ) {
    //         result.camera = false;
    //         // result.errInfo.camera = {};
    //         console.error("webrtc requires https or localhost");
    //       } else {
    //         try {
    //           const video = await navigator.mediaDevices.getUserMedia({
    //             video: true
    //           });
    //           video &&
    //             (result.camera = true) &&
    //             video.getTracks().forEach(track => track.stop());
    //         } catch (err) {
    //           result.errInfo.camera = {
    //             name: err.name,
    //             message: err.message
    //           };
    //           console.error("camera devices detect error: ", err.name, err.message);
    //         }
    //         try {
    //           const audio = await navigator.mediaDevices.getUserMedia({
    //             audio: true
    //           });
    //           audio &&
    //             (result.microphone = true) &&
    //             audio.getTracks().forEach(track => track.stop());
    //         } catch (err) {
    //           result.errInfo.microphone = {
    //             name: err.name,
    //             message: err.message
    //           };
    //           console.error(
    //             "microphone devices detect error: ",
    //             err.name,
    //             err.message
    //           );
    //         }
    //       }
    //     }
    //     this.supportVideoCodeType(
    //       (
    //         rtcCodec: {
    //           webRTC: boolean;
    //           H264: boolean;
    //           VP8: boolean;
    //           H265: boolean;
    //           VP9: boolean;
    //         },
    //         err?: any
    //       ) => {
    //         result.videoCodec.H264 = rtcCodec.H264;
    //         result.videoCodec.H265 = rtcCodec.H265;
    //         result.videoCodec.VP8 = rtcCodec.VP8;
    //         result.videoCodec.VP9 = rtcCodec.VP9;
    //         result.webRTC = rtcCodec.webRTC;
    //         if (err) {
    //           result.errInfo.webRTC = {
    //             name: err.name,
    //             message: err.message
    //           };
    //           console.error("videoCodec detect error: " + err);
    //         }
    //         success && success(result);
    //       }
    //     );
    //   }
    //   static getNetQuality(rtt: number, fractionLost: number) {
    //     let netQuality = 0;
    //     if (rtt && rtt < 600) {
    //       if (fractionLost > 0.4) {
    //         netQuality = 2;
    //       } else if (fractionLost > 0.3) {
    //         netQuality = 4;
    //       } else {
    //         netQuality = 5;
    //       }
    //     } else if (rtt < 900) {
    //       if (fractionLost > 0.4) {
    //         netQuality = 2;
    //       } else if (fractionLost > 0.2) {
    //         netQuality = 3;
    //       } else {
    //         netQuality = 4;
    //       }
    //     } else {
    //       if (fractionLost > 0.2) {
    //         netQuality = 2;
    //       } else {
    //         netQuality = 3;
    //       }
    //     }
    //     return netQuality;
    //   }
    //   static getDevices(
    //     deviceInfoCallback: (res: {
    //       microphones: Array<{
    //         deviceName: string;
    //         deviceID: string;
    //       }>;
    //       speakers: Array<{
    //         deviceName: string;
    //         deviceID: string;
    //       }>;
    //       cameras: Array<{
    //         deviceName: string;
    //         deviceID: string;
    //       }>;
    //     }) => void,
    //     error: (err: ERRO) => void
    //   ): void {
    //     if (
    //       navigator.mediaDevices === undefined ||
    //       navigator.mediaDevices.enumerateDevices === undefined
    //     ) {
    //       if (error) {
    //         error(
    //           ZegoRTCLogEvent.kZegoTaskEnumDevices.error.kBrowserNotSupportError
    //         );
    //       }
    //       return;
    //     }
    //     navigator.mediaDevices
    //       .enumerateDevices()
    //       .then(deviceInfos => {
    //         const microphone = [];
    //         const speaker = [];
    //         const camera = [];
    //         for (let i = 0; i < deviceInfos.length; i++) {
    //           const deviceInfo = deviceInfos[i];
    //           if (deviceInfo.kind === "audioinput") {
    //             microphone.push({
    //               deviceName: deviceInfo.label,
    //               deviceID: deviceInfo.deviceId
    //             });
    //           }
    //           if (deviceInfo.kind === "audiooutput") {
    //             speaker.push({
    //               deviceName: deviceInfo.label,
    //               deviceID: deviceInfo.deviceId
    //             });
    //           }
    //           if (deviceInfo.kind === "videoinput") {
    //             camera.push({
    //               deviceName: deviceInfo.label,
    //               deviceID: deviceInfo.deviceId
    //             });
    //           }
    //         }
    //         if (deviceInfoCallback) {
    //           deviceInfoCallback({
    //             microphones: microphone,
    //             speakers: speaker,
    //             cameras: camera
    //           });
    //         }
    //       })
    //       .catch(err => {
    //         console.error("enumerate devices wrong " + err);
    //         error &&
    //           error(ZegoRTCLogEvent.kZegoTaskEnumDevices.error.kEnumDevicesError);
    //       });
    //   }
    ClientUtil.checkConfigParam = function (option, logger) {
        if (!option.appid || typeof option.appid !== "number") {
            logger.error("ccp.0 appid must be number");
            return false;
        }
        if (!option.server ||
            option.server.length < 1 ||
            (typeof option.server !== "string" && !Array.isArray(option.server))) {
            logger.error("ccp.0 server must be string or string[] and not empty");
            return false;
        }
        if (!option.idName || typeof option.idName !== "string") {
            logger.error("ccp.0 idName must be string and not empty");
            return false;
        }
        return true;
    };
    ClientUtil.compareVersion = function (v1, v2) {
        v1 = v1.split(".");
        v2 = v2.split(".");
        var len = Math.max(v1.length, v2.length);
        while (v1.length < len) {
            v1.push("0");
        }
        while (v2.length < len) {
            v2.push("0");
        }
        for (var i = 0; i < len; i++) {
            var num1 = parseInt(v1[i]);
            var num2 = parseInt(v2[i]);
            if (num1 > num2) {
                return 1;
            }
            else if (num1 < num2) {
                return -1;
            }
        }
        return 0;
    };
    ClientUtil.isSupportLive = function (sucCall, errCall) {
        var resultList = {
            10001: "",
            10002: ""
        };
        var version = wx.getSystemInfoSync().SDKVersion;
        var res = {
            code: -1,
            msg: ""
        };
        if (this.compareVersion(version, "1.7.0") < 0) {
            res = {
                code: 10001,
                msg: resultList[10001]
            };
            sucCall && sucCall(res);
        }
        wx.getSetting({
            success: function (_a) {
                var authSetting = _a.authSetting;
                if (!authSetting["scope.camera"] || !authSetting["scope.record"]) {
                    res = {
                        code: 10002,
                        msg: resultList[10002]
                    };
                }
                sucCall && sucCall(res);
            },
            fail: function (err) {
                console.error("get setting error", err);
                errCall && errCall(err);
            }
        });
    };
    //   static supportVideoCodeType(sucCall: {
    //     (
    //       rtcCodec: {
    //         webRTC: boolean;
    //         H264: boolean;
    //         VP8: boolean;
    //         VP9: boolean;
    //         H265: boolean;
    //       },
    //       error?: any
    //     ): void;
    //   }): void {
    //     //@ts-ignore
    //     const rtcCodec = {
    //       webRTC: false,
    //       H264: false,
    //       VP8: false,
    //       VP9: false,
    //       H265: false
    //     };
    //     try {
    //       new RTCPeerConnection()
    //         .createOffer({
    //           offerToReceiveAudio: true,
    //           offerToReceiveVideo: true
    //         })
    //         .then((desc: any) => {
    //           rtcCodec.webRTC = true;
    //           if (desc && desc.sdp) {
    //             const sdplist = desc.sdp.split("\r\n");
    //             rtcCodec.H264 = sdplist.some((item: any) => {
    //               return item.startsWith("a=rtpmap:") && item.indexOf("H264/") > -1;
    //             });
    //             rtcCodec.VP8 = sdplist.some((item: any) => {
    //               return item.startsWith("a=rtpmap:") && item.indexOf("VP8/") > -1;
    //             });
    //             rtcCodec.VP9 = sdplist.some((item: any) => {
    //               return item.startsWith("a=rtpmap:") && item.indexOf("VP9/") > -1;
    //             });
    //             rtcCodec.H265 = sdplist.some((item: any) => {
    //               return item.startsWith("a=rtpmap:") && item.indexOf("H265/") > -1;
    //             });
    //             sucCall && sucCall(rtcCodec);
    //           }
    //         });
    //     } catch (error) {
    //       sucCall && sucCall(rtcCodec, error);
    //     }
    //   }
    ClientUtil.inlineWorker = function (func) {
        //worker
        if (Worker && func) {
            var functionBody = func
                .toString()
                .trim()
                .match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1];
            var url = URL.createObjectURL(new window.Blob([functionBody], {
                type: "text/javascript"
            }));
            return new Worker(url);
        }
        return null;
    };
    ClientUtil.getBrowser = function () {
        var ua = window.navigator.userAgent;
        var isIE = window.ActiveXObject != undefined && ua.indexOf("MSIE") != -1;
        var isFirefox = ua.indexOf("Firefox") != -1;
        var isOpera = window.opr != undefined;
        var isChrome = ua.indexOf("Chrome") && window.chrome;
        var isSafari = ua.indexOf("Safari") != -1 && ua.indexOf("Version") != -1;
        if (isIE) {
            return "IE";
        }
        else if (isFirefox) {
            return "Firefox";
        }
        else if (isOpera) {
            return "Opera";
        }
        else if (isChrome) {
            return "Chrome";
        }
        else if (isSafari) {
            return "Safari";
        }
        else {
            return "Unkown";
        }
    };
    ClientUtil.getPublisherStateType = function (type) {
        return type == 0 || type == 1
            ? type == 0
                ? "PUBLISHING"
                : "NO_PUBLISH"
            : "PUBLISH_REQUESTING";
    };
    ClientUtil.getPlayerStateType = function (type) {
        return type == 0 || type == 1
            ? type == 0
                ? "PLAYING"
                : "NO_PLAY"
            : "PLAY_REQUESTING";
    };
    ClientUtil.getSteamUpdateType = function (type) {
        return type == 0 ? "DELETE" : "ADD";
    };
    //   static checkScreenParams(
    //     screen: Constraints["screen"],
    //     errorCallback: Function
    //   ): boolean {
    //     if (typeof screen === "object" && screen.videoQuality !== undefined) {
    //       if (!ClientUtil.checkInteger(screen.videoQuality)) {
    //         errorCallback(
    //           ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError,
    //           " videoQuality must be integer number"
    //         );
    //         return false;
    //       }
    //     }
    //     if (typeof screen === "object" && screen.videoQuality === 4) {
    //       if (screen.bitRate === undefined) {
    //         errorCallback(
    //           ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError,
    //           " bitrate is required when videoQuality is 4"
    //         );
    //         return false;
    //       } else if (!ClientUtil.checkInteger(screen.bitRate)) {
    //         errorCallback(
    //           ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError,
    //           " bitrate must be integer number"
    //         );
    //         return false;
    //       } else if (screen.bitRate > 10240) {
    //         errorCallback(
    //           ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError,
    //           " bitrate cannot greater than 10 Mbps"
    //         );
    //         return false;
    //       }
    //       if (screen.frameRate === undefined) {
    //         errorCallback(
    //           ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError,
    //           " frameRate is required when videoQuality is 4"
    //         );
    //         return false;
    //       } else if (!ClientUtil.checkInteger(screen.frameRate)) {
    //         errorCallback(
    //           ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError,
    //           " frameRate must be integer number"
    //         );
    //         return false;
    //       }
    //       if (screen.width === undefined) {
    //         errorCallback(
    //           ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError,
    //           " width is required when videoQuality is 4"
    //         );
    //         return false;
    //       } else if (!ClientUtil.checkInteger(screen.width)) {
    //         errorCallback(
    //           ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError,
    //           " width must be integer number"
    //         );
    //         return false;
    //       }
    //       if (screen.height === undefined) {
    //         errorCallback(
    //           ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError,
    //           " height is required when videoQuality is 4"
    //         );
    //         return false;
    //       } else if (!ClientUtil.checkInteger(screen.height)) {
    //         errorCallback(
    //           ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError,
    //           " height must be integer number"
    //         );
    //         return false;
    //       }
    //     }
    //     return true;
    //   }
    ClientUtil.checkCameraParams = function (cameras, errorCallback) {
        if (!cameras.width || !ClientUtil.checkValidNumber(cameras.width)) {
            errorCallback(zego_log_event_1.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError, " widths must be integer number");
            return false;
        }
        if (!cameras.height || !ClientUtil.checkValidNumber(cameras.height)) {
            errorCallback(zego_log_event_1.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError, " height must be integer number");
            return false;
        }
        if (!cameras.frameRate || !ClientUtil.checkValidNumber(cameras.frameRate)) {
            errorCallback(zego_log_event_1.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError, " frameRate must be integer number");
            return false;
        }
        if (!cameras.bitRate || !ClientUtil.checkValidNumber(cameras.bitRate)) {
            errorCallback(zego_log_event_1.ZegoRTCLogEvent.kZegoTaskCreateStream.error.kParamError, " bitrate must be integer number");
            return false;
        }
        return true;
    };
    ClientUtil.makeCallbackStreamList = function (streamList) {
        var callbackStreamList = [];
        if (streamList && streamList.length > 0) {
            for (var i = 0; i < streamList.length; i++) {
                var streamInfo = {
                    anchor_id_name: streamList[i].anchor_id_name,
                    stream_gid: streamList[i].stream_gid,
                    anchor_nick_name: streamList[i].anchor_nick_name,
                    extra_info: streamList[i].extra_info,
                    stream_id: streamList[i].stream_id,
                    urls_flv: "",
                    urls_rtmp: "",
                    urls_hls: "",
                    urls_https_flv: "",
                    urls_https_hls: ""
                };
                var streamItem = streamList[i];
                streamInfo.urls_flv = streamItem.urls_flv;
                streamInfo.urls_hls = streamItem.urls_m3u8;
                streamInfo.urls_https_flv = streamItem.urls_https_flv;
                streamInfo.urls_https_hls = streamItem.urls_https_m3u8;
                streamInfo.urls_rtmp = streamItem.urls_rtmp;
                callbackStreamList.push(streamInfo);
            }
        }
        return callbackStreamList;
    };
    return ClientUtil;
}());
exports.ClientUtil = ClientUtil;


/***/ }),

/***/ "./sdk/src/util/mediaUtil.ts":
/*!***********************************!*\
  !*** ./sdk/src/util/mediaUtil.ts ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
exports.MediaUtil = void 0;
var client_util_1 = __webpack_require__(/*! ./client-util */ "./sdk/src/util/client-util.ts");
var MediaUtil = /** @class */ (function () {
    function MediaUtil(_a) {
        var _this = this;
        var type = _a.type, _b = _a.channels, channels = _b === void 0 ? 1 : _b, _c = _a.bufferSize, bufferSize = _c === void 0 ? 0 : _c, _d = _a.sampleBit, sampleBit = _d === void 0 ? 16 : _d, _e = _a.sampleRate, sampleRate = _e === void 0 ? 44100 : _e;
        this.instant = 0.0;
        this.slow = 0.0;
        this.clip = 0.0;
        var context = new (typeof webkitAudioContext !== "undefined"
            ? webkitAudioContext
            : AudioContext)();
        this.context = context;
        // @ts-ignore
        this.type = type;
        this.channels = channels;
        this.bufferSize = bufferSize;
        this.sampleBit = sampleBit;
        this.sampleRate = sampleRate;
        this.script = context.createScriptProcessor(bufferSize, channels, channels);
        var audioprocessTime = new Date().getTime();
        this.script.addEventListener("audioprocess", function (event) {
            var input = event.inputBuffer.getChannelData(0);
            var i;
            var sum = 0.0;
            var clipcount = 0;
            for (i = 0; i < input.length; ++i) {
                sum += input[i] * input[i];
                if (Math.abs(input[i]) > 0.99) {
                    clipcount += 1;
                }
            }
            _this.instant = Math.sqrt(sum / input.length);
            _this.slow = 0.95 * _this.slow + 0.05 * _this.instant;
            _this.clip = clipcount / input.length;
            // 
            if (type === "pcm" || type === "wav") {
                var buffer = [];
                for (var i_1 = 0; i_1 < _this.channels; i_1++) {
                    buffer.push(event.inputBuffer.getChannelData(i_1));
                }
                // @ts-ignore
                _this.recorderBuffer(buffer);
            }
        });
        // ,worker
        if (type === "pcm" || type === "wav") {
            this.initRecorderBuffer(type);
        }
    }
    MediaUtil.prototype.connectToSource = function (stream, callback) {
        console.log("SoundMeter connecting");
        try {
            this.mic = this.context.createMediaStreamSource(stream);
            this.mic.connect(this.script);
            // necessary to make sample run, but should not be.
            this.script.connect(this.context.destination);
            if (typeof callback !== "undefined") {
                callback(null);
            }
        }
        catch (e) {
            console.error(e);
            if (typeof callback !== "undefined") {
                callback(e);
            }
        }
        return this;
    };
    MediaUtil.prototype.recorderBuffer = function (audioBuffer) {
        this.worker.postMessage({
            command: "record",
            val: audioBuffer
        });
    };
    MediaUtil.prototype.initRecorderBuffer = function (type) {
        var _this = this;
        // eslint-disable-next-line @typescript-eslint/no-this-alias
        var self = this;
        this.worker = client_util_1.ClientUtil.inlineWorker(function () {
            var record = [], sampleChannel, sampleBit, sampleRate, oldSampleRate, bufferSize, type;
            // eslint-disable-next-line @typescript-eslint/no-this-alias
            var _self = _this;
            function init(option) {
                sampleChannel = option.sampleChannel;
                sampleBit = option.sampleBit;
                sampleRate = option.sampleRate;
                oldSampleRate = option.oldSampleRate;
                bufferSize = option.bufferSize;
                type = option.type;
            }
            function floatTo16BitPCM(output, offset, input) {
                for (var i = 0; i < input.length; i++, offset += 2) {
                    var s = Math.max(-1, Math.min(1, input[i]));
                    output.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7fff, true);
                }
            }
            function floatTo8BitPCM(output, offset, input) {
                for (var i = 0; i < input.length; i++, offset++) {
                    //1
                    var s = Math.max(-1, Math.min(1, input[i]));
                    var val = s < 0 ? s * 0x80 : s * 0x7f;
                    val += 128;
                    output.setInt8(offset, val);
                }
            }
            function floatToPCM(samples, _sampleBit) {
                var dataLength;
                if (_sampleBit == 8) {
                    dataLength = samples.length;
                }
                else if (_sampleBit == 16) {
                    //16
                    dataLength = samples.length;
                    dataLength = dataLength * 2;
                }
                var buffer = new ArrayBuffer(dataLength);
                var view = new DataView(buffer);
                if (_sampleBit == 8) {
                    floatTo8BitPCM(view, 0, samples);
                }
                else if (sampleBit == 16) {
                    floatTo16BitPCM(view, 0, samples);
                }
                return view;
            }
            function writeString(view, offset, string) {
                for (var i = 0; i < string.length; i++) {
                    view.setUint8(offset + i, string.charCodeAt(i));
                }
            }
            function encodeWave(samples, _sampleBit) {
                var dataLength;
                if (_sampleBit == 8) {
                    dataLength = samples.length;
                }
                else if (sampleBit == 16) {
                    //16
                    dataLength = samples.length;
                    dataLength = dataLength * 2;
                }
                var buffer = new ArrayBuffer(dataLength + 44);
                var view = new DataView(buffer);
                var newSamepleRate = sampleRate;
                var newSampleBits = sampleBit;
                var newSampleChannel = sampleChannel;
                writeString(view, 0, "RIFF");
                view.setUint32(4, 36 + dataLength, true);
                writeString(view, 8, "WAVE");
                writeString(view, 12, "fmt ");
                view.setUint32(16, 16, true);
                view.setUint16(20, 1, true);
                view.setUint16(22, newSampleChannel, true);
                view.setUint32(24, newSamepleRate, true);
                view.setUint32(28, newSamepleRate * newSampleChannel * (newSampleBits / 8), true);
                view.setUint16(32, newSampleChannel * (newSampleBits / 8), true);
                view.setUint16(34, newSampleBits, true);
                writeString(view, 36, "data");
                view.setUint32(40, dataLength, true);
                if (sampleBit == 8) {
                    floatTo8BitPCM(view, 44, samples);
                }
                else if (sampleBit == 16) {
                    floatTo16BitPCM(view, 44, samples);
                }
                return view;
            }
            //
            function compressHandler(compressRate, data) {
                var result = new Float32Array(data.length / compressRate);
                var index = 0, j = 0;
                while (index < result.length) {
                    result[index] = data[j];
                    j += compressRate;
                    index++;
                }
                return result;
            }
            //buffer
            function getAudioBuffer(data, _bufferSize, _record) {
                var result = new Float32Array(_bufferSize * data.length);
                var offset = 0;
                for (var i = 0; i < _record[0].length; i++) {
                    result.set(_record[0][i], offset);
                    offset += _record[0][i].length;
                    //console.log(offset);
                }
                return result;
            }
            //
            function combineChannels(channelL, channelR) {
                var result = new Float32Array(channelL.length + channelR.length);
                for (var i = 0; i < channelL.length + channelR.length; i += 2) {
                    result[i] = channelL[(i / 2) >> 0];
                    result[i + 1] = channelR[(i / 2) >> 0];
                }
                return result;
            }
            function collectBuffer(compressRate) {
                var collect_record, compress_collect_record;
                if (sampleChannel == 1) {
                    //
                    collect_record = getAudioBuffer(record[0], bufferSize, record);
                    if (compressRate != 1) {
                        //
                        compress_collect_record = compressHandler(compressRate, collect_record);
                    }
                }
                else if (sampleChannel == 2) {
                    //
                    //1,2
                    var collect_record_1 = getAudioBuffer(record[0], bufferSize, record);
                    var collect_record_2 = getAudioBuffer(record[1], bufferSize, record);
                    var compress_collect_record_1 = void 0, compress_collect_record_2 = void 0;
                    if (compressRate != 1) {
                        //12
                        compress_collect_record_1 = compressHandler(compressRate, collect_record_1);
                        compress_collect_record_2 = compressHandler(compressRate, collect_record_2);
                        compress_collect_record = combineChannels(compress_collect_record_1, compress_collect_record_2);
                    }
                    else {
                        collect_record = combineChannels(collect_record_1, collect_record_2);
                    }
                }
                if (compressRate != 1) {
                    //
                    return compress_collect_record;
                }
                else {
                    return collect_record;
                }
            }
            function collectPCM(compressRate) {
                var result = collectBuffer(compressRate);
                var interleaveData = floatToPCM(result, sampleBit);
                _self.postMessage({
                    command: "exportPcmLive",
                    val: interleaveData
                });
            }
            function collectWAV(compressRate) {
                var result = collectBuffer(compressRate);
                var interleaveData = encodeWave(result, sampleBit);
                _self.postMessage({
                    command: "exportWav",
                    val: interleaveData
                });
            }
            function recordData(buffer) {
                for (var i = 0; i < sampleChannel; i++) {
                    if (!record[i]) {
                        record[i] = [];
                    }
                    record[i].push(buffer[i]);
                }
                var compressRate = Math.round(oldSampleRate / sampleRate);
                if (type === "pcm") {
                    collectPCM(compressRate);
                }
                else if (type === "wav") {
                    collectWAV(compressRate);
                }
                record = []; //
            }
            _this.onmessage = function (e) {
                switch (e.data.command) {
                    case "init":
                        init(e.data.val);
                        break;
                    case "record":
                        recordData(e.data.val);
                        break;
                }
            };
        });
        this.worker.postMessage({
            command: "init",
            val: {
                sampleChannel: this.channels,
                sampleBit: this.sampleBit,
                sampleRate: this.sampleRate,
                oldSampleRate: this.context.sampleRate,
                bufferSize: this.bufferSize,
                type: type
            }
        });
        this.worker.onmessage = function (e) {
            switch (e.data.command) {
                case "exportPcmLive":
                    self.onReceiveBuffer(e.data.val);
                    break;
                case "exportWav":
                    self.onReceiveWav(e.data.val);
                    break;
            }
        };
    };
    MediaUtil.prototype.onReceiveBuffer = function (val) { };
    MediaUtil.prototype.onReceiveWav = function (wavBlob) { };
    MediaUtil.prototype.writeString = function (view, offset, string) {
        for (var i = 0; i < string.length; i++) {
            view.setUint8(offset + i, string.charCodeAt(i));
        }
    };
    MediaUtil.prototype.writeBuffer = function (view, offset, buffer) {
        for (var i = 0; i < buffer.byteLength; i++) {
            view.setUint8(offset + i, buffer[i]);
        }
    };
    MediaUtil.prototype.concatenation = function (segments) {
        var sumLength = 0;
        for (var i = 0; i < segments.length; ++i) {
            sumLength += segments[i].buffer.byteLength;
        }
        var whole = new Uint8Array(sumLength);
        var pos = 0;
        for (var i = 0; i < segments.length; ++i) {
            whole.set(new Uint8Array(segments[i].buffer), pos);
            pos += segments[i].buffer.byteLength;
        }
        return whole;
    };
    MediaUtil.prototype.encodeWave = function (samples) {
        var wholeBuffer = this.concatenation(samples);
        var dataLength = wholeBuffer.byteLength;
        var buffer = new ArrayBuffer(dataLength + 44);
        var view = new DataView(buffer);
        var newSamepleRate = this.sampleRate;
        var newSampleBits = this.sampleBit;
        var newSampleChannel = this.channels;
        this.writeString(view, 0, "RIFF");
        view.setUint32(4, 36 + dataLength, true);
        this.writeString(view, 8, "WAVE");
        this.writeString(view, 12, "fmt ");
        view.setUint32(16, 16, true);
        view.setUint16(20, 1, true);
        view.setUint16(22, newSampleChannel, true);
        view.setUint32(24, newSamepleRate, true);
        view.setUint32(28, newSamepleRate * newSampleChannel * (newSampleBits / 8), true);
        view.setUint16(32, newSampleChannel * (newSampleBits / 8), true);
        view.setUint16(34, newSampleBits, true);
        this.writeString(view, 36, "data");
        view.setUint32(40, dataLength, true);
        this.writeBuffer(view, 44, wholeBuffer);
        return view;
    };
    MediaUtil.prototype.stop = function () {
        this.mic.disconnect();
        this.script.disconnect();
    };
    return MediaUtil;
}());
exports.MediaUtil = MediaUtil;


/***/ }),

/***/ "./sdk/src/webrtc/zego.client.web.ts":
/*!*******************************************!*\
  !*** ./sdk/src/webrtc/zego.client.web.ts ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (this && this.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.ZegoFlutterEngine = void 0;
var common_1 = __webpack_require__(/*! ../common */ "./sdk/src/common/index.ts");
var stateCenter_1 = __webpack_require__(/*! ../common/stateCenter */ "./sdk/src/common/stateCenter.ts");
var zego_stream_video_1 = __webpack_require__(/*! ./zego.stream.video */ "./sdk/src/webrtc/zego.stream.video.ts");
var mediaUtil_1 = __webpack_require__(/*! ../util/mediaUtil */ "./sdk/src/util/mediaUtil.ts");
// import { ClientUtil } from "../util/client-util";
var zego_express_engine_webrtc_1 = __webpack_require__(/*! zego-express-engine-webrtc */ "../zego-express-WebRTC/dist/ZegoExpressWebRTC.js");
var ZegoFlutterEngine = /** @class */ (function (_super) {
    __extends(ZegoFlutterEngine, _super);
    function ZegoFlutterEngine() {
        var _this = _super.call(this) || this;
        // this.logger = new ZegoLogger(0);
        _this.stateCenter = new stateCenter_1.StateCenter();
        _this.streamVideoCenter = new zego_stream_video_1.StreamVideoCenter();
        return _this;
    }
    ZegoFlutterEngine.createEngineWithProfile = function (profile) {
        if (!ZegoFlutterEngine.instance) {
            ZegoFlutterEngine.instance = new ZegoFlutterEngine();
            ZegoFlutterEngine.instance.createEngineWithProfile(profile);
        }
        return;
    };
    ZegoFlutterEngine.prototype.setLocalAudioOutput = function (localVideo, audioOutput) {
        this.logger.debug("zl.p.slao call");
        if (typeof audioOutput !== "string") {
            console.error("audiooutput is not string");
            return false;
        }
        return this.streamVideoCenter.setStreamAudioOutput(localVideo, audioOutput);
    };
    ZegoFlutterEngine.prototype.setPlayAudioOutput = function (streamid, audioOutput) {
        this.logger.debug("zl.p.spao call");
        if (typeof audioOutput !== "string") {
            console.error("audiooutput is not string");
            return false;
        }
        return this.streamVideoCenter.setPlayStreamAudioOutput(streamid, audioOutput);
    };
    ZegoFlutterEngine.prototype.setCustomSignalUrl = function (signalUrl) {
        this.logger.debug("zl.p.scs.0 call: " + signalUrl);
        this.zegoWebRTC.setCustomSignalUrl(signalUrl);
    };
    ZegoFlutterEngine.prototype.setQualityMonitorCycle = function (timeInMs) {
        if (typeof timeInMs === "number" && timeInMs >= 1000) {
            this.zegoWebRTC.streamCenter.setQualityMonitorCycle(timeInMs);
        }
    };
    /*
     *    "zl.p.sps.0": "ZegoFlutterEngine.startPlayingStream",  // 
     */
    ZegoFlutterEngine.prototype.startPlayingStream = function (streamid, remoteVideo, audioOutput, playOption) {
        var _this = this;
        this.logger.info("zl.p.sps.0 call streamid " + streamid);
        if (!remoteVideo) {
            this.logger.error("zl.p.sps.0 don't have remoteVideo");
            return false;
        }
        remoteVideo.oncanplay = function () {
            // this.onVideoSizeChanged(
            //   streamid,
            //   (remoteVideo as HTMLVideoElement).videoWidth,
            //   (remoteVideo as HTMLVideoElement).videoHeight
            // );
        };
        var option = {};
        playOption &&
            // @ts-ignore
            playOption.resourceMode &&
            // @ts-ignore
            (option.resourceMode = playOption.resourceMode);
        playOption &&
            playOption.streamParams &&
            (option.streamParams = playOption.streamParams);
        playOption &&
            playOption.videoDecodeType &&
            (option.videoCodec = playOption.videoDecodeType);
        if (playOption && playOption.playType) {
            switch (playOption.playType) {
                case "all":
                    option.video = true;
                    option.audio = true;
                    break;
                case "video":
                    option.audio = false;
                    break;
                case "audio":
                    option.video = false;
                    break;
                default:
                    break;
            }
        }
        this.zegoWebRTC.rtcModules.playModule
            .startPlayingStream(streamid, option)
            .then(function (stream) {
            remoteVideo.srcObject = stream;
            audioOutput && _this.setLocalAudioOutput(remoteVideo, audioOutput);
            _this.streamVideoCenter.playVideoStreamList.push({
                streamID: streamid,
                video: remoteVideo,
                mediaStream: stream
            });
        });
        return true;
    };
    ZegoFlutterEngine.prototype.setVideoConfig = function (config, channel) {
        var channelMap;
        channelMap = this.stateCenter.channelPreviewMap.get(channel);
        if (channelMap) {
            channelMap.videoConfig = config;
        }
        else {
            channelMap = { videoConfig: config };
        }
        this.stateCenter.channelPreviewMap.set(channel, channelMap);
    };
    ZegoFlutterEngine.prototype.getVideoConfig = function (channel) {
        var _a;
        return (_a = this.stateCenter.channelPreviewMap.get(channel)) === null || _a === void 0 ? void 0 : _a.videoConfig;
    };
    /*
     *    "zl.p.sps.0.1": "ZegoFlutterEngine.stopPlayingStream",
     */
    ZegoFlutterEngine.prototype.stopPlayingStream = function (streamid) {
        this.logger.info("zl.p.sps.1.0 call");
        this.zegoEntity.stopPlayingStream(streamid);
        this.streamVideoCenter.playVideoStreamList = this.streamVideoCenter.playVideoStreamList.filter(function (item) { return item.streamID !== streamid; });
        return true;
    };
    /*
     *    "zl.p.sp.0": "ZegoFlutterEngine.startPreview", 
     */
    ZegoFlutterEngine.prototype.startPreview = function (localVideo, channel) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var _a, _b, _c;
            _this.logger.info("zl.p.sp.0 call");
            if (!localVideo) {
                _this.logger.error("zl.p.sp.0 no localVideo");
                reject();
                return;
            }
            if ((_a = _this.stateCenter.channelPreviewMap.get(channel)) === null || _a === void 0 ? void 0 : _a.localVideo) {
                _this.logger.error("zl.p.sp.0 preview already exist");
                return;
            }
            var videoConfig = (_b = _this.stateCenter.channelPreviewMap.get(channel)) === null || _b === void 0 ? void 0 : _b.videoConfig;
            var enableCamera = (_c = _this.stateCenter.channelPreviewMap.get(channel)) === null || _c === void 0 ? void 0 : _c.enableCamera;
            var constraints = {
                camera: {
                    AEC: _this.stateCenter.audioConfig.AEC,
                    AGC: _this.stateCenter.audioConfig.AGC,
                    ANS: _this.stateCenter.audioConfig.ANS
                }
            };
            if (typeof enableCamera == "boolean") {
                constraints.camera.video = enableCamera;
            }
            if (videoConfig) {
                constraints = {
                    camera: __assign(__assign({}, constraints.camera), { videoQuality: 4, width: videoConfig.captureWidth, height: videoConfig.captureHeight, frameRate: videoConfig.fps, bitrate: videoConfig.bitrate })
                };
            }
            _this.zegoEntity
                .createStream(constraints)
                .then(function (stream) {
                localVideo.srcObject = stream;
                _this.streamVideoCenter.publishVideoStreamList.push({
                    video: localVideo,
                    mediaStream: stream
                });
                var channelMap;
                channelMap = _this.stateCenter.channelPreviewMap.get(channel);
                if (channelMap) {
                    channelMap.localVideo = localVideo;
                    channelMap.isStopPre = false;
                }
                else {
                    channelMap = { localVideo: localVideo, isStopPre: false };
                }
                _this.stateCenter.channelPreviewMap.set(channel, channelMap);
                resolve();
            })
                .catch(function (err) {
                reject();
            });
        });
    };
    ZegoFlutterEngine.prototype.mutePublishStreamVideo = function (mute, channel) {
        var channelMap = this.stateCenter.channelPreviewMap.get(channel);
        var localVideo;
        if (channelMap) {
            localVideo = channelMap.localVideo;
        }
        if (!localVideo || !localVideo.srcObject) {
            return false;
        }
        var stream = localVideo.srcObject;
        return this.zegoEntity.mutePublishStreamVideo(stream, mute);
    };
    ZegoFlutterEngine.prototype.mutePublishStreamAudio = function (mute, channel) {
        var channelMap = this.stateCenter.channelPreviewMap.get(channel);
        var localVideo;
        if (channelMap) {
            localVideo = channelMap.localVideo;
        }
        if (!localVideo || !localVideo.srcObject) {
            return false;
        }
        var stream = localVideo.srcObject;
        return this.zegoEntity.mutePublishStreamAudio(stream, mute);
    };
    /*
     *    "zl.p.sp.1": "ZegoFlutterEngine.stopPreview",
     */
    ZegoFlutterEngine.prototype.stopPreview = function (channel) {
        var _a;
        this.logger.debug("zl.p.sp.1.0 call");
        var localVideo = (_a = this.stateCenter.channelPreviewMap.get(channel)) === null || _a === void 0 ? void 0 : _a.localVideo;
        if (!localVideo) {
            this.logger.info("zl.p.sp.1.0 param error");
            return false;
        }
        var videoStream = this.streamVideoCenter.checkPublishVideo(localVideo);
        if (!videoStream) {
            this.logger.info("zl.p.sp.1.0 video not found");
            return false;
        }
        this.zegoEntity.destroyStream(videoStream.mediaStream);
        this.streamVideoCenter.removePublishVideo(localVideo);
        localVideo.srcObject = null;
        var channelMap = this.stateCenter.channelPreviewMap.get(channel);
        if (channelMap) {
            channelMap.localVideo = undefined;
            this.stateCenter.channelPreviewMap.set(channel, channelMap);
        }
        return true;
    };
    /*
     *    "zl.p.sps.1": "ZegoFlutterEngine.startPublishingStream",
     */
    ZegoFlutterEngine.prototype.startPublishingStream = function (streamid, channel) {
        var _this = this;
        var _a, _b;
        this.logger.info("zl.p.sps.1 call streamid: " + streamid);
        var localVideo = (_a = this.stateCenter.channelPreviewMap.get(channel)) === null || _a === void 0 ? void 0 : _a.localVideo;
        if (!localVideo) {
            this.logger.info("zl.p.sp.1 localVideo no found");
            var _localVideo = document.createElement("video");
            this.startPreview(_localVideo, channel).then(function () {
                var channelMap = _this.stateCenter.channelPreviewMap.get(channel);
                if (channelMap) {
                    channelMap.isStopPre = true;
                    _this.stateCenter.channelPreviewMap.set(channel, channelMap);
                }
                _this.startPublishingStream(streamid, channel);
            }).catch(function (err) {
                console.error(err);
            });
            return;
        }
        var videoStream = this.streamVideoCenter.checkPublishVideo(localVideo);
        if (!videoStream) {
            this.logger.info("zl.p.sp.1 video not found");
            return;
        }
        var videoCodec;
        var config = (_b = this.stateCenter.channelPreviewMap.get(channel)) === null || _b === void 0 ? void 0 : _b.videoConfig;
        if (config) {
            videoCodec = config.codecID == 2 ? "VP8" : "H264";
        }
        try {
            this.zegoEntity.startPublishingStream(streamid, videoStream.mediaStream, {
                // streamParams: playOption && playOption.streamParams,
                // extraInfo: extraInfo === null ? "" : extraInfo,
                videoCodec: videoCodec,
                // @ts-ignore
                // cdnUrl: playOption && playOption.cdnUrl
            });
            var channelMap = this.stateCenter.channelPreviewMap.get(channel);
            if (channelMap) {
                channelMap.streamID = streamid;
                this.stateCenter.channelPreviewMap.set(channel, channelMap);
            }
        }
        catch (error) {
            console.error(error);
        }
        return;
    };
    //
    ZegoFlutterEngine.prototype.stopPublishingStream = function (channel) {
        var channelMap = this.stateCenter.channelPreviewMap.get(channel);
        if (channelMap) {
            var streamID = channelMap.streamID;
            if (!streamID) {
                this.logger.error("zl.p.sps.1 streamID no found");
                return false;
            }
            channelMap.streamID = undefined;
            this.stateCenter.channelPreviewMap.set(channel, channelMap);
            if (this.zegoEntity.stopPublishingStream(streamID) && channelMap.isStopPre) {
                this.stopPreview(channel);
                return true;
            }
            else {
                return false;
            }
        }
        else {
            return false;
        }
    };
    ZegoFlutterEngine.prototype.enableCamera = function (enable, channel) {
        if (typeof enable !== "boolean") {
            return;
        }
        var channelMap = this.stateCenter.channelPreviewMap.get(channel);
        if (channelMap) {
            channelMap.enableCamera = enable;
            this.mutePublishStreamVideo(enable, channel);
        }
        else {
            channelMap = { enableCamera: enable };
        }
        this.stateCenter.channelPreviewMap.set(channel, channelMap);
    };
    //
    ZegoFlutterEngine.prototype.startMixingAudio = function (streamID, audio, replace) {
        this.logger.debug("zl.sma.0 call");
        if (!streamID || typeof streamID !== "string") {
            this.logger.error("zl.sma.0 stream id type error");
            return false;
        }
        if (!audio) {
            this.logger.error("zl.sma.0 no audio");
            return false;
        }
        if (Array.isArray(audio) && audio.length !== 0) {
            this.streamVideoCenter.audio = audio;
            return this.zegoEntity.startMixingAudio(streamID, audio);
        }
        else if (audio instanceof HTMLMediaElement) {
            this.streamVideoCenter.audio = [audio];
            return this.zegoEntity.startMixingAudio(streamID, [audio]);
        }
        else {
            this.logger.error("zl.sma.0 audio param type error");
            return false;
        }
    };
    //
    ZegoFlutterEngine.prototype.stopMixingAudio = function (streamID, audio) {
        if (!streamID || typeof streamID !== "string") {
            this.logger.error("zl.sma.1 param streamID format error");
            return false;
        }
        // 
        this.zegoWebRTC.stopEffect(streamID);
        // 
        if (Array.isArray(audio) && audio.length !== 0) {
            var res = this.zegoEntity.stopMixingAudio(streamID, audio);
            this.streamVideoCenter.audio = this.streamVideoCenter.audio.filter(function (audioItem) { return audio.every(function (item) { return item !== audioItem; }); });
            return res;
        }
        else if (typeof audio === "undefined") {
            var res = this.zegoEntity.stopMixingAudio(streamID, this.streamVideoCenter.audio);
            this.streamVideoCenter.audio = [];
            return res;
        }
        else {
            this.logger.info("zl.sma.0 no audio");
            return false;
        }
    };
    //
    //   mixingBuffer(
    //     streamID: string,
    //     sourceID: string,
    //     arrayBuffer: ArrayBuffer,
    //     callBack?: Function
    //   ) {
    //     // const publisher: ZegoPublish = this.getPublisher(streamID);
    //     // if (!publisher) {
    //     //   this.logger.error("zl.mb.0 publisher doesn't exist");
    //     //   return;
    //     // }
    //     // if (arrayBuffer instanceof ArrayBuffer) {
    //     //   publisher.mixingBuffer(arrayBuffer, callBack);
    //     // } else {
    //     //   this.logger.error("zl.mb.0 array buffer not found");
    //     //   return;
    //     // }
    //   }
    //   stopMixingBuffer(streamID: string, source: Array<string>): boolean {
    //     // if (!streamID || typeof streamID !== "string") {
    //     //   this.logger.error("zl.sma.1 param streamid format error");
    //     //   return false;
    //     // }
    //     // const publisher: ZegoPublish = this.getPublisher(streamID);
    //     // if (!publisher) {
    //     //   this.logger.error("zl.sma.1 publisher doesn't exist");
    //     //   return false;
    //     // }
    //     // return publisher.stopMixingBuffer();
    //     return true;
    //   }
    ZegoFlutterEngine.prototype.setMixingAudioVolume = function (streamid, volume) {
        var _this = this;
        this.logger.debug("zl.sma.2 call");
        if (!streamid ||
            typeof streamid !== "string" ||
            typeof volume !== "number" ||
            volume < 0 ||
            volume > 100) {
            this.logger.error("zl.sma.2 param error");
            return false;
        }
        if (Array.isArray(this.streamVideoCenter.audio) &&
            this.streamVideoCenter.audio.length !== 0) {
            this.streamVideoCenter.audio.forEach(function (item) {
                _this.zegoEntity.setMixingAudioVolume(streamid, volume, item);
            });
        }
        return this.zegoWebRTC.rtcModules.audioMixModule.setEffectVolume(streamid, volume);
    };
    ZegoFlutterEngine.prototype.startScreenShotChrome = function (callBack) {
        var _this = this;
        this.zegoEntity
            .createStream({
            screen: {
                audio: false,
                // @ts-ignore
                type: "shot"
            }
        })
            .then(function (stream) {
            _this.streamVideoCenter.screenShotStreamList.push({ stream: stream });
            callBack(true, stream);
        })
            .catch(function (err) {
            callBack(false, null, err);
        });
    };
    ZegoFlutterEngine.prototype.startScreenSharing = function (screenConfig, audio, callBack) {
        var _this = this;
        this.zegoEntity
            .createStream({
            screen: {
                audio: audio,
                width: screenConfig.width || window.screen.width,
                height: screenConfig.height || window.screen.height,
                frameRate: screenConfig.frameRate || 15,
                videoQuality: 4,
                bitrate: screenConfig.bitRate || 1500,
                // @ts-ignore
                type: "sharing"
            }
        })
            .then(function (stream) {
            _this.streamVideoCenter.screenShotStreamList.push({ stream: stream });
            callBack(true, stream);
        })
            .catch(function (err) {
            callBack(false, null, err);
        });
    };
    ZegoFlutterEngine.prototype.startScreenShotFirFox = function (screenConfig, mediaSource, audio, callBack) {
        var _this = this;
        this.zegoEntity
            .createStream({
            screen: {
                audio: audio,
                width: screenConfig.width || window.screen.width,
                height: screenConfig.height || window.screen.height,
                frameRate: screenConfig.frameRate || 15,
                videoQuality: 4,
                // @ts-ignore
                bitrate: screenConfig.bitRate || 1500,
                // @ts-ignore
                type: "firefox"
            }
        })
            .then(function (stream) {
            _this.streamVideoCenter.screenShotStreamList.push({ stream: stream });
            callBack(true, stream);
        })
            .catch(function (err) {
            callBack(false, null);
        });
    };
    ZegoFlutterEngine.prototype.stopScreenShot = function (stream) {
        var _this = this;
        if (stream === undefined) {
            this.streamVideoCenter.screenShotStreamList.forEach(function (item) {
                _this.zegoEntity.destroyStream(item.stream);
            });
        }
        else {
            this.zegoEntity.destroyStream(stream);
        }
    };
    ZegoFlutterEngine.prototype.switchDevice = function (type, localVideo, deviceId, success, error) {
        if ((type !== "audio" && type !== "video") ||
            typeof deviceId !== "string") {
            this.logger.error("zg.sd.0 param error");
            return;
        }
        var videoStream = this.streamVideoCenter.checkPublishVideo(localVideo);
        if (!videoStream) {
            this.logger.info("zl.p.sp.1 video not found");
            return;
        }
        if (type === "video") {
            this.zegoEntity
                .useVideoDevice(videoStream.mediaStream, deviceId)
                .then(function () {
                success && success();
            })
                .catch(function (err) {
                error && error(err);
            });
        }
        else {
            this.zegoEntity
                .useAudioDevice(videoStream.mediaStream, deviceId)
                .then(function () {
                success && success();
            })
                .catch(function (err) {
                error && error(err);
            });
        }
    };
    ZegoFlutterEngine.prototype.filterStreamList = function (streamId) {
        var _a;
        var flv = {};
        var hls = {};
        var rtmp = {};
        var streamListUrl = [];
        var index = 0;
        var streamList = (_a = this.zegoWebRTC.streamCenter.getRoomByStreamID(streamId || "")) === null || _a === void 0 ? void 0 : _a.streamList;
        if (!streamList)
            return;
        streamList.forEach(function (item, ind) {
            if (item.stream_id == streamId)
                index = ind;
        });
        for (var key in streamList[index]) {
            if (key == "urls_flv" || key == "urls_https_flv") {
                flv[key] = streamList[index][key];
            }
            if (key == "urls_m3u8" || key == "urls_https_m3u8") {
                hls[key] = streamList[index][key];
            }
            if (key == "urls_rtmp") {
                rtmp[key] = streamList[index][key];
            }
        }
        var pro = window.location.protocol;
        var ua = window.navigator.userAgent;
        if (/Safari/.test(ua) && !/Chrome/.test(ua)) {
            for (var key in hls) {
                if (hls[key]) {
                    hls[key].forEach(function (item) {
                        if (item.indexOf(pro) !== -1)
                            streamListUrl.push(item);
                    });
                }
            }
        }
        else if (pro == "http:") {
            for (var key in flv) {
                if (flv[key]) {
                    flv[key].forEach(function (item) {
                        if (item.indexOf("http") !== -1 || item.indexOf("https") !== -1)
                            streamListUrl.push(item);
                    });
                }
            }
        }
        else if (pro == "https:") {
            for (var key in flv) {
                if (flv[key]) {
                    flv[key].forEach(function (item) {
                        if (item.indexOf(pro) !== -1)
                            streamListUrl.push(item);
                    });
                }
            }
        }
        else if (pro == "rtmp:") {
            for (var key in rtmp) {
                if (rtmp[key]) {
                    rtmp[key].forEach(function (item) {
                        if (item.indexOf(pro) !== -1)
                            streamListUrl.push(item);
                    });
                }
            }
        }
        return streamListUrl.filter(function (ele, index, self) { return self.indexOf(ele) == index; });
    };
    ZegoFlutterEngine.prototype.setPublishStreamConstraints = function (streamID, constraints, success, error) {
        var _a;
        this.logger.info("zl.spsc.0 call");
        var publish = this.zegoWebRTC.streamCenter.publisherList[streamID];
        if (!publish || !publish.localStream) {
            this.logger.error("zl.spsc.0 publish not exist");
            return;
        }
        var promiseList = [];
        var maxBitrate = undefined;
        if (typeof (constraints === null || constraints === void 0 ? void 0 : constraints.bitRate) === "number") {
            maxBitrate = constraints.bitRate;
        }
        else if (typeof (constraints === null || constraints === void 0 ? void 0 : constraints.maxBitRate) === "number") {
            maxBitrate = constraints.maxBitRate;
        }
        else if (typeof ((_a = constraints === null || constraints === void 0 ? void 0 : constraints.bitRate) === null || _a === void 0 ? void 0 : _a.maxBitRate) === "number") {
            maxBitrate = constraints.bitRate.maxBitRate;
        }
        if (constraints.width ||
            constraints.height ||
            constraints.frameRate ||
            constraints.bitRate) {
            promiseList.push(this.zegoEntity.setVideoConfig(publish.localStream, {
                width: constraints.width,
                height: constraints.height,
                frameRate: constraints.frameRate,
                maxBitrate: maxBitrate
            }));
        }
        var audioConfigKeys = [
            "noiseSuppression",
            "autoGainControl",
            "echoCancellation"
        ];
        var hasSetAudio = audioConfigKeys.some(function (key) {
            var value = constraints[key];
            if (typeof value !== "undefined")
                return true;
            return false;
        });
        if (hasSetAudio) {
            var promise = this.zegoEntity.setAudioConfig(publish.localStream, {
                ANS: constraints.noiseSuppression,
                AGC: constraints.autoGainControl,
                AEC: constraints.echoCancellation
            });
            promiseList.push(promise);
        }
        Promise.all(promiseList)
            .then(function () {
            success();
        })
            .catch(function (err) {
            error(err);
        });
    };
    ZegoFlutterEngine.prototype.setSoundLevelDelegate = function (bool, timeInMs) {
        this.logger.info("zl.ssd.0 call");
        this.zegoEntity.setSoundLevelDelegate(bool, timeInMs);
    };
    ZegoFlutterEngine.prototype.enableAEC = function (enable) {
        if (typeof enable == "boolean") {
            this.stateCenter.audioConfig.AEC = enable;
        }
    };
    ZegoFlutterEngine.prototype.enableAGC = function (enable) {
        if (typeof enable == "boolean") {
            this.stateCenter.audioConfig.AGC = enable;
        }
    };
    ZegoFlutterEngine.prototype.enableANS = function (enable) {
        if (typeof enable == "boolean") {
            this.stateCenter.audioConfig.ANS = enable;
        }
    };
    /**
     * 
     *
     * Note: 2.14.0 
     *
     * Note:  mutePublishStreamVideo(true)  mutePublishStreamVideo(false) 
     *
     * Note: 
     *
     * Note:  API 
     *
     * @param filePath 
     * @param stream mediaStream HTMLMediaElement  srcObject
     */
    ZegoFlutterEngine.supportDetection = function (success, error) {
        if (navigator &&
            navigator.mediaDevices &&
            (this.screenShotReady || "getDisplayMedia" in navigator.mediaDevices)) {
            zego_express_engine_webrtc_1.ClientUtil.supportDetection(true, function (capability) {
                success({
                    webRtc: capability.webRTC,
                    capture: capability.customCapture,
                    videoDecodeType: capability.videoCodec,
                    screenSharing: capability.screenSharing,
                    camera: capability.camera,
                    microphone: capability.microphone
                });
            }, 0);
        }
        else {
            zego_express_engine_webrtc_1.ClientUtil.supportDetection(false, function (capability) {
                success({
                    webRtc: capability.webRTC,
                    capture: capability.customCapture,
                    videoDecodeType: capability.videoCodec,
                    screenSharing: capability.screenSharing
                });
            }, 0);
        }
    };
    ZegoFlutterEngine.prototype.enumDevices = function (deviceInfoCallback, error) {
        ZegoFlutterEngine.enumDevices(deviceInfoCallback, error);
    };
    ZegoFlutterEngine.enumDevices = function (deviceInfoCallback, error) {
        if (navigator.mediaDevices === undefined ||
            navigator.mediaDevices.enumerateDevices === undefined) {
            if (error) {
                error("browser don't support enumerate devices");
            }
            return;
        }
        navigator.mediaDevices
            .enumerateDevices()
            .then(function (deviceInfos) {
            var microphone = [];
            var speaker = [];
            var camera = [];
            for (var i = 0; i < deviceInfos.length; i++) {
                var deviceInfo = deviceInfos[i];
                if (deviceInfo.kind === "audioinput") {
                    microphone.push({
                        label: deviceInfo.label,
                        deviceId: deviceInfo.deviceId
                    });
                }
                if (deviceInfo.kind === "audiooutput") {
                    speaker.push({
                        label: deviceInfo.label,
                        deviceId: deviceInfo.deviceId
                    });
                }
                if (deviceInfo.kind === "videoinput") {
                    camera.push({
                        label: deviceInfo.label,
                        deviceId: deviceInfo.deviceId
                    });
                }
            }
            if (deviceInfoCallback) {
                deviceInfoCallback({
                    microphones: microphone,
                    speakers: speaker,
                    cameras: camera
                });
            }
        })
            .catch(function (err) {
            if (error) {
                error(err);
            }
        });
    };
    ZegoFlutterEngine.getAudioInfo = function (el, errCallBack, option) {
        if (!el.srcObject) {
            console.error("srcObject is empty!");
            return null;
        }
        var _option = __assign({}, option);
        return new mediaUtil_1.MediaUtil(_option).connectToSource(el.srcObject, function (e) {
            errCallBack(e);
        });
    };
    ZegoFlutterEngine.handleDataAvailable = function (event) {
        if (event.data && event.data.size > 0) {
            ZegoFlutterEngine.recordedBlobs.push(event.data);
        }
    };
    ZegoFlutterEngine.startRecord = function (el, constraints, callBack) {
        return __awaiter(this, void 0, void 0, function () {
            var playStream, options;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        console.error("startRecord", MediaRecorder);
                        ZegoFlutterEngine.recordedBlobs = [];
                        options = { mimeType: "video/webm;codecs=vp9" };
                        if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                            options = { mimeType: "video/webm;codecs=vp8" };
                            if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                                options = { mimeType: "video/webm" };
                                if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                                    options = { mimeType: "" };
                                }
                            }
                        }
                        if (!(constraints && constraints.audio)) return [3 /*break*/, 2];
                        options = { mimeType: "audio/webm" };
                        if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                            options = { mimeType: "" };
                        }
                        return [4 /*yield*/, navigator.mediaDevices.getUserMedia({
                                audio: {
                                    deviceId: constraints.audioInput ? constraints.audioInput : ""
                                }
                            })];
                    case 1:
                        playStream = _a.sent();
                        ZegoFlutterEngine.recordType = "audio";
                        return [3 /*break*/, 3];
                    case 2:
                        playStream = el.captureStream();
                        _a.label = 3;
                    case 3:
                        try {
                            ZegoFlutterEngine.mediaRecorder = new MediaRecorder(playStream, options);
                        }
                        catch (e) {
                            console.error("Exception while creating MediaRecorder:", e);
                            callBack && callBack(e);
                            return [2 /*return*/];
                        }
                        ZegoFlutterEngine.mediaRecorder.onstop = function (event) {
                            console.log("Recorder stopped: ", event);
                            constraints &&
                                constraints.audio &&
                                playStream.getTracks().forEach(function (track) { return track.stop(); });
                        };
                        ZegoFlutterEngine.mediaRecorder.ondataavailable = ZegoFlutterEngine.handleDataAvailable;
                        ZegoFlutterEngine.mediaRecorder.start(10); // collect 10ms of data
                        callBack && callBack();
                        return [2 /*return*/];
                }
            });
        });
    };
    ZegoFlutterEngine.stopRecord = function () {
        if (ZegoFlutterEngine.mediaRecorder) {
            ZegoFlutterEngine.mediaRecorder.stop();
        }
        else {
            console.warn("please invoke startRecord first");
        }
    };
    ZegoFlutterEngine.resumeRecord = function () {
        if (ZegoFlutterEngine.mediaRecorder) {
            ZegoFlutterEngine.mediaRecorder.resume();
        }
        else {
            console.warn("please invoke startRecord first");
        }
    };
    ZegoFlutterEngine.pauseRecord = function () {
        if (ZegoFlutterEngine.mediaRecorder) {
            ZegoFlutterEngine.mediaRecorder.pause();
        }
        else {
            console.warn("please invoke startRecord first");
        }
    };
    ZegoFlutterEngine.saveRecord = function (name) {
        if (ZegoFlutterEngine.mediaRecorder && ZegoFlutterEngine.recordedBlobs) {
            var blob = new Blob(ZegoFlutterEngine.recordedBlobs, {
                type: ZegoFlutterEngine.recordType === "video" ? "video/webm" : "audio/webm"
            });
            var url_1 = window.URL.createObjectURL(blob);
            if (typeof name == "string" && name !== "") {
                var a_1 = document.createElement("a");
                a_1.style.display = "none";
                a_1.href = url_1;
                a_1.download = name + ".webm";
                document.body.appendChild(a_1);
                a_1.click();
                setTimeout(function () {
                    document.body.removeChild(a_1);
                    window.URL.revokeObjectURL(url_1);
                }, 100);
            }
            return url_1;
        }
        else {
            console.warn("please invoke startRecord first");
        }
    };
    ZegoFlutterEngine.resumeRecordAudio = function () {
        if (ZegoFlutterEngine.mediaRecorder) {
            ZegoFlutterEngine.mediaRecorder.resume();
        }
        else {
            console.warn("please invoke startRecordAudio first");
        }
    };
    ZegoFlutterEngine.pauseRecordAudio = function () {
        if (ZegoFlutterEngine.mediaRecorder) {
            ZegoFlutterEngine.mediaRecorder.pause();
        }
        else {
            console.warn("please invoke startRecordAudio first");
        }
    };
    ZegoFlutterEngine.getRecordAudio = function () {
        if (ZegoFlutterEngine.mediaRecorder && ZegoFlutterEngine.recordedBlobs) {
            var blob = new Blob(ZegoFlutterEngine.recordedBlobs);
            var url = window.URL.createObjectURL(blob);
            return url;
        }
        else {
            console.warn("please invoke startRecordAudio first");
        }
    };
    ZegoFlutterEngine.takeSnapShot = function (el, img) {
        if (el && el.videoHeight !== 0) {
            var canvas = document.createElement("canvas");
            canvas.width = el.videoWidth;
            canvas.height = el.videoHeight;
            var canvasContext = canvas.getContext("2d");
            canvasContext.drawImage(el, 0, 0, canvas.width, canvas.height);
            img.src = canvas.toDataURL("image/jpeg");
        }
        else {
            console.error("video can not empty");
        }
    };
    ZegoFlutterEngine.saveSnapShot = function (el, name) {
        if (el && el.videoHeight !== 0) {
            var canvas = document.createElement("canvas");
            canvas.width = el.videoWidth;
            canvas.height = el.videoHeight;
            var canvasContext = canvas.getContext("2d");
            canvasContext.drawImage(el, 0, 0, canvas.width, canvas.height);
            canvas.toBlob(function (blob) {
                var url = window.URL.createObjectURL(blob);
                var a = document.createElement("a");
                a.style.display = "none";
                a.href = url;
                a.download = name + ".jpeg";
                document.body.appendChild(a);
                a.click();
                setTimeout(function () {
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                }, 100);
            });
        }
        else {
            console.error("video can not empty");
        }
    };
    ZegoFlutterEngine.destroyEngine = function () {
        var _a;
        if (ZegoFlutterEngine.instance) {
            ZegoFlutterEngine.instance.logoutRoom();
            (_a = ZegoFlutterEngine.instance.zegoEntity.zegoWebRTM.netAgent) === null || _a === void 0 ? void 0 : _a.destroyConnect();
        }
        ZegoFlutterEngine.instance = null;
        // this.logger.stopLogServer();
        // this.logger.debug("zl.cm.rl call success");
    };
    ZegoFlutterEngine.screenShotReady = false;
    ZegoFlutterEngine.recordType = "video";
    return ZegoFlutterEngine;
}(common_1.BaseCenter));
exports.ZegoFlutterEngine = ZegoFlutterEngine;


/***/ }),

/***/ "./sdk/src/webrtc/zego.stream.video.ts":
/*!*********************************************!*\
  !*** ./sdk/src/webrtc/zego.stream.video.ts ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
exports.StreamVideoCenter = void 0;
var StreamVideoCenter = /** @class */ (function () {
    function StreamVideoCenter() {
        this.publishVideoStreamList = [];
        this.playVideoStreamList = [];
        this.screenShotStreamList = [];
        this.audio = [];
    }
    StreamVideoCenter.prototype.checkPublishVideo = function (localVideo) {
        for (var i = 0; i < this.publishVideoStreamList.length; i++) {
            if (this.publishVideoStreamList[i].video === localVideo) {
                return this.publishVideoStreamList[i];
            }
        }
        return null;
    };
    StreamVideoCenter.prototype.checkPlayVideo = function (localVideo) {
        for (var i = 0; i < this.playVideoStreamList.length; i++) {
            if (this.playVideoStreamList[i].video === localVideo) {
                return this.playVideoStreamList[i];
            }
        }
        return null;
    };
    StreamVideoCenter.prototype.removePublishVideo = function (localVideo) {
        for (var i = 0; i < this.publishVideoStreamList.length; i++) {
            if (this.publishVideoStreamList[i].video === localVideo) {
                this.publishVideoStreamList.splice(i--, 1);
                break;
            }
        }
    };
    StreamVideoCenter.prototype.setStreamAudioOutput = function (localVideo, audioOutput) {
        var _this = this;
        if (audioOutput != undefined && audioOutput.length != 0 && localVideo) {
            this.logger.debug("zsc.ssao.0 device " + audioOutput);
            if (!localVideo) {
                this.logger.error("zsc.ssao.0 no localVideo");
                return false;
            }
            if (localVideo.sinkId !== "undefined") {
                localVideo
                    .setSinkId(audioOutput)
                    .then(function () {
                    _this.logger.info("zsc.ssao.0 success device: " + audioOutput);
                    // _this.audioOutput = audioOutput;
                })
                    .catch(function (error) {
                    _this.logger.info("zsc.ssao.0 " + error.name);
                });
                return true;
            }
            else {
                this.logger.error("zsc.ssao.0 browser does not support");
                return false;
            }
        }
        return false;
    };
    StreamVideoCenter.prototype.setPlayStreamAudioOutput = function (streamid, audioOutput) {
        if (audioOutput != undefined && audioOutput.length != 0) {
            this.logger.debug("zsc.psao.1 device " + audioOutput);
            var playVideoStream = this.playVideoStreamList.find(function (item) { return item.streamID === streamid; });
            if (!playVideoStream) {
                this.logger.info("zsc.psao.1 play don't exist");
                return false;
            }
            return this.setStreamAudioOutput(playVideoStream.video, audioOutput);
        }
        return false;
    };
    return StreamVideoCenter;
}());
exports.StreamVideoCenter = StreamVideoCenter;


/***/ })

/******/ });